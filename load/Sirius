{"status":200,"content":"CmxvY2FsIHJlcXVlc3QgPSByZXF1aXJlICdnYW1lc2Vuc2UvaHR0cCcKCgoKCgoKCgpsb2NhbCBmdW5jdGlvbiBsZXJwKHgsIHYsIHQpCiAgICBpZiB0eXBlKHgpID09ICd0YWJsZScgdGhlbgogICAgICAgIHJldHVybiBsZXJwKHhbMV0sIHZbMV0sIHQpLCBsZXJwKHhbMl0sIHZbMl0sIHQpLCBsZXJwKHhbM10sIHZbM10sIHQpLCBsZXJwKHhbNF0sIHZbNF0sIHQpCiAgICBlbmQKCiAgICBsb2NhbCBkZWx0YSA9IHYgLSB4CgogICAgaWYgdHlwZShkZWx0YSkgPT0gJ251bWJlcicgdGhlbgogICAgICAgIGlmIG1hdGguYWJzKGRlbHRhKSA8IDAuMDA1IHRoZW4KICAgICAgICAgICAgcmV0dXJuIHYKICAgICAgICBlbmQKICAgIGVuZAoKICAgIHJldHVybiBkZWx0YSAqIHQgKyB4CmVuZAoKCgoKCmxvY2FsIHZlY3RvciA9IHJlcXVpcmUgJ3ZlY3RvcicKCmxvY2FsIHJnYmFfdG9faGV4ID0gZnVuY3Rpb24ociwgZywgYiwgYSkKICAgIHJldHVybiBiaXQudG9oZXgoCiAgICAgICAgKG1hdGguZmxvb3IociArIDAuNSkgKiAxNjc3NzIxNikgKwogICAgICAgIChtYXRoLmZsb29yKGcgKyAwLjUpICogNjU1MzYpICsKICAgICAgICAobWF0aC5mbG9vcihiICsgMC41KSAqIDI1NikgKwogICAgICAgIChtYXRoLmZsb29yKGEgKyAwLjUpKQogICAgKQplbmQKCmxvY2FsIGZ1bmN0aW9uIGhleGFUb1JnYmEoaGV4YUNvbG9yKQogICAgbG9jYWwgaGV4ID0gaGV4YUNvbG9yOmdzdWIoIiMiLCAiIikKICAgIGxvY2FsIHIgPSB0b251bWJlcihoZXg6c3ViKDEsIDIpLCAxNikgLyAyNTUKICAgIGxvY2FsIGcgPSB0b251bWJlcihoZXg6c3ViKDMsIDQpLCAxNikgLyAyNTUKICAgIGxvY2FsIGIgPSB0b251bWJlcihoZXg6c3ViKDUsIDYpLCAxNikgLyAyNTUKICAgIGxvY2FsIGEgPSB0b251bWJlcihoZXg6c3ViKDcsIDgpLCAxNikgLyAyNTUKCiAgICByZXR1cm4gciwgZywgYiwgYQplbmQKbG9jYWwgaGl0Z3JvdXBfbmFtZXMgPSB7ICJnZW5lcmljIiwgImhlYWQiLCAiY2hlc3QiLCAic3RvbWFjaCIsICJsZWZ0IGFybSIsICJyaWdodCBhcm0iLCAibGVmdCBsZWciLCAicmlnaHQgbGVnIiwgIm5lY2siLAogICAgIj8iLCAiZ2VhciIgfQpsb2NhbCByZWZzID0gewogICAgZG91YmxlX3RhcCA9IHsgdWkucmVmZXJlbmNlKCdSQUdFJywgJ0FpbWJvdCcsICdEb3VibGUgdGFwJykgfSwKICAgIGR1Y2tfcGVla19hc3Npc3QgPSB1aS5yZWZlcmVuY2UoJ1JBR0UnLCAnT3RoZXInLCAnRHVjayBwZWVrIGFzc2lzdCcpLAogICAgcGl0Y2ggPSB7IHVpLnJlZmVyZW5jZSgnQUEnLCAnQW50aS1haW1ib3QgYW5nbGVzJywgJ1BpdGNoJykgfSwKICAgIHlhd19iYXNlID0gdWkucmVmZXJlbmNlKCdBQScsICdBbnRpLWFpbWJvdCBhbmdsZXMnLCAnWWF3IGJhc2UnKSwKICAgIHlhdyA9IHsgdWkucmVmZXJlbmNlKCdBQScsICdBbnRpLWFpbWJvdCBhbmdsZXMnLCAnWWF3JykgfSwKICAgIHlhd19qaXR0ZXIgPSB7IHVpLnJlZmVyZW5jZSgnQUEnLCAnQW50aS1haW1ib3QgYW5nbGVzJywgJ1lhdyBqaXR0ZXInKSB9LAogICAgYm9keV95YXcgPSB7IHVpLnJlZmVyZW5jZSgnQUEnLCAnQW50aS1haW1ib3QgYW5nbGVzJywgJ0JvZHkgeWF3JykgfSwKICAgIGZyZWVzdGFuZGluZ19ib2R5X3lhdyA9IHVpLnJlZmVyZW5jZSgnQUEnLCAnYW50aS1haW1ib3QgYW5nbGVzJywgJ0ZyZWVzdGFuZGluZyBib2R5IHlhdycpLAogICAgZWRnZV95YXcgPSB1aS5yZWZlcmVuY2UoJ0FBJywgJ0FudGktYWltYm90IGFuZ2xlcycsICdFZGdlIHlhdycpLAogICAgZnJlZXN0YW5kaW5nID0geyB1aS5yZWZlcmVuY2UoJ0FBJywgJ0FudGktYWltYm90IGFuZ2xlcycsICdGcmVlc3RhbmRpbmcnKSB9LAogICAgcm9sbCA9IHVpLnJlZmVyZW5jZSgnQUEnLCAnQW50aS1haW1ib3QgYW5nbGVzJywgJ1JvbGwnKSwKICAgIG9uX3Nob3RfYW50aV9haW0gPSB7IHVpLnJlZmVyZW5jZSgnQUEnLCAnT3RoZXInLCAnT24gc2hvdCBhbnRpLWFpbScpIH0sCiAgICBzbG93X21vdGlvbiA9IHsgdWkucmVmZXJlbmNlKCdBQScsICdPdGhlcicsICdTbG93IG1vdGlvbicpIH0sCiAgICBkbWcgPSB7IHVpLnJlZmVyZW5jZSgnUkFHRScsICdBaW1ib3QnLCAnTWluaW11bSBkYW1hZ2Ugb3ZlcnJpZGUnKSB9LAogICAgYXV0b19wZWVrID0geyB1aS5yZWZlcmVuY2UoIlJhZ2UiLCAiT3RoZXIiLCAiUXVpY2sgcGVlayBhc3Npc3QiKSB9LAp9CgoKbG9jYWwgbEZlZXRZYXcgICA9IDAKbG9jYWwgQW5nbGUyICAgICA9IDAKCmxvY2FsIGxvZyAgICAgICAgPSB7fQpsb2NhbCBsb2dzICAgICAgID0ge30KCi0tICogdGFibGUKdGFibGUuc2hhbGxfY29weSA9IGZ1bmN0aW9uKHQpCiAgICBsb2NhbCBuZXdfdCA9IHt9CiAgICBmb3IgaSA9IDEsICN0IGRvCiAgICAgICAgdGFibGUuaW5zZXJ0KG5ld190LCB0W2ldKQogICAgZW5kCiAgICByZXR1cm4gbmV3X3QKZW5kCnRhYmxlLnJldmVyc2UgICAgPSBmdW5jdGlvbih0KQogICAgbG9jYWwgbmV3X3QgPSB0YWJsZS5zaGFsbF9jb3B5KHQpCiAgICBmb3IgaSA9IDEsIG1hdGguZmxvb3IoI3QgLyAyKSwgMSBkbwogICAgICAgIG5ld190W2ldLCBuZXdfdFsjdCAtIGkgKyAxXSA9IG5ld190WyN0IC0gaSArIDFdLCBuZXdfdFtpXQogICAgZW5kCiAgICByZXR1cm4gbmV3X3QKZW5kCnRhYmxlLmFkZF90YWJsZSAgPSBmdW5jdGlvbih0LCBhZGRfdCkKICAgIGxvY2FsIG5ld190ID0gdGFibGUuc2hhbGxfY29weSh0KQogICAgZm9yIF8sIHYgaW4gcGFpcnMoYWRkX3QpIGRvCiAgICAgICAgdGFibGUuaW5zZXJ0KG5ld190LCB2KQogICAgZW5kCiAgICByZXR1cm4gbmV3X3QKZW5kCnRhYmxlLmtleV9yb3RhdGUgPSBmdW5jdGlvbih0LCBpKQogICAgaSA9IC1pCiAgICBmb3IgayA9IDEsIG1hdGguYWJzKGkpIGRvCiAgICAgICAgaWYgaSA8IDAgdGhlbgogICAgICAgICAgICB0YWJsZS5pbnNlcnQodCwgMSwgdGFibGUucmVtb3ZlKHQpKQogICAgICAgIGVsc2UKICAgICAgICAgICAgdGFibGUuaW5zZXJ0KHQsIHRhYmxlLnJlbW92ZSh0LCAxKSkKICAgICAgICBlbmQKICAgIGVuZAogICAgcmV0dXJuIHQKZW5kCi0tICogbWF0aAptYXRoLmZsZXJwICAgICAgID0gZnVuY3Rpb24oYSwgYiwgdCkKICAgIHJldHVybiBhICsgdCAqIChiIC0gYSkKZW5kCm1hdGgucm91bmQgICAgICAgPSBmdW5jdGlvbih2YWx1ZSwgZGVjaW1hbHMpCiAgICBsb2NhbCBtdWx0aXBsaWVyID0gMTAuMCBeIChkZWNpbWFscyBvciAwLjApCiAgICByZXR1cm4gbWF0aC5mbG9vcih2YWx1ZSAqIG11bHRpcGxpZXIgKyAwLjUpIC8gbXVsdGlwbGllcgplbmQKbWF0aC5mbGVycF9jb2xvciA9IGZ1bmN0aW9uKGNscjEsIGNscjIsIHQpCiAgICByZXR1cm4gcmVuZGVyLmNvbG9yKAogICAgICAgIG1hdGgucm91bmQobWF0aC5mbGVycChjbHIxLnIsIGNscjIuciwgdCkpLAogICAgICAgIG1hdGgucm91bmQobWF0aC5mbGVycChjbHIxLmcsIGNscjIuZywgdCkpLAogICAgICAgIG1hdGgucm91bmQobWF0aC5mbGVycChjbHIxLmIsIGNscjIuYiwgdCkpLAogICAgICAgIG1hdGgucm91bmQobWF0aC5mbGVycChjbHIxLmEsIGNscjIuYSwgdCkpCiAgICApCmVuZAptYXRoLm53YXkgICAgICAgID0gZnVuY3Rpb24oc3RhcnQsIGZpbmFsLCB3YXkpCiAgICBsb2NhbCB2YWxfdCA9IHt9OyBmb3IgaSA9IDAsIDEsIDEgLyAod2F5IC0gMSkgZG8KICAgICAgICB0YWJsZS5pbnNlcnQodmFsX3QsIG1hdGguZmxlcnAoc3RhcnQsIGZpbmFsLCBpKSkKICAgIGVuZAogICAgcmV0dXJuIHZhbF90CmVuZAptYXRoLmlzX2Zsb2F0ICAgID0gZnVuY3Rpb24obnVtKQogICAgcmV0dXJuIG51bSAlIDEgfj0gMAplbmQKCmxvY2FsIHNpZGUgICAgICAgPSAwCnN0cmluZy5zcGxpdCAgICAgPSBmdW5jdGlvbih0ZXh0KQogICAgbG9jYWwgdCA9IHt9CiAgICBmb3IgaSA9IDEsIHRleHQ6bGVuKCkgZG8KICAgICAgICB0YWJsZS5pbnNlcnQodCwgdGV4dDpzdWIoaSwgaSkpCiAgICBlbmQKICAgIHJldHVybiB0CmVuZApsb2NhbCBNYXRoICAgICAgID0gewogICAgbnVtYmVyX2ZpeCAgICA9IGZ1bmN0aW9uKG51bWJlciwgdmFsdWUpCiAgICAgICAgcmV0dXJuIHN0cmluZy5mb3JtYXQoIiVnIiwgc3RyaW5nLmZvcm1hdCgiJS4iIC4uIHZhbHVlIC4uICJmIiwgbnVtYmVyKSkKICAgIGVuZCwKICAgIHRpbWVfdG9fdGlja3MgPSBmdW5jdGlvbih0KQogICAgICAgIHJldHVybiBtYXRoLmZsb29yKDAuNSArICh0IC8gZ2xvYmFscy50aWNraW50ZXJ2YWwoKSkpCiAgICBlbmQsCiAgICByb3VuZCAgICAgICAgID0gZnVuY3Rpb24odmFsdWUsIGRlY2ltYWxzKQogICAgICAgIGxvY2FsIG11bHRpcGxpZXIgPSAxMC4wIF4gKGRlY2ltYWxzIG9yIDAuMCkKICAgICAgICByZXR1cm4gbWF0aC5mbG9vcih2YWx1ZSAqIG11bHRpcGxpZXIgKyAwLjUpIC8gbXVsdGlwbGllcgogICAgZW5kLAogICAgY2xhbXAgICAgICAgICA9IGZ1bmN0aW9uKHgsIG1pbiwgbWF4KQogICAgICAgIGlmIHggPCBtaW4gdGhlbiByZXR1cm4gbWluIGVuZAogICAgICAgIGlmIHggPiBtYXggdGhlbiByZXR1cm4gbWF4IGVuZAogICAgICAgIGlmIHggPT0gbmlsIHRoZW4gcmV0dXJuIG1pbiBlbmQKICAgICAgICByZXR1cm4geAogICAgZW5kLAogICAgbm9ybWFsaXplX3lhdyA9IGZ1bmN0aW9uKGFuZ2xlKQogICAgICAgIGlmIGFuZ2xlIDwgLTE4MCB0aGVuCiAgICAgICAgICAgIGFuZ2xlID0gYW5nbGUgKyAzNjAKICAgICAgICBlbmQKICAgICAgICBpZiBhbmdsZSA+IDE4MCB0aGVuCiAgICAgICAgICAgIGFuZ2xlID0gYW5nbGUgLSAzNjAKICAgICAgICBlbmQKICAgICAgICByZXR1cm4gYW5nbGUKICAgIGVuZCwKICAgIGxlcnAgICAgICAgICAgPSBmdW5jdGlvbihzdGFydCwgX2VuZCwgdGltZSwgZG9fZXh0cmFhbmltKQogICAgICAgIGlmIChub3QgZG9fZXh0cmFhbmltIGFuZCBtYXRoLmZsb29yKHN0YXJ0KSA9PSBfZW5kKSB0aGVuCiAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICAgICAgX2VuZAogICAgICAgIGVuZAogICAgICAgIHRpbWUgPSBnbG9iYWxfdmFycy5mcmFtZXRpbWUgKiAodGltZSAqIDE3NSkKICAgICAgICBpZiB0aW1lIDwgMCB0aGVuCiAgICAgICAgICAgIHRpbWUgPSAwLjAxCiAgICAgICAgZWxzZWlmIHRpbWUgPiAxIHRoZW4KICAgICAgICAgICAgdGltZSA9IDEKICAgICAgICBlbmQKICAgICAgICByZXR1cm4gTWF0aC5yb3VuZCgoX2VuZCAtIHN0YXJ0KSAqIHRpbWUgKyBzdGFydCwgMikKICAgIGVuZCwKICAgIGZsZXJwICAgICAgICAgPSBmdW5jdGlvbihhLCBiLCB0KQogICAgICAgIHJldHVybiBhICsgdCAqIChiIC0gYSkKICAgIGVuZCwKICAgIGVsZXJwICAgICAgICAgPSBmdW5jdGlvbihzZWxmLCBzdGFydCwgZW5kXywgc3BlZWQsIGRlbHRhKQogICAgICAgIGlmIChtYXRoLmFicyhzdGFydCAtIGVuZF8pIDwgKGRlbHRhIG9yIDAuMDEpKSB0aGVuCiAgICAgICAgICAgIHJldHVybiBlbmRfCiAgICAgICAgZW5kCiAgICAgICAgc3BlZWQgPSBzcGVlZCBvciAwLjA5NQogICAgICAgIGxvY2FsIHRpbWUgPSBnbG9iYWxfdmFycy5mcmFtZXRpbWUgKiAoMTc1ICogc3BlZWQpCiAgICAgICAgcmV0dXJuICgoZW5kXyAtIHN0YXJ0KSAqIHRpbWUgKyBzdGFydCkKICAgIGVuZCwKfQptYXRoLmxlcnAgICAgICAgID0gZnVuY3Rpb24oYSwgYiwgdGltZSkKICAgIHJldHVybiBNYXRoLnJvdW5kKGEgKyAoYiAtIGEpICogdGltZSwgNCkKZW5kCmxvY2FsIGZ1bmN0aW9uIGdldF9jdXJ0aW1lKG9mZnNldCkKICAgIHJldHVybiBnbG9iYWxzLmN1cnRpbWUoKSAtIChvZmZzZXQgKiBnbG9iYWxzLnRpY2tpbnRlcnZhbCgpKQplbmQKCgpsb2NhbCBhbmltYXRpb25zID0gewogICAgZGF0YSA9IHt9LAoKICAgIHByb2Nlc3MgPSBmdW5jdGlvbihzZWxmLCBuYW1lLCBib29sLCB0aW1lKQogICAgICAgIGlmIG5vdCBzZWxmLmRhdGFbbmFtZV0gdGhlbgogICAgICAgICAgICBzZWxmLmRhdGFbbmFtZV0gPSAwCiAgICAgICAgZW5kCgogICAgICAgIGxvY2FsIGFuaW1hdGlvbiA9IGdsb2JhbHMuZnJhbWV0aW1lKCkgKiAoYm9vbCBhbmQgMSBvciAtMSkgKiAodGltZSBvciA0KQogICAgICAgIHNlbGYuZGF0YVtuYW1lXSA9IE1hdGguY2xhbXAoc2VsZi5kYXRhW25hbWVdICsgYW5pbWF0aW9uLCAwLCAxKQogICAgICAgIHJldHVybiBzZWxmLmRhdGFbbmFtZV0KICAgIGVuZCwKCiAgICBsZXJwID0gZnVuY3Rpb24oc2VsZiwgc3RhcnQsIGVuZF8sIHNwZWVkLCBkZWx0YSkKICAgICAgICBpZiAobWF0aC5hYnMoc3RhcnQgLSBlbmRfKSA8IChkZWx0YSBvciAwLjAxKSkgdGhlbgogICAgICAgICAgICByZXR1cm4gZW5kXwogICAgICAgIGVuZAogICAgICAgIHNwZWVkID0gc3BlZWQgb3IgMC4wOTUKICAgICAgICBsb2NhbCB0aW1lID0gZ2xvYmFscy5mcmFtZXRpbWUoKSAqICgxNzUgKiBzcGVlZCkKICAgICAgICByZXR1cm4gKChlbmRfIC0gc3RhcnQpICogdGltZSArIHN0YXJ0KQogICAgZW5kLAp9CmxvY2FsIHNpbXRpbWVfb2xkID0gMDsKbG9jYWwgZGVmZW5zaXZlX3VudGlsID0gMDsKbG9jYWwgc2ltdGltZSA9IDA7CmxvY2FsIGFjdGl2aXR5ID0gMDsKbG9jYWwgd2F5ID0gMApsb2NhbCBmdW5jdGlvbiBjb250YWlucyhzb3VyY2UsIHRhcmdldCkKICAgIGZvciBpZCwgbmFtZSBpbiBwYWlycyh1aS5nZXQoc291cmNlKSkgZG8KICAgICAgICBpZiBuYW1lID09IHRhcmdldCB0aGVuCiAgICAgICAgICAgIHJldHVybiB0cnVlCiAgICAgICAgZW5kCiAgICBlbmQKCiAgICByZXR1cm4gZmFsc2UKZW5kCgoKbG9jYWwgYWxsID0gewogICAgc3RhdGVzID0geyAic3RhbmRpbmciLCAibW92aW5nIiwgImp1bXBpbmciLCAianVtcGluZy1jcm91Y2giLCAid2Fsa2luZyIsICJkdWNraW5nIiwgImZyZWVzdGFuZCIgfSwKICAgIG1lbnVfc3RhdGVzID0geyAifnMgIiwgIn5tICIsICJ+aiAiLCAifmotYyAiLCAifncgIiwgIn5kICIsICJ+ZnMgIiB9Cn0KbG9jYWwgbWVudSA9IHsKICAgIGdsb2JhbCA9IHsKICAgICAgICBtZW51ID0gdWkubmV3X2NvbWJvYm94KCJMVUEiLCAiQSIsICJzaXJpdXMgXGE5NkM4M0NGRmdhbWVzZW5zZSIsCiAgICAgICAgICAgIHsgImdsb2JhbCIsICJhbnRpaGl0IHN5c3RlbSIsICJ2aXN1YWxzIiwgIm1pc2MiIH0pCiAgICB9LAogICAgYW50aV9haW0gPSB7CiAgICAgICAgc3RhdGVzID0gdWkubmV3X2NvbWJvYm94KCJMVUEiLCAiQiIsICJwbGF5ZXJcYTk2QzgzQ0ZGc3RhdGUiLCBhbGwuc3RhdGVzKSwKICAgICAgICBzZWxlY3QgPSB1aS5uZXdfY29tYm9ib3goIkxVQSIsICJBIiwgImJ1aWRlciBtb2RlIiwgeyAiZGVmYXVsdCIsICJcYUI2QjY2NUZGZGVmZW5zaXZlIiB9KSwKICAgICAgICBkZWZfcmVhZHQgPSB1aS5uZXdfbXVsdGlzZWxlY3QoIkxVQSIsICJBIiwgImRlZmVuc2l2ZSBvbiIsIHsgImhpZGVzaG90cyIsICJkb3VibGV0YXAiIH0pLAogICAgICAgIGRlZmVuc2l2ZSA9IHt9LAogICAgfSwKICAgIHZpc3VhbHMgPSB7CiAgICAgICAgaW5kaWNhdG9ycyA9IHVpLm5ld19jaGVja2JveCgiTFVBIiwgIkIiLCAiaW5kaWNhdG9ycyIpLAogICAgICAgIGluZF9jb2xvciA9IHVpLm5ld19jb2xvcl9waWNrZXIoIkxVQSIsICJCIiwgImluZGljYXRvcnMiLCAyNTUsIDI1NSwgMjU1LCAyNTUpLAogICAgICAgIGxvZ3MgPSB1aS5uZXdfY2hlY2tib3goIkxVQSIsICJCIiwgImhpdGxvZ3MiKSwKICAgIH0sCiAgICBtaXNjID0ge30sCgp9Cgpmb3IgaSA9IDEsICNhbGwuc3RhdGVzIGRvCiAgICBtZW51LmFudGlfYWltW2ldID0gewogICAgICAgIHBpdGNoID0gdWkubmV3X2NvbWJvYm94KCJMVUEiLCAiQiIsICJcYUZGRkZGRkM4IiAuLiBhbGwubWVudV9zdGF0ZXNbaV0gLi4gInBpdGNoIiwKICAgICAgICAgICAgeyAib2ZmIiwgImRlZmF1bHQiLCAidXAiLCAiZG93biIsICJtaW5pbWFsIiwgInJhbmRvbSIsICJjdXN0b20iIH0pLAogICAgICAgIGN1c3RvbV9waXRjaCA9IHVpLm5ld19zbGlkZXIoIkxVQSIsICJCIiwgIlxhRkZGRkZGQzgiIC4uIGFsbC5tZW51X3N0YXRlc1tpXSAuLiAiY3VzdG9tIHBpdGNoIiwgLTg5LCA4OSwgMCwgdHJ1ZSwKICAgICAgICAgICAgJ8KwJyksCiAgICAgICAgeWF3YmFzZSA9IHVpLm5ld19jb21ib2JveCgiTFVBIiwgIkIiLCAiXGFGRkZGRkZDOCIgLi4gYWxsLm1lbnVfc3RhdGVzW2ldIC4uICJ5YXcgYmFzZSIsCiAgICAgICAgICAgIHsgImxvY2FsIHZpZXciLCAiYXQgdGFyZ2V0cyIgfSksCiAgICAgICAgeWF3ID0gdWkubmV3X2NvbWJvYm94KCJMVUEiLCAiQiIsICJcYUZGRkZGRkM4IiAuLiBhbGwubWVudV9zdGF0ZXNbaV0gLi4gInlhdyIsCiAgICAgICAgICAgIHsgIm9mZiIsICIxODAiLCAic3BpbiIsICJzdGF0aWMiLCAiMTgweiIsICJjcm9zc2hhaXIiIH0pLAogICAgICAgIHlhd2ppdHRlciA9IHVpLm5ld19jb21ib2JveCgiTFVBIiwgIkIiLCAiXGFGRkZGRkZDOCIgLi4gYWxsLm1lbnVfc3RhdGVzW2ldIC4uICJ5YXcgaml0dGVyIiwKICAgICAgICAgICAgeyAib2ZmIiwgIm9mZnNldCIsICJjZW50ZXIiLCAicmFuZG9tIiwgInNraXR0ZXIiIH0pLAogICAgICAgIGppdHRlcmludCA9IHVpLm5ld19zbGlkZXIoIkxVQSIsICJCIiwgIlxhRkZGRkZGQzgiIC4uIGFsbC5tZW51X3N0YXRlc1tpXSAuLiAiaml0dGVyIiwgLTE4MCwgMTgwLCAwLCB0cnVlLCAnwrAnKSwKICAgICAgICB5YXdhZGQgPSB1aS5uZXdfY29tYm9ib3goIkxVQSIsICJCIiwgIlxhRkZGRkZGQzgiIC4uIGFsbC5tZW51X3N0YXRlc1tpXSAuLiAieWF3IGFkZCB0eXBlIiwKICAgICAgICAgICAgeyAic3RhdGljIiwgIjItc2lkZSIsICJzbG93ZWQiLCAiMy13YXkiLCAiNS13YXkiIH0pLAoKICAgICAgICB5YXdzdGF0aWMgPSB1aS5uZXdfc2xpZGVyKCJMVUEiLCAiQiIsICJcYUZGRkZGRkM4IiAuLiBhbGwubWVudV9zdGF0ZXNbaV0gLi4gInN0YXRpYyIsIC0xODAsIDE4MCwgMCwgdHJ1ZSwgJ8KwJyksCgogICAgICAgIHlhd2xlZnQgPSB1aS5uZXdfc2xpZGVyKCJMVUEiLCAiQiIsICJcYUZGRkZGRkM4IiAuLiBhbGwubWVudV9zdGF0ZXNbaV0gLi4gImxlZnQiLCAtMTgwLCAxODAsIDAsIHRydWUsICfCsCcpLAogICAgICAgIHlhd3JpZ2h0ID0gdWkubmV3X3NsaWRlcigiTFVBIiwgIkIiLCAiXGFGRkZGRkZDOCIgLi4gYWxsLm1lbnVfc3RhdGVzW2ldIC4uICJyaWdodCIsIC0xODAsIDE4MCwgMCwgdHJ1ZSwgJ8KwJyksCiAgICAgICAgdGlja3MgPSB1aS5uZXdfc2xpZGVyKCJMVUEiLCAiQiIsICJcYUZGRkZGRkM4IiAuLiBhbGwubWVudV9zdGF0ZXNbaV0gLi4gInNsb3dlZCBieSIsIDIsIDgsIDAsIHRydWUsICd0JyksCgogICAgICAgIHdheTEgPSB1aS5uZXdfc2xpZGVyKCJMVUEiLCAiQiIsICJcYUZGRkZGRkM4IiAuLiBhbGwubWVudV9zdGF0ZXNbaV0gLi4gIndheSAxIiwgLTE4MCwgMTgwLCAwLCB0cnVlLCAnwrAnKSwKICAgICAgICB3YXkyID0gdWkubmV3X3NsaWRlcigiTFVBIiwgIkIiLCAiXGFGRkZGRkZDOCIgLi4gYWxsLm1lbnVfc3RhdGVzW2ldIC4uICJ3YXkgMiIsIC0xODAsIDE4MCwgMCwgdHJ1ZSwgJ8KwJyksCiAgICAgICAgd2F5MyA9IHVpLm5ld19zbGlkZXIoIkxVQSIsICJCIiwgIlxhRkZGRkZGQzgiIC4uIGFsbC5tZW51X3N0YXRlc1tpXSAuLiAid2F5IDMiLCAtMTgwLCAxODAsIDAsIHRydWUsICfCsCcpLAogICAgICAgIHdheTQgPSB1aS5uZXdfc2xpZGVyKCJMVUEiLCAiQiIsICJcYUZGRkZGRkM4IiAuLiBhbGwubWVudV9zdGF0ZXNbaV0gLi4gIndheSA0IiwgLTE4MCwgMTgwLCAwLCB0cnVlLCAnwrAnKSwKICAgICAgICB3YXk1ID0gdWkubmV3X3NsaWRlcigiTFVBIiwgIkIiLCAiXGFGRkZGRkZDOCIgLi4gYWxsLm1lbnVfc3RhdGVzW2ldIC4uICJ3YXkgNSIsIC0xODAsIDE4MCwgMCwgdHJ1ZSwgJ8KwJyksCgogICAgICAgIGJvZHl5YXcgPSB1aS5uZXdfY29tYm9ib3goIkxVQSIsICJCIiwgIlxhRkZGRkZGQzgiIC4uIGFsbC5tZW51X3N0YXRlc1tpXSAuLiAiYm9keSB5YXciLAogICAgICAgICAgICB7ICJvZmYiLCAib3Bwb3NpdGUiLCAiaml0dGVyIiwgInN0YXRpYyIgfSksCiAgICAgICAgYm9keWludCA9IHVpLm5ld19zbGlkZXIoIkxVQSIsICJCIiwgIlxhRkZGRkZGQzgiIC4uIGFsbC5tZW51X3N0YXRlc1tpXSAuLiAiZGVzeW5jIiwgLTE4MCwgMTgwLCAwLCB0cnVlLCAnwrAnKSwKICAgICAgICBib2R5ZnJlZSA9IHVpLm5ld19jaGVja2JveCgiTFVBIiwgIkIiLCBhbGwubWVudV9zdGF0ZXNbaV0gLi4gImZyZWVzdGFuZGluZyBib2R5IHlhdyIpLAogICAgICAgIGRlZmVuc2l2ZSA9IHsKICAgICAgICAgICAgZm9yY2UgPSB1aS5uZXdfY2hlY2tib3goIkxVQSIsICJCIiwKICAgICAgICAgICAgICAgICJcYUI2QjY2NUZGZGVmICIgLi4gIlxhRkZGRkZGQzgiIC4uIGFsbC5tZW51X3N0YXRlc1tpXSAuLiAib3ZlcnJpZGUgZGVmZW5zaXZlIiksCiAgICAgICAgICAgIGVuYWJsZSA9IHVpLm5ld19jaGVja2JveCgiTFVBIiwgIkIiLCAiXGFCNkI2NjVGRmRlZiAiIC4uICJcYUZGRkZGRkM4IiAuLiBhbGwubWVudV9zdGF0ZXNbaV0gLi4gImVuYWJsZSIpLAogICAgICAgICAgICBwaXRjaCA9IHVpLm5ld19jb21ib2JveCgiTFVBIiwgIkIiLCAiXGFCNkI2NjVGRmRlZiAiIC4uICJcYUZGRkZGRkM4IiAuLiBhbGwubWVudV9zdGF0ZXNbaV0gLi4gInBpdGNoIiwKICAgICAgICAgICAgICAgIHsgIm9mZiIsICJkZWZhdWx0IiwgInVwIiwgImRvd24iLCAibWluaW1hbCIsICJyYW5kb20iLCAiY3VzdG9tIiB9KSwKICAgICAgICAgICAgY3VzdG9tX3BpdGNoID0gdWkubmV3X3NsaWRlcigiTFVBIiwgIkIiLAogICAgICAgICAgICAgICAgIlxhQjZCNjY1RkZkZWYgIiAuLiAiXGFGRkZGRkZDOCIgLi4gYWxsLm1lbnVfc3RhdGVzW2ldIC4uICJjdXN0b20gcGl0Y2giLCAtODksIDg5LCAwLCB0cnVlLCAnwrAnKSwKICAgICAgICAgICAgeWF3YmFzZSA9IHVpLm5ld19jb21ib2JveCgiTFVBIiwgIkIiLCAiXGFCNkI2NjVGRmRlZiAiIC4uICJcYUZGRkZGRkM4IiAuLiBhbGwubWVudV9zdGF0ZXNbaV0gLi4gInlhdyBiYXNlIiwKICAgICAgICAgICAgICAgIHsgImxvY2FsIHZpZXciLCAiYXQgdGFyZ2V0cyIgfSksCiAgICAgICAgICAgIHlhdyA9IHVpLm5ld19jb21ib2JveCgiTFVBIiwgIkIiLCAiXGFCNkI2NjVGRmRlZiAiIC4uICJcYUZGRkZGRkM4IiAuLiBhbGwubWVudV9zdGF0ZXNbaV0gLi4gInlhdyIsCiAgICAgICAgICAgICAgICB7ICJvZmYiLCAiMTgwIiwgInNwaW4iLCAic3RhdGljIiwgIjE4MHoiLCAiY3Jvc3NoYWlyIiB9KSwKCiAgICAgICAgICAgIHlhd2ppdHRlciA9IHVpLm5ld19jb21ib2JveCgiTFVBIiwgIkIiLAogICAgICAgICAgICAgICAgIlxhQjZCNjY1RkZkZWYgIiAuLiAiXGFGRkZGRkZDOCIgLi4gYWxsLm1lbnVfc3RhdGVzW2ldIC4uICJ5YXcgaml0dGVyIiwKICAgICAgICAgICAgICAgIHsgIm9mZiIsICJvZmZzZXQiLCAiY2VudGVyIiwgInJhbmRvbSIsICJza2l0dGVyIiB9KSwKICAgICAgICAgICAgaml0dGVyaW50ID0gdWkubmV3X3NsaWRlcigiTFVBIiwgIkIiLCAiXGFCNkI2NjVGRmRlZiAiIC4uICJcYUZGRkZGRkM4IiAuLiBhbGwubWVudV9zdGF0ZXNbaV0gLi4gImppdHRlciIsCiAgICAgICAgICAgICAgICAtMTgwLCAxODAsIDAsIHRydWUsICfCsCcpLAoKICAgICAgICAgICAgeWF3YWRkID0gdWkubmV3X2NvbWJvYm94KCJMVUEiLCAiQiIsICJcYUI2QjY2NUZGZGVmICIgLi4gIlxhRkZGRkZGQzgiIC4uIGFsbC5tZW51X3N0YXRlc1tpXSAuLiAieWF3IGFkZCB0eXBlIiwKICAgICAgICAgICAgICAgIHsgInN0YXRpYyIsICIyLXNpZGUiLCAic2xvd2VkIiwgIjMtd2F5IiwgIjUtd2F5IiB9KSwKCiAgICAgICAgICAgIHlhd3N0YXRpYyA9IHVpLm5ld19zbGlkZXIoIkxVQSIsICJCIiwgIlxhQjZCNjY1RkZkZWYgIiAuLiAiXGFGRkZGRkZDOCIgLi4gYWxsLm1lbnVfc3RhdGVzW2ldIC4uICJzdGF0aWMiLAogICAgICAgICAgICAgICAgLTE4MCwgMTgwLCAwLCB0cnVlLCAnwrAnKSwKCiAgICAgICAgICAgIHlhd2xlZnQgPSB1aS5uZXdfc2xpZGVyKCJMVUEiLCAiQiIsICJcYUI2QjY2NUZGZGVmICIgLi4gIlxhRkZGRkZGQzgiIC4uIGFsbC5tZW51X3N0YXRlc1tpXSAuLiAibGVmdCIsIC0xODAsCiAgICAgICAgICAgICAgICAxODAsIDAsIHRydWUsICfCsCcpLAogICAgICAgICAgICB5YXdyaWdodCA9IHVpLm5ld19zbGlkZXIoIkxVQSIsICJCIiwgIlxhQjZCNjY1RkZkZWYgIiAuLiAiXGFGRkZGRkZDOCIgLi4gYWxsLm1lbnVfc3RhdGVzW2ldIC4uICJyaWdodCIsIC0xODAsCiAgICAgICAgICAgICAgICAxODAsIDAsIHRydWUsICfCsCcpLAogICAgICAgICAgICB0aWNrcyA9IHVpLm5ld19zbGlkZXIoIkxVQSIsICJCIiwgIlxhQjZCNjY1RkZkZWYgIiAuLiAiXGFGRkZGRkZDOCIgLi4gYWxsLm1lbnVfc3RhdGVzW2ldIC4uICJzbG93ZWQgYnkiLCAyLCA4LAogICAgICAgICAgICAgICAgMCwgdHJ1ZSwgJ3QnKSwKCiAgICAgICAgICAgIHdheTEgPSB1aS5uZXdfc2xpZGVyKCJMVUEiLCAiQiIsICJcYUI2QjY2NUZGZGVmICIgLi4gIlxhRkZGRkZGQzgiIC4uIGFsbC5tZW51X3N0YXRlc1tpXSAuLiAid2F5IDEiLCAtMTgwLCAxODAsCiAgICAgICAgICAgICAgICAwLCB0cnVlLCAnwrAnKSwKICAgICAgICAgICAgd2F5MiA9IHVpLm5ld19zbGlkZXIoIkxVQSIsICJCIiwgIlxhQjZCNjY1RkZkZWYgIiAuLiAiXGFGRkZGRkZDOCIgLi4gYWxsLm1lbnVfc3RhdGVzW2ldIC4uICJ3YXkgMiIsIC0xODAsIDE4MCwKICAgICAgICAgICAgICAgIDAsIHRydWUsICfCsCcpLAogICAgICAgICAgICB3YXkzID0gdWkubmV3X3NsaWRlcigiTFVBIiwgIkIiLCAiXGFCNkI2NjVGRmRlZiAiIC4uICJcYUZGRkZGRkM4IiAuLiBhbGwubWVudV9zdGF0ZXNbaV0gLi4gIndheSAzIiwgLTE4MCwgMTgwLAogICAgICAgICAgICAgICAgMCwgdHJ1ZSwgJ8KwJyksCiAgICAgICAgICAgIHdheTQgPSB1aS5uZXdfc2xpZGVyKCJMVUEiLCAiQiIsICJcYUI2QjY2NUZGZGVmICIgLi4gIlxhRkZGRkZGQzgiIC4uIGFsbC5tZW51X3N0YXRlc1tpXSAuLiAid2F5IDQiLCAtMTgwLCAxODAsCiAgICAgICAgICAgICAgICAwLCB0cnVlLCAnwrAnKSwKICAgICAgICAgICAgd2F5NSA9IHVpLm5ld19zbGlkZXIoIkxVQSIsICJCIiwgIlxhQjZCNjY1RkZkZWYgIiAuLiAiXGFGRkZGRkZDOCIgLi4gYWxsLm1lbnVfc3RhdGVzW2ldIC4uICJ3YXkgNSIsIC0xODAsIDE4MCwKICAgICAgICAgICAgICAgIDAsIHRydWUsICfCsCcpLAogICAgICAgICAgICBib2R5eWF3ID0gdWkubmV3X2NvbWJvYm94KCJMVUEiLCAiQiIsICJcYUI2QjY2NUZGZGVmICIgLi4gIlxhRkZGRkZGQzgiIC4uIGFsbC5tZW51X3N0YXRlc1tpXSAuLiAiYm9keSB5YXciLAogICAgICAgICAgICAgICAgeyAib2ZmIiwgIm9wcG9zaXRlIiwgImppdHRlciIsICJzdGF0aWMiIH0pLAogICAgICAgICAgICBib2R5aW50ID0gdWkubmV3X3NsaWRlcigiTFVBIiwgIkIiLCAiXGFCNkI2NjVGRmRlZiAiIC4uICJcYUZGRkZGRkM4IiAuLiBhbGwubWVudV9zdGF0ZXNbaV0gLi4gImRlc3luYyIsIC0xODAsCiAgICAgICAgICAgICAgICAxODAsIDAsIHRydWUsICfCsCcpLAogICAgICAgICAgICBib2R5ZnJlZSA9IHVpLm5ld19jaGVja2JveCgiTFVBIiwgIkIiLCAiXGFCNkI2NjVGRmRlZiAiIC4uIGFsbC5tZW51X3N0YXRlc1tpXSAuLiAiZnJlZXN0YW5kaW5nIGJvZHkgeWF3IiksCiAgICAgICAgfQogICAgfQplbmQKbG9nLmFkZCAgICAgICAgICAgICAgICA9IGZ1bmN0aW9uKHRleHQsIHIsIGcsIGIsIGEpCiAgICBjbGllbnQuY29sb3JfbG9nKHIsIGcsIGIsICJbc2lyaXVzXSAiIC4uIHRleHQpCiAgICB0YWJsZS5pbnNlcnQobG9ncywgMSwgeyB0ZXh0ID0gdGV4dCwgcjEgPSByLCBnMSA9IGcsIGIxID0gYiwgYTEgPSBhLCBhbHBoYSA9IDAsIHRpbWUgPSBnbG9iYWxzLmN1cnRpbWUoKSArIDQgfSkKZW5kCmxvY2FsIGhlbHBlcnMgICAgICAgICAgPSB7CiAgICBsYXN0X3NpbV90aW1lID0gMCwKICAgIGRlZmVuc2l2ZV91bnRpbCA9IDAsCgogICAgaXNfZGVmZW5zaXZlID0gZnVuY3Rpb24oc2VsZikKICAgICAgICBpZiBub3QgZW50aXR5LmdldF9sb2NhbF9wbGF5ZXIoKSB0aGVuCiAgICAgICAgICAgIHJldHVybiBmYWxzZQogICAgICAgIGVuZAogICAgICAgIGxvY2FsIHRpY2tjb3VudCA9IGdsb2JhbHMudGlja2NvdW50KCk7CiAgICAgICAgbG9jYWwgbG9jYWxfcGxheWVyID0gZW50aXR5LmdldF9sb2NhbF9wbGF5ZXIoKTsKICAgICAgICBsb2NhbCBzaW1fdGltZSA9IE1hdGgudGltZV90b190aWNrcyhlbnRpdHkuZ2V0X3Byb3AoZW50aXR5LmdldF9sb2NhbF9wbGF5ZXIoKSwgIm1fZmxTaW11bGF0aW9uVGltZSIpKTsKICAgICAgICBpZiAoKHVpLmdldChyZWZzLmRvdWJsZV90YXBbMl0pIGFuZCBjb250YWlucyhtZW51LmFudGlfYWltLmRlZl9yZWFkdCwgImRvdWJsZXRhcCIpKSBvciAodWkuZ2V0KHJlZnMub25fc2hvdF9hbnRpX2FpbVsyXSkgYW5kIGNvbnRhaW5zKG1lbnUuYW50aV9haW0uZGVmX3JlYWR0LCAiaGlkZXNob3RzIikpKSB0aGVuCiAgICAgICAgICAgIGxvY2FsIHNpbV9kaWZmID0gc2ltX3RpbWUgLSBzZWxmLmxhc3Rfc2ltX3RpbWU7CgogICAgICAgICAgICBpZiBzaW1fZGlmZiA8IDAgdGhlbgogICAgICAgICAgICAgICAgc2VsZi5kZWZlbnNpdmVfdW50aWwgPSB0aWNrY291bnQgKyBtYXRoLmFicyhzaW1fZGlmZikgLQogICAgICAgICAgICAgICAgICAgIE1hdGgudGltZV90b190aWNrcyhjbGllbnQubGF0ZW5jeSgpKTsKICAgICAgICAgICAgZW5kCgogICAgICAgICAgICBzZWxmLmxhc3Rfc2ltX3RpbWUgPSBzaW1fdGltZTsKCiAgICAgICAgICAgIHJldHVybiBzZWxmLmRlZmVuc2l2ZV91bnRpbCA+IHRpY2tjb3VudDsKICAgICAgICBlbmQKICAgIGVuZCwKICAgIGdldF9jaGFyZ2UgPSBmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgdGFyZ2V0ID0gZW50aXR5LmdldF9sb2NhbF9wbGF5ZXIoKQogICAgICAgIGlmIG5vdCB0YXJnZXQgdGhlbgogICAgICAgICAgICByZXR1cm4KICAgICAgICBlbmQKCiAgICAgICAgbG9jYWwgd2VhcG9uID0gZW50aXR5LmdldF9wbGF5ZXJfd2VhcG9uKHRhcmdldCkKCiAgICAgICAgaWYgdGFyZ2V0ID09IG5pbCBvciB3ZWFwb24gPT0gbmlsIHRoZW4KICAgICAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgICAgZW5kCgogICAgICAgIGlmIGdldF9jdXJ0aW1lKDE2KSA8IGVudGl0eS5nZXRfcHJvcCh0YXJnZXQsICdtX2ZsTmV4dEF0dGFjaycpIHRoZW4KICAgICAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgICAgZW5kCgogICAgICAgIGlmIGdldF9jdXJ0aW1lKDApIDwgZW50aXR5LmdldF9wcm9wKHdlYXBvbiwgJ21fZmxOZXh0UHJpbWFyeUF0dGFjaycpIHRoZW4KICAgICAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgICAgZW5kCgogICAgICAgIHJldHVybiB0cnVlCiAgICBlbmQKCn0KCmxvY2FsIHBsYXllcnN0YXRlICAgICAgPSAwCmxvY2FsIGFpcl90aWNrICAgICAgICAgPSAwCmxvY2FsIGluX2FpciAgICAgICAgICAgPSBmYWxzZQpsb2NhbCB0aWNrX3N3aXRjaCAgICAgID0gMApsb2NhbCBzY3JlZW54LCBzY3JlZW55ID0gY2xpZW50LnNjcmVlbl9zaXplKCkKbG9jYWwgY2FsbGJhY2tzICAgICAgICA9IHsKICAgIG9uX3BhaW50ID0gewogICAgICAgIG1lbnVfZWxlbWVudHMgPSBmdW5jdGlvbigpCiAgICAgICAgICAgIGxvY2FsIHRhYiA9IHVpLmdldChtZW51Lmdsb2JhbC5tZW51KQoKICAgICAgICAgICAgdWkuc2V0X3Zpc2libGUobWVudS5hbnRpX2FpbS5zdGF0ZXMsIHRhYiA9PSAiYW50aWhpdCBzeXN0ZW0iKQogICAgICAgICAgICB1aS5zZXRfdmlzaWJsZShtZW51LmFudGlfYWltLnNlbGVjdCwgdGFiID09ICJhbnRpaGl0IHN5c3RlbSIpCiAgICAgICAgICAgIHVpLnNldF92aXNpYmxlKG1lbnUuYW50aV9haW0uZGVmX3JlYWR0LCB0YWIgPT0gImFudGloaXQgc3lzdGVtIikKICAgICAgICAgICAgdWkuc2V0X3Zpc2libGUobWVudS52aXN1YWxzLmluZGljYXRvcnMsIHRhYiA9PSAidmlzdWFscyIpCiAgICAgICAgICAgIHVpLnNldF92aXNpYmxlKG1lbnUudmlzdWFscy5pbmRfY29sb3IsIHRhYiA9PSAidmlzdWFscyIgYW5kIHVpLmdldChtZW51LnZpc3VhbHMuaW5kaWNhdG9ycykpCiAgICAgICAgICAgIGZvciBpID0gMSwgI2FsbC5zdGF0ZXMgZG8KICAgICAgICAgICAgICAgIHVpLnNldF92aXNpYmxlKG1lbnUuYW50aV9haW1baV0uZGVmZW5zaXZlLmVuYWJsZSwKICAgICAgICAgICAgICAgICAgICB0YWIgPT0gImFudGloaXQgc3lzdGVtIiBhbmQgdWkuZ2V0KG1lbnUuYW50aV9haW0uc3RhdGVzKSA9PSBhbGwuc3RhdGVzW2ldIGFuZAogICAgICAgICAgICAgICAgICAgIHVpLmdldChtZW51LmFudGlfYWltLnNlbGVjdCkgPT0gIlxhQjZCNjY1RkZkZWZlbnNpdmUiKQogICAgICAgICAgICAgICAgdWkuc2V0X3Zpc2libGUobWVudS5hbnRpX2FpbVtpXS5kZWZlbnNpdmUuZm9yY2UsCiAgICAgICAgICAgICAgICAgICAgdGFiID09ICJhbnRpaGl0IHN5c3RlbSIgYW5kIHVpLmdldChtZW51LmFudGlfYWltLnN0YXRlcykgPT0gYWxsLnN0YXRlc1tpXSBhbmQKICAgICAgICAgICAgICAgICAgICB1aS5nZXQobWVudS5hbnRpX2FpbS5zZWxlY3QpID09ICJcYUI2QjY2NUZGZGVmZW5zaXZlIikKCiAgICAgICAgICAgICAgICB1aS5zZXRfdmlzaWJsZShtZW51LmFudGlfYWltW2ldLnBpdGNoLAogICAgICAgICAgICAgICAgICAgIHRhYiA9PSAiYW50aWhpdCBzeXN0ZW0iIGFuZCB1aS5nZXQobWVudS5hbnRpX2FpbS5zdGF0ZXMpID09IGFsbC5zdGF0ZXNbaV0gYW5kCiAgICAgICAgICAgICAgICAgICAgdWkuZ2V0KG1lbnUuYW50aV9haW0uc2VsZWN0KSA9PSAiZGVmYXVsdCIpCiAgICAgICAgICAgICAgICB1aS5zZXRfdmlzaWJsZShtZW51LmFudGlfYWltW2ldLmN1c3RvbV9waXRjaCwKICAgICAgICAgICAgICAgICAgICB0YWIgPT0gImFudGloaXQgc3lzdGVtIiBhbmQgdWkuZ2V0KG1lbnUuYW50aV9haW0uc3RhdGVzKSA9PSBhbGwuc3RhdGVzW2ldIGFuZAogICAgICAgICAgICAgICAgICAgIHVpLmdldChtZW51LmFudGlfYWltW2ldLnBpdGNoKSA9PSAiY3VzdG9tIiBhbmQgdWkuZ2V0KG1lbnUuYW50aV9haW0uc2VsZWN0KSA9PSAiZGVmYXVsdCIpCiAgICAgICAgICAgICAgICB1aS5zZXRfdmlzaWJsZShtZW51LmFudGlfYWltW2ldLnlhd2Jhc2UsCiAgICAgICAgICAgICAgICAgICAgdGFiID09ICJhbnRpaGl0IHN5c3RlbSIgYW5kIHVpLmdldChtZW51LmFudGlfYWltLnN0YXRlcykgPT0gYWxsLnN0YXRlc1tpXSBhbmQKICAgICAgICAgICAgICAgICAgICB1aS5nZXQobWVudS5hbnRpX2FpbS5zZWxlY3QpID09ICJkZWZhdWx0IikKICAgICAgICAgICAgICAgIHVpLnNldF92aXNpYmxlKG1lbnUuYW50aV9haW1baV0ueWF3LAogICAgICAgICAgICAgICAgICAgIHRhYiA9PSAiYW50aWhpdCBzeXN0ZW0iIGFuZCB1aS5nZXQobWVudS5hbnRpX2FpbS5zdGF0ZXMpID09IGFsbC5zdGF0ZXNbaV0gYW5kCiAgICAgICAgICAgICAgICAgICAgdWkuZ2V0KG1lbnUuYW50aV9haW0uc2VsZWN0KSA9PSAiZGVmYXVsdCIpCiAgICAgICAgICAgICAgICB1aS5zZXRfdmlzaWJsZShtZW51LmFudGlfYWltW2ldLnlhd2FkZCwKICAgICAgICAgICAgICAgICAgICB0YWIgPT0gImFudGloaXQgc3lzdGVtIiBhbmQgdWkuZ2V0KG1lbnUuYW50aV9haW0uc3RhdGVzKSA9PSBhbGwuc3RhdGVzW2ldIGFuZAogICAgICAgICAgICAgICAgICAgIHVpLmdldChtZW51LmFudGlfYWltLnNlbGVjdCkgPT0gImRlZmF1bHQiKQoKICAgICAgICAgICAgICAgIHVpLnNldF92aXNpYmxlKG1lbnUuYW50aV9haW1baV0ueWF3aml0dGVyLAogICAgICAgICAgICAgICAgICAgIHRhYiA9PSAiYW50aWhpdCBzeXN0ZW0iIGFuZCB1aS5nZXQobWVudS5hbnRpX2FpbS5zdGF0ZXMpID09IGFsbC5zdGF0ZXNbaV0gYW5kCiAgICAgICAgICAgICAgICAgICAgdWkuZ2V0KG1lbnUuYW50aV9haW0uc2VsZWN0KSA9PSAiZGVmYXVsdCIpCgogICAgICAgICAgICAgICAgdWkuc2V0X3Zpc2libGUobWVudS5hbnRpX2FpbVtpXS5qaXR0ZXJpbnQsCiAgICAgICAgICAgICAgICAgICAgdGFiID09ICJhbnRpaGl0IHN5c3RlbSIgYW5kIHVpLmdldChtZW51LmFudGlfYWltLnN0YXRlcykgPT0gYWxsLnN0YXRlc1tpXSBhbmQKICAgICAgICAgICAgICAgICAgICB1aS5nZXQobWVudS5hbnRpX2FpbS5zZWxlY3QpID09ICJkZWZhdWx0IiBhbmQKICAgICAgICAgICAgICAgICAgICAodWkuZ2V0KG1lbnUuYW50aV9haW1baV0ueWF3aml0dGVyKSA9PSAib2Zmc2V0IiBvciB1aS5nZXQobWVudS5hbnRpX2FpbVtpXS55YXdqaXR0ZXIpID09ICJjZW50ZXIiIG9yIHVpLmdldChtZW51LmFudGlfYWltW2ldLnlhd2ppdHRlcikgPT0gInJhbmRvbSIgb3IgdWkuZ2V0KG1lbnUuYW50aV9haW1baV0ueWF3aml0dGVyKSA9PSAic2tpdHRlciIpKQogICAgICAgICAgICAgICAgdWkuc2V0X3Zpc2libGUobWVudS5hbnRpX2FpbVtpXS55YXdzdGF0aWMsCiAgICAgICAgICAgICAgICAgICAgdGFiID09ICJhbnRpaGl0IHN5c3RlbSIgYW5kIHVpLmdldChtZW51LmFudGlfYWltLnN0YXRlcykgPT0gYWxsLnN0YXRlc1tpXSBhbmQKICAgICAgICAgICAgICAgICAgICB1aS5nZXQobWVudS5hbnRpX2FpbVtpXS55YXdhZGQpID09ICJzdGF0aWMiIGFuZCB1aS5nZXQobWVudS5hbnRpX2FpbS5zZWxlY3QpID09ICJkZWZhdWx0IikKICAgICAgICAgICAgICAgIHVpLnNldF92aXNpYmxlKG1lbnUuYW50aV9haW1baV0ueWF3bGVmdCwKICAgICAgICAgICAgICAgICAgICB0YWIgPT0gImFudGloaXQgc3lzdGVtIiBhbmQgdWkuZ2V0KG1lbnUuYW50aV9haW0uc3RhdGVzKSA9PSBhbGwuc3RhdGVzW2ldIGFuZAogICAgICAgICAgICAgICAgICAgICh1aS5nZXQobWVudS5hbnRpX2FpbVtpXS55YXdhZGQpID09ICIyLXNpZGUiIG9yIHVpLmdldChtZW51LmFudGlfYWltW2ldLnlhd2FkZCkgPT0gInNsb3dlZCIpIGFuZAogICAgICAgICAgICAgICAgICAgIHVpLmdldChtZW51LmFudGlfYWltLnNlbGVjdCkgPT0gImRlZmF1bHQiKQogICAgICAgICAgICAgICAgdWkuc2V0X3Zpc2libGUobWVudS5hbnRpX2FpbVtpXS55YXdyaWdodCwKICAgICAgICAgICAgICAgICAgICB0YWIgPT0gImFudGloaXQgc3lzdGVtIiBhbmQgdWkuZ2V0KG1lbnUuYW50aV9haW0uc3RhdGVzKSA9PSBhbGwuc3RhdGVzW2ldIGFuZAogICAgICAgICAgICAgICAgICAgICh1aS5nZXQobWVudS5hbnRpX2FpbVtpXS55YXdhZGQpID09ICIyLXNpZGUiIG9yIHVpLmdldChtZW51LmFudGlfYWltW2ldLnlhd2FkZCkgPT0gInNsb3dlZCIpIGFuZAogICAgICAgICAgICAgICAgICAgIHVpLmdldChtZW51LmFudGlfYWltLnNlbGVjdCkgPT0gImRlZmF1bHQiKQogICAgICAgICAgICAgICAgdWkuc2V0X3Zpc2libGUobWVudS5hbnRpX2FpbVtpXS50aWNrcywKICAgICAgICAgICAgICAgICAgICB0YWIgPT0gImFudGloaXQgc3lzdGVtIiBhbmQgdWkuZ2V0KG1lbnUuYW50aV9haW0uc3RhdGVzKSA9PSBhbGwuc3RhdGVzW2ldIGFuZAogICAgICAgICAgICAgICAgICAgICh1aS5nZXQobWVudS5hbnRpX2FpbVtpXS55YXdhZGQpID09ICJzbG93ZWQiKSBhbmQgdWkuZ2V0KG1lbnUuYW50aV9haW0uc2VsZWN0KSA9PSAiZGVmYXVsdCIpCiAgICAgICAgICAgICAgICB1aS5zZXRfdmlzaWJsZShtZW51LmFudGlfYWltW2ldLndheTEsCiAgICAgICAgICAgICAgICAgICAgdGFiID09ICJhbnRpaGl0IHN5c3RlbSIgYW5kIHVpLmdldChtZW51LmFudGlfYWltLnN0YXRlcykgPT0gYWxsLnN0YXRlc1tpXSBhbmQKICAgICAgICAgICAgICAgICAgICAodWkuZ2V0KG1lbnUuYW50aV9haW1baV0ueWF3YWRkKSA9PSAiMy13YXkiIG9yIHVpLmdldChtZW51LmFudGlfYWltW2ldLnlhd2FkZCkgPT0gIjUtd2F5IikgYW5kCiAgICAgICAgICAgICAgICAgICAgdWkuZ2V0KG1lbnUuYW50aV9haW0uc2VsZWN0KSA9PSAiZGVmYXVsdCIpCiAgICAgICAgICAgICAgICB1aS5zZXRfdmlzaWJsZShtZW51LmFudGlfYWltW2ldLndheTIsCiAgICAgICAgICAgICAgICAgICAgdGFiID09ICJhbnRpaGl0IHN5c3RlbSIgYW5kIHVpLmdldChtZW51LmFudGlfYWltLnN0YXRlcykgPT0gYWxsLnN0YXRlc1tpXSBhbmQKICAgICAgICAgICAgICAgICAgICAodWkuZ2V0KG1lbnUuYW50aV9haW1baV0ueWF3YWRkKSA9PSAiMy13YXkiIG9yIHVpLmdldChtZW51LmFudGlfYWltW2ldLnlhd2FkZCkgPT0gIjUtd2F5IikgYW5kCiAgICAgICAgICAgICAgICAgICAgdWkuZ2V0KG1lbnUuYW50aV9haW0uc2VsZWN0KSA9PSAiZGVmYXVsdCIpCiAgICAgICAgICAgICAgICB1aS5zZXRfdmlzaWJsZShtZW51LmFudGlfYWltW2ldLndheTMsCiAgICAgICAgICAgICAgICAgICAgdGFiID09ICJhbnRpaGl0IHN5c3RlbSIgYW5kIHVpLmdldChtZW51LmFudGlfYWltLnN0YXRlcykgPT0gYWxsLnN0YXRlc1tpXSBhbmQKICAgICAgICAgICAgICAgICAgICAodWkuZ2V0KG1lbnUuYW50aV9haW1baV0ueWF3YWRkKSA9PSAiMy13YXkiIG9yIHVpLmdldChtZW51LmFudGlfYWltW2ldLnlhd2FkZCkgPT0gIjUtd2F5IikgYW5kCiAgICAgICAgICAgICAgICAgICAgdWkuZ2V0KG1lbnUuYW50aV9haW0uc2VsZWN0KSA9PSAiZGVmYXVsdCIpCiAgICAgICAgICAgICAgICB1aS5zZXRfdmlzaWJsZShtZW51LmFudGlfYWltW2ldLndheTQsCiAgICAgICAgICAgICAgICAgICAgdGFiID09ICJhbnRpaGl0IHN5c3RlbSIgYW5kIHVpLmdldChtZW51LmFudGlfYWltLnN0YXRlcykgPT0gYWxsLnN0YXRlc1tpXSBhbmQKICAgICAgICAgICAgICAgICAgICAodWkuZ2V0KG1lbnUuYW50aV9haW1baV0ueWF3YWRkKSA9PSAiNS13YXkiKSBhbmQgdWkuZ2V0KG1lbnUuYW50aV9haW0uc2VsZWN0KSA9PSAiZGVmYXVsdCIpCiAgICAgICAgICAgICAgICB1aS5zZXRfdmlzaWJsZShtZW51LmFudGlfYWltW2ldLndheTUsCiAgICAgICAgICAgICAgICAgICAgdGFiID09ICJhbnRpaGl0IHN5c3RlbSIgYW5kIHVpLmdldChtZW51LmFudGlfYWltLnN0YXRlcykgPT0gYWxsLnN0YXRlc1tpXSBhbmQKICAgICAgICAgICAgICAgICAgICAodWkuZ2V0KG1lbnUuYW50aV9haW1baV0ueWF3YWRkKSA9PSAiNS13YXkiKSBhbmQgdWkuZ2V0KG1lbnUuYW50aV9haW0uc2VsZWN0KSA9PSAiZGVmYXVsdCIpCgogICAgICAgICAgICAgICAgdWkuc2V0X3Zpc2libGUobWVudS5hbnRpX2FpbVtpXS5ib2R5eWF3LAogICAgICAgICAgICAgICAgICAgIHRhYiA9PSAiYW50aWhpdCBzeXN0ZW0iIGFuZCB1aS5nZXQobWVudS5hbnRpX2FpbS5zdGF0ZXMpID09IGFsbC5zdGF0ZXNbaV0gYW5kCiAgICAgICAgICAgICAgICAgICAgdWkuZ2V0KG1lbnUuYW50aV9haW0uc2VsZWN0KSA9PSAiZGVmYXVsdCIpCiAgICAgICAgICAgICAgICB1aS5zZXRfdmlzaWJsZShtZW51LmFudGlfYWltW2ldLmJvZHlpbnQsCiAgICAgICAgICAgICAgICAgICAgdGFiID09ICJhbnRpaGl0IHN5c3RlbSIgYW5kIHVpLmdldChtZW51LmFudGlfYWltLnN0YXRlcykgPT0gYWxsLnN0YXRlc1tpXSBhbmQKICAgICAgICAgICAgICAgICAgICB1aS5nZXQobWVudS5hbnRpX2FpbS5zZWxlY3QpID09ICJkZWZhdWx0IiBhbmQKICAgICAgICAgICAgICAgICAgICAodWkuZ2V0KG1lbnUuYW50aV9haW1baV0uYm9keXlhdykgPT0gImppdHRlciIgb3IgdWkuZ2V0KG1lbnUuYW50aV9haW1baV0uYm9keXlhdykgPT0gInN0YXRpYyIpKQogICAgICAgICAgICAgICAgdWkuc2V0X3Zpc2libGUobWVudS5hbnRpX2FpbVtpXS5ib2R5ZnJlZSwKICAgICAgICAgICAgICAgICAgICB0YWIgPT0gImFudGloaXQgc3lzdGVtIiBhbmQgdWkuZ2V0KG1lbnUuYW50aV9haW0uc3RhdGVzKSA9PSBhbGwuc3RhdGVzW2ldIGFuZAogICAgICAgICAgICAgICAgICAgIHVpLmdldChtZW51LmFudGlfYWltLnNlbGVjdCkgPT0gImRlZmF1bHQiKQoKCiAgICAgICAgICAgICAgICB1aS5zZXRfdmlzaWJsZShtZW51LmFudGlfYWltW2ldLmRlZmVuc2l2ZS5waXRjaCwKICAgICAgICAgICAgICAgICAgICB0YWIgPT0gImFudGloaXQgc3lzdGVtIiBhbmQgdWkuZ2V0KG1lbnUuYW50aV9haW0uc3RhdGVzKSA9PSBhbGwuc3RhdGVzW2ldIGFuZAogICAgICAgICAgICAgICAgICAgIHVpLmdldChtZW51LmFudGlfYWltLnNlbGVjdCkgPT0gIlxhQjZCNjY1RkZkZWZlbnNpdmUiIGFuZAogICAgICAgICAgICAgICAgICAgIHVpLmdldChtZW51LmFudGlfYWltW2ldLmRlZmVuc2l2ZS5lbmFibGUpID09IHRydWUpCiAgICAgICAgICAgICAgICB1aS5zZXRfdmlzaWJsZShtZW51LmFudGlfYWltW2ldLmRlZmVuc2l2ZS5jdXN0b21fcGl0Y2gsCiAgICAgICAgICAgICAgICAgICAgdGFiID09ICJhbnRpaGl0IHN5c3RlbSIgYW5kIHVpLmdldChtZW51LmFudGlfYWltLnN0YXRlcykgPT0gYWxsLnN0YXRlc1tpXSBhbmQKICAgICAgICAgICAgICAgICAgICB1aS5nZXQobWVudS5hbnRpX2FpbVtpXS5kZWZlbnNpdmUucGl0Y2gpID09ICJjdXN0b20iIGFuZAogICAgICAgICAgICAgICAgICAgIHVpLmdldChtZW51LmFudGlfYWltLnNlbGVjdCkgPT0gIlxhQjZCNjY1RkZkZWZlbnNpdmUiIGFuZAogICAgICAgICAgICAgICAgICAgIHVpLmdldChtZW51LmFudGlfYWltW2ldLmRlZmVuc2l2ZS5lbmFibGUpID09IHRydWUpCiAgICAgICAgICAgICAgICB1aS5zZXRfdmlzaWJsZShtZW51LmFudGlfYWltW2ldLmRlZmVuc2l2ZS55YXdiYXNlLAogICAgICAgICAgICAgICAgICAgIHRhYiA9PSAiYW50aWhpdCBzeXN0ZW0iIGFuZCB1aS5nZXQobWVudS5hbnRpX2FpbS5zdGF0ZXMpID09IGFsbC5zdGF0ZXNbaV0gYW5kCiAgICAgICAgICAgICAgICAgICAgdWkuZ2V0KG1lbnUuYW50aV9haW0uc2VsZWN0KSA9PSAiXGFCNkI2NjVGRmRlZmVuc2l2ZSIgYW5kCiAgICAgICAgICAgICAgICAgICAgdWkuZ2V0KG1lbnUuYW50aV9haW1baV0uZGVmZW5zaXZlLmVuYWJsZSkgPT0gdHJ1ZSkKICAgICAgICAgICAgICAgIHVpLnNldF92aXNpYmxlKG1lbnUuYW50aV9haW1baV0uZGVmZW5zaXZlLnlhdywKICAgICAgICAgICAgICAgICAgICB0YWIgPT0gImFudGloaXQgc3lzdGVtIiBhbmQgdWkuZ2V0KG1lbnUuYW50aV9haW0uc3RhdGVzKSA9PSBhbGwuc3RhdGVzW2ldIGFuZAogICAgICAgICAgICAgICAgICAgIHVpLmdldChtZW51LmFudGlfYWltLnNlbGVjdCkgPT0gIlxhQjZCNjY1RkZkZWZlbnNpdmUiIGFuZAogICAgICAgICAgICAgICAgICAgIHVpLmdldChtZW51LmFudGlfYWltW2ldLmRlZmVuc2l2ZS5lbmFibGUpID09IHRydWUpCiAgICAgICAgICAgICAgICB1aS5zZXRfdmlzaWJsZShtZW51LmFudGlfYWltW2ldLmRlZmVuc2l2ZS55YXdhZGQsCiAgICAgICAgICAgICAgICAgICAgdGFiID09ICJhbnRpaGl0IHN5c3RlbSIgYW5kIHVpLmdldChtZW51LmFudGlfYWltLnN0YXRlcykgPT0gYWxsLnN0YXRlc1tpXSBhbmQKICAgICAgICAgICAgICAgICAgICB1aS5nZXQobWVudS5hbnRpX2FpbS5zZWxlY3QpID09ICJcYUI2QjY2NUZGZGVmZW5zaXZlIiBhbmQKICAgICAgICAgICAgICAgICAgICB1aS5nZXQobWVudS5hbnRpX2FpbVtpXS5kZWZlbnNpdmUuZW5hYmxlKSA9PSB0cnVlKQoKICAgICAgICAgICAgICAgIHVpLnNldF92aXNpYmxlKG1lbnUuYW50aV9haW1baV0uZGVmZW5zaXZlLnlhd3N0YXRpYywKICAgICAgICAgICAgICAgICAgICB0YWIgPT0gImFudGloaXQgc3lzdGVtIiBhbmQgdWkuZ2V0KG1lbnUuYW50aV9haW0uc3RhdGVzKSA9PSBhbGwuc3RhdGVzW2ldIGFuZAogICAgICAgICAgICAgICAgICAgIHVpLmdldChtZW51LmFudGlfYWltW2ldLmRlZmVuc2l2ZS55YXdhZGQpID09ICJzdGF0aWMiIGFuZAogICAgICAgICAgICAgICAgICAgIHVpLmdldChtZW51LmFudGlfYWltLnNlbGVjdCkgPT0gIlxhQjZCNjY1RkZkZWZlbnNpdmUiIGFuZAogICAgICAgICAgICAgICAgICAgIHVpLmdldChtZW51LmFudGlfYWltW2ldLmRlZmVuc2l2ZS5lbmFibGUpID09IHRydWUpCiAgICAgICAgICAgICAgICB1aS5zZXRfdmlzaWJsZShtZW51LmFudGlfYWltW2ldLmRlZmVuc2l2ZS55YXdsZWZ0LAogICAgICAgICAgICAgICAgICAgIHRhYiA9PSAiYW50aWhpdCBzeXN0ZW0iIGFuZCB1aS5nZXQobWVudS5hbnRpX2FpbS5zdGF0ZXMpID09IGFsbC5zdGF0ZXNbaV0gYW5kCiAgICAgICAgICAgICAgICAgICAgKHVpLmdldChtZW51LmFudGlfYWltW2ldLmRlZmVuc2l2ZS55YXdhZGQpID09ICIyLXNpZGUiIG9yIHVpLmdldChtZW51LmFudGlfYWltW2ldLnlhd2FkZCkgPT0gInNsb3dlZCIpIGFuZAogICAgICAgICAgICAgICAgICAgIHVpLmdldChtZW51LmFudGlfYWltLnNlbGVjdCkgPT0gIlxhQjZCNjY1RkZkZWZlbnNpdmUiIGFuZAogICAgICAgICAgICAgICAgICAgIHVpLmdldChtZW51LmFudGlfYWltW2ldLmRlZmVuc2l2ZS5lbmFibGUpID09IHRydWUpCiAgICAgICAgICAgICAgICB1aS5zZXRfdmlzaWJsZShtZW51LmFudGlfYWltW2ldLmRlZmVuc2l2ZS55YXdyaWdodCwKICAgICAgICAgICAgICAgICAgICB0YWIgPT0gImFudGloaXQgc3lzdGVtIiBhbmQgdWkuZ2V0KG1lbnUuYW50aV9haW0uc3RhdGVzKSA9PSBhbGwuc3RhdGVzW2ldIGFuZAogICAgICAgICAgICAgICAgICAgICh1aS5nZXQobWVudS5hbnRpX2FpbVtpXS5kZWZlbnNpdmUueWF3YWRkKSA9PSAiMi1zaWRlIiBvciB1aS5nZXQobWVudS5hbnRpX2FpbVtpXS55YXdhZGQpID09ICJzbG93ZWQiKSBhbmQKICAgICAgICAgICAgICAgICAgICB1aS5nZXQobWVudS5hbnRpX2FpbS5zZWxlY3QpID09ICJcYUI2QjY2NUZGZGVmZW5zaXZlIiBhbmQKICAgICAgICAgICAgICAgICAgICB1aS5nZXQobWVudS5hbnRpX2FpbVtpXS5kZWZlbnNpdmUuZW5hYmxlKSA9PSB0cnVlKQogICAgICAgICAgICAgICAgdWkuc2V0X3Zpc2libGUobWVudS5hbnRpX2FpbVtpXS5kZWZlbnNpdmUudGlja3MsCiAgICAgICAgICAgICAgICAgICAgdGFiID09ICJhbnRpaGl0IHN5c3RlbSIgYW5kIHVpLmdldChtZW51LmFudGlfYWltLnN0YXRlcykgPT0gYWxsLnN0YXRlc1tpXSBhbmQKICAgICAgICAgICAgICAgICAgICAodWkuZ2V0KG1lbnUuYW50aV9haW1baV0uZGVmZW5zaXZlLnlhd2FkZCkgPT0gInNsb3dlZCIpIGFuZAogICAgICAgICAgICAgICAgICAgIHVpLmdldChtZW51LmFudGlfYWltLnNlbGVjdCkgPT0gIlxhQjZCNjY1RkZkZWZlbnNpdmUiIGFuZAogICAgICAgICAgICAgICAgICAgIHVpLmdldChtZW51LmFudGlfYWltW2ldLmRlZmVuc2l2ZS5lbmFibGUpID09IHRydWUpCiAgICAgICAgICAgICAgICB1aS5zZXRfdmlzaWJsZShtZW51LmFudGlfYWltW2ldLmRlZmVuc2l2ZS53YXkxLAogICAgICAgICAgICAgICAgICAgIHRhYiA9PSAiYW50aWhpdCBzeXN0ZW0iIGFuZCB1aS5nZXQobWVudS5hbnRpX2FpbS5zdGF0ZXMpID09IGFsbC5zdGF0ZXNbaV0gYW5kCiAgICAgICAgICAgICAgICAgICAgKHVpLmdldChtZW51LmFudGlfYWltW2ldLmRlZmVuc2l2ZS55YXdhZGQpID09ICIzLXdheSIgb3IgdWkuZ2V0KG1lbnUuYW50aV9haW1baV0uZGVmZW5zaXZlLnlhd2FkZCkgPT0gIjUtd2F5IikgYW5kCiAgICAgICAgICAgICAgICAgICAgdWkuZ2V0KG1lbnUuYW50aV9haW0uc2VsZWN0KSA9PSAiXGFCNkI2NjVGRmRlZmVuc2l2ZSIgYW5kCiAgICAgICAgICAgICAgICAgICAgdWkuZ2V0KG1lbnUuYW50aV9haW1baV0uZGVmZW5zaXZlLmVuYWJsZSkgPT0gdHJ1ZSkKICAgICAgICAgICAgICAgIHVpLnNldF92aXNpYmxlKG1lbnUuYW50aV9haW1baV0uZGVmZW5zaXZlLndheTIsCiAgICAgICAgICAgICAgICAgICAgdGFiID09ICJhbnRpaGl0IHN5c3RlbSIgYW5kIHVpLmdldChtZW51LmFudGlfYWltLnN0YXRlcykgPT0gYWxsLnN0YXRlc1tpXSBhbmQKICAgICAgICAgICAgICAgICAgICAodWkuZ2V0KG1lbnUuYW50aV9haW1baV0uZGVmZW5zaXZlLnlhd2FkZCkgPT0gIjMtd2F5IiBvciB1aS5nZXQobWVudS5hbnRpX2FpbVtpXS5kZWZlbnNpdmUueWF3YWRkKSA9PSAiNS13YXkiKSBhbmQKICAgICAgICAgICAgICAgICAgICB1aS5nZXQobWVudS5hbnRpX2FpbS5zZWxlY3QpID09ICJcYUI2QjY2NUZGZGVmZW5zaXZlIiBhbmQKICAgICAgICAgICAgICAgICAgICB1aS5nZXQobWVudS5hbnRpX2FpbVtpXS5kZWZlbnNpdmUuZW5hYmxlKSA9PSB0cnVlKQogICAgICAgICAgICAgICAgdWkuc2V0X3Zpc2libGUobWVudS5hbnRpX2FpbVtpXS5kZWZlbnNpdmUud2F5MywKICAgICAgICAgICAgICAgICAgICB0YWIgPT0gImFudGloaXQgc3lzdGVtIiBhbmQgdWkuZ2V0KG1lbnUuYW50aV9haW0uc3RhdGVzKSA9PSBhbGwuc3RhdGVzW2ldIGFuZAogICAgICAgICAgICAgICAgICAgICh1aS5nZXQobWVudS5hbnRpX2FpbVtpXS5kZWZlbnNpdmUueWF3YWRkKSA9PSAiMy13YXkiIG9yIHVpLmdldChtZW51LmFudGlfYWltW2ldLmRlZmVuc2l2ZS55YXdhZGQpID09ICI1LXdheSIpIGFuZAogICAgICAgICAgICAgICAgICAgIHVpLmdldChtZW51LmFudGlfYWltLnNlbGVjdCkgPT0gIlxhQjZCNjY1RkZkZWZlbnNpdmUiIGFuZAogICAgICAgICAgICAgICAgICAgIHVpLmdldChtZW51LmFudGlfYWltW2ldLmRlZmVuc2l2ZS5lbmFibGUpID09IHRydWUpCiAgICAgICAgICAgICAgICB1aS5zZXRfdmlzaWJsZShtZW51LmFudGlfYWltW2ldLmRlZmVuc2l2ZS53YXk0LAogICAgICAgICAgICAgICAgICAgIHRhYiA9PSAiYW50aWhpdCBzeXN0ZW0iIGFuZCB1aS5nZXQobWVudS5hbnRpX2FpbS5zdGF0ZXMpID09IGFsbC5zdGF0ZXNbaV0gYW5kCiAgICAgICAgICAgICAgICAgICAgKHVpLmdldChtZW51LmFudGlfYWltW2ldLmRlZmVuc2l2ZS55YXdhZGQpID09ICI1LXdheSIpIGFuZAogICAgICAgICAgICAgICAgICAgIHVpLmdldChtZW51LmFudGlfYWltLnNlbGVjdCkgPT0gIlxhQjZCNjY1RkZkZWZlbnNpdmUiIGFuZAogICAgICAgICAgICAgICAgICAgIHVpLmdldChtZW51LmFudGlfYWltW2ldLmRlZmVuc2l2ZS5lbmFibGUpID09IHRydWUpCiAgICAgICAgICAgICAgICB1aS5zZXRfdmlzaWJsZShtZW51LmFudGlfYWltW2ldLmRlZmVuc2l2ZS53YXk1LAogICAgICAgICAgICAgICAgICAgIHRhYiA9PSAiYW50aWhpdCBzeXN0ZW0iIGFuZCB1aS5nZXQobWVudS5hbnRpX2FpbS5zdGF0ZXMpID09IGFsbC5zdGF0ZXNbaV0gYW5kCiAgICAgICAgICAgICAgICAgICAgKHVpLmdldChtZW51LmFudGlfYWltW2ldLmRlZmVuc2l2ZS55YXdhZGQpID09ICI1LXdheSIpIGFuZAogICAgICAgICAgICAgICAgICAgIHVpLmdldChtZW51LmFudGlfYWltLnNlbGVjdCkgPT0gIlxhQjZCNjY1RkZkZWZlbnNpdmUiIGFuZAogICAgICAgICAgICAgICAgICAgIHVpLmdldChtZW51LmFudGlfYWltW2ldLmRlZmVuc2l2ZS5lbmFibGUpID09IHRydWUpCgoKICAgICAgICAgICAgICAgIHVpLnNldF92aXNpYmxlKG1lbnUuYW50aV9haW1baV0uZGVmZW5zaXZlLnlhd2ppdHRlciwKICAgICAgICAgICAgICAgICAgICB0YWIgPT0gImFudGloaXQgc3lzdGVtIiBhbmQgdWkuZ2V0KG1lbnUuYW50aV9haW0uc3RhdGVzKSA9PSBhbGwuc3RhdGVzW2ldIGFuZAogICAgICAgICAgICAgICAgICAgIHVpLmdldChtZW51LmFudGlfYWltW2ldLmRlZmVuc2l2ZS5lbmFibGUpID09IHRydWUgYW5kCiAgICAgICAgICAgICAgICAgICAgdWkuZ2V0KG1lbnUuYW50aV9haW0uc2VsZWN0KSA9PSAiXGFCNkI2NjVGRmRlZmVuc2l2ZSIpCgogICAgICAgICAgICAgICAgdWkuc2V0X3Zpc2libGUobWVudS5hbnRpX2FpbVtpXS5kZWZlbnNpdmUuaml0dGVyaW50LAogICAgICAgICAgICAgICAgICAgIHRhYiA9PSAiYW50aWhpdCBzeXN0ZW0iIGFuZCB1aS5nZXQobWVudS5hbnRpX2FpbS5zdGF0ZXMpID09IGFsbC5zdGF0ZXNbaV0gYW5kCiAgICAgICAgICAgICAgICAgICAgdWkuZ2V0KG1lbnUuYW50aV9haW0uc2VsZWN0KSA9PSAiXGFCNkI2NjVGRmRlZmVuc2l2ZSIgYW5kCiAgICAgICAgICAgICAgICAgICAgdWkuZ2V0KG1lbnUuYW50aV9haW1baV0uZGVmZW5zaXZlLmVuYWJsZSkgPT0gdHJ1ZSBhbmQKICAgICAgICAgICAgICAgICAgICAodWkuZ2V0KG1lbnUuYW50aV9haW1baV0uZGVmZW5zaXZlLnlhd2ppdHRlcikgPT0gIm9mZnNldCIgb3IgdWkuZ2V0KG1lbnUuYW50aV9haW1baV0uZGVmZW5zaXZlLnlhd2ppdHRlcikgPT0gImNlbnRlciIgb3IgdWkuZ2V0KG1lbnUuYW50aV9haW1baV0uZGVmZW5zaXZlLnlhd2ppdHRlcikgPT0gInJhbmRvbSIgb3IgdWkuZ2V0KG1lbnUuYW50aV9haW1baV0uZGVmZW5zaXZlLnlhd2ppdHRlcikgPT0gInNraXR0ZXIiKSkKCgoKCiAgICAgICAgICAgICAgICB1aS5zZXRfdmlzaWJsZShtZW51LmFudGlfYWltW2ldLmRlZmVuc2l2ZS5ib2R5eWF3LAogICAgICAgICAgICAgICAgICAgIHRhYiA9PSAiYW50aWhpdCBzeXN0ZW0iIGFuZCB1aS5nZXQobWVudS5hbnRpX2FpbS5zdGF0ZXMpID09IGFsbC5zdGF0ZXNbaV0gYW5kCiAgICAgICAgICAgICAgICAgICAgdWkuZ2V0KG1lbnUuYW50aV9haW0uc2VsZWN0KSA9PSAiXGFCNkI2NjVGRmRlZmVuc2l2ZSIgYW5kCiAgICAgICAgICAgICAgICAgICAgdWkuZ2V0KG1lbnUuYW50aV9haW1baV0uZGVmZW5zaXZlLmVuYWJsZSkgPT0gdHJ1ZSkKICAgICAgICAgICAgICAgIHVpLnNldF92aXNpYmxlKG1lbnUuYW50aV9haW1baV0uZGVmZW5zaXZlLmJvZHlpbnQsCiAgICAgICAgICAgICAgICAgICAgdGFiID09ICJhbnRpaGl0IHN5c3RlbSIgYW5kIHVpLmdldChtZW51LmFudGlfYWltLnN0YXRlcykgPT0gYWxsLnN0YXRlc1tpXSBhbmQKICAgICAgICAgICAgICAgICAgICB1aS5nZXQobWVudS5hbnRpX2FpbS5zZWxlY3QpID09ICJcYUI2QjY2NUZGZGVmZW5zaXZlIiBhbmQKICAgICAgICAgICAgICAgICAgICB1aS5nZXQobWVudS5hbnRpX2FpbVtpXS5kZWZlbnNpdmUuZW5hYmxlKSA9PSB0cnVlIGFuZAogICAgICAgICAgICAgICAgICAgICh1aS5nZXQobWVudS5hbnRpX2FpbVtpXS5kZWZlbnNpdmUuYm9keXlhdykgPT0gImppdHRlciIgb3IgdWkuZ2V0KG1lbnUuYW50aV9haW1baV0uZGVmZW5zaXZlLmJvZHl5YXcpID09ICJzdGF0aWMiKSkKICAgICAgICAgICAgICAgIHVpLnNldF92aXNpYmxlKG1lbnUuYW50aV9haW1baV0uZGVmZW5zaXZlLmJvZHlmcmVlLAogICAgICAgICAgICAgICAgICAgIHRhYiA9PSAiYW50aWhpdCBzeXN0ZW0iIGFuZCB1aS5nZXQobWVudS5hbnRpX2FpbS5zdGF0ZXMpID09IGFsbC5zdGF0ZXNbaV0gYW5kCiAgICAgICAgICAgICAgICAgICAgdWkuZ2V0KG1lbnUuYW50aV9haW1baV0uZGVmZW5zaXZlLmVuYWJsZSkgPT0gdHJ1ZSBhbmQKICAgICAgICAgICAgICAgICAgICB1aS5nZXQobWVudS5hbnRpX2FpbS5zZWxlY3QpID09ICJcYUI2QjY2NUZGZGVmZW5zaXZlIikKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kLAogICAgICAgIGluZGljYXRvcnMgPSBmdW5jdGlvbigpCiAgICAgICAgICAgIGxvY2FsIGxvY2FsX3BsYXllciA9IGVudGl0eS5nZXRfbG9jYWxfcGxheWVyKCkKICAgICAgICAgICAgaWYgbm90IGxvY2FsX3BsYXllciBvciBub3QgZW50aXR5LmlzX2FsaXZlKGxvY2FsX3BsYXllcikgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgICAgIGlmIG5vdCB1aS5nZXQobWVudS52aXN1YWxzLmluZGljYXRvcnMpIHRoZW4gcmV0dXJuIGVuZAogICAgICAgICAgICBsb2NhbCBkdF9hbmltID0gYW5pbWF0aW9uczpwcm9jZXNzKCJJcyBjaGFyZ2VkIiwgaGVscGVycy5nZXRfY2hhcmdlKCksIDgpCiAgICAgICAgICAgIGxvY2FsIGJpbmRfY29sb3IgPSB7IHVpLmdldChtZW51LnZpc3VhbHMuaW5kX2NvbG9yKSB9CiAgICAgICAgICAgIGxvY2FsIGR0X3IsIGR0X2csIGR0X2IgPSBsZXJwKHsgMjU1LCAyNSwgMjUsIDI1NSB9LCB7IGJpbmRfY29sb3JbMV0sIGJpbmRfY29sb3JbMl0sIGJpbmRfY29sb3JbM10sIDI1NSB9LAogICAgICAgICAgICAgICAgZHRfYW5pbSkKICAgICAgICAgICAgbG9jYWwgbGlzdCA9IHsKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBuYW1lID0gIkRUIiwKICAgICAgICAgICAgICAgICAgICBwYXRoID0gcmVmcy5kb3VibGVfdGFwWzJdLAogICAgICAgICAgICAgICAgICAgIHIgPSBkdF9yLAogICAgICAgICAgICAgICAgICAgIGcgPSBkdF9nLAogICAgICAgICAgICAgICAgICAgIGIgPSBkdF9iLAogICAgICAgICAgICAgICAgICAgIGdldF9ib29sID0gMCwKICAgICAgICAgICAgICAgICAgICBzY29wZSA9IDAKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgbmFtZSA9ICJPUyIsCiAgICAgICAgICAgICAgICAgICAgcGF0aCA9IHJlZnMub25fc2hvdF9hbnRpX2FpbVsyXSwKICAgICAgICAgICAgICAgICAgICByID0gMjU1LAogICAgICAgICAgICAgICAgICAgIGcgPSAyNTUsCiAgICAgICAgICAgICAgICAgICAgYiA9IDI1NSwKICAgICAgICAgICAgICAgICAgICBnZXRfYm9vbCA9IDAsCiAgICAgICAgICAgICAgICAgICAgc2NvcGUgPSAwCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIG5hbWUgPSAiRE1HIiwKICAgICAgICAgICAgICAgICAgICBwYXRoID0gcmVmcy5kbWdbMl0sCiAgICAgICAgICAgICAgICAgICAgciA9IDIwMCwKICAgICAgICAgICAgICAgICAgICBnID0gMjAwLAogICAgICAgICAgICAgICAgICAgIGIgPSAyMDAsCiAgICAgICAgICAgICAgICAgICAgZ2V0X2Jvb2wgPSAwLAogICAgICAgICAgICAgICAgICAgIHNjb3BlID0gMAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBuYW1lID0gIlBBIiwKICAgICAgICAgICAgICAgICAgICBwYXRoID0gcmVmcy5hdXRvX3BlZWtbMl0sCiAgICAgICAgICAgICAgICAgICAgciA9IGJpbmRfY29sb3JbMV0sCiAgICAgICAgICAgICAgICAgICAgZyA9IGJpbmRfY29sb3JbMl0sCiAgICAgICAgICAgICAgICAgICAgYiA9IGJpbmRfY29sb3JbM10sCiAgICAgICAgICAgICAgICAgICAgZ2V0X2Jvb2wgPSAwLAogICAgICAgICAgICAgICAgICAgIHNjb3BlID0gMAogICAgICAgICAgICAgICAgfSwKCiAgICAgICAgICAgIH0KICAgICAgICAgICAgbG9jYWwgYXkgPSAwCiAgICAgICAgICAgIGxvY2FsIHgsIHkgPSBzY3JlZW54IC8gMiwgc2NyZWVueSAvIDIKICAgICAgICAgICAgbG9jYWwgc2NvcGVkID0gZW50aXR5LmdldF9wcm9wKGxvY2FsX3BsYXllciwgIm1fYklzU2NvcGVkIikKICAgICAgICAgICAgbG9jYWwgYW5pbSA9IGFuaW1hdGlvbnM6cHJvY2VzcygiSW5kaWNhdG9ycyIsIHNjb3BlZCA9PSAxIGFuZCB0cnVlIG9yIGZhbHNlLCA4KQogICAgICAgICAgICBsb2NhbCBhZGRfeCA9IDI0ICogYW5pbQogICAgICAgICAgICBsb2NhbCBidWlsZF90ZXh0ID0gcmVuZGVyZXIubWVhc3VyZV90ZXh0KCJjLSIsICJCRVRBIikKICAgICAgICAgICAgbG9jYWwgc2lyaXVzX3RleHQgPSByZW5kZXJlci5tZWFzdXJlX3RleHQoImMtIiwgIlNJUklVUyAiKQogICAgICAgICAgICByZW5kZXJlci50ZXh0KHggLSAyICsgYWRkX3ggLSBidWlsZF90ZXh0IC8gMiwgeSArIDIwLCAyNTUsIDI1NSwgMjU1LCAyNTUsICJjLSIsIG5pbCwgIlNJUklVUyIpCiAgICAgICAgICAgIHJlbmRlcmVyLnRleHQoeCAtIDEgKyBhZGRfeCArIHNpcml1c190ZXh0IC8gMiwgeSArIDIwLCAyNTUsIDI1NSwgMjU1LCAyNTUsICJjLSIsIDAsCiAgICAgICAgICAgICAgICAiXGEiIC4uIHJnYmFfdG9faGV4KHVpLmdldChtZW51LnZpc3VhbHMuaW5kX2NvbG9yKSkgLi4gIkJFVEEiKQoKICAgICAgICAgICAgZm9yIGssIHYgaW4gcGFpcnMobGlzdCkgZG8KICAgICAgICAgICAgICAgIHYuZ2V0X2Jvb2wgPSBhbmltYXRpb25zOnByb2Nlc3Modi5uYW1lIC4uICIgYW5pbSIsIHVpLmdldCh2LnBhdGgpIGFuZCB0cnVlIG9yIGZhbHNlLCA4KQogICAgICAgICAgICAgICAgdi5zY29wZSA9IChyZW5kZXJlci5tZWFzdXJlX3RleHQoImMtIiwgIlNJUklVUyIpIC8gMiArIHJlbmRlcmVyLm1lYXN1cmVfdGV4dCgiYy0iLCB2Lm5hbWUpIC8gMiAtIDEwKSAqCiAgICAgICAgICAgICAgICAgICAgYW5pbQogICAgICAgICAgICAgICAgcmVuZGVyZXIudGV4dCh4IC0gMSArIHYuc2NvcGUsIHkgKyAyOCArIGF5LCB2LnIsIHYuZywgdi5iLCAyNTUgKiB2LmdldF9ib29sLCAiYy0iLCAwLCB2Lm5hbWUpCiAgICAgICAgICAgICAgICBheSA9IGF5ICsgOCAqIHYuZ2V0X2Jvb2wKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kLAogICAgICAgIGxvZ3MgPSBmdW5jdGlvbigpCiAgICAgICAgICAgIGxvY2FsIHNzID0ge30KICAgICAgICAgICAgc3MueCwgc3MueSA9IHNjcmVlbngsIHNjcmVlbnkKICAgICAgICAgICAgbG9jYWwgb2Zmc2V0ID0gMAogICAgICAgICAgICBsb2NhbCBsb2NhbF9wbGF5ZXIgPSBlbnRpdHkuZ2V0X2xvY2FsX3BsYXllcigpCiAgICAgICAgICAgIGlmIG5vdCBsb2NhbF9wbGF5ZXIgdGhlbiBsb2dzID0ge30gZW5kCiAgICAgICAgICAgIGlmIG5vdCB1aS5nZXQobWVudS52aXN1YWxzLmxvZ3MpIHRoZW4gcmV0dXJuIGVuZAogICAgICAgICAgICBmb3IgaSwgdiBpbiBwYWlycyhsb2dzKSBkbwogICAgICAgICAgICAgICAgaWYgdi50aW1lID4gZ2xvYmFscy5jdXJ0aW1lKCkgYW5kIGkgPD0gMTAgdGhlbgogICAgICAgICAgICAgICAgICAgIHYuYWxwaGEgPSBtYXRoLmxlcnAodi5hbHBoYSwgMjU1LCAwLjEzKQogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIHYuYWxwaGEgPSBtYXRoLmxlcnAodi5hbHBoYSwgMCwgMC4xMykKICAgICAgICAgICAgICAgICAgICBpZiB2LmFscGhhIDwgMCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlLnJlbW92ZShsb2dzLCBpKQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgcmVuZGVyZXIudGV4dChzcy54IC8gMiAtIDUwICsgKDUwICogKHYuYWxwaGEgLyAyNTUpKSwgc3MueSAvIDIgKyAxNTUgKyBvZmZzZXQsIHYucjEsIHYuZzEsIHYuYjEsIHYuYWxwaGEsCiAgICAgICAgICAgICAgICAgICAgImMiLCAwLCB2LnRleHQpCiAgICAgICAgICAgICAgICBvZmZzZXQgPSBvZmZzZXQgKyAxNSAqICh2LmFscGhhIC8gMjU1KQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKCiAgICB9LAogICAgb25fY3JlYXRlX21vdmUgPSB7CiAgICAgICAgYnVpbGRlciA9IGZ1bmN0aW9uKGNtZCkKICAgICAgICAgICAgbG9jYWwgbG9jYWxfcGxheWVyID0gZW50aXR5LmdldF9sb2NhbF9wbGF5ZXIoKQoKICAgICAgICAgICAgaWYgbm90IGxvY2FsX3BsYXllciB0aGVuIHJldHVybiBlbmQKCgoKICAgICAgICAgICAgbG9jYWwgZmxhZyA9IGVudGl0eS5nZXRfcHJvcChsb2NhbF9wbGF5ZXIsICJtX2ZGbGFncyIpCgogICAgICAgICAgICBsb2NhbCB2ZWwgPSB2ZWN0b3IoZW50aXR5LmdldF9wcm9wKGxvY2FsX3BsYXllciwgJ21fdmVjVmVsb2NpdHknKSk6bGVuZ3RoMmQoKQogICAgICAgICAgICBsb2NhbCBkdWNrZWQgPSBlbnRpdHkuZ2V0X3Byb3AobG9jYWxfcGxheWVyLCAnbV9iRHVja2VkJykgPT0gMQogICAgICAgICAgICBpZiB1aS5nZXQocmVmcy5mcmVlc3RhbmRpbmdbMl0pIHRoZW4KICAgICAgICAgICAgICAgIHBsYXllcnN0YXRlID0gNwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBpZiBmbGFnID09IDI1NiBvciBmbGFnID09IDI2MiB0aGVuCiAgICAgICAgICAgICAgICAgICAgaW5fYWlyID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgIGFpcl90aWNrID0gZ2xvYmFscy50aWNrY291bnQoKSArIDMKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICBpbl9haXIgPSAoYWlyX3RpY2sgPiBnbG9iYWxzLnRpY2tjb3VudCgpKSBhbmQgdHJ1ZSBvciBmYWxzZQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBpZiBpbl9haXIgYW5kIGR1Y2tlZCB0aGVuCiAgICAgICAgICAgICAgICAgICAgcGxheWVyc3RhdGUgPSA0CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgaWYgaW5fYWlyIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgcGxheWVyc3RhdGUgPSAzCiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICBpZiBkdWNrZWQgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxheWVyc3RhdGUgPSA2CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHVpLmdldChyZWZzLnNsb3dfbW90aW9uWzJdKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxheWVyc3RhdGUgPSA1CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgdmVsIDwgNSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYXllcnN0YXRlID0gMQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxheWVyc3RhdGUgPSAyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCgoKICAgICAgICAgICAgbG9jYWwgYm9keV95YXcgPSBlbnRpdHkuZ2V0X3Byb3AobG9jYWxfcGxheWVyLCAnbV9mbFBvc2VQYXJhbWV0ZXInLCAxMSkKCiAgICAgICAgICAgIGlmIGdsb2JhbHMuY2hva2VkY29tbWFuZHMoKSA9PSAwIG9yIGdsb2JhbHMuY2hva2VkY29tbWFuZHMoKSA9PSAxIHRoZW4KICAgICAgICAgICAgICAgIEFuZ2xlMiA9IE1hdGgucm91bmQoYm9keV95YXcgKiAxMjAgLSA2MCkKICAgICAgICAgICAgZW5kCgogICAgICAgICAgICBpZiB1aS5nZXQobWVudS5hbnRpX2FpbVtwbGF5ZXJzdGF0ZV0ueWF3YWRkKSA9PSAic2xvd2VkIiBvciB1aS5nZXQobWVudS5hbnRpX2FpbVtwbGF5ZXJzdGF0ZV0uZGVmZW5zaXZlLnlhd2FkZCkgPT0gIjItc2lkZSIgdGhlbgogICAgICAgICAgICAgICAgaWYgZ2xvYmFscy5jaG9rZWRjb21tYW5kcygpID09IDAgb3IgZ2xvYmFscy5jaG9rZWRjb21tYW5kcygpID09IDEgdGhlbgogICAgICAgICAgICAgICAgICAgIHRpY2tfc3dpdGNoID0gdGlja19zd2l0Y2ggKyAxCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIHNwZWVkX3RpY2sgPSB1aS5nZXQobWVudS5hbnRpX2FpbVtwbGF5ZXJzdGF0ZV0udGlja3MpCiAgICAgICAgICAgICAgICBpZiB0aWNrX3N3aXRjaCA9PSBzcGVlZF90aWNrIHRoZW4KICAgICAgICAgICAgICAgICAgICBzaWRlID0gMAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBpZiB0aWNrX3N3aXRjaCA+PSBzcGVlZF90aWNrICogMiB0aGVuCiAgICAgICAgICAgICAgICAgICAgc2lkZSA9IDEKICAgICAgICAgICAgICAgICAgICB0aWNrX3N3aXRjaCA9IDAKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICAgICAgaWYgZ2xvYmFscy5jaG9rZWRjb21tYW5kcygpID09IDAgb3IgZ2xvYmFscy5jaG9rZWRjb21tYW5kcygpID09IDEgdGhlbgogICAgICAgICAgICAgICAgaWYgdWkuZ2V0KG1lbnUuYW50aV9haW1bcGxheWVyc3RhdGVdLnlhd2FkZCkgPT0gIjMtd2F5IiBvciB1aS5nZXQobWVudS5hbnRpX2FpbVtwbGF5ZXJzdGF0ZV0uZGVmZW5zaXZlLnlhd2FkZCkgPT0gIjMtd2F5IiB0aGVuCiAgICAgICAgICAgICAgICAgICAgd2F5ID0gd2F5ICsgMQogICAgICAgICAgICAgICAgICAgIGlmIHdheSA+IDIgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICB3YXkgPSAwCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGlmIHVpLmdldChtZW51LmFudGlfYWltW3BsYXllcnN0YXRlXS55YXdhZGQpID09ICI1LXdheSIgb3IgdWkuZ2V0KG1lbnUuYW50aV9haW1bcGxheWVyc3RhdGVdLmRlZmVuc2l2ZS55YXdhZGQpID09ICI1LXdheSIgdGhlbgogICAgICAgICAgICAgICAgICAgIHdheSA9IHdheSArIDEKICAgICAgICAgICAgICAgICAgICBpZiB3YXkgPiA0IHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgd2F5ID0gMAogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgaWYgdWkuZ2V0KG1lbnUuYW50aV9haW1bcGxheWVyc3RhdGVdLnlhd2FkZCkgPT0gIjItc2lkZSIgb3IgdWkuZ2V0KG1lbnUuYW50aV9haW1bcGxheWVyc3RhdGVdLmRlZmVuc2l2ZS55YXdhZGQpID09ICIyLXNpZGUiIHRoZW4KICAgICAgICAgICAgICAgIGlmIEFuZ2xlMiA+PSAwIHRoZW4KICAgICAgICAgICAgICAgICAgICBzaWRlID0gMQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBpZiBBbmdsZTIgPD0gMCB0aGVuCiAgICAgICAgICAgICAgICAgICAgc2lkZSA9IDAKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIHVpLnNldChyZWZzLnBpdGNoWzFdLCB1aS5nZXQobWVudS5hbnRpX2FpbVtwbGF5ZXJzdGF0ZV0ucGl0Y2gpKQogICAgICAgICAgICB1aS5zZXQocmVmcy5waXRjaFsyXSwgdWkuZ2V0KG1lbnUuYW50aV9haW1bcGxheWVyc3RhdGVdLmN1c3RvbV9waXRjaCkpCiAgICAgICAgICAgIHVpLnNldChyZWZzLnlhd19iYXNlLCB1aS5nZXQobWVudS5hbnRpX2FpbVtwbGF5ZXJzdGF0ZV0ueWF3YmFzZSkpCgogICAgICAgICAgICB1aS5zZXQocmVmcy55YXdbMV0sIHVpLmdldChtZW51LmFudGlfYWltW3BsYXllcnN0YXRlXS55YXcpKQogICAgICAgICAgICBpZiB1aS5nZXQobWVudS5hbnRpX2FpbVtwbGF5ZXJzdGF0ZV0ueWF3YWRkKSA9PSAic3RhdGljIiB0aGVuCiAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy55YXdbMl0sIHVpLmdldChtZW51LmFudGlfYWltW3BsYXllcnN0YXRlXS55YXdzdGF0aWMpKQogICAgICAgICAgICBlbmQKICAgICAgICAgICAgdWkuc2V0KHJlZnMueWF3X2ppdHRlclsxXSwgdWkuZ2V0KG1lbnUuYW50aV9haW1bcGxheWVyc3RhdGVdLnlhd2ppdHRlcikpCiAgICAgICAgICAgIHVpLnNldChyZWZzLnlhd19qaXR0ZXJbMl0sIHVpLmdldChtZW51LmFudGlfYWltW3BsYXllcnN0YXRlXS5qaXR0ZXJpbnQpKQogICAgICAgICAgICBpZiB1aS5nZXQobWVudS5hbnRpX2FpbVtwbGF5ZXJzdGF0ZV0ueWF3YWRkKSA9PSAiMi1zaWRlIiB0aGVuCiAgICAgICAgICAgICAgICBpZiBzaWRlID09IDAgdGhlbgogICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnlhd1syXSwgdWkuZ2V0KG1lbnUuYW50aV9haW1bcGxheWVyc3RhdGVdLnlhd2xlZnQpKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBpZiBzaWRlID09IDEgdGhlbgogICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnlhd1syXSwgdWkuZ2V0KG1lbnUuYW50aV9haW1bcGxheWVyc3RhdGVdLnlhd3JpZ2h0KSkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIGlmIHVpLmdldChtZW51LmFudGlfYWltW3BsYXllcnN0YXRlXS55YXdhZGQpID09ICJzbG93ZWQiIHRoZW4KICAgICAgICAgICAgICAgIGlmIHNpZGUgPT0gMCB0aGVuCiAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMueWF3WzJdLCB1aS5nZXQobWVudS5hbnRpX2FpbVtwbGF5ZXJzdGF0ZV0ueWF3bGVmdCkpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGlmIHNpZGUgPT0gMSB0aGVuCiAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMueWF3WzJdLCB1aS5nZXQobWVudS5hbnRpX2FpbVtwbGF5ZXJzdGF0ZV0ueWF3cmlnaHQpKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgaWYgdWkuZ2V0KG1lbnUuYW50aV9haW1bcGxheWVyc3RhdGVdLnlhd2FkZCkgPT0gIjMtd2F5IiB0aGVuCiAgICAgICAgICAgICAgICBpZiB3YXkgPT0gMCB0aGVuCiAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMueWF3WzJdLCB1aS5nZXQobWVudS5hbnRpX2FpbVtwbGF5ZXJzdGF0ZV0ud2F5MSkpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGlmIHdheSA9PSAxIHRoZW4KICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy55YXdbMl0sIHVpLmdldChtZW51LmFudGlfYWltW3BsYXllcnN0YXRlXS53YXkyKSkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgaWYgd2F5ID09IDIgdGhlbgogICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnlhd1syXSwgdWkuZ2V0KG1lbnUuYW50aV9haW1bcGxheWVyc3RhdGVdLndheTMpKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAoKCiAgICAgICAgICAgIGlmIHVpLmdldChtZW51LmFudGlfYWltW3BsYXllcnN0YXRlXS55YXdhZGQpID09ICI1LXdheSIgdGhlbgogICAgICAgICAgICAgICAgaWYgd2F5ID09IDAgdGhlbgogICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnlhd1syXSwgdWkuZ2V0KG1lbnUuYW50aV9haW1bcGxheWVyc3RhdGVdLndheTEpKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBpZiB3YXkgPT0gMSB0aGVuCiAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMueWF3WzJdLCB1aS5nZXQobWVudS5hbnRpX2FpbVtwbGF5ZXJzdGF0ZV0ud2F5MikpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGlmIHdheSA9PSAyIHRoZW4KICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy55YXdbMl0sIHVpLmdldChtZW51LmFudGlfYWltW3BsYXllcnN0YXRlXS53YXkzKSkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgaWYgd2F5ID09IDMgdGhlbgogICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnlhd1syXSwgdWkuZ2V0KG1lbnUuYW50aV9haW1bcGxheWVyc3RhdGVdLndheTQpKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBpZiB3YXkgPT0gNCB0aGVuCiAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMueWF3WzJdLCB1aS5nZXQobWVudS5hbnRpX2FpbVtwbGF5ZXJzdGF0ZV0ud2F5NSkpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIHVpLnNldChyZWZzLmJvZHlfeWF3WzFdLCB1aS5nZXQobWVudS5hbnRpX2FpbVtwbGF5ZXJzdGF0ZV0uYm9keXlhdykpCiAgICAgICAgICAgIGxvY2FsIGJ5YXcKICAgICAgICAgICAgaWYgc2lkZSA9PSAwIHRoZW4KICAgICAgICAgICAgICAgIGJ5YXcgPSB1aS5nZXQobWVudS5hbnRpX2FpbVtwbGF5ZXJzdGF0ZV0uYm9keWludCkgKiAxCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBpZiBzaWRlID09IDEgdGhlbgogICAgICAgICAgICAgICAgYnlhdyA9IHVpLmdldChtZW51LmFudGlfYWltW3BsYXllcnN0YXRlXS5ib2R5aW50KSAqIC0xCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBpZiB1aS5nZXQobWVudS5hbnRpX2FpbVtwbGF5ZXJzdGF0ZV0ueWF3YWRkKSA9PSAic2xvd2VkIiBhbmQgdWkuZ2V0KG1lbnUuYW50aV9haW1bcGxheWVyc3RhdGVdLmJvZHl5YXcpID09ICJqaXR0ZXIiIHRoZW4KICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLmJvZHlfeWF3WzFdLCAic3RhdGljIikKCiAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy5ib2R5X3lhd1syXSwgYnlhdykKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMuYm9keV95YXdbMl0sIHVpLmdldChtZW51LmFudGlfYWltW3BsYXllcnN0YXRlXS5ib2R5aW50KSkKICAgICAgICAgICAgZW5kCgogICAgICAgICAgICB1aS5zZXQocmVmcy5mcmVlc3RhbmRpbmdfYm9keV95YXcsIHVpLmdldChtZW51LmFudGlfYWltW3BsYXllcnN0YXRlXS5ib2R5ZnJlZSkpCgogICAgICAgICAgICBjbWQuZm9yY2VfZGVmZW5zaXZlID0gdWkuZ2V0KG1lbnUuYW50aV9haW1bcGxheWVyc3RhdGVdLmRlZmVuc2l2ZS5mb3JjZSkKCiAgICAgICAgICAgIGlmIGhlbHBlcnM6aXNfZGVmZW5zaXZlKCkgdGhlbgogICAgICAgICAgICAgICAgaWYgdWkuZ2V0KG1lbnUuYW50aV9haW1bcGxheWVyc3RhdGVdLmRlZmVuc2l2ZS5lbmFibGUpIHRoZW4KICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy55YXdfaml0dGVyWzFdLCB1aS5nZXQobWVudS5hbnRpX2FpbVtwbGF5ZXJzdGF0ZV0uZGVmZW5zaXZlLnlhd2ppdHRlcikpCiAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMueWF3X2ppdHRlclsyXSwgdWkuZ2V0KG1lbnUuYW50aV9haW1bcGxheWVyc3RhdGVdLmRlZmVuc2l2ZS5qaXR0ZXJpbnQpKQogICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnBpdGNoWzFdLCB1aS5nZXQobWVudS5hbnRpX2FpbVtwbGF5ZXJzdGF0ZV0uZGVmZW5zaXZlLnBpdGNoKSkKICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy5waXRjaFsyXSwgdWkuZ2V0KG1lbnUuYW50aV9haW1bcGxheWVyc3RhdGVdLmRlZmVuc2l2ZS5jdXN0b21fcGl0Y2gpKQogICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnlhd19iYXNlLCB1aS5nZXQobWVudS5hbnRpX2FpbVtwbGF5ZXJzdGF0ZV0uZGVmZW5zaXZlLnlhd2Jhc2UpKQoKICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy55YXdbMV0sIHVpLmdldChtZW51LmFudGlfYWltW3BsYXllcnN0YXRlXS5kZWZlbnNpdmUueWF3KSkKICAgICAgICAgICAgICAgICAgICBpZiB1aS5nZXQobWVudS5hbnRpX2FpbVtwbGF5ZXJzdGF0ZV0uZGVmZW5zaXZlLnlhd2FkZCkgPT0gInN0YXRpYyIgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy55YXdbMl0sIHVpLmdldChtZW51LmFudGlfYWltW3BsYXllcnN0YXRlXS5kZWZlbnNpdmUueWF3c3RhdGljKSkKICAgICAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICAgICAgaWYgdWkuZ2V0KG1lbnUuYW50aV9haW1bcGxheWVyc3RhdGVdLmRlZmVuc2l2ZS55YXdhZGQpID09ICIyLXNpZGUiIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgaWYgc2lkZSA9PSAwIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnlhd1syXSwgdWkuZ2V0KG1lbnUuYW50aV9haW1bcGxheWVyc3RhdGVdLmRlZmVuc2l2ZS55YXdsZWZ0KSkKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHNpZGUgPT0gMSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy55YXdbMl0sIHVpLmdldChtZW51LmFudGlfYWltW3BsYXllcnN0YXRlXS5kZWZlbnNpdmUueWF3cmlnaHQpKQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICAgICAgaWYgdWkuZ2V0KG1lbnUuYW50aV9haW1bcGxheWVyc3RhdGVdLmRlZmVuc2l2ZS55YXdhZGQpID09ICJzbG93ZWQiIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgaWYgc2lkZSA9PSAwIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnlhd1syXSwgdWkuZ2V0KG1lbnUuYW50aV9haW1bcGxheWVyc3RhdGVdLmRlZmVuc2l2ZS55YXdsZWZ0KSkKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHNpZGUgPT0gMSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy55YXdbMl0sIHVpLmdldChtZW51LmFudGlfYWltW3BsYXllcnN0YXRlXS5kZWZlbnNpdmUueWF3cmlnaHQpKQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICAgICAgaWYgdWkuZ2V0KG1lbnUuYW50aV9haW1bcGxheWVyc3RhdGVdLmRlZmVuc2l2ZS55YXdhZGQpID09ICIzLXdheSIgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBpZiB3YXkgPT0gMCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy55YXdbMl0sIHVpLmdldChtZW51LmFudGlfYWltW3BsYXllcnN0YXRlXS5kZWZlbnNpdmUud2F5MSkpCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBpZiB3YXkgPT0gMSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy55YXdbMl0sIHVpLmdldChtZW51LmFudGlfYWltW3BsYXllcnN0YXRlXS5kZWZlbnNpdmUud2F5MikpCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBpZiB3YXkgPT0gMiB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy55YXdbMl0sIHVpLmdldChtZW51LmFudGlfYWltW3BsYXllcnN0YXRlXS5kZWZlbnNpdmUud2F5MykpCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVuZAoKCiAgICAgICAgICAgICAgICAgICAgaWYgdWkuZ2V0KG1lbnUuYW50aV9haW1bcGxheWVyc3RhdGVdLmRlZmVuc2l2ZS55YXdhZGQpID09ICI1LXdheSIgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBpZiB3YXkgPT0gMCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy55YXdbMl0sIHVpLmdldChtZW51LmFudGlfYWltW3BsYXllcnN0YXRlXS5kZWZlbnNpdmUud2F5MSkpCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBpZiB3YXkgPT0gMSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy55YXdbMl0sIHVpLmdldChtZW51LmFudGlfYWltW3BsYXllcnN0YXRlXS5kZWZlbnNpdmUud2F5MikpCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBpZiB3YXkgPT0gMiB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy55YXdbMl0sIHVpLmdldChtZW51LmFudGlfYWltW3BsYXllcnN0YXRlXS5kZWZlbnNpdmUud2F5MykpCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBpZiB3YXkgPT0gMyB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy55YXdbMl0sIHVpLmdldChtZW51LmFudGlfYWltW3BsYXllcnN0YXRlXS5kZWZlbnNpdmUud2F5NCkpCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBpZiB3YXkgPT0gNCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy55YXdbMl0sIHVpLmdldChtZW51LmFudGlfYWltW3BsYXllcnN0YXRlXS5kZWZlbnNpdmUud2F5NSkpCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLmJvZHlfeWF3WzFdLCB1aS5nZXQobWVudS5hbnRpX2FpbVtwbGF5ZXJzdGF0ZV0uZGVmZW5zaXZlLmJvZHl5YXcpKQogICAgICAgICAgICAgICAgICAgIGxvY2FsIGJ5YXcyCiAgICAgICAgICAgICAgICAgICAgaWYgc2lkZSA9PSAwIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgYnlhdzIgPSB1aS5nZXQobWVudS5hbnRpX2FpbVtwbGF5ZXJzdGF0ZV0uZGVmZW5zaXZlLmJvZHlpbnQpICogMQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGlmIHNpZGUgPT0gMSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGJ5YXcyID0gdWkuZ2V0KG1lbnUuYW50aV9haW1bcGxheWVyc3RhdGVdLmRlZmVuc2l2ZS5ib2R5aW50KSAqIC0xCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgaWYgdWkuZ2V0KG1lbnUuYW50aV9haW1bcGxheWVyc3RhdGVdLmRlZmVuc2l2ZS55YXdhZGQpID09ICJzbG93ZWQiIGFuZCB1aS5nZXQobWVudS5hbnRpX2FpbVtwbGF5ZXJzdGF0ZV0uZGVmZW5zaXZlLmJvZHl5YXcpID09ICJqaXR0ZXIiIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMuYm9keV95YXdbMV0sICJzdGF0aWMiKQoKICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMuYm9keV95YXdbMl0sIGJ5YXcyKQogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMuYm9keV95YXdbMl0sIHVpLmdldChtZW51LmFudGlfYWltW3BsYXllcnN0YXRlXS5kZWZlbnNpdmUuYm9keWludCkpCiAgICAgICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLmZyZWVzdGFuZGluZ19ib2R5X3lhdywgdWkuZ2V0KG1lbnUuYW50aV9haW1bcGxheWVyc3RhdGVdLmRlZmVuc2l2ZS5ib2R5ZnJlZSkpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICB9Cn0KCmxvY2FsIGZ1bmN0aW9uIGFpbV9taXNzKGUpCiAgICBsb2NhbCBncm91cCA9IGhpdGdyb3VwX25hbWVzW2UuaGl0Z3JvdXAgKyAxXSBvciAiPyIKCiAgICBsb2cuYWRkKHN0cmluZy5mb3JtYXQoCiAgICAgICAgIk1pc3NlZCAlcydzICVzIGR1ZSB0byAlcyIsCiAgICAgICAgZW50aXR5LmdldF9wbGF5ZXJfbmFtZShlLnRhcmdldCksIGdyb3VwLCBlLnJlYXNvbgogICAgKSwgMjU1LCAxMjUsIDEyNSwgMjU1KQplbmQKCmNsaWVudC5zZXRfZXZlbnRfY2FsbGJhY2soImFpbV9taXNzIiwgYWltX21pc3MpCmxvY2FsIGZ1bmN0aW9uIGFpbV9oaXQoZSkKICAgIGxvY2FsIGdyb3VwID0gaGl0Z3JvdXBfbmFtZXNbZS5oaXRncm91cCArIDFdIG9yICI/IgoKICAgIGxvZy5hZGQoc3RyaW5nLmZvcm1hdCgKICAgICAgICAiSGl0ICVzJ3MgaW4gdGhlICVzIGZvciAlZCBkYW1hZ2UgKCVkIGhlYWx0aCByZW1haW5pbmcpIiwKICAgICAgICBlbnRpdHkuZ2V0X3BsYXllcl9uYW1lKGUudGFyZ2V0KSwgZ3JvdXAsIGUuZGFtYWdlLAogICAgICAgIGVudGl0eS5nZXRfcHJvcChlLnRhcmdldCwgIm1faUhlYWx0aCIpCiAgICApLCAxNTAsIDIwMCwgNjAsIDI1NSkKZW5kCgpjbGllbnQuc2V0X2V2ZW50X2NhbGxiYWNrKCJhaW1faGl0IiwgYWltX2hpdCkKbG9jYWwgZnVuY3Rpb24gYWltX2ZpcmUoZSkKICAgIGxvY2FsIGdyb3VwID0gaGl0Z3JvdXBfbmFtZXNbZS5oaXRncm91cCArIDFdIG9yICI/IgogICAgbG9nLmFkZChzdHJpbmcuZm9ybWF0KAogICAgICAgICJGaXJlZCBhdCAlcydzICVzIGZvciAlZCBkbWcgKGhjPSVkJSUsIGJ0PSUyZCkiLAogICAgICAgIGVudGl0eS5nZXRfcGxheWVyX25hbWUoZS50YXJnZXQpLCBncm91cCwgZS5kYW1hZ2UsCiAgICAgICAgbWF0aC5mbG9vcihlLmhpdF9jaGFuY2UgKyAwLjUpLCBNYXRoLnRpbWVfdG9fdGlja3MoZS5iYWNrdHJhY2spCiAgICApLCAyNTUsIDI1NSwgMjU1LCAyNTUpCmVuZAoKY2xpZW50LnNldF9ldmVudF9jYWxsYmFjaygiYWltX2ZpcmUiLCBhaW1fZmlyZSkKY2xpZW50LnNldF9ldmVudF9jYWxsYmFjaygic2V0dXBfY29tbWFuZCIsIGZ1bmN0aW9uKGNtZCkKICAgIGZvciBrLCB2IGluIHBhaXJzKGNhbGxiYWNrcy5vbl9jcmVhdGVfbW92ZSkgZG8KICAgICAgICB2KGNtZCkKICAgIGVuZAplbmQpCgpjbGllbnQuc2V0X2V2ZW50X2NhbGxiYWNrKCJwYWludCIsIGZ1bmN0aW9uKCkKICAgIGZvciBrLCB2IGluIHBhaXJzKGNhbGxiYWNrcy5vbl9wYWludCkgZG8KICAgICAgICB2KCkKICAgIGVuZAplbmQpCgo="}