{"status":200,"content":"bG9jYWwgZmZpID0gcmVxdWlyZSgiZmZpIikKbG9jYWwgY19lbnRpdHkgPSByZXF1aXJlKCJnYW1lc2Vuc2UvZW50aXR5IikKbG9jYWwgcHVpID0gcmVxdWlyZSgiZ2FtZXNlbnNlL3B1aSIpCmxvY2FsIGh0dHAgPSByZXF1aXJlKCJnYW1lc2Vuc2UvaHR0cCIpCmxvY2FsIGJhc2U2NCA9IHJlcXVpcmUoImdhbWVzZW5zZS9iYXNlNjQiKQpsb2NhbCBjbGlwYm9hcmQgPSByZXF1aXJlKCJnYW1lc2Vuc2UvY2xpcGJvYXJkIikKbG9jYWwgd2Vic29ja2V0ID0gcmVxdWlyZSgiZ2FtZXNlbnNlL3dlYnNvY2tldHMiKQpsb2NhbCB2ZWN0b3IgPSByZXF1aXJlKCJ2ZWN0b3IiKQpsb2NhbCBjX2VudGl0eSA9IHJlcXVpcmUoJ2dhbWVzZW5zZS9lbnRpdHknKQpsb2NhbCBqc29uID0gcmVxdWlyZSgianNvbiIpCgoKICAgICAgICAgICAgICAgIGxvY2FsIHhfaW5kLCB5X2luZCA9IGNsaWVudC5zY3JlZW5fc2l6ZSgpCgogICAgICAgICAgICAgICAgbG9jYWwgbHVhX2dyb3VwID0gcHVpLmdyb3VwKCJhYSIsICJhbnRpLWFpbWJvdCBhbmdsZXMiKQogICAgICAgICAgICAgICAgbG9jYWwgY29uZmlnX2dyb3VwID0gcHVpLmdyb3VwKCJhYSIsICJGYWtlIGxhZyIpCiAgICAgICAgICAgICAgICBsb2NhbCBvdGhlcl9ncm91cCA9IHB1aS5ncm91cCgiYWEiLCAib3RoZXIiKQogICAgICAgICAgICAgICAgcHVpLmFjY2VudCA9ICI5RkNBMkJGRiIKCiAgICAgICAgICAgICAgICBsb2NhbCBhbnRpYWltX2NvbmQgPSB7ICdcdkdsb2JhbFxyJywgJ1x2U3RhbmRccicsICdcdldhbGtpbmdccicsICdcdlJ1bm5pbmdccicgLCAnXHZBaXJccicsICdcdkFpcitccicsICdcdkR1Y2tccicsICdcdkR1Y2srTW92ZVxyJyB9CiAgICAgICAgICAgICAgICBsb2NhbCBzaG9ydF9jb25kID0geyAnXHZHIMK3XHInLCAnXHZTIMK3XHInLCAnXHZXIMK3XHInLCAnXHZSIMK3XHInICwnXHZBIMK3XHInLCAnXHZBKyDCt1xyJywgJ1x2RCDCt1xyJywgJ1x2RCsgwrdccicgfQoKICAgICAgICAgICAgICAgIGxvY2FsIHJlZiA9IHsKICAgICAgICAgICAgICAgICAgICBlbmFibGVkID0gdWkucmVmZXJlbmNlKCdBQScsICdBbnRpLWFpbWJvdCBhbmdsZXMnLCAnRW5hYmxlZCcpLAogICAgICAgICAgICAgICAgICAgIHlhd2Jhc2UgPSB1aS5yZWZlcmVuY2UoJ0FBJywgJ0FudGktYWltYm90IGFuZ2xlcycsICdZYXcgYmFzZScpLAogICAgICAgICAgICAgICAgICAgIGZzYm9keXlhdyA9IHVpLnJlZmVyZW5jZSgnQUEnLCAnYW50aS1haW1ib3QgYW5nbGVzJywgJ0ZyZWVzdGFuZGluZyBib2R5IHlhdycpLAogICAgICAgICAgICAgICAgICAgIGVkZ2V5YXcgPSB1aS5yZWZlcmVuY2UoJ0FBJywgJ0FudGktYWltYm90IGFuZ2xlcycsICdFZGdlIHlhdycpLAogICAgICAgICAgICAgICAgICAgIGZha2VkdWNrID0gdWkucmVmZXJlbmNlKCdSQUdFJywgJ090aGVyJywgJ0R1Y2sgcGVlayBhc3Npc3QnKSwKICAgICAgICAgICAgICAgICAgICBmb3JjZWJhaW0gPSB1aS5yZWZlcmVuY2UoJ1JBR0UnLCAnQWltYm90JywgJ0ZvcmNlIGJvZHkgYWltJyksCiAgICAgICAgICAgICAgICAgICAgc2FmZXBvaW50ID0gdWkucmVmZXJlbmNlKCdSQUdFJywgJ0FpbWJvdCcsICdGb3JjZSBzYWZlIHBvaW50JyksCiAgICAgICAgICAgICAgICAgICAgcm9sbCA9IHsgdWkucmVmZXJlbmNlKCdBQScsICdBbnRpLWFpbWJvdCBhbmdsZXMnLCAnUm9sbCcpIH0sCiAgICAgICAgICAgICAgICAgICAgY2xhbnRhZyA9IHVpLnJlZmVyZW5jZSgnTWlzYycsICdNaXNjZWxsYW5lb3VzJywgJ0NsYW4gdGFnIHNwYW1tZXInKSwKCiAgICAgICAgICAgICAgICAgICAgcGl0Y2ggPSB7IHVpLnJlZmVyZW5jZSgnQUEnLCAnQW50aS1haW1ib3QgYW5nbGVzJywgJ3BpdGNoJyksIH0sCiAgICAgICAgICAgICAgICAgICAgcmFnZSA9IHsgdWkucmVmZXJlbmNlKCdSQUdFJywgJ0FpbWJvdCcsICdFbmFibGVkJykgfSwKICAgICAgICAgICAgICAgICAgICB5YXcgPSB7IHVpLnJlZmVyZW5jZSgnQUEnLCAnQW50aS1haW1ib3QgYW5nbGVzJywgJ1lhdycpIH0sIAogICAgICAgICAgICAgICAgICAgIHlhd2ppdHRlciA9IHsgdWkucmVmZXJlbmNlKCdBQScsICdBbnRpLWFpbWJvdCBhbmdsZXMnLCAnWWF3IGppdHRlcicpIH0sCiAgICAgICAgICAgICAgICAgICAgYm9keXlhdyA9IHsgdWkucmVmZXJlbmNlKCdBQScsICdBbnRpLWFpbWJvdCBhbmdsZXMnLCAnQm9keSB5YXcnKSB9LAogICAgICAgICAgICAgICAgICAgIGZyZWVzdGFuZCA9IHsgdWkucmVmZXJlbmNlKCdBQScsICdBbnRpLWFpbWJvdCBhbmdsZXMnLCAnRnJlZXN0YW5kaW5nJykgfSwKICAgICAgICAgICAgICAgICAgICBzbG93ID0geyB1aS5yZWZlcmVuY2UoJ0FBJywgJ090aGVyJywgJ1Nsb3cgbW90aW9uJykgfSwKICAgICAgICAgICAgICAgICAgICBvcyA9IHsgdWkucmVmZXJlbmNlKCdBQScsICdPdGhlcicsICdPbiBzaG90IGFudGktYWltJykgfSwKICAgICAgICAgICAgICAgICAgICBzbG93ID0geyB1aS5yZWZlcmVuY2UoJ0FBJywgJ090aGVyJywgJ1Nsb3cgbW90aW9uJykgfSwKICAgICAgICAgICAgICAgICAgICBkdCA9IHsgdWkucmVmZXJlbmNlKCdSQUdFJywgJ0FpbWJvdCcsICdEb3VibGUgdGFwJykgfSwKICAgICAgICAgICAgICAgICAgICBtaW5pbXVtX2RhbWFnZV9vdmVycmlkZSA9IHsgdWkucmVmZXJlbmNlKCJSQUdFIiwgIkFpbWJvdCIsICJNaW5pbXVtIGRhbWFnZSBvdmVycmlkZSIpIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBsb2NhbCBsdWFfbWVudSA9IHsKICAgICAgICAgICAgICAgICAgICBtYWluID0gewogICAgICAgICAgICAgICAgICAgICAgICBlbmFibGUgPSBsdWFfZ3JvdXA6bGFiZWwoImdlbmVzaXMiKSwKICAgICAgICAgICAgICAgICAgICAgICAgdGFiID0gbHVhX2dyb3VwOmNvbWJvYm94KCdcdlMgwrcgXHJDdXJyZW50IFRhYicsIHsiQW50aS1BaW0iLCAiVmlzdWFscyIsICJNaXNjIn0pLAogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgYW50aWFpbSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgdGFiID0gbHVhX2dyb3VwOmNvbWJvYm94KCJcdkdTIMK3IEFudGlBaW0gVGFiIiwgeyJNYWluIiwgIkJ1aWxkZXIifSksCiAgICAgICAgICAgICAgICAgICAgICAgIGFkZG9ucyA9IGx1YV9ncm91cDptdWx0aXNlbGVjdCgnXHZHUyDCtyBcckhlbHBlcnMnLCB7J1dhcm11cCBBbnRpfkFpbScsICdBbnRpfktuaWZlJywgJ1NhZmUgSGVhZCd9KSwKICAgICAgICAgICAgICAgICAgICAgICAgc2FmZV9oZWFkID0gbHVhX2dyb3VwOm11bHRpc2VsZWN0KCdcdkdTIMK3IFxyU2FmZSBIZWFkJywgeydBaXIrQyBLbmlmZScsICdBaXIrQyBaZXVzJywgJ0hpZ2ggRGlzdGFuY2UnfSksCiAgICAgICAgICAgICAgICAgICAgICAgIHlhd19kaXJlY3Rpb24gPSBsdWFfZ3JvdXA6bXVsdGlzZWxlY3QoJ1x2R1MgwrcgXHJZYXcgT3ZlcnJpZGUnLCB7J0ZyZWVzdGFuZGluZycsICdNYW51YWwnfSksCiAgICAgICAgICAgICAgICAgICAgICAgIGtleV9mcmVlc3RhbmQgPSBsdWFfZ3JvdXA6aG90a2V5KCdcdkdTIMK3IFxyRnJlZXN0YW5kaW5nJyksCiAgICAgICAgICAgICAgICAgICAgICAgIGtleV9sZWZ0ID0gbHVhX2dyb3VwOmhvdGtleSgnXHZHUyDCtyBcck1hbnVhbCBMZWZ0JyksCiAgICAgICAgICAgICAgICAgICAgICAgIGtleV9yaWdodCA9IGx1YV9ncm91cDpob3RrZXkoJ1x2R1MgwrcgXHJNYW51YWwgUmlnaHQnKSwKICAgICAgICAgICAgICAgICAgICAgICAga2V5X2ZvcndhcmQgPSBsdWFfZ3JvdXA6aG90a2V5KCdcdkdTIMK3IFxyTWFudWFsIEZvcndhcmQnKSwKICAgICAgICAgICAgICAgICAgICAgICAgeWF3X2Jhc2UgPSBsdWFfZ3JvdXA6Y29tYm9ib3goIlx2R1MgwrcgXHJZYXcgQmFzZSIsIHsiTG9jYWwgdmlldyIsICJBdCB0YXJnZXRzIn0pLAogICAgICAgICAgICAgICAgICAgICAgICBjb25kaXRpb24gPSBsdWFfZ3JvdXA6Y29tYm9ib3goJ1x2R1MgwrcgXHZDdXJyZW50IENvbmRpdGlvbicsIGFudGlhaW1fY29uZCksCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBtaXNjID0gewogICAgICAgICAgICAgICAgICAgICAgICBjcm9zc19pbmQgPSBsdWFfZ3JvdXA6Y2hlY2tib3goIlx2R1MgwrcgXHJDcm9zc2hhaXIgSW5kaWNhdG9ycyIsIHsyNTUsIDI1NSwgMjU1fSksCiAgICAgICAgICAgICAgICAgICAgICAgIGNyb3NzX2luZF90eXBlID0gbHVhX2dyb3VwOmNvbWJvYm94KCIgIFx2R1MgwrcgXHJJbmRpY2F0b3IgU3R5bGUiLCB7Ik5ld2VzdCIsICJEZWZhdWx0IiwgIk1vZGVybiIsICJBbHRlcm5hdGl2ZSJ9KSwKICAgICAgICAgICAgICAgICAgICAgICAgY3Jvc3NfY29sb3IgPSBsdWFfZ3JvdXA6Y2hlY2tib3goIiAgXHZHUyDCtyBcckluZGljYXRvciBDb2xvciIsIHsxMDAsIDEwMCwgMjU1fSksCiAgICAgICAgICAgICAgICAgICAgICAgIGtleV9jb2xvciA9IGx1YV9ncm91cDpjaGVja2JveCgiICBcdkdTIMK3IFxyS2V5YmluZHMgQ29sb3IiLCB7MjU1LCAyNTUsIDI1NX0pLAogICAgICAgICAgICAgICAgICAgICAgICBpbmZvX3BhbmVsID0gbHVhX2dyb3VwOmNoZWNrYm94KCJcdkdTIMK3IFxySW5mbyBQYW5lbCIpLAogICAgICAgICAgICAgICAgICAgICAgICBkZWZlbnNpdmVfd2luZG93ID0gbHVhX2dyb3VwOmNoZWNrYm94KCJcdkdTIMK3IFxyRGVmZW5zaXZlIFdpbmRvdyIsIHsyNTUsIDI1NSwgMjU1fSksCiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVuc2l2ZV9zdHlsZSA9IGx1YV9ncm91cDpjb21ib2JveCgiICBcdkdTIMK3IFxyRGVmZW5zaXZlIFN0eWxlIiwgeyJEZWZhdWx0IiwgIk1vZGVybiJ9KSwKICAgICAgICAgICAgICAgICAgICAgICAgdmVsb2NpdHlfd2luZG93ID0gbHVhX2dyb3VwOmNoZWNrYm94KCJcdkdTIMK3IFxyVmVsb2NpdHkgV2luZG93IiwgezI1NSwgMjU1LCAyNTV9KSwKICAgICAgICAgICAgICAgICAgICAgICAgdmVsb2NpdHlfc3R5bGUgPSBsdWFfZ3JvdXA6Y29tYm9ib3goIiAgXHZHUyDCtyBcckRlZmVuc2l2ZSBTdHlsZSIsIHsiRGVmYXVsdCIsICJNb2Rlcm4ifSksCiAgICAgICAgICAgICAgICAgICAgICAgIGZhc3RfbGFkZGVyID0gbHVhX2dyb3VwOmNoZWNrYm94KCJcdkdTIMK3IFxyRmFzdCBMYWRkZXIiKSwKICAgICAgICAgICAgICAgICAgICAgICAgbG9nID0gbHVhX2dyb3VwOmNoZWNrYm94KCJcdkdTIMK3IFxyUmFnZWJvdCBMb2dzIiksCiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ190eXBlID0gbHVhX2dyb3VwOm11bHRpc2VsZWN0KCIgIFx2R1MgwrcgXHJMb2cgVHlwZXMiLCB7IkNvbnNvbGUiLCAiU2NyZWVuIn0pLAogICAgICAgICAgICAgICAgICAgICAgICBzY3JlZW5fdHlwZSA9IGx1YV9ncm91cDpjb21ib2JveCgiICBcdkdTIMK3IFxyTG9nIFN0eWxlIiwgeyJEZWZhdWx0IiwgIk1vZGVybiJ9KSwKICAgICAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uID0gbHVhX2dyb3VwOmNoZWNrYm94KCJcdkdTIMK3IFxyQW5pbWF0aW9uIEJyZWFrZXJzIiksCiAgICAgICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbl9ncm91bmQgPSBsdWFfZ3JvdXA6Y29tYm9ib3goIiAgXHZHUyDCtyBcckdyb3VuZCIsIHsiU3RhdGljIiwgIkppdHRlciIsICJSYW5kb21pemUifSksCiAgICAgICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbl92YWx1ZSA9IGx1YV9ncm91cDpzbGlkZXIoIiAgXHZHUyDCtyBcclZhbHVlIiwgMCwgMTAsIDUpLAogICAgICAgICAgICAgICAgICAgICAgICBhbmltYXRpb25fYWlyID0gbHVhX2dyb3VwOmNvbWJvYm94KCIgIFx2R1MgwrcgXHJBaXIiLCB7Ik9mZiIsICJTdGF0aWMiLCAiUmFuZG9taXplIn0pLAogICAgICAgICAgICAgICAgICAgICAgICB0aGlyZF9wZXJzb24gPSBsdWFfZ3JvdXA6Y2hlY2tib3goIlx2R1MgwrcgXHJUaGlyZCBQZXJzb24gRGlzdGFuY2UiKSwKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcmRfcGVyc29uX3ZhbHVlID0gbHVhX2dyb3VwOnNsaWRlcigiICBcdkdTIMK3IFxyIFRoaXJkIFBlcnNvbiBEaXN0YW5jZSBWYWx1ZSIsIDMwLCAyMDAsIDUwKSwKICAgICAgICAgICAgICAgICAgICAgICAgYXNwZWN0cmF0aW8gPSBsdWFfZ3JvdXA6Y2hlY2tib3goIlx2R1MgwrcgXHJBc3BlY3QgUmF0aW8iKSwKICAgICAgICAgICAgICAgICAgICAgICAgYXNwZWN0cmF0aW9fdmFsdWUgPSBsdWFfZ3JvdXA6c2xpZGVyKCIgIFx2R1MgwrcgXHIgQXNwZWN0IFJhdGlvIFZhbHVlIiwgMDAsIDIwMCwgMTMzKSwKICAgICAgICAgICAgICAgICAgICAgICAgdGVsZXBvcnQgPSBsdWFfZ3JvdXA6Y2hlY2tib3goIlx2R1MgwrcgXHJCcmVhayBMQyBUZWxlcG9ydCIpLAogICAgICAgICAgICAgICAgICAgICAgICB0ZWxlcG9ydF9rZXkgPSBsdWFfZ3JvdXA6aG90a2V5KCJcdkdTIMK3IFxyQnJlYWsgTEMgVGVsZXBvcnQiLCB0cnVlKSwKICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZXIgPSBsdWFfZ3JvdXA6Y2hlY2tib3goIlx2R1MgwrcgQ3VzdG9tIFJlc29sdmVyIiksCiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmVyX3R5cGUgPSBsdWFfZ3JvdXA6Y29tYm9ib3goIiAgXHZHUyDCtyBcciBSZXNvbHZlciBUeXBlIiwgeyJTYWZlIiwgIkV4cGVyaW1lbnRhbCIsICJEZWZlbnNpdmUifSksCiAgICAgICAgICAgICAgICAgICAgICAgIHNwYW1tZXJzID0gbHVhX2dyb3VwOm11bHRpc2VsZWN0KCJcdkdTIMK3IFxyIFNwYW1tZXJzIiwgeyJDbGFudGFnIiwgIlRyYXNoVGFsayJ9KSwKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGxvY2FsIGFudGlhaW1fc3lzdGVtID0ge30KCiAgICAgICAgICAgICAgICBmb3IgaT0xLCAjYW50aWFpbV9jb25kIGRvCiAgICAgICAgICAgICAgICAgICAgYW50aWFpbV9zeXN0ZW1baV0gPSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsID0gbHVhX2dyb3VwOmxhYmVsKCcgwrcgQ29uZGl0aW9uYWwgXHZCdWlsZGVyXHIgU2V0dXAgfiAnKSwKICAgICAgICAgICAgICAgICAgICAgICAgZW5hYmxlID0gbHVhX2dyb3VwOmNoZWNrYm94KCdFbmFibGUgwrcgJy4uYW50aWFpbV9jb25kW2ldKSwKICAgICAgICAgICAgICAgICAgICAgICAgeWF3X3R5cGUgPSBsdWFfZ3JvdXA6Y29tYm9ib3goc2hvcnRfY29uZFtpXS4uJyBZYXcgVHlwZScsIHsiRGVmYXVsdCIsICJEZWxheSJ9KSwKICAgICAgICAgICAgICAgICAgICAgICAgeWF3X2RlbGF5ID0gbHVhX2dyb3VwOnNsaWRlcihzaG9ydF9jb25kW2ldLi4nIERlbGF5IFRpY2tzJywgMSwgMTAsIDQsIHRydWUsICd0JywgMSksCiAgICAgICAgICAgICAgICAgICAgICAgIHlhd19sZWZ0ID0gbHVhX2dyb3VwOnNsaWRlcihzaG9ydF9jb25kW2ldLi4nIFlhdyBMZWZ0JywgLTE4MCwgMTgwLCAwLCB0cnVlLCAnwrAnLCAxKSwKICAgICAgICAgICAgICAgICAgICAgICAgeWF3X3JpZ2h0ID0gbHVhX2dyb3VwOnNsaWRlcihzaG9ydF9jb25kW2ldLi4nIFlhdyBSaWdodCcsIC0xODAsIDE4MCwgMCwgdHJ1ZSwgJ8KwJywgMSksCiAgICAgICAgICAgICAgICAgICAgICAgIHlhd19yYW5kb20gPSBsdWFfZ3JvdXA6c2xpZGVyKHNob3J0X2NvbmRbaV0uLicgUmFuZG9taXphdGlvbicsIDAsIDEwMCwgMCwgdHJ1ZSwgJyUnLCAxKSwKICAgICAgICAgICAgICAgICAgICAgICAgbW9kX3R5cGUgPSBsdWFfZ3JvdXA6Y29tYm9ib3goc2hvcnRfY29uZFtpXS4uJyBKaXR0ZXIgVHlwZScsIHsnT2ZmJywgJ09mZnNldCcsICdDZW50ZXInLCAnUmFuZG9tJywgJ1NraXR0ZXInfSksCiAgICAgICAgICAgICAgICAgICAgICAgIG1vZF9kbSA9IGx1YV9ncm91cDpzbGlkZXIoc2hvcnRfY29uZFtpXS4uJyBKaXR0ZXIgQW1vdW50JywgLTE4MCwgMTgwLCAwLCB0cnVlLCAnwrAnLCAxKSwKICAgICAgICAgICAgICAgICAgICAgICAgYm9keV95YXdfdHlwZSA9IGx1YV9ncm91cDpjb21ib2JveChzaG9ydF9jb25kW2ldLi4nIEJvZHkgWWF3JywgeydPZmYnLCAnT3Bwb3NpdGUnLCAnSml0dGVyJywgJ1N0YXRpYyd9KSwKICAgICAgICAgICAgICAgICAgICAgICAgYm9keV9zbGlkZXIgPSBsdWFfZ3JvdXA6c2xpZGVyKHNob3J0X2NvbmRbaV0uLicgQm9keSBZYXcgQW1vdW50JywgLTE4MCwgMTgwLCAwLCB0cnVlLCAnwrAnLCAxKSwKICAgICAgICAgICAgICAgICAgICAgICAgZm9yY2VfZGVmID0gbHVhX2dyb3VwOmNoZWNrYm94KHNob3J0X2NvbmRbaV0uLicgRm9yY2UgRGVmZW5zaXZlJyksCiAgICAgICAgICAgICAgICAgICAgICAgIHBlZWtfZGVmID0gbHVhX2dyb3VwOmNoZWNrYm94KHNob3J0X2NvbmRbaV0uLicgXHZEZWZlbnNpdmUgUGVlaycpLAogICAgICAgICAgICAgICAgICAgICAgICBkZWZlbnNpdmUgPSBsdWFfZ3JvdXA6Y2hlY2tib3goc2hvcnRfY29uZFtpXS4uJyBEZWZlbnNpdmUgQW50aX5BaW0nKSwKICAgICAgICAgICAgICAgICAgICAgICAgZGVmZW5zaXZlX3R5cGUgPSBsdWFfZ3JvdXA6Y29tYm9ib3goc2hvcnRfY29uZFtpXS4uJyBEZWZlbnNpdmUgVHlwZScsIHsnRGVmYXVsdCcsICdCdWlsZGVyJ30pLAoKICAgICAgICAgICAgICAgICAgICAgICAgZGVmZW5zaXZlX3lhdyA9IGx1YV9ncm91cDpjb21ib2JveChzaG9ydF9jb25kW2ldLi4nIERlZmVuc2l2ZSBZYXcnLCB7J09mZicsICdTcGluJywgJ01ldGF+V2F5cycsICdSYW5kb20nfSksCgogICAgICAgICAgICAgICAgICAgICAgICB5YXdfdmFsdWUgPSBsdWFfZ3JvdXA6c2xpZGVyKHNob3J0X2NvbmRbaV0uLicgWWF3IFZhbHVlJywgLTE4MCwgMTgwLCAwLCB0cnVlLCAnwrAnLCAxKSwKICAgICAgICAgICAgICAgICAgICAgICAgZGVmX3lhd192YWx1ZSA9IGx1YV9ncm91cDpzbGlkZXIoc2hvcnRfY29uZFtpXS4uJyBbREVGXSBZYXcgVmFsdWUnLCAtMTgwLCAxODAsIDAsIHRydWUsICfCsCcsIDEpLAogICAgICAgICAgICAgICAgICAgICAgICBkZWZfbW9kX3R5cGUgPSBsdWFfZ3JvdXA6Y29tYm9ib3goc2hvcnRfY29uZFtpXS4uJyBbREVGXSBKaXR0ZXIgVHlwZScsIHsnT2ZmJywgJ09mZnNldCcsICdDZW50ZXInLCAnUmFuZG9tJywgJ1NraXR0ZXInfSksCiAgICAgICAgICAgICAgICAgICAgICAgIGRlZl9tb2RfZG0gPSBsdWFfZ3JvdXA6c2xpZGVyKHNob3J0X2NvbmRbaV0uLicgW0RFRl0gSml0dGVyIEFtb3VudCcsIC0xODAsIDE4MCwgMCwgdHJ1ZSwgJ8KwJywgMSksCiAgICAgICAgICAgICAgICAgICAgICAgIGRlZl9ib2R5X3lhd190eXBlID0gbHVhX2dyb3VwOmNvbWJvYm94KHNob3J0X2NvbmRbaV0uLicgW0RFRl0gQm9keSBZYXcnLCB7J09mZicsICdPcHBvc2l0ZScsICdKaXR0ZXInLCAnU3RhdGljJ30pLAogICAgICAgICAgICAgICAgICAgICAgICBkZWZfYm9keV9zbGlkZXIgPSBsdWFfZ3JvdXA6c2xpZGVyKHNob3J0X2NvbmRbaV0uLicgW0RFRl0gQm9keSBZYXcgQW1vdW50JywgLTE4MCwgMTgwLCAwLCB0cnVlLCAnwrAnLCAxKSwKCiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVuc2l2ZV9waXRjaCA9IGx1YV9ncm91cDpjb21ib2JveChzaG9ydF9jb25kW2ldLi4nIERlZmVuc2l2ZSBQaXRjaCcsIHsnT2ZmJywgJ0N1c3RvbScsICdNZXRhfldheXMnLCAnUmFuZG9tJ30pLAogICAgICAgICAgICAgICAgICAgICAgICBwaXRjaF92YWx1ZSA9IGx1YV9ncm91cDpzbGlkZXIoc2hvcnRfY29uZFtpXS4uJyBQaXRjaCBWYWx1ZScsIC04OSwgODksIDAsIHRydWUsICfCsCcsIDEpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgbG9jYWwgYWFfdGFiID0ge2x1YV9tZW51Lm1haW4udGFiLCAiQW50aS1BaW0ifQogICAgICAgICAgICAgICAgbG9jYWwgbWlzY190YWIgPSB7bHVhX21lbnUubWFpbi50YWIsICJNaXNjIn0KICAgICAgICAgICAgICAgIGxvY2FsIHZpc3VhbF90YWIgPSB7bHVhX21lbnUubWFpbi50YWIsICJWaXN1YWxzIn0KICAgICAgICAgICAgICAgIGxvY2FsIGFhX2J1aWxkZXIgPSB7bHVhX21lbnUuYW50aWFpbS50YWIsICJCdWlsZGVyIn0KICAgICAgICAgICAgICAgIGxvY2FsIGFhX21haW4gPSB7bHVhX21lbnUuYW50aWFpbS50YWIsICJNYWluIn0KCiAgICAgICAgICAgICAgICBsdWFfbWVudS5hbnRpYWltLnRhYjpkZXBlbmQoYWFfdGFiKQogICAgICAgICAgICAgICAgbHVhX21lbnUuYW50aWFpbS5hZGRvbnM6ZGVwZW5kKGFhX3RhYiwgYWFfbWFpbikKICAgICAgICAgICAgICAgIGx1YV9tZW51LmFudGlhaW0uc2FmZV9oZWFkOmRlcGVuZChhYV90YWIsIHtsdWFfbWVudS5hbnRpYWltLmFkZG9ucywgIlNhZmUgSGVhZCJ9LCBhYV9tYWluKQogICAgICAgICAgICAgICAgbHVhX21lbnUuYW50aWFpbS55YXdfYmFzZTpkZXBlbmQoYWFfdGFiLCBhYV9tYWluKQogICAgICAgICAgICAgICAgbHVhX21lbnUuYW50aWFpbS5jb25kaXRpb246ZGVwZW5kKGFhX3RhYiwgYWFfYnVpbGRlcikKICAgICAgICAgICAgICAgIGx1YV9tZW51LmFudGlhaW0ueWF3X2RpcmVjdGlvbjpkZXBlbmQoYWFfdGFiLCBhYV9tYWluKQogICAgICAgICAgICAgICAgbHVhX21lbnUuYW50aWFpbS5rZXlfZnJlZXN0YW5kOmRlcGVuZChhYV90YWIsIHtsdWFfbWVudS5hbnRpYWltLnlhd19kaXJlY3Rpb24sICJGcmVlc3RhbmRpbmcifSwgYWFfbWFpbikKICAgICAgICAgICAgICAgIGx1YV9tZW51LmFudGlhaW0ua2V5X2xlZnQ6ZGVwZW5kKGFhX3RhYiwge2x1YV9tZW51LmFudGlhaW0ueWF3X2RpcmVjdGlvbiwgIk1hbnVhbCJ9LCBhYV9tYWluKQogICAgICAgICAgICAgICAgbHVhX21lbnUuYW50aWFpbS5rZXlfcmlnaHQ6ZGVwZW5kKGFhX3RhYiwge2x1YV9tZW51LmFudGlhaW0ueWF3X2RpcmVjdGlvbiwgIk1hbnVhbCJ9LCBhYV9tYWluKQogICAgICAgICAgICAgICAgbHVhX21lbnUuYW50aWFpbS5rZXlfZm9yd2FyZDpkZXBlbmQoYWFfdGFiLCB7bHVhX21lbnUuYW50aWFpbS55YXdfZGlyZWN0aW9uLCAiTWFudWFsIn0sIGFhX21haW4pCiAgICAgICAgICAgICAgICBsdWFfbWVudS5taXNjLmNyb3NzX2luZDpkZXBlbmQodmlzdWFsX3RhYikKICAgICAgICAgICAgICAgIGx1YV9tZW51Lm1pc2MuY3Jvc3NfaW5kX3R5cGU6ZGVwZW5kKHZpc3VhbF90YWIsIHtsdWFfbWVudS5taXNjLmNyb3NzX2luZCwgdHJ1ZX0pCiAgICAgICAgICAgICAgICBsdWFfbWVudS5taXNjLmluZm9fcGFuZWw6ZGVwZW5kKHZpc3VhbF90YWIpCiAgICAgICAgICAgICAgICBsdWFfbWVudS5taXNjLmRlZmVuc2l2ZV93aW5kb3c6ZGVwZW5kKHZpc3VhbF90YWIpCiAgICAgICAgICAgICAgICBsdWFfbWVudS5taXNjLmRlZmVuc2l2ZV9zdHlsZTpkZXBlbmQodmlzdWFsX3RhYiwge2x1YV9tZW51Lm1pc2MuZGVmZW5zaXZlX3dpbmRvdywgdHJ1ZX0pCiAgICAgICAgICAgICAgICBsdWFfbWVudS5taXNjLnZlbG9jaXR5X3dpbmRvdzpkZXBlbmQodmlzdWFsX3RhYikKICAgICAgICAgICAgICAgIGx1YV9tZW51Lm1pc2MudmVsb2NpdHlfc3R5bGU6ZGVwZW5kKHZpc3VhbF90YWIsIHtsdWFfbWVudS5taXNjLnZlbG9jaXR5X3dpbmRvdywgdHJ1ZX0pCiAgICAgICAgICAgICAgICBsdWFfbWVudS5taXNjLmNyb3NzX2NvbG9yOmRlcGVuZCh2aXN1YWxfdGFiLCB7bHVhX21lbnUubWlzYy5jcm9zc19pbmQsIHRydWV9KQogICAgICAgICAgICAgICAgbHVhX21lbnUubWlzYy5rZXlfY29sb3I6ZGVwZW5kKHZpc3VhbF90YWIsIHtsdWFfbWVudS5taXNjLmNyb3NzX2luZCwgdHJ1ZX0pCiAgICAgICAgICAgICAgICBsdWFfbWVudS5taXNjLmxvZzpkZXBlbmQodmlzdWFsX3RhYikKICAgICAgICAgICAgICAgIGx1YV9tZW51Lm1pc2MubG9nX3R5cGU6ZGVwZW5kKHZpc3VhbF90YWIsIHtsdWFfbWVudS5taXNjLmxvZywgdHJ1ZX0pCiAgICAgICAgICAgICAgICBsdWFfbWVudS5taXNjLnNjcmVlbl90eXBlOmRlcGVuZCh2aXN1YWxfdGFiLCB7bHVhX21lbnUubWlzYy5sb2csIHRydWV9LCB7bHVhX21lbnUubWlzYy5sb2dfdHlwZSwgIlNjcmVlbiJ9KQogICAgICAgICAgICAgICAgbHVhX21lbnUubWlzYy5mYXN0X2xhZGRlcjpkZXBlbmQobWlzY190YWIpCiAgICAgICAgICAgICAgICBsdWFfbWVudS5taXNjLmFuaW1hdGlvbjpkZXBlbmQobWlzY190YWIpCiAgICAgICAgICAgICAgICBsdWFfbWVudS5taXNjLmFuaW1hdGlvbl9ncm91bmQ6ZGVwZW5kKG1pc2NfdGFiLCB7bHVhX21lbnUubWlzYy5hbmltYXRpb24sIHRydWV9KQogICAgICAgICAgICAgICAgbHVhX21lbnUubWlzYy5hbmltYXRpb25fdmFsdWU6ZGVwZW5kKG1pc2NfdGFiLCB7bHVhX21lbnUubWlzYy5hbmltYXRpb24sIHRydWV9KQogICAgICAgICAgICAgICAgbHVhX21lbnUubWlzYy5hbmltYXRpb25fYWlyOmRlcGVuZChtaXNjX3RhYiwge2x1YV9tZW51Lm1pc2MuYW5pbWF0aW9uLCB0cnVlfSkKICAgICAgICAgICAgICAgIGx1YV9tZW51Lm1pc2MudGhpcmRfcGVyc29uOmRlcGVuZChtaXNjX3RhYikKICAgICAgICAgICAgICAgIGx1YV9tZW51Lm1pc2MudGhpcmRfcGVyc29uX3ZhbHVlOmRlcGVuZChtaXNjX3RhYiwge2x1YV9tZW51Lm1pc2MudGhpcmRfcGVyc29uLCB0cnVlfSkKICAgICAgICAgICAgICAgIGx1YV9tZW51Lm1pc2MuYXNwZWN0cmF0aW86ZGVwZW5kKG1pc2NfdGFiKQogICAgICAgICAgICAgICAgbHVhX21lbnUubWlzYy5hc3BlY3RyYXRpb192YWx1ZTpkZXBlbmQobWlzY190YWIsIHtsdWFfbWVudS5taXNjLmFzcGVjdHJhdGlvLCB0cnVlfSkKICAgICAgICAgICAgICAgIGx1YV9tZW51Lm1pc2MudGVsZXBvcnQ6ZGVwZW5kKG1pc2NfdGFiKQogICAgICAgICAgICAgICAgbHVhX21lbnUubWlzYy50ZWxlcG9ydF9rZXk6ZGVwZW5kKG1pc2NfdGFiKQogICAgICAgICAgICAgICAgbHVhX21lbnUubWlzYy5yZXNvbHZlcjpkZXBlbmQobWlzY190YWIpCiAgICAgICAgICAgICAgICBsdWFfbWVudS5taXNjLnJlc29sdmVyX3R5cGU6ZGVwZW5kKG1pc2NfdGFiLCB7bHVhX21lbnUubWlzYy5yZXNvbHZlciwgdHJ1ZX0pCiAgICAgICAgICAgICAgICBsdWFfbWVudS5taXNjLnNwYW1tZXJzOmRlcGVuZChtaXNjX3RhYikKCiAgICAgICAgICAgICAgICBmb3IgaT0xLCAjYW50aWFpbV9jb25kIGRvCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgY29uZF9jaGVjayA9IHtsdWFfbWVudS5hbnRpYWltLmNvbmRpdGlvbiwgZnVuY3Rpb24oKSByZXR1cm4gKGkgfj0gMSkgZW5kfQogICAgICAgICAgICAgICAgICAgIGxvY2FsIHRhYl9jb25kID0ge2x1YV9tZW51LmFudGlhaW0uY29uZGl0aW9uLCBhbnRpYWltX2NvbmRbaV19CiAgICAgICAgICAgICAgICAgICAgbG9jYWwgY25kX2VuID0ge2FudGlhaW1fc3lzdGVtW2ldLmVuYWJsZSwgZnVuY3Rpb24oKSBpZiAoaSA9PSAxKSB0aGVuIHJldHVybiB0cnVlIGVsc2UgcmV0dXJuIGFudGlhaW1fc3lzdGVtW2ldLmVuYWJsZTpnZXQoKSBlbmQgZW5kfQogICAgICAgICAgICAgICAgICAgIGxvY2FsIGFhX3RhYiA9IHtsdWFfbWVudS5tYWluLnRhYiwgIkFudGktQWltIn0KICAgICAgICAgICAgICAgICAgICBsb2NhbCBqaXRfY2ggPSB7YW50aWFpbV9zeXN0ZW1baV0ubW9kX3R5cGUsIGZ1bmN0aW9uKCkgcmV0dXJuIGFudGlhaW1fc3lzdGVtW2ldLm1vZF90eXBlOmdldCgpIH49ICJPZmYiIGVuZH0KICAgICAgICAgICAgICAgICAgICBsb2NhbCBkZWZfaml0X2NoID0ge2FudGlhaW1fc3lzdGVtW2ldLmRlZl9tb2RfdHlwZSwgZnVuY3Rpb24oKSByZXR1cm4gYW50aWFpbV9zeXN0ZW1baV0uZGVmX21vZF90eXBlOmdldCgpIH49ICJPZmYiIGVuZH0KICAgICAgICAgICAgICAgICAgICBsb2NhbCBkZWZfY2ggPSB7YW50aWFpbV9zeXN0ZW1baV0uZGVmZW5zaXZlLCB0cnVlfQogICAgICAgICAgICAgICAgICAgIGxvY2FsIGJvZHlfY2ggPSB7YW50aWFpbV9zeXN0ZW1baV0uYm9keV95YXdfdHlwZSwgZnVuY3Rpb24oKSByZXR1cm4gYW50aWFpbV9zeXN0ZW1baV0uYm9keV95YXdfdHlwZTpnZXQoKSB+PSAiT2ZmIiBlbmR9CiAgICAgICAgICAgICAgICAgICAgbG9jYWwgZGVmX2JvZHlfY2ggPSB7YW50aWFpbV9zeXN0ZW1baV0uZGVmX2JvZHlfeWF3X3R5cGUsIGZ1bmN0aW9uKCkgcmV0dXJuIGFudGlhaW1fc3lzdGVtW2ldLmRlZl9ib2R5X3lhd190eXBlOmdldCgpIH49ICJPZmYiIGVuZH0KICAgICAgICAgICAgICAgICAgICBsb2NhbCBkZWxheV9jaCA9IHthbnRpYWltX3N5c3RlbVtpXS55YXdfdHlwZSwgIkRlbGF5In0KICAgICAgICAgICAgICAgICAgICBsb2NhbCB5YXdfY2ggPSB7YW50aWFpbV9zeXN0ZW1baV0uZGVmZW5zaXZlX3lhdywgIlNwaW4ifQogICAgICAgICAgICAgICAgICAgIGxvY2FsIGRlZl95YXdfY2ggPSB7YW50aWFpbV9zeXN0ZW1baV0uZGVmZW5zaXZlX3R5cGUsICJCdWlsZGVyIn0KCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgZGVmX2RlZiA9IHthbnRpYWltX3N5c3RlbVtpXS5kZWZlbnNpdmVfdHlwZSwgIkRlZmF1bHQifQogICAgICAgICAgICAgICAgICAgIGxvY2FsIGRlZl9idWlsZCA9IHthbnRpYWltX3N5c3RlbVtpXS5kZWZlbnNpdmVfdHlwZSwgIkJ1aWxkZXIifQogICAgICAgICAgICAgICAgICAgIGxvY2FsIHBpdGNoX2NoID0ge2FudGlhaW1fc3lzdGVtW2ldLmRlZmVuc2l2ZV9waXRjaCwgIkN1c3RvbSJ9CiAgICAgICAgICAgICAgICAgICAgYW50aWFpbV9zeXN0ZW1baV0ubGFiZWw6ZGVwZW5kKHRhYl9jb25kLCBhYV90YWIsIGFhX2J1aWxkZXIpCiAgICAgICAgICAgICAgICAgICAgYW50aWFpbV9zeXN0ZW1baV0uZW5hYmxlOmRlcGVuZChjb25kX2NoZWNrLCB0YWJfY29uZCwgYWFfdGFiLCBhYV9idWlsZGVyKQogICAgICAgICAgICAgICAgICAgIGFudGlhaW1fc3lzdGVtW2ldLnlhd190eXBlOmRlcGVuZChjbmRfZW4sIHRhYl9jb25kLCBhYV90YWIsIGFhX2J1aWxkZXIpCiAgICAgICAgICAgICAgICAgICAgYW50aWFpbV9zeXN0ZW1baV0ueWF3X2RlbGF5OmRlcGVuZChjbmRfZW4sIHRhYl9jb25kLCBhYV90YWIsIGRlbGF5X2NoLCBhYV9idWlsZGVyKQogICAgICAgICAgICAgICAgICAgIGFudGlhaW1fc3lzdGVtW2ldLnlhd19sZWZ0OmRlcGVuZChjbmRfZW4sIHRhYl9jb25kLCBhYV90YWIsIGFhX2J1aWxkZXIpCiAgICAgICAgICAgICAgICAgICAgYW50aWFpbV9zeXN0ZW1baV0ueWF3X3JpZ2h0OmRlcGVuZChjbmRfZW4sIHRhYl9jb25kLCBhYV90YWIsIGFhX2J1aWxkZXIpCiAgICAgICAgICAgICAgICAgICAgYW50aWFpbV9zeXN0ZW1baV0ueWF3X3JhbmRvbTpkZXBlbmQoY25kX2VuLCB0YWJfY29uZCwgYWFfdGFiLCBhYV9idWlsZGVyKQogICAgICAgICAgICAgICAgICAgIGFudGlhaW1fc3lzdGVtW2ldLm1vZF90eXBlOmRlcGVuZChjbmRfZW4sIHRhYl9jb25kLCBhYV90YWIsIGFhX2J1aWxkZXIpCgogICAgICAgICAgICAgICAgICAgIGFudGlhaW1fc3lzdGVtW2ldLm1vZF9kbTpkZXBlbmQoY25kX2VuLCB0YWJfY29uZCwgYWFfdGFiLCBqaXRfY2gsIGFhX2J1aWxkZXIpCiAgICAgICAgICAgICAgICAgICAgYW50aWFpbV9zeXN0ZW1baV0uYm9keV95YXdfdHlwZTpkZXBlbmQoY25kX2VuLCB0YWJfY29uZCwgYWFfdGFiLCBhYV9idWlsZGVyKQogICAgICAgICAgICAgICAgICAgIGFudGlhaW1fc3lzdGVtW2ldLmJvZHlfc2xpZGVyOmRlcGVuZChjbmRfZW4sIHRhYl9jb25kLCBhYV90YWIsIGJvZHlfY2gsIGFhX2J1aWxkZXIpCgogICAgICAgICAgICAgICAgICAgIGFudGlhaW1fc3lzdGVtW2ldLmZvcmNlX2RlZjpkZXBlbmQoY25kX2VuLCB0YWJfY29uZCwgYWFfdGFiLCBhYV9idWlsZGVyKQogICAgICAgICAgICAgICAgICAgIGFudGlhaW1fc3lzdGVtW2ldLnBlZWtfZGVmOmRlcGVuZChjbmRfZW4sIHRhYl9jb25kLCBhYV90YWIsIHthbnRpYWltX3N5c3RlbVtpXS5mb3JjZV9kZWYsIGZhbHNlfSwgYWFfYnVpbGRlcikKICAgICAgICAgICAgICAgICAgICBhbnRpYWltX3N5c3RlbVtpXS5kZWZlbnNpdmU6ZGVwZW5kKGNuZF9lbiwgdGFiX2NvbmQsIGFhX3RhYiwgYWFfYnVpbGRlcikKICAgICAgICAgICAgICAgICAgICBhbnRpYWltX3N5c3RlbVtpXS5kZWZlbnNpdmVfdHlwZTpkZXBlbmQoY25kX2VuLCB0YWJfY29uZCwgYWFfdGFiLCBkZWZfY2gsIGFhX2J1aWxkZXIpCiAgICAgICAgICAgICAgICAgICAgYW50aWFpbV9zeXN0ZW1baV0uZGVmZW5zaXZlX3lhdzpkZXBlbmQoY25kX2VuLCB0YWJfY29uZCwgYWFfdGFiLCBkZWZfY2gsIGRlZl9kZWYsIGFhX2J1aWxkZXIpCiAgICAgICAgICAgICAgICAgICAgYW50aWFpbV9zeXN0ZW1baV0uZGVmX3lhd192YWx1ZTpkZXBlbmQoY25kX2VuLCB0YWJfY29uZCwgYWFfdGFiLCBkZWZfY2gsIGRlZl95YXdfY2gsIGFhX2J1aWxkZXIpCiAgICAgICAgICAgICAgICAgICAgYW50aWFpbV9zeXN0ZW1baV0ueWF3X3ZhbHVlOmRlcGVuZChjbmRfZW4sIHRhYl9jb25kLCBhYV90YWIsIGRlZl9jaCwgeWF3X2NoLCBkZWZfZGVmLCBhYV9idWlsZGVyKQogICAgICAgICAgICAgICAgICAgIGFudGlhaW1fc3lzdGVtW2ldLmRlZl9tb2RfdHlwZTpkZXBlbmQoY25kX2VuLCB0YWJfY29uZCwgYWFfdGFiLCBkZWZfY2gsIGRlZl9idWlsZCwgYWFfYnVpbGRlcikKICAgICAgICAgICAgICAgICAgICBhbnRpYWltX3N5c3RlbVtpXS5kZWZfbW9kX2RtOmRlcGVuZChjbmRfZW4sIHRhYl9jb25kLCBhYV90YWIsIGRlZl9jaCwgZGVmX2J1aWxkLCBkZWZfaml0X2NoLCBhYV9idWlsZGVyKQogICAgICAgICAgICAgICAgICAgIGFudGlhaW1fc3lzdGVtW2ldLmRlZl9ib2R5X3lhd190eXBlOmRlcGVuZChjbmRfZW4sIHRhYl9jb25kLCBhYV90YWIsIGRlZl9jaCwgZGVmX2J1aWxkLCBhYV9idWlsZGVyKQogICAgICAgICAgICAgICAgICAgIGFudGlhaW1fc3lzdGVtW2ldLmRlZl9ib2R5X3NsaWRlcjpkZXBlbmQoY25kX2VuLCB0YWJfY29uZCwgYWFfdGFiLCBkZWZfY2gsIGRlZl9idWlsZCwgZGVmX2JvZHlfY2gsIGFhX2J1aWxkZXIpCiAgICAgICAgICAgICAgICAgICAgYW50aWFpbV9zeXN0ZW1baV0uZGVmZW5zaXZlX3BpdGNoOmRlcGVuZChjbmRfZW4sIHRhYl9jb25kLCBhYV90YWIsIGRlZl9jaCwgYWFfYnVpbGRlcikKICAgICAgICAgICAgICAgICAgICBhbnRpYWltX3N5c3RlbVtpXS5waXRjaF92YWx1ZTpkZXBlbmQoY25kX2VuLCB0YWJfY29uZCwgYWFfdGFiLCBkZWZfY2gsIHBpdGNoX2NoLCBhYV9idWlsZGVyKQogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgbG9jYWwgZnVuY3Rpb24gaGlkZV9vcmlnaW5hbF9tZW51KHN0YXRlKQogICAgICAgICAgICAgICAgICAgIHVpLnNldF92aXNpYmxlKHJlZi5lbmFibGVkLCBzdGF0ZSkKICAgICAgICAgICAgICAgICAgICB1aS5zZXRfdmlzaWJsZShyZWYucGl0Y2hbMV0sIHN0YXRlKQogICAgICAgICAgICAgICAgICAgIHVpLnNldF92aXNpYmxlKHJlZi5waXRjaFsyXSwgc3RhdGUpCiAgICAgICAgICAgICAgICAgICAgdWkuc2V0X3Zpc2libGUocmVmLnlhd2Jhc2UsIHN0YXRlKQogICAgICAgICAgICAgICAgICAgIHVpLnNldF92aXNpYmxlKHJlZi55YXdbMV0sIHN0YXRlKQogICAgICAgICAgICAgICAgICAgIHVpLnNldF92aXNpYmxlKHJlZi55YXdbMl0sIHN0YXRlKQogICAgICAgICAgICAgICAgICAgIHVpLnNldF92aXNpYmxlKHJlZi55YXdqaXR0ZXJbMV0sIHN0YXRlKQogICAgICAgICAgICAgICAgICAgIHVpLnNldF92aXNpYmxlKHJlZi5yb2xsWzFdLCBzdGF0ZSkKICAgICAgICAgICAgICAgICAgICB1aS5zZXRfdmlzaWJsZShyZWYueWF3aml0dGVyWzJdLCBzdGF0ZSkKICAgICAgICAgICAgICAgICAgICB1aS5zZXRfdmlzaWJsZShyZWYuYm9keXlhd1sxXSwgc3RhdGUpCiAgICAgICAgICAgICAgICAgICAgdWkuc2V0X3Zpc2libGUocmVmLmJvZHl5YXdbMl0sIHN0YXRlKQogICAgICAgICAgICAgICAgICAgIHVpLnNldF92aXNpYmxlKHJlZi5mc2JvZHl5YXcsIHN0YXRlKQogICAgICAgICAgICAgICAgICAgIHVpLnNldF92aXNpYmxlKHJlZi5lZGdleWF3LCBzdGF0ZSkKICAgICAgICAgICAgICAgICAgICB1aS5zZXRfdmlzaWJsZShyZWYuZnJlZXN0YW5kWzFdLCBzdGF0ZSkKICAgICAgICAgICAgICAgICAgICB1aS5zZXRfdmlzaWJsZShyZWYuZnJlZXN0YW5kWzJdLCBzdGF0ZSkKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIGxvY2FsIGZ1bmN0aW9uIHJhbmRvbWl6ZV92YWx1ZShvcmlnaW5hbF92YWx1ZSwgcGVyY2VudCkKICAgICAgICAgICAgICAgICAgICBsb2NhbCBtaW5fcmFuZ2UgPSBvcmlnaW5hbF92YWx1ZSAtIChvcmlnaW5hbF92YWx1ZSAqIHBlcmNlbnQgLyAxMDApCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgbWF4X3JhbmdlID0gb3JpZ2luYWxfdmFsdWUgKyAob3JpZ2luYWxfdmFsdWUgKiBwZXJjZW50IC8gMTAwKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBtYXRoLnJhbmRvbShtaW5fcmFuZ2UsIG1heF9yYW5nZSkKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIGxvY2FsIGxhc3Rfc2ltX3RpbWUgPSAwCiAgICAgICAgICAgICAgICBsb2NhbCBuYXRpdmVfR2V0Q2xpZW50RW50aXR5ID0gdnRhYmxlX2JpbmQoJ2NsaWVudC5kbGwnLCAnVkNsaWVudEVudGl0eUxpc3QwMDMnLCAzLCAndm9pZCooX190aGlzY2FsbCopKHZvaWQqLCBpbnQpJykKCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBpc19kZWZlbnNpdmVfYWN0aXZlKGxwKQogICAgICAgICAgICAgICAgICAgIGlmIGdsb2JhbHMuY2hva2VkY29tbWFuZHMoKSA+IDEgdGhlbiByZXR1cm4gZmFsc2UgZW5kCiAgICAgICAgICAgICAgICAgICAgaWYgbHAgPT0gbmlsIG9yIG5vdCBlbnRpdHkuaXNfYWxpdmUobHApIHRoZW4gcmV0dXJuIGVuZAogICAgICAgICAgICAgICAgICAgIGxvY2FsIG1fZmxPbGRTaW11bGF0aW9uVGltZSA9IGZmaS5jYXN0KCJmbG9hdCoiLCBmZmkuY2FzdCgidWludHB0cl90IiwgbmF0aXZlX0dldENsaWVudEVudGl0eShscCkpICsgMHgyNkMpWzBdCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgbV9mbFNpbXVsYXRpb25UaW1lID0gZW50aXR5LmdldF9wcm9wKGxwLCAibV9mbFNpbXVsYXRpb25UaW1lIikKICAgICAgICAgICAgICAgICAgICBsb2NhbCBkZWx0YSA9IHRvdGlja3MobV9mbE9sZFNpbXVsYXRpb25UaW1lIC0gbV9mbFNpbXVsYXRpb25UaW1lKQogICAgICAgICAgICAgICAgICAgIGlmIGRlbHRhID4gMCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3Rfc2ltX3RpbWUgPSBnbG9iYWxzLnRpY2tjb3VudCgpICsgZGVsdGEgLSB0b3RpY2tzKGNsaWVudC5yZWFsX2xhdGVuY3koKSkKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbGFzdF9zaW1fdGltZSA+IGdsb2JhbHMudGlja2NvdW50KCkKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGlzX2RlZmVuc2l2ZV9yZXNvbHZlcihscCkKICAgICAgICAgICAgICAgICAgICBpZiBscCA9PSBuaWwgb3Igbm90IGVudGl0eS5pc19hbGl2ZShscCkgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgbV9mbE9sZFNpbXVsYXRpb25UaW1lID0gZmZpLmNhc3QoImZsb2F0KiIsIGZmaS5jYXN0KCJ1aW50cHRyX3QiLCBuYXRpdmVfR2V0Q2xpZW50RW50aXR5KGxwKSkgKyAweDI2QylbMF0KICAgICAgICAgICAgICAgICAgICBsb2NhbCBtX2ZsU2ltdWxhdGlvblRpbWUgPSBlbnRpdHkuZ2V0X3Byb3AobHAsICJtX2ZsU2ltdWxhdGlvblRpbWUiKQogICAgICAgICAgICAgICAgICAgIGxvY2FsIGRlbHRhID0gdG90aWNrcyhtX2ZsT2xkU2ltdWxhdGlvblRpbWUgLSBtX2ZsU2ltdWxhdGlvblRpbWUpCiAgICAgICAgICAgICAgICAgICAgaWYgZGVsdGEgPiAwIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgbGFzdF9zaW1fdGltZSA9IGdsb2JhbHMudGlja2NvdW50KCkgKyBkZWx0YSAtIHRvdGlja3MoY2xpZW50LnJlYWxfbGF0ZW5jeSgpKQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIHJldHVybiBsYXN0X3NpbV90aW1lID4gZ2xvYmFscy50aWNrY291bnQoKQogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgbG9jYWwgaWQgPSAxICAgCiAgICAgICAgICAgICAgICBsb2NhbCBmdW5jdGlvbiBwbGF5ZXJfc3RhdGUoY21kKQogICAgICAgICAgICAgICAgICAgIGxvY2FsIGxwID0gZW50aXR5LmdldF9sb2NhbF9wbGF5ZXIoKQogICAgICAgICAgICAgICAgICAgIGlmIGxwID09IG5pbCB0aGVuIHJldHVybiBlbmQKCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgdmVjdmVsb2NpdHkgPSB7IGVudGl0eS5nZXRfcHJvcChscCwgJ21fdmVjVmVsb2NpdHknKSB9CiAgICAgICAgICAgICAgICAgICAgbG9jYWwgZmxhZ3MgPSBlbnRpdHkuZ2V0X3Byb3AobHAsICdtX2ZGbGFncycpCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgdmVsb2NpdHkgPSBtYXRoLnNxcnQodmVjdmVsb2NpdHlbMV1eMit2ZWN2ZWxvY2l0eVsyXV4yKQogICAgICAgICAgICAgICAgICAgIGxvY2FsIGdyb3VuZGNoZWNrID0gYml0LmJhbmQoZmxhZ3MsIDEpID09IDEKICAgICAgICAgICAgICAgICAgICBsb2NhbCBqdW1wY2hlY2sgPSBiaXQuYmFuZChmbGFncywgMSkgPT0gMCBvciBjbWQuaW5fanVtcCA9PSAxCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgZHVja2VkID0gZW50aXR5LmdldF9wcm9wKGxwLCAnbV9mbER1Y2tBbW91bnQnKSA+IDAuNwogICAgICAgICAgICAgICAgICAgIGxvY2FsIGR1Y2tjaGVjayA9IGR1Y2tlZCBvciB1aS5nZXQocmVmLmZha2VkdWNrKQogICAgICAgICAgICAgICAgICAgIGxvY2FsIHNsb3d3YWxrX2tleSA9IHVpLmdldChyZWYuc2xvd1sxXSkgYW5kIHVpLmdldChyZWYuc2xvd1syXSkKCiAgICAgICAgICAgICAgICAgICAgaWYganVtcGNoZWNrIGFuZCBkdWNrY2hlY2sgdGhlbiByZXR1cm4gIkFpcitDIgogICAgICAgICAgICAgICAgICAgIGVsc2VpZiBqdW1wY2hlY2sgdGhlbiByZXR1cm4gIkFpciIKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgZHVja2NoZWNrIGFuZCB2ZWxvY2l0eSA+IDEwIHRoZW4gcmV0dXJuICJEdWNrLU1vdmluZyIKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgZHVja2NoZWNrIGFuZCB2ZWxvY2l0eSA8IDEwIHRoZW4gcmV0dXJuICJEdWNrIgogICAgICAgICAgICAgICAgICAgIGVsc2VpZiBncm91bmRjaGVjayBhbmQgc2xvd3dhbGtfa2V5IGFuZCB2ZWxvY2l0eSA+IDEwIHRoZW4gcmV0dXJuICJXYWxraW5nIgogICAgICAgICAgICAgICAgICAgIGVsc2VpZiBncm91bmRjaGVjayBhbmQgdmVsb2NpdHkgPiA1IHRoZW4gcmV0dXJuICJNb3ZpbmciCiAgICAgICAgICAgICAgICAgICAgZWxzZWlmIGdyb3VuZGNoZWNrIGFuZCB2ZWxvY2l0eSA8IDUgdGhlbiByZXR1cm4gIlN0YW5kIgogICAgICAgICAgICAgICAgICAgIGVsc2UgcmV0dXJuICJHbG9iYWwiIGVuZAogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgbG9jYWwgeWF3X2RpcmVjdGlvbiA9IDAKICAgICAgICAgICAgICAgIGxvY2FsIGxhc3RfcHJlc3NfdF9kaXIgPSAwCgogICAgICAgICAgICAgICAgbG9jYWwgcnVuX2RpcmVjdGlvbiA9IGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmLmZyZWVzdGFuZFsxXSwgbHVhX21lbnUuYW50aWFpbS55YXdfZGlyZWN0aW9uOmdldCgiRnJlZXN0YW5kaW5nIikpCiAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZi5mcmVlc3RhbmRbMl0sIGx1YV9tZW51LmFudGlhaW0ua2V5X2ZyZWVzdGFuZDpnZXQoKSBhbmQgJ0Fsd2F5cyBvbicgb3IgJ09uIGhvdGtleScpCgogICAgICAgICAgICAgICAgICAgIGlmIHlhd19kaXJlY3Rpb24gfj0gMCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWYuZnJlZXN0YW5kWzFdLCBmYWxzZSkKICAgICAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICAgICAgaWYgbHVhX21lbnUuYW50aWFpbS55YXdfZGlyZWN0aW9uOmdldCgiTWFudWFsIikgYW5kIGx1YV9tZW51LmFudGlhaW0ua2V5X3JpZ2h0OmdldCgpIGFuZCBsYXN0X3ByZXNzX3RfZGlyICsgMC4yIDwgZ2xvYmFscy5jdXJ0aW1lKCkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICB5YXdfZGlyZWN0aW9uID0geWF3X2RpcmVjdGlvbiA9PSA5MCBhbmQgMCBvciA5MAogICAgICAgICAgICAgICAgICAgICAgICBsYXN0X3ByZXNzX3RfZGlyID0gZ2xvYmFscy5jdXJ0aW1lKCkKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgbHVhX21lbnUuYW50aWFpbS55YXdfZGlyZWN0aW9uOmdldCgiTWFudWFsIikgYW5kIGx1YV9tZW51LmFudGlhaW0ua2V5X2xlZnQ6Z2V0KCkgYW5kIGxhc3RfcHJlc3NfdF9kaXIgKyAwLjIgPCBnbG9iYWxzLmN1cnRpbWUoKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHlhd19kaXJlY3Rpb24gPSB5YXdfZGlyZWN0aW9uID09IC05MCBhbmQgMCBvciAtOTAKICAgICAgICAgICAgICAgICAgICAgICAgbGFzdF9wcmVzc190X2RpciA9IGdsb2JhbHMuY3VydGltZSgpCiAgICAgICAgICAgICAgICAgICAgZWxzZWlmIGx1YV9tZW51LmFudGlhaW0ueWF3X2RpcmVjdGlvbjpnZXQoIk1hbnVhbCIpIGFuZCBsdWFfbWVudS5hbnRpYWltLmtleV9mb3J3YXJkOmdldCgpIGFuZCBsYXN0X3ByZXNzX3RfZGlyICsgMC4yIDwgZ2xvYmFscy5jdXJ0aW1lKCkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICB5YXdfZGlyZWN0aW9uID0geWF3X2RpcmVjdGlvbiA9PSAxODAgYW5kIDAgb3IgMTgwCiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RfcHJlc3NfdF9kaXIgPSBnbG9iYWxzLmN1cnRpbWUoKQogICAgICAgICAgICAgICAgICAgIGVsc2VpZiBsYXN0X3ByZXNzX3RfZGlyID4gZ2xvYmFscy5jdXJ0aW1lKCkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBsYXN0X3ByZXNzX3RfZGlyID0gZ2xvYmFscy5jdXJ0aW1lKCkKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIGFudGlfa25pZmVfZGlzdCA9IGZ1bmN0aW9uICh4MSwgeTEsIHoxLCB4MiwgeTIsIHoyKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBtYXRoLnNxcnQoKHgyIC0geDEpXjIgKyAoeTIgLSB5MSleMiArICh6MiAtIHoxKV4yKQogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgbG9jYWwgZnVuY3Rpb24gaXNfdnVsbmVyYWJsZSgpCiAgICAgICAgICAgICAgICAgICAgZm9yIF8sIHYgaW4gaXBhaXJzKGVudGl0eS5nZXRfcGxheWVycyh0cnVlKSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgZmxhZ3MgPSAoZW50aXR5LmdldF9lc3BfZGF0YSh2KSkuZmxhZ3MKICAgICAgICAgICAgICAgICAgICAgICAgaWYgYml0LmJhbmQoZmxhZ3MsIGJpdC5sc2hpZnQoMSwgMTEpKSB+PSAwIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZQogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgbG9jYWwgZnVuY3Rpb24gc2FmZV9mdW5jKCkKICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmLnlhd2ppdHRlclsxXSwgIk9mZiIpCiAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZi55YXdbMV0sICcxODAnKQogICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWYuYm9keXlhd1sxXSwgIlN0YXRpYyIpCiAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZi5ib2R5eWF3WzJdLCAxKQogICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWYueWF3WzJdLCAxNCkKICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmLnBpdGNoWzJdLCA4OSkKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIGxvY2FsIGN1cnJlbnRfdGlja2NvdW50ID0gMAogICAgICAgICAgICAgICAgbG9jYWwgdG9faml0dGVyID0gZmFsc2UKICAgICAgICAgICAgICAgIGxvY2FsIHRvX2RlZmVuc2l2ZSA9IHRydWUKICAgICAgICAgICAgICAgIGxvY2FsIGZpcnN0X2V4ZWN1dGlvbiA9IHRydWUKICAgICAgICAgICAgICAgIGxvY2FsIHlhd19hbW91bnQgPSAwCgogICAgICAgICAgICAgICAgbG9jYWwgZnVuY3Rpb24gZGVmZW5zaXZlX3BlZWsoKQogICAgICAgICAgICAgICAgICAgIHRvX2RlZmVuc2l2ZSA9IGZhbHNlCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBsb2NhbCBmdW5jdGlvbiBkZWZlbnNpdmVfZGlzYWJsZXIoKQogICAgICAgICAgICAgICAgICAgIHRvX2RlZmVuc2l2ZSA9IHRydWUKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIGxvY2FsIGZ1bmN0aW9uIGFhX3NldHVwKGNtZCkKICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGxvY2FsIGxwID0gZW50aXR5LmdldF9sb2NhbF9wbGF5ZXIoKQogICAgICAgICAgICAgICAgICAgIGlmIGxwID09IG5pbCB0aGVuIHJldHVybiBlbmQKICAgICAgICAgICAgICAgICAgICBpZiBwbGF5ZXJfc3RhdGUoY21kKSA9PSAiRHVjay1Nb3ZpbmciIGFuZCBhbnRpYWltX3N5c3RlbVs4XS5lbmFibGU6Z2V0KCkgdGhlbiBpZCA9IDgKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgcGxheWVyX3N0YXRlKGNtZCkgPT0gIkR1Y2siIGFuZCBhbnRpYWltX3N5c3RlbVs3XS5lbmFibGU6Z2V0KCkgdGhlbiBpZCA9IDcKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgcGxheWVyX3N0YXRlKGNtZCkgPT0gIkFpcitDIiBhbmQgYW50aWFpbV9zeXN0ZW1bNl0uZW5hYmxlOmdldCgpIHRoZW4gaWQgPSA2CiAgICAgICAgICAgICAgICAgICAgZWxzZWlmIHBsYXllcl9zdGF0ZShjbWQpID09ICJBaXIiIGFuZCBhbnRpYWltX3N5c3RlbVs1XS5lbmFibGU6Z2V0KCkgdGhlbiBpZCA9IDUKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgcGxheWVyX3N0YXRlKGNtZCkgPT0gIk1vdmluZyIgYW5kIGFudGlhaW1fc3lzdGVtWzRdLmVuYWJsZTpnZXQoKSB0aGVuIGlkID0gNAogICAgICAgICAgICAgICAgICAgIGVsc2VpZiBwbGF5ZXJfc3RhdGUoY21kKSA9PSAiV2Fsa2luZyIgYW5kIGFudGlhaW1fc3lzdGVtWzNdLmVuYWJsZTpnZXQoKSB0aGVuIGlkID0gMwogICAgICAgICAgICAgICAgICAgIGVsc2VpZiBwbGF5ZXJfc3RhdGUoY21kKSA9PSAiU3RhbmQiIGFuZCBhbnRpYWltX3N5c3RlbVsyXS5lbmFibGU6Z2V0KCkgdGhlbiBpZCA9IDIKICAgICAgICAgICAgICAgICAgICBlbHNlIGlkID0gMSBlbmQKCiAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZi5yb2xsWzFdLCAwKQoKICAgICAgICAgICAgICAgICAgICBydW5fZGlyZWN0aW9uKCkKCiAgICAgICAgICAgICAgICAgICAgaWYgZ2xvYmFscy50aWNrY291bnQoKSA+IGN1cnJlbnRfdGlja2NvdW50ICsgYW50aWFpbV9zeXN0ZW1baWRdLnlhd19kZWxheTpnZXQoKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGNtZC5jaG9rZWRjb21tYW5kcyA9PSAwIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvX2ppdHRlciA9IG5vdCB0b19qaXR0ZXIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRfdGlja2NvdW50ID0gZ2xvYmFscy50aWNrY291bnQoKQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgZ2xvYmFscy50aWNrY291bnQoKSA8ICBjdXJyZW50X3RpY2tjb3VudCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRfdGlja2NvdW50ID0gZ2xvYmFscy50aWNrY291bnQoKQogICAgICAgICAgICAgICAgICAgIGVuZAoKCiAgICAgICAgICAgICAgICAgICAgaWYgaXNfdnVsbmVyYWJsZSgpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgaWYgZmlyc3RfZXhlY3V0aW9uIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcnN0X2V4ZWN1dGlvbiA9IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b19kZWZlbnNpdmUgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGllbnQuc2V0X2V2ZW50X2NhbGxiYWNrKCJzZXR1cF9jb21tYW5kIiwgZGVmZW5zaXZlX2Rpc2FibGVyKQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgaWYgZ2xvYmFscy50aWNrY291bnQoKSAlIDEwID09IDkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmZW5zaXZlX3BlZWsoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xpZW50LnVuc2V0X2V2ZW50X2NhbGxiYWNrKCJzZXR1cF9jb21tYW5kIiwgZGVmZW5zaXZlX2Rpc2FibGVyKQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIGZpcnN0X2V4ZWN1dGlvbiA9IHRydWUKICAgICAgICAgICAgICAgICAgICAgICAgdG9fZGVmZW5zaXZlID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZi5mc2JvZHl5YXcsIGZhbHNlKQogICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWYucGl0Y2hbMV0sICJDdXN0b20iKQogICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWYueWF3YmFzZSwgbHVhX21lbnUuYW50aWFpbS55YXdfYmFzZTpnZXQoKSkKCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgc2VsZWN0ZWRfYnVpbGRlcl9kZWYgPSBhbnRpYWltX3N5c3RlbVtpZF0uZGVmZW5zaXZlOmdldCgpIGFuZCBhbnRpYWltX3N5c3RlbVtpZF0uZGVmZW5zaXZlX3R5cGU6Z2V0KCkgPT0gIkJ1aWxkZXIiIGFuZCBpc19kZWZlbnNpdmVfYWN0aXZlKGxwKQoKICAgICAgICAgICAgICAgICAgICBpZiBzZWxlY3RlZF9idWlsZGVyX2RlZiB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWYueWF3aml0dGVyWzFdLCBhbnRpYWltX3N5c3RlbVtpZF0uZGVmX21vZF90eXBlOmdldCgpKQogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmLnlhd2ppdHRlclsyXSwgYW50aWFpbV9zeXN0ZW1baWRdLmRlZl9tb2RfZG06Z2V0KCkpCiAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWYuYm9keXlhd1sxXSwgYW50aWFpbV9zeXN0ZW1baWRdLmRlZl9ib2R5X3lhd190eXBlOmdldCgpKQogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmLmJvZHl5YXdbMl0sIGFudGlhaW1fc3lzdGVtW2lkXS5kZWZfYm9keV9zbGlkZXI6Z2V0KCkpCiAgICAgICAgICAgICAgICAgICAgICAgIHlhd19hbW91bnQgPSB5YXdfZGlyZWN0aW9uID09IDAgYW5kIGFudGlhaW1fc3lzdGVtW2lkXS5kZWZfeWF3X3ZhbHVlOmdldCgpIG9yIHlhd19kaXJlY3Rpb24KICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWYueWF3aml0dGVyWzFdLCBhbnRpYWltX3N5c3RlbVtpZF0ubW9kX3R5cGU6Z2V0KCkpCiAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWYueWF3aml0dGVyWzJdLCBhbnRpYWltX3N5c3RlbVtpZF0ubW9kX2RtOmdldCgpKQogICAgICAgICAgICAgICAgICAgICAgICBpZiBhbnRpYWltX3N5c3RlbVtpZF0ueWF3X3R5cGU6Z2V0KCkgPT0gIkRlbGF5IiB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmLmJvZHl5YXdbMV0sICJTdGF0aWMiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZi5ib2R5eWF3WzJdLCB0b19qaXR0ZXIgYW5kIDEgb3IgLTEpCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWYuYm9keXlhd1sxXSwgYW50aWFpbV9zeXN0ZW1baWRdLmJvZHlfeWF3X3R5cGU6Z2V0KCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmLmJvZHl5YXdbMl0sIGFudGlhaW1fc3lzdGVtW2lkXS5ib2R5X3NsaWRlcjpnZXQoKSkKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgICAgIGlmIGlzX2RlZmVuc2l2ZV9hY3RpdmUobHApIGFuZCBhbnRpYWltX3N5c3RlbVtpZF0uZGVmZW5zaXZlOmdldCgpIGFuZCBhbnRpYWltX3N5c3RlbVtpZF0uZGVmZW5zaXZlX3R5cGU6Z2V0KCkgPT0gIkRlZmF1bHQiIGFuZCBhbnRpYWltX3N5c3RlbVtpZF0uZGVmZW5zaXZlX3lhdzpnZXQoKSA9PSAiU3BpbiIgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmLnlhd1sxXSwgJ1NwaW4nKQogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZi55YXdbMV0sICcxODAnKQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGNtZC5mb3JjZV9kZWZlbnNpdmUgPSBhbnRpYWltX3N5c3RlbVtpZF0uZm9yY2VfZGVmOmdldCgpIG9yIGFudGlhaW1fc3lzdGVtW2lkXS5wZWVrX2RlZjpnZXQoKSBhbmQgdG9fZGVmZW5zaXZlCgogICAgICAgICAgICAgICAgICAgIGxvY2FsIGRlc3luY190eXBlID0gZW50aXR5LmdldF9wcm9wKGxwLCAnbV9mbFBvc2VQYXJhbWV0ZXInLCAxMSkgKiAxMjAgLSA2MAogICAgICAgICAgICAgICAgICAgIGxvY2FsIGRlc3luY19zaWRlID0gZGVzeW5jX3R5cGUgPiAwCgogICAgICAgICAgICAgICAgICAgIGlmIGlzX2RlZmVuc2l2ZV9hY3RpdmUobHApIGFuZCBhbnRpYWltX3N5c3RlbVtpZF0uZGVmZW5zaXZlOmdldCgpIGFuZCBhbnRpYWltX3N5c3RlbVtpZF0uZGVmZW5zaXZlX3R5cGU6Z2V0KCkgPT0gIkRlZmF1bHQiIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgaWYgYW50aWFpbV9zeXN0ZW1baWRdLmRlZmVuc2l2ZV95YXc6Z2V0KCkgPT0gIlNwaW4iIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHlhd19hbW91bnQgPSBhbnRpYWltX3N5c3RlbVtpZF0ueWF3X3ZhbHVlOmdldCgpCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VpZiBhbnRpYWltX3N5c3RlbVtpZF0uZGVmZW5zaXZlX3lhdzpnZXQoKSA9PSAiTWV0YX5XYXlzIiB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB5YXdfYW1vdW50ID0gZGVzeW5jX3NpZGUgYW5kIDkwIG9yIC05MAogICAgICAgICAgICAgICAgICAgICAgICBlbHNlaWYgYW50aWFpbV9zeXN0ZW1baWRdLmRlZmVuc2l2ZV95YXc6Z2V0KCkgPT0gIlJhbmRvbSIgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgeWF3X2Ftb3VudCA9IG1hdGgucmFuZG9tKC0xODAsIDE4MCkKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgeWF3X2Ftb3VudCA9IGRlc3luY19zaWRlIGFuZCByYW5kb21pemVfdmFsdWUoYW50aWFpbV9zeXN0ZW1baWRdLnlhd19sZWZ0OmdldCgpLCBhbnRpYWltX3N5c3RlbVtpZF0ueWF3X3JhbmRvbTpnZXQoKSkgb3IgcmFuZG9taXplX3ZhbHVlKGFudGlhaW1fc3lzdGVtW2lkXS55YXdfcmlnaHQ6Z2V0KCksIGFudGlhaW1fc3lzdGVtW2lkXS55YXdfcmFuZG9tOmdldCgpKQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgbm90IHNlbGVjdGVkX2J1aWxkZXJfZGVmIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgeWF3X2Ftb3VudCA9IGRlc3luY19zaWRlIGFuZCByYW5kb21pemVfdmFsdWUoYW50aWFpbV9zeXN0ZW1baWRdLnlhd19sZWZ0OmdldCgpLCBhbnRpYWltX3N5c3RlbVtpZF0ueWF3X3JhbmRvbTpnZXQoKSkgb3IgcmFuZG9taXplX3ZhbHVlKGFudGlhaW1fc3lzdGVtW2lkXS55YXdfcmlnaHQ6Z2V0KCksIGFudGlhaW1fc3lzdGVtW2lkXS55YXdfcmFuZG9tOmdldCgpKQogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmLnBpdGNoWzJdLCA4OSkKICAgICAgICAgICAgICAgICAgICBlbmQKCgogICAgICAgICAgICAgICAgICAgIGlmIGlzX2RlZmVuc2l2ZV9hY3RpdmUobHApIGFuZCBhbnRpYWltX3N5c3RlbVtpZF0uZGVmZW5zaXZlOmdldCgpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgaWYgYW50aWFpbV9zeXN0ZW1baWRdLmRlZmVuc2l2ZV9waXRjaDpnZXQoKSA9PSAiQ3VzdG9tIiB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmLnBpdGNoWzJdLCBhbnRpYWltX3N5c3RlbVtpZF0ucGl0Y2hfdmFsdWU6Z2V0KCkpCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VpZiBhbnRpYWltX3N5c3RlbVtpZF0uZGVmZW5zaXZlX3BpdGNoOmdldCgpID09ICJNZXRhfldheXMiIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWYucGl0Y2hbMl0sIGRlc3luY19zaWRlIGFuZCA0OSBvciAtNDkpCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VpZiBhbnRpYWltX3N5c3RlbVtpZF0uZGVmZW5zaXZlX3BpdGNoOmdldCgpID09ICJSYW5kb20iIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWYucGl0Y2hbMl0sIG1hdGgucmFuZG9tKC04OSwgODkpKQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmLnBpdGNoWzJdLCA4OSkKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWYueWF3WzJdLCB5YXdfZGlyZWN0aW9uID09IDAgYW5kIHlhd19hbW91bnQgb3IgeWF3X2RpcmVjdGlvbikKICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgcGxheWVycyA9IGVudGl0eS5nZXRfcGxheWVycyh0cnVlKQogICAgICAgICAgICAgICAgICAgIGlmIGx1YV9tZW51LmFudGlhaW0uYWRkb25zOmdldCgiV2FybXVwIEFudGl+QWltIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBpZiBlbnRpdHkuZ2V0X3Byb3AoZW50aXR5LmdldF9nYW1lX3J1bGVzKCksICJtX2JXYXJtdXBQZXJpb2QiKSA9PSAxIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWYueWF3WzJdLCBtYXRoLnJhbmRvbSgtMTgwLCAxODApKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZi55YXdqaXR0ZXJbMl0sIG1hdGgucmFuZG9tKC0xODAsIDE4MCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmLmJvZHl5YXdbMl0sIG1hdGgucmFuZG9tKC0xODAsIDE4MCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmLnBpdGNoWzFdLCAiQ3VzdG9tIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWYucGl0Y2hbMl0sIG1hdGgucmFuZG9tKC04OSwgODkpKSAKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgICAgIGxvY2FsIHRocmVhdCA9IGNsaWVudC5jdXJyZW50X3RocmVhdCgpCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgbHBfd2VhcG9uID0gZW50aXR5LmdldF9wbGF5ZXJfd2VhcG9uKGxwKQogICAgICAgICAgICAgICAgICAgIGxvY2FsIGxwX29yaWdfeCwgbHBfb3JpZ195LCBscF9vcmlnX3ogPSBlbnRpdHkuZ2V0X3Byb3AobHAsICJtX3ZlY09yaWdpbiIpCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgZmxhZ3MgPSBlbnRpdHkuZ2V0X3Byb3AobHAsICdtX2ZGbGFncycpCiAgICAgICAgICAgICAgICAgICAgbG9jYWwganVtcGNoZWNrID0gYml0LmJhbmQoZmxhZ3MsIDEpID09IDAgb3IgY21kLmluX2p1bXAgPT0gMQogICAgICAgICAgICAgICAgICAgIGxvY2FsIGR1Y2tlZCA9IGVudGl0eS5nZXRfcHJvcChscCwgJ21fZmxEdWNrQW1vdW50JykgPiAwLjcKCiAgICAgICAgICAgICAgICAgICAgaWYgbHVhX21lbnUuYW50aWFpbS5hZGRvbnM6Z2V0KCJTYWZlIEhlYWQiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGxwX3dlYXBvbiB+PSBuaWwgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgbHVhX21lbnUuYW50aWFpbS5zYWZlX2hlYWQ6Z2V0KCJBaXIrQyBLbmlmZSIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBqdW1wY2hlY2sgYW5kIGR1Y2tlZCBhbmQgZW50aXR5LmdldF9jbGFzc25hbWUobHBfd2VhcG9uKSA9PSAiQ0tuaWZlIiB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhZmVfZnVuYygpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGx1YV9tZW51LmFudGlhaW0uc2FmZV9oZWFkOmdldCgiQWlyK0MgWmV1cyIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBqdW1wY2hlY2sgYW5kIGR1Y2tlZCBhbmQgZW50aXR5LmdldF9jbGFzc25hbWUobHBfd2VhcG9uKSA9PSAiQ1dlYXBvblRhc2VyIiB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhZmVfZnVuYygpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGx1YV9tZW51LmFudGlhaW0uc2FmZV9oZWFkOmdldCgiSGlnaCBEaXN0YW5jZSIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiB0aHJlYXQgfj0gbmlsIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyZWF0X3gsIHRocmVhdF95LCB0aHJlYXRfeiA9IGVudGl0eS5nZXRfcHJvcCh0aHJlYXQsICJtX3ZlY09yaWdpbiIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocmVhdF9kaXN0ID0gYW50aV9rbmlmZV9kaXN0KGxwX29yaWdfeCwgbHBfb3JpZ195LCBscF9vcmlnX3osIHRocmVhdF94LCB0aHJlYXRfeSwgdGhyZWF0X3opCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHRocmVhdF9kaXN0ID4gOTAwIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhZmVfZnVuYygpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGlmIGx1YV9tZW51LmFudGlhaW0uYWRkb25zOmdldCgiQW50aX5LbmlmZSIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGk9MSwgI3BsYXllcnMgZG8KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHBsYXllcnMgPT0gbmlsIHRoZW4gcmV0dXJuIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5lbXlfb3JpZ194LCBlbmVteV9vcmlnX3ksIGVuZW15X29yaWdfeiA9IGVudGl0eS5nZXRfcHJvcChwbGF5ZXJzW2ldLCAibV92ZWNPcmlnaW4iKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzdGFuY2VfdG8gPSBhbnRpX2tuaWZlX2Rpc3QobHBfb3JpZ194LCBscF9vcmlnX3ksIGxwX29yaWdfeiwgZW5lbXlfb3JpZ194LCBlbmVteV9vcmlnX3ksIGVuZW15X29yaWdfeikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdlYXBvbiA9IGVudGl0eS5nZXRfcGxheWVyX3dlYXBvbihwbGF5ZXJzW2ldKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgd2VhcG9uID09IG5pbCB0aGVuIHJldHVybiBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGVudGl0eS5nZXRfY2xhc3NuYW1lKHdlYXBvbikgPT0gIkNLbmlmZSIgYW5kIGRpc3RhbmNlX3RvIDw9IDI1MCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZi55YXdbMl0sIDE4MCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmLnlhd2Jhc2UsICJBdCB0YXJnZXRzIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIGxvY2FsIGxhc3RtaXNzID0gMAogICAgICAgICAgICAgICAgbG9jYWwgZnVuY3Rpb24gR2V0Q2xvc2VzdFBvaW50KEEsIEIsIFApCiAgICAgICAgICAgICAgICAgICAgYV90b19wID0geyBQWzFdIC0gQVsxXSwgUFsyXSAtIEFbMl0gfQogICAgICAgICAgICAgICAgICAgIGFfdG9fYiA9IHsgQlsxXSAtIEFbMV0sIEJbMl0gLSBBWzJdIH0KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGF0YjIgPSBhX3RvX2JbMV1eMiArIGFfdG9fYlsyXV4yCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBhdHBfZG90X2F0YiA9IGFfdG9fcFsxXSphX3RvX2JbMV0gKyBhX3RvX3BbMl0qYV90b19iWzJdCiAgICAgICAgICAgICAgICAgICAgdCA9IGF0cF9kb3RfYXRiIC8gYXRiMgogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIHJldHVybiB7IEFbMV0gKyBhX3RvX2JbMV0qdCwgQVsyXSArIGFfdG9fYlsyXSp0IH0KICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBjbGllbnQuc2V0X2V2ZW50X2NhbGxiYWNrKCJidWxsZXRfaW1wYWN0IiwgZnVuY3Rpb24oZSkgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBpZiBub3QgZW50aXR5LmlzX2FsaXZlKGVudGl0eS5nZXRfbG9jYWxfcGxheWVyKCkpIHRoZW4gcmV0dXJuIGVuZAogICAgICAgICAgICAgICAgICAgIGxvY2FsIGVudCA9IGNsaWVudC51c2VyaWRfdG9fZW50aW5kZXgoZS51c2VyaWQpCiAgICAgICAgICAgICAgICAgICAgaWYgZW50IH49IGNsaWVudC5jdXJyZW50X3RocmVhdCgpIHRoZW4gcmV0dXJuIGVuZAogICAgICAgICAgICAgICAgICAgIGlmIGVudGl0eS5pc19kb3JtYW50KGVudCkgb3Igbm90IGVudGl0eS5pc19lbmVteShlbnQpIHRoZW4gcmV0dXJuIGVuZAogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgZW50X29yaWdpbiA9IHsgZW50aXR5LmdldF9wcm9wKGVudCwgIm1fdmVjT3JpZ2luIikgfQogICAgICAgICAgICAgICAgICAgIGVudF9vcmlnaW5bM10gPSBlbnRfb3JpZ2luWzNdICsgZW50aXR5LmdldF9wcm9wKGVudCwgIm1fdmVjVmlld09mZnNldFsyXSIpCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgbG9jYWxfaGVhZCA9IHsgZW50aXR5LmhpdGJveF9wb3NpdGlvbihlbnRpdHkuZ2V0X2xvY2FsX3BsYXllcigpLCAwKSB9CiAgICAgICAgICAgICAgICAgICAgbG9jYWwgY2xvc2VzdCA9IEdldENsb3Nlc3RQb2ludChlbnRfb3JpZ2luLCB7IGUueCwgZS55LCBlLnogfSwgbG9jYWxfaGVhZCkKICAgICAgICAgICAgICAgICAgICBsb2NhbCBkZWx0YSA9IHsgbG9jYWxfaGVhZFsxXS1jbG9zZXN0WzFdLCBsb2NhbF9oZWFkWzJdLWNsb3Nlc3RbMl0gfQogICAgICAgICAgICAgICAgICAgIGxvY2FsIGRlbHRhXzJkID0gbWF0aC5zcXJ0KGRlbHRhWzFdXjIrZGVsdGFbMl1eMikKICAgICAgICAgICAgICAgICAgICBpZiBtYXRoLmFicyhkZWx0YV8yZCkgPD0gNjAgYW5kIGdsb2JhbHMuY3VydGltZSgpIC0gbGFzdG1pc3MgPiAwLjAxNSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RtaXNzID0gZ2xvYmFscy5jdXJ0aW1lKCkKICAgICAgICAgICAgICAgICAgICAgICAgaWYgbHVhX21lbnUubWlzYy5sb2dfdHlwZTpnZXQoIlNjcmVlbiIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbmRlcmVyLmxvZyhlbnRpdHkuZ2V0X3BsYXllcl9uYW1lKGVudCkuLiIgU2hvdCBBdCBZb3UiKQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZCkKCiAgICAgICAgICAgICAgICBsb2NhbCBmdW5jdGlvbiBhbmltX2JyZWFrZXIoKQogICAgICAgICAgICAgICAgICAgIGxvY2FsIGxwID0gZW50aXR5LmdldF9sb2NhbF9wbGF5ZXIoKQogICAgICAgICAgICAgICAgICAgIGlmIG5vdCBscCB0aGVuIHJldHVybiBlbmQKICAgICAgICAgICAgICAgICAgICBpZiBub3QgZW50aXR5LmlzX2FsaXZlKGxwKSB0aGVuIHJldHVybiBlbmQKCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgc2VsZl9pbmRleCA9IGNfZW50aXR5Lm5ldyhscCkKICAgICAgICAgICAgICAgICAgICBsb2NhbCBzZWxmX2FuaW1fc3RhdGUgPSBzZWxmX2luZGV4OmdldF9hbmltX3N0YXRlKCkKICAgICAgICAgICAgICAgICAgICBpZiBub3Qgc2VsZl9hbmltX3N0YXRlIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgICAgIGxvY2FsIHNlbGZfYW5pbV9vdmVybGF5ID0gc2VsZl9pbmRleDpnZXRfYW5pbV9vdmVybGF5KDEyKQogICAgICAgICAgICAgICAgICAgIGlmIG5vdCBzZWxmX2FuaW1fb3ZlcmxheSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGxvY2FsIHhfdmVsb2NpdHkgPSBlbnRpdHkuZ2V0X3Byb3AobHAsICJtX3ZlY1ZlbG9jaXR5WzBdIikKICAgICAgICAgICAgICAgICAgICBpZiBtYXRoLmFicyh4X3ZlbG9jaXR5KSA+PSAzIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgc2VsZl9hbmltX292ZXJsYXkud2VpZ2h0ID0gMQogICAgICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgICAgICBpZiBsdWFfbWVudS5taXNjLmFuaW1hdGlvbl9ncm91bmQ6Z2V0KCkgPT0gIlN0YXRpYyIgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBlbnRpdHkuc2V0X3Byb3AobHAsICJtX2ZsUG9zZVBhcmFtZXRlciIsIGx1YV9tZW51Lm1pc2MuYW5pbWF0aW9uX3ZhbHVlOmdldCgpLzEwLCAwKQogICAgICAgICAgICAgICAgICAgIGVsc2VpZiBsdWFfbWVudS5taXNjLmFuaW1hdGlvbl9ncm91bmQ6Z2V0KCkgPT0gIkppdHRlciIgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBlbnRpdHkuc2V0X3Byb3AobHAsICJtX2ZsUG9zZVBhcmFtZXRlciIsIGdsb2JhbHMudGlja2NvdW50KCkgJTQgPiAxIGFuZCBsdWFfbWVudS5taXNjLmFuaW1hdGlvbl92YWx1ZTpnZXQoKS8xMCBvciAwLCAwKQogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgZW50aXR5LnNldF9wcm9wKGxwLCAibV9mbFBvc2VQYXJhbWV0ZXIiLCBtYXRoLnJhbmRvbShsdWFfbWVudS5taXNjLmFuaW1hdGlvbl92YWx1ZTpnZXQoKSwgMTApLzEwLCAwKQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGlmIGx1YV9tZW51Lm1pc2MuYW5pbWF0aW9uX2FpcjpnZXQoKSA9PSAiU3RhdGljIiB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGVudGl0eS5zZXRfcHJvcChscCwgIm1fZmxQb3NlUGFyYW1ldGVyIiwgMSwgNikKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgbHVhX21lbnUubWlzYy5hbmltYXRpb25fYWlyOmdldCgpID09ICJSYW5kb21pemUiIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgZW50aXR5LnNldF9wcm9wKGxwLCAibV9mbFBvc2VQYXJhbWV0ZXIiLCBtYXRoLnJhbmRvbSgwLCAxMCkvMTAsIDYpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBsb2NhbCBmdW5jdGlvbiBhdXRvX3RwKGNtZCkKICAgICAgICAgICAgICAgICAgICBsb2NhbCBscCA9IGVudGl0eS5nZXRfbG9jYWxfcGxheWVyKCkKICAgICAgICAgICAgICAgICAgICBpZiBscCA9PSBuaWwgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgZmxhZ3MgPSBlbnRpdHkuZ2V0X3Byb3AobHAsICdtX2ZGbGFncycpCiAgICAgICAgICAgICAgICAgICAgbG9jYWwganVtcGNoZWNrID0gYml0LmJhbmQoZmxhZ3MsIDEpID09IDAKICAgICAgICAgICAgICAgICAgICBpZiBpc192dWxuZXJhYmxlKCkgYW5kIGp1bXBjaGVjayB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGNtZC5mb3JjZV9kZWZlbnNpdmUgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgICAgIGNtZC5kaXNjaGFyZ2VfcGVuZGluZyA9IHRydWUKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIGxvY2FsIHNjcmVlbiA9IHtjbGllbnQuc2NyZWVuX3NpemUoKX0KICAgICAgICAgICAgICAgIGxvY2FsIGNlbnRlciA9IHtzY3JlZW5bMV0vMiwgc2NyZWVuWzJdLzJ9IAoKICAgICAgICAgICAgICAgIG1hdGgubGVycCA9IGZ1bmN0aW9uKG5hbWUsIHZhbHVlLCBzcGVlZCkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmFtZSArICh2YWx1ZSAtIG5hbWUpICogZ2xvYmFscy5hYnNvbHV0ZWZyYW1ldGltZSgpICogc3BlZWQKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIGxvY2FsIGxvZ3MgPSB7fQogICAgICAgICAgICAgICAgbG9jYWwgZnVuY3Rpb24gcmFnZWJvdF9sb2dzKCkKICAgICAgICAgICAgICAgICAgICBsb2NhbCBvZmZzZXQsIHgsIHkgPSAwLCBzY3JlZW5bMV0gLyAyLCBzY3JlZW5bMl0gLyAxLjQKICAgICAgICAgICAgICAgICAgICBmb3IgaWR4LCBkYXRhIGluIGlwYWlycyhsb2dzKSBkbwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoKChnbG9iYWxzLmN1cnRpbWUoKS8yKSAqIDIuMCkgLSBkYXRhWzNdKSA8IDQuMCBhbmQgbm90ICgjbG9ncyA+IDUgYW5kIGlkeCA8ICNsb2dzIC0gNSkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVsyXSA9IG1hdGgubGVycChkYXRhWzJdLCAyNTUsIDEwKQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhWzJdID0gbWF0aC5sZXJwKGRhdGFbMl0sIDAsIDEwKQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0ID0gb2Zmc2V0IC0gNDAgKiAoZGF0YVsyXSAvIDI1NSkKCiAgICAgICAgICAgICAgICAgICAgICAgIHRleHRfc2l6ZV94LCB0ZXh0X3Npc2VfeSA9IHJlbmRlcmVyLm1lYXN1cmVfdGV4dCgiIiwgZGF0YVsxXSkKICAgICAgICAgICAgICAgICAgICAgICAgaWYgbHVhX21lbnUubWlzYy5zY3JlZW5fdHlwZTpnZXQoKSA9PSAiRGVmYXVsdCIgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVuZGVyZXIucmVjdGFuZ2xlKHggLSA3IC0gdGV4dF9zaXplX3ggLyAyLCB5IC0gb2Zmc2V0LTgsIHRleHRfc2l6ZV94ICsgMTMsIDI2LCAwLCAwLCAwLCAoZGF0YVsyXSAvIDI1NSkgKiAxNTApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW5kZXJlci5yZWN0YW5nbGUoeCAtIDYgLSB0ZXh0X3NpemVfeCAvIDIsIHkgLSBvZmZzZXQtNywgdGV4dF9zaXplX3ggKyAxMSwgMjQsIDUwLCA1MCwgNTAsIChkYXRhWzJdIC8gMjU1KSAqIDI1NSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbmRlcmVyLnJlY3RhbmdsZSh4IC0gNCAtIHRleHRfc2l6ZV94IC8gMiwgeSAtIG9mZnNldC00LCB0ZXh0X3NpemVfeCArIDcsIDE4LCA4MCwgODAsIDgwLCAoZGF0YVsyXSAvIDI1NSkgKiAyNTUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW5kZXJlci5yZWN0YW5nbGUoeCAtIDMgLSB0ZXh0X3NpemVfeCAvIDIsIHkgLSBvZmZzZXQtMywgdGV4dF9zaXplX3ggKyA1LCAxNiwgMjAsIDIwLCAyMCwgKGRhdGFbMl0gLyAyNTUpICogMjAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVuZGVyZXIuZ3JhZGllbnQoeCAtIDMgLSB0ZXh0X3NpemVfeCAvIDIsIHkgLSBvZmZzZXQtMywgdGV4dF9zaXplX3gvMiszLCAxLCA3OCwxNjksMjQ5LCAoZGF0YVsyXSAvIDI1NSkgKiAyNTUsIDI1NCw4NiwyMTcsIChkYXRhWzJdIC8gMjU1KSAqIDI1NSwgdHJ1ZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbmRlcmVyLmdyYWRpZW50KHggLSAzLCB5IC0gb2Zmc2V0LTMsIHRleHRfc2l6ZV94LzIrNSwgMSwgMjU0LDg2LDIxNywgKGRhdGFbMl0gLyAyNTUpICogMjU1LCAyMTQsMjU1LDEwOCwgKGRhdGFbMl0gLyAyNTUpICogMjU1LCB0cnVlKQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW5kZXJlci5yZWN0YW5nbGUoeCAtIDcgLSB0ZXh0X3NpemVfeCAvIDIsIHkgLSBvZmZzZXQtNSwgdGV4dF9zaXplX3ggKyAxMywgMiwgMTQ1LCA5MCwgMTUwLCBkYXRhWzJdKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVuZGVyZXIucmVjdGFuZ2xlKHggLSA3IC0gdGV4dF9zaXplX3ggLyAyLCB5IC0gb2Zmc2V0LTUsIHRleHRfc2l6ZV94ICsgMTMsIDIwLCAwLCAwLCAwLCAoZGF0YVsyXSAvIDI1NSkgKiA1MCkKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIHJlbmRlcmVyLnRleHQoeCAtIDEgLSB0ZXh0X3NpemVfeCAvIDIsIHkgLSBvZmZzZXQsIDI1NSwgMjU1LCAyNTUsIGRhdGFbMl0sICIiLCAwLCBkYXRhWzFdKQogICAgICAgICAgICAgICAgICAgICAgICBpZiBkYXRhWzJdIDwgMC4xIG9yIG5vdCBlbnRpdHkuZ2V0X2xvY2FsX3BsYXllcigpIHRoZW4gdGFibGUucmVtb3ZlKGxvZ3MsIGlkeCkgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICByZW5kZXJlci5sb2cgPSBmdW5jdGlvbih0ZXh0KQogICAgICAgICAgICAgICAgICAgIHRhYmxlLmluc2VydChsb2dzLCB7IHRleHQsIDAsICgoZ2xvYmFscy5jdXJ0aW1lKCkgLyAyKSAqIDIuMCl9KQogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgbG9jYWwgaGl0Z3JvdXBfbmFtZXMgPSB7J2dlbmVyaWMnLCAnaGVhZCcsICdjaGVzdCcsICdzdG9tYWNoJywgJ2xlZnQgYXJtJywgJ3JpZ2h0IGFybScsICdsZWZ0IGxlZycsICdyaWdodCBsZWcnLCAnbmVjaycsICc/JywgJ2dlYXInfQoKICAgICAgICAgICAgICAgIGxvY2FsIGZ1bmN0aW9uIGFpbV9oaXQoZSkKICAgICAgICAgICAgICAgICAgICBpZiBub3QgbHVhX21lbnUubWlzYy5sb2c6Z2V0KCkgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgZ3JvdXAgPSBoaXRncm91cF9uYW1lc1tlLmhpdGdyb3VwICsgMV0gb3IgJz8nCiAgICAgICAgICAgICAgICAgICAgaWYgbHVhX21lbnUubWlzYy5sb2dfdHlwZTpnZXQoIlNjcmVlbiIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgcmVuZGVyZXIubG9nKHN0cmluZy5mb3JtYXQoJ0hpdCAlcyBpbiB0aGUgJXMgZm9yICVkIGRhbWFnZScsIGVudGl0eS5nZXRfcGxheWVyX25hbWUoZS50YXJnZXQpLCBncm91cCwgZS5kYW1hZ2UpKQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGlmIGx1YV9tZW51Lm1pc2MubG9nX3R5cGU6Z2V0KCJDb25zb2xlIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBwcmludChzdHJpbmcuZm9ybWF0KCdIaXQgJXMgaW4gdGhlICVzIGZvciAlZCBkYW1hZ2UnLCBlbnRpdHkuZ2V0X3BsYXllcl9uYW1lKGUudGFyZ2V0KSwgZ3JvdXAsIGUuZGFtYWdlKSkKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgY2xpZW50LnNldF9ldmVudF9jYWxsYmFjaygnYWltX2hpdCcsIGFpbV9oaXQpCgogICAgICAgICAgICAgICAgbG9jYWwgZnVuY3Rpb24gYWltX21pc3MoZSkKICAgICAgICAgICAgICAgICAgICBpZiBub3QgbHVhX21lbnUubWlzYy5sb2c6Z2V0KCkgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgZ3JvdXAgPSBoaXRncm91cF9uYW1lc1tlLmhpdGdyb3VwICsgMV0gb3IgJz8nCiAgICAgICAgICAgICAgICAgICAgaWYgbHVhX21lbnUubWlzYy5sb2dfdHlwZTpnZXQoIlNjcmVlbiIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgcmVuZGVyZXIubG9nKHN0cmluZy5mb3JtYXQoJ01pc3NlZCAlcyBpbiB0aGUgJXMgZHVlIHRvICVzJywgZW50aXR5LmdldF9wbGF5ZXJfbmFtZShlLnRhcmdldCksIGdyb3VwLCBlLnJlYXNvbikpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgaWYgbHVhX21lbnUubWlzYy5sb2dfdHlwZTpnZXQoIkNvbnNvbGUiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KHN0cmluZy5mb3JtYXQoJ01pc3NlZCAlcyBpbiB0aGUgJXMgZHVlIHRvICVzJywgZW50aXR5LmdldF9wbGF5ZXJfbmFtZShlLnRhcmdldCksIGdyb3VwLCBlLnJlYXNvbikpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGNsaWVudC5zZXRfZXZlbnRfY2FsbGJhY2soJ2FpbV9taXNzJywgYWltX21pc3MpCgogICAgICAgICAgICAgICAgbG9jYWwgcmdiYV90b19oZXggPSBmdW5jdGlvbihiLCBjLCBkLCBlKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBzdHJpbmcuZm9ybWF0KCclMDJ4JTAyeCUwMnglMDJ4JywgYiwgYywgZCwgZSkKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGxlcnAoYSwgYiwgdCkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gYSArIChiIC0gYSkgKiB0CiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBjbGFtcCh4LCBtaW52YWwsIG1heHZhbCkKICAgICAgICAgICAgICAgICAgICBpZiB4IDwgbWludmFsIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1pbnZhbAogICAgICAgICAgICAgICAgICAgIGVsc2VpZiB4ID4gbWF4dmFsIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1heHZhbAogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHgKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIGxvY2FsIGZ1bmN0aW9uIHRleHRfZmFkZV9hbmltYXRpb24oeCwgeSwgc3BlZWQsIGNvbG9yMSwgY29sb3IyLCB0ZXh0LCBmbGFnKQogICAgICAgICAgICAgICAgICAgIGxvY2FsIGZpbmFsX3RleHQgPSAnJwogICAgICAgICAgICAgICAgICAgIGxvY2FsIGN1cnRpbWUgPSBnbG9iYWxzLmN1cnRpbWUoKQogICAgICAgICAgICAgICAgICAgIGZvciBpID0gMCwgI3RleHQgZG8KICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgeCA9IGkgKiAxMCAgCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIHdhdmUgPSBtYXRoLmNvcyg4ICogc3BlZWQgKiBjdXJ0aW1lICsgeCAvIDMwKQogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBjb2xvciA9IHJnYmFfdG9faGV4KAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVycChjb2xvcjEuciwgY29sb3IyLnIsIGNsYW1wKHdhdmUsIDAsIDEpKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlcnAoY29sb3IxLmcsIGNvbG9yMi5nLCBjbGFtcCh3YXZlLCAwLCAxKSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXJwKGNvbG9yMS5iLCBjb2xvcjIuYiwgY2xhbXAod2F2ZSwgMCwgMSkpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3IxLmEKICAgICAgICAgICAgICAgICAgICAgICAgKSAKICAgICAgICAgICAgICAgICAgICAgICAgZmluYWxfdGV4dCA9IGZpbmFsX3RleHQgLi4gJ1xhJyAuLiBjb2xvciAuLiB0ZXh0OnN1YihpLCBpKSAKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICByZW5kZXJlci50ZXh0KHgsIHksIGNvbG9yMS5yLCBjb2xvcjEuZywgY29sb3IxLmIsIGNvbG9yMS5hLCBmbGFnLCBuaWwsIGZpbmFsX3RleHQpCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBsb2NhbCBmdW5jdGlvbiBkb3VibGV0YXBfY2hhcmdlZCgpCiAgICAgICAgICAgICAgICAgICAgaWYgbm90IHVpLmdldChyZWYuZHRbMV0pIG9yIG5vdCB1aS5nZXQocmVmLmR0WzJdKSBvciB1aS5nZXQocmVmLmZha2VkdWNrKSB0aGVuIHJldHVybiBmYWxzZSBlbmQKICAgICAgICAgICAgICAgICAgICBpZiBub3QgZW50aXR5LmlzX2FsaXZlKGVudGl0eS5nZXRfbG9jYWxfcGxheWVyKCkpIG9yIGVudGl0eS5nZXRfbG9jYWxfcGxheWVyKCkgPT0gbmlsIHRoZW4gcmV0dXJuIGVuZAogICAgICAgICAgICAgICAgICAgIGxvY2FsIHdlYXBvbiA9IGVudGl0eS5nZXRfcHJvcChlbnRpdHkuZ2V0X2xvY2FsX3BsYXllcigpLCAibV9oQWN0aXZlV2VhcG9uIikKICAgICAgICAgICAgICAgICAgICBpZiB3ZWFwb24gPT0gbmlsIHRoZW4gcmV0dXJuIGZhbHNlIGVuZAogICAgICAgICAgICAgICAgICAgIGxvY2FsIG5leHRfYXR0YWNrID0gZW50aXR5LmdldF9wcm9wKGVudGl0eS5nZXRfbG9jYWxfcGxheWVyKCksICJtX2ZsTmV4dEF0dGFjayIpICsgMC4wMQogICAgICAgICAgICAgICAgICAgIGxvY2FsIGNoZWNrY2hlY2sgPSBlbnRpdHkuZ2V0X3Byb3Aod2VhcG9uLCAibV9mbE5leHRQcmltYXJ5QXR0YWNrIikKICAgICAgICAgICAgICAgICAgICBpZiBjaGVja2NoZWNrID09IG5pbCB0aGVuIHJldHVybiBlbmQKICAgICAgICAgICAgICAgICAgICBsb2NhbCBuZXh0X3ByaW1hcnlfYXR0YWNrID0gY2hlY2tjaGVjayArIDAuMDEKICAgICAgICAgICAgICAgICAgICBpZiBuZXh0X2F0dGFjayA9PSBuaWwgb3IgbmV4dF9wcmltYXJ5X2F0dGFjayA9PSBuaWwgdGhlbiByZXR1cm4gZmFsc2UgZW5kCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5leHRfYXR0YWNrIC0gZ2xvYmFscy5jdXJ0aW1lKCkgPCAwIGFuZCBuZXh0X3ByaW1hcnlfYXR0YWNrIC0gZ2xvYmFscy5jdXJ0aW1lKCkgPCAwCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBsb2NhbCBzY29wZWRfc3BhY2UgPSAwCiAgICAgICAgICAgICAgICBsb2NhbCBtYWluX2ZvbnQgPSAiYy1iIgogICAgICAgICAgICAgICAgbG9jYWwga2V5X2ZvbnQgPSAiYyIKCiAgICAgICAgICAgICAgICBsb2NhbCBmdW5jdGlvbiBzY3JlZW5faW5kaWNhdG9yKCkKICAgICAgICAgICAgICAgICAgICBsb2NhbCBscCA9IGVudGl0eS5nZXRfbG9jYWxfcGxheWVyKCkKICAgICAgICAgICAgICAgICAgICBpZiBscCA9PSBuaWwgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgaW5kX3NpemUgPSByZW5kZXJlci5tZWFzdXJlX3RleHQoImNiIiwgImdlbmVzaXMiKQogICAgICAgICAgICAgICAgICAgIGxvY2FsIHNjcGQgPSBlbnRpdHkuZ2V0X3Byb3AobHAsICJtX2JJc1Njb3BlZCIpID09IDEKICAgICAgICAgICAgICAgICAgICBzY29wZWRfc3BhY2UgPSBtYXRoLmxlcnAoc2NvcGVkX3NwYWNlLCBzY3BkIGFuZCA1MCBvciAwLCAyMCkKICAgICAgICAgICAgICAgICAgICBsb2NhbCBjb25kaXRpb24gPSAic2hhcmUiCiAgICAgICAgICAgICAgICAgICAgaWYgaWQgPT0gMSB0aGVuIGNvbmRpdGlvbiA9ICJzaGFyZSIKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgaWQgPT0gMiB0aGVuIGNvbmRpdGlvbiA9ICJzdGFuZCIKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgaWQgPT0gMyB0aGVuIGNvbmRpdGlvbiA9ICJ3YWxrIgogICAgICAgICAgICAgICAgICAgIGVsc2VpZiBpZCA9PSA0IHRoZW4gY29uZGl0aW9uID0gInJ1biIKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgaWQgPT0gNSB0aGVuIGNvbmRpdGlvbiA9ICJhaXIiCiAgICAgICAgICAgICAgICAgICAgZWxzZWlmIGlkID09IDYgdGhlbiBjb25kaXRpb24gPSAiYWlyIgogICAgICAgICAgICAgICAgICAgIGVsc2VpZiBpZCA9PSA3IHRoZW4gY29uZGl0aW9uID0gImR1Y2siCiAgICAgICAgICAgICAgICAgICAgZWxzZWlmIGlkID09IDggdGhlbiBjb25kaXRpb24gPSAiZHVjayIgZW5kCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgc3BhY2VpbmQgPSAxMAoKICAgICAgICAgICAgICAgICAgICBpZiBsdWFfbWVudS5taXNjLmNyb3NzX2luZF90eXBlOmdldCgpID09ICJEZWZhdWx0IiB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIG1haW5fZm9udCA9ICJjLWIiCiAgICAgICAgICAgICAgICAgICAgICAgIGtleV9mb250ID0gImMiCiAgICAgICAgICAgICAgICAgICAgZWxzZWlmIGx1YV9tZW51Lm1pc2MuY3Jvc3NfaW5kX3R5cGU6Z2V0KCkgPT0gIk1vZGVybiIgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBtYWluX2ZvbnQgPSAiYy1iIgogICAgICAgICAgICAgICAgICAgICAgICBrZXlfZm9udCA9ICJjLWIiCiAgICAgICAgICAgICAgICAgICAgZWxzZWlmIGx1YV9tZW51Lm1pc2MuY3Jvc3NfaW5kX3R5cGU6Z2V0KCkgPT0gIkFsdGVybmF0aXZlIiB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIG1haW5fZm9udCA9ICJjIgogICAgICAgICAgICAgICAgICAgICAgICBrZXlfZm9udCA9ICJjIgogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgbWFpbl9mb250ID0gImMtZCIKICAgICAgICAgICAgICAgICAgICAgICAga2V5X2ZvbnQgPSAiYy1kIgogICAgICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgICAgICBsb2NhbCBuZXdfY2hlY2sgPSBsdWFfbWVudS5taXNjLmNyb3NzX2luZF90eXBlOmdldCgpID09ICJOZXdlc3QiCgogICAgICAgICAgICAgICAgICAgIGx1YV9tZW51Lm1pc2MuY3Jvc3NfY29sb3I6b3ZlcnJpZGUodHJ1ZSkKICAgICAgICAgICAgICAgICAgICBsdWFfbWVudS5taXNjLmtleV9jb2xvcjpvdmVycmlkZSh0cnVlKQogICAgICAgICAgICAgICAgICAgIGxvY2FsIHIxLCBnMSwgYjEsIGExID0gbHVhX21lbnUubWlzYy5jcm9zc19pbmQ6Z2V0X2NvbG9yKCkKICAgICAgICAgICAgICAgICAgICBsb2NhbCByMiwgZzIsIGIyLCBhMiA9IGx1YV9tZW51Lm1pc2MuY3Jvc3NfY29sb3I6Z2V0X2NvbG9yKCkKICAgICAgICAgICAgICAgICAgICBsb2NhbCByMywgZzMsIGIzLCBhMyA9IGx1YV9tZW51Lm1pc2Mua2V5X2NvbG9yOmdldF9jb2xvcigpCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgciwgZywgYiwgYSA9IDI1NSwgMjU1LCAyNTUsIDI1NQogICAgICAgICAgICAgICAgICAgIHRleHRfZmFkZV9hbmltYXRpb24oY2VudGVyWzFdICsgc2NvcGVkX3NwYWNlLCBjZW50ZXJbMl0gKyAzMCwgLTEsIHtyPXIxLCBnPWcxLCBiPWIxLCBhPTI1NX0sIHtyPXIyLCBnPWcyLCBiPWIyLCBhPTI1NX0sIG5ld19jaGVjayBhbmQgc3RyaW5nLnVwcGVyKCJnZW5lc2lzIikgb3IgImdlbmVzaXMiLCBtYWluX2ZvbnQpCiAgICAgICAgICAgICAgICAgICAgcmVuZGVyZXIudGV4dChjZW50ZXJbMV0gKyBzY29wZWRfc3BhY2UsIGNlbnRlclsyXSArIDQwLCByMiwgZzIsIGIyLCAyNTUsIG1haW5fZm9udCwgMCwgY29uZGl0aW9uKQoKICAgICAgICAgICAgICAgICAgICBpZiB1aS5nZXQocmVmLmZvcmNlYmFpbSl0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHJlbmRlcmVyLnRleHQoY2VudGVyWzFdICsgc2NvcGVkX3NwYWNlLCBjZW50ZXJbMl0gKyA0MCArIChzcGFjZWluZCksIDI1NSwgMTAyLCAxMTcsIDI1NSwga2V5X2ZvbnQsIDAsIG5ld19jaGVjayBhbmQgIkJPRFkiIG9yICJib2R5IikKICAgICAgICAgICAgICAgICAgICAgICAgc3BhY2VpbmQgPSBzcGFjZWluZCArIDEwCiAgICAgICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgICAgIGlmIHVpLmdldChyZWYub3NbMl0pIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgcmVuZGVyZXIudGV4dChjZW50ZXJbMV0gKyBzY29wZWRfc3BhY2UsIGNlbnRlclsyXSArIDQwICsgKHNwYWNlaW5kKSwgcjMsIGczLCBiMywgMjU1LCBrZXlfZm9udCwgMCwgbmV3X2NoZWNrIGFuZCAiT1NBQSIgb3Iib3NhYSIpCiAgICAgICAgICAgICAgICAgICAgICAgIHNwYWNlaW5kID0gc3BhY2VpbmQgKyAxMAogICAgICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgICAgICBpZiB1aS5nZXQocmVmLm1pbmltdW1fZGFtYWdlX292ZXJyaWRlWzJdKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHJlbmRlcmVyLnRleHQoY2VudGVyWzFdICsgc2NvcGVkX3NwYWNlLCBjZW50ZXJbMl0gKyA0MCArIChzcGFjZWluZCksIHIzLCBnMywgYjMsIDI1NSwga2V5X2ZvbnQsIDAsIG5ld19jaGVjayBhbmQgIkRNRyIgb3IiZG1nIikKICAgICAgICAgICAgICAgICAgICAgICAgc3BhY2VpbmQgPSBzcGFjZWluZCArIDEwCiAgICAgICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgICAgIGlmIHVpLmdldChyZWYuZHRbMV0pIGFuZCB1aS5nZXQocmVmLmR0WzJdKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGRvdWJsZXRhcF9jaGFyZ2VkKCkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVuZGVyZXIudGV4dChjZW50ZXJbMV0gKyBzY29wZWRfc3BhY2UsIGNlbnRlclsyXSArIDQwICsgKHNwYWNlaW5kKSwgcjMsIGczLCBiMywgYSwga2V5X2ZvbnQsIDAsIG5ld19jaGVjayBhbmQgIkRUIiBvciAiZHQiKQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW5kZXJlci50ZXh0KGNlbnRlclsxXSArIHNjb3BlZF9zcGFjZSwgY2VudGVyWzJdICsgNDAgKyAoc3BhY2VpbmQpLCAyNTUsIDAsIDAsIDI1NSwga2V5X2ZvbnQsIDAsIG5ld19jaGVjayBhbmQgIkRUIiBvciAiZHQiKQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgc3BhY2VpbmQgPSBzcGFjZWluZCArIDEwCiAgICAgICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgICAgIGlmIHVpLmdldChyZWYuZnJlZXN0YW5kWzFdKSBhbmQgdWkuZ2V0KHJlZi5mcmVlc3RhbmRbMl0pIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgcmVuZGVyZXIudGV4dChjZW50ZXJbMV0gKyBzY29wZWRfc3BhY2UsIGNlbnRlclsyXSArIDQwICsgKHNwYWNlaW5kKSwgcjMsIGczLCBiMywgYSwga2V5X2ZvbnQsIDAsIG5ld19jaGVjayBhbmQgIkZTIiBvciAiZnMiKQogICAgICAgICAgICAgICAgICAgICAgICBzcGFjZWluZCA9IHNwYWNlaW5kICsgMTAKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIGxvY2FsIGRlZmVuc2l2ZV9hbHBoYSA9IDAKICAgICAgICAgICAgICAgIGxvY2FsIGRlZmVuc2l2ZV9hbW91bnQgPSAwCiAgICAgICAgICAgICAgICBsb2NhbCB2ZWxvY2l0eV9hbHBoYSA9IDAKICAgICAgICAgICAgICAgIGxvY2FsIHZlbG9jaXR5X2Ftb3VudCA9IDAKCiAgICAgICAgICAgICAgICAtLWx1YV9tZW51Lm1pc2MudmVsb2NpdHlfc3R5bGUKICAgICAgICAgICAgICAgIC0tbHVhX21lbnUubWlzYy5kZWZlbnNpdmVfc3R5bGUKCiAgICAgICAgICAgICAgICBsb2NhbCBmdW5jdGlvbiB2ZWxvY2l0eV9pbmQoKQogICAgICAgICAgICAgICAgICAgIGxvY2FsIGxwID0gZW50aXR5LmdldF9sb2NhbF9wbGF5ZXIoKQogICAgICAgICAgICAgICAgICAgIGlmIGxwID09IG5pbCB0aGVuIHJldHVybiBlbmQKICAgICAgICAgICAgICAgICAgICBsb2NhbCByLCBnLCBiLCBhID0gbHVhX21lbnUubWlzYy52ZWxvY2l0eV93aW5kb3c6Z2V0X2NvbG9yKCkKICAgICAgICAgICAgICAgICAgICBsb2NhbCB2ZWxfbW9kID0gZW50aXR5LmdldF9wcm9wKGxwLCAnbV9mbFZlbG9jaXR5TW9kaWZpZXInKQogICAgICAgICAgICAgICAgICAgIGlmIG5vdCB1aS5pc19tZW51X29wZW4oKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHZlbG9jaXR5X2FscGhhID0gbWF0aC5sZXJwKHZlbG9jaXR5X2FscGhhLCB2ZWxfbW9kIDwgMSBhbmQgMjU1IG9yIDAsIDEwKQogICAgICAgICAgICAgICAgICAgICAgICB2ZWxvY2l0eV9hbW91bnQgPSBtYXRoLmxlcnAodmVsb2NpdHlfYW1vdW50LCB2ZWxfbW9kLCAxMCkKICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIHZlbG9jaXR5X2FscGhhID0gbWF0aC5sZXJwKHZlbG9jaXR5X2FscGhhLCAyNTUsIDEwKQogICAgICAgICAgICAgICAgICAgICAgICB2ZWxvY2l0eV9hbW91bnQgPSBnbG9iYWxzLnRpY2tjb3VudCgpICUgNTAvMTAwICogMgogICAgICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgICAgICByZW5kZXJlci50ZXh0KGNlbnRlclsxXSwgc2NyZWVuWzJdIC8gMyAtIDEwLCAyNTUsIDI1NSwgMjU1LCB2ZWxvY2l0eV9hbHBoYSwgImMiLCAwLCAiLSB2ZWxvY2l0eSAtIikKICAgICAgICAgICAgICAgICAgICBpZiBsdWFfbWVudS5taXNjLnZlbG9jaXR5X3N0eWxlOmdldCgpID09ICJEZWZhdWx0IiB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHJlbmRlcmVyLnJlY3RhbmdsZShjZW50ZXJbMV0tNTAsIHNjcmVlblsyXSAvIDMsIDEwMCwgNSwgMCwwLDAsIHZlbG9jaXR5X2FscGhhKQogICAgICAgICAgICAgICAgICAgICAgICByZW5kZXJlci5yZWN0YW5nbGUoY2VudGVyWzFdLTQ5LCBzY3JlZW5bMl0gLyAzKzEsICgxMDAqdmVsb2NpdHlfYW1vdW50KS0xLCAzLCByLCBnLCBiLCB2ZWxvY2l0eV9hbHBoYSkKICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIHJlbmRlcmVyLmdyYWRpZW50KHNjcmVlblsxXS8yIC0gKDUwICp2ZWxvY2l0eV9hbW91bnQpLCBzY3JlZW5bMl0gLyAzLCAxICsgNTAqdmVsb2NpdHlfYW1vdW50LCAyLCByLCBnLCBiLCB2ZWxvY2l0eV9hbHBoYS8zLCByLCBnLCBiLCB2ZWxvY2l0eV9hbHBoYSwgdHJ1ZSkKICAgICAgICAgICAgICAgICAgICAgICAgcmVuZGVyZXIuZ3JhZGllbnQoc2NyZWVuWzFdLzIsIHNjcmVlblsyXSAvIDMsIDUwKnZlbG9jaXR5X2Ftb3VudCwgMiwgciwgZywgYiwgdmVsb2NpdHlfYWxwaGEsIHIsIGcsIGIsIHZlbG9jaXR5X2FscGhhLzMsIHRydWUpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBsb2NhbCBmdW5jdGlvbiBkZWZlbnNpdmVfaW5kKCkKICAgICAgICAgICAgICAgICAgICBsb2NhbCBscCA9IGVudGl0eS5nZXRfbG9jYWxfcGxheWVyKCkKICAgICAgICAgICAgICAgICAgICBpZiBscCA9PSBuaWwgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgY2hhcmdlZCA9IGRvdWJsZXRhcF9jaGFyZ2VkKCkKICAgICAgICAgICAgICAgICAgICBsb2NhbCBhY3RpdmUgPSBpc19kZWZlbnNpdmVfYWN0aXZlKGxwKQogICAgICAgICAgICAgICAgICAgIGxvY2FsIHIsIGcsIGIsIGEgPSBsdWFfbWVudS5taXNjLmRlZmVuc2l2ZV93aW5kb3c6Z2V0X2NvbG9yKCkKICAgICAgICAgICAgICAgICAgICBpZiBub3QgdWkuaXNfbWVudV9vcGVuKCkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBpZiB1aS5nZXQocmVmLmR0WzFdKSBhbmQgdWkuZ2V0KHJlZi5kdFsyXSkgYW5kIG5vdCB1aS5nZXQocmVmLmZha2VkdWNrKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBjaGFyZ2VkIGFuZCBhY3RpdmUgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVuc2l2ZV9hbHBoYSA9IG1hdGgubGVycChkZWZlbnNpdmVfYWxwaGEsIDI1NSwgMTApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmZW5zaXZlX2Ftb3VudCA9IG1hdGgubGVycChkZWZlbnNpdmVfYW1vdW50LCAxLCAxMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VpZiBjaGFyZ2VkIGFuZCBub3QgYWN0aXZlIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZlbnNpdmVfYWxwaGEgPSBtYXRoLmxlcnAoZGVmZW5zaXZlX2FscGhhLCAwLCAxMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZlbnNpdmVfYW1vdW50ID0gbWF0aC5sZXJwKGRlZmVuc2l2ZV9hbW91bnQsIDAuNSwgMTApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmZW5zaXZlX2FscGhhID0gbWF0aC5sZXJwKGRlZmVuc2l2ZV9hbHBoYSwgMjU1LCAxMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZlbnNpdmVfYW1vdW50ID0gbWF0aC5sZXJwKGRlZmVuc2l2ZV9hbW91bnQsIDAsIDEwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVuc2l2ZV9hbHBoYSA9IG1hdGgubGVycChkZWZlbnNpdmVfYWxwaGEsIDAsIDEwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmZW5zaXZlX2Ftb3VudCA9IG1hdGgubGVycChkZWZlbnNpdmVfYW1vdW50LCAwLCAxMCkKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICBkZWZlbnNpdmVfYWxwaGEgPSBtYXRoLmxlcnAoZGVmZW5zaXZlX2FscGhhLCAyNTUsIDEwKQogICAgICAgICAgICAgICAgICAgICAgICBkZWZlbnNpdmVfYW1vdW50ID0gZ2xvYmFscy50aWNrY291bnQoKSAlIDUwLzEwMCAqIDIKICAgICAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICAgICAgcmVuZGVyZXIudGV4dChjZW50ZXJbMV0sIHNjcmVlblsyXSAvIDQgLSAxMCwgMjU1LCAyNTUsIDI1NSwgZGVmZW5zaXZlX2FscGhhLCAiYyIsIDAsICItIGRlZmVuc2l2ZSAtIikKICAgICAgICAgICAgICAgICAgICBpZiBsdWFfbWVudS5taXNjLmRlZmVuc2l2ZV9zdHlsZTpnZXQoKSA9PSAiRGVmYXVsdCIgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICByZW5kZXJlci5yZWN0YW5nbGUoY2VudGVyWzFdLTUwLCBzY3JlZW5bMl0gLyA0LCAxMDAsIDUsIDAsMCwwLCBkZWZlbnNpdmVfYWxwaGEpCiAgICAgICAgICAgICAgICAgICAgICAgIHJlbmRlcmVyLnJlY3RhbmdsZShjZW50ZXJbMV0tNDksIHNjcmVlblsyXSAvIDQrMSwgKDEwMCpkZWZlbnNpdmVfYW1vdW50KS0xLCAzLCByLCBnLCBiLCBkZWZlbnNpdmVfYWxwaGEpCiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICByZW5kZXJlci5ncmFkaWVudChzY3JlZW5bMV0vMiAtICg1MCAqZGVmZW5zaXZlX2Ftb3VudCksIHNjcmVlblsyXSAvIDQsIDEgKyA1MCpkZWZlbnNpdmVfYW1vdW50LCAyLCByLCBnLCBiLCBkZWZlbnNpdmVfYWxwaGEvMywgciwgZywgYiwgZGVmZW5zaXZlX2FscGhhLCB0cnVlKQogICAgICAgICAgICAgICAgICAgICAgICByZW5kZXJlci5ncmFkaWVudChzY3JlZW5bMV0vMiwgc2NyZWVuWzJdIC8gNCwgNTAqZGVmZW5zaXZlX2Ftb3VudCwgMiwgciwgZywgYiwgZGVmZW5zaXZlX2FscGhhLCByLCBnLCBiLCBkZWZlbnNpdmVfYWxwaGEvMywgdHJ1ZSkKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIGxvY2FsIGZ1bmN0aW9uIGluZm9fcGFuZWwoKQogICAgICAgICAgICAgICAgICAgIGxvY2FsIGxwID0gZW50aXR5LmdldF9sb2NhbF9wbGF5ZXIoKQogICAgICAgICAgICAgICAgICAgIGlmIGxwID09IG5pbCB0aGVuIHJldHVybiBlbmQKICAgICAgICAgICAgICAgICAgICBsb2NhbCBjb25kaXRpb24gPSAic2hhcmUiCiAgICAgICAgICAgICAgICAgICAgaWYgaWQgPT0gMSB0aGVuIGNvbmRpdGlvbiA9ICJzaGFyZSIKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgaWQgPT0gMiB0aGVuIGNvbmRpdGlvbiA9ICJzdGFuZCIKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgaWQgPT0gMyB0aGVuIGNvbmRpdGlvbiA9ICJ3YWxrIgogICAgICAgICAgICAgICAgICAgIGVsc2VpZiBpZCA9PSA0IHRoZW4gY29uZGl0aW9uID0gInJ1biIKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgaWQgPT0gNSB0aGVuIGNvbmRpdGlvbiA9ICJhaXIiCiAgICAgICAgICAgICAgICAgICAgZWxzZWlmIGlkID09IDYgdGhlbiBjb25kaXRpb24gPSAiYWlyIgogICAgICAgICAgICAgICAgICAgIGVsc2VpZiBpZCA9PSA3IHRoZW4gY29uZGl0aW9uID0gImR1Y2siCiAgICAgICAgICAgICAgICAgICAgZWxzZWlmIGlkID09IDggdGhlbiBjb25kaXRpb24gPSAiZHVjayIgZW5kCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgdGhyZWF0ID0gY2xpZW50LmN1cnJlbnRfdGhyZWF0KCkKICAgICAgICAgICAgICAgICAgICBsb2NhbCBuYW1lID0gIm5pbCIKICAgICAgICAgICAgICAgICAgICBsb2NhbCB0aHJlYXRfZGVzeW5jID0gMAogICAgICAgICAgICAgICAgICAgIGxvY2FsIHNob3dlZF9uYW1lID0gIkFkbWluIgogICAgICAgICAgICAgICAgICAgIGlmIHRocmVhdCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWUgPSBlbnRpdHkuZ2V0X3BsYXllcl9uYW1lKHRocmVhdCkKICAgICAgICAgICAgICAgICAgICAgICAgdGhyZWF0X2Rlc3luYyA9IG1hdGguZmxvb3IoZW50aXR5LmdldF9wcm9wKHRocmVhdCwgJ21fZmxQb3NlUGFyYW1ldGVyJywgMTEpICogMTIwIC0gNjApCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgc2hvd2VkX25hbWUgPSBzaG93ZWRfbmFtZTpzdWIoMSwgMTIpCiAgICAgICAgICAgICAgICAgICAgbmFtZSA9IG5hbWU6c3ViKDEsIDEyKQoKICAgICAgICAgICAgICAgICAgICBsb2NhbCBkZXN5bmNfYW1vdW50ID0gbWF0aC5mbG9vcihlbnRpdHkuZ2V0X3Byb3AobHAsICdtX2ZsUG9zZVBhcmFtZXRlcicsIDExKSAqIDEyMCAtIDYwKQogICAgICAgICAgICAgICAgICAgIHRleHRfZmFkZV9hbmltYXRpb24oMjAsIGNlbnRlclsyXSwgLTEsIHtyPTIwMCwgZz0yMDAsIGI9MjAwLCBhPTI1NX0sIHtyPTE1MCwgZz0xNTAsIGI9MTUwLCBhPTI1NX0sICJnZW5lc2lzLmx1YSB+IGFscGhhIiwgImQiKQogICAgICAgICAgICAgICAgICAgIGxvY2FsIHRleHRzaXplID0gcmVuZGVyZXIubWVhc3VyZV90ZXh0KCJkIiwgImdlbmVzaXMubHVhIH4gYWxwaGEiKQogICAgICAgICAgICAgICAgICAgIHJlbmRlcmVyLmdyYWRpZW50KDIwLCBjZW50ZXJbMl0gKyAxNSwgdGV4dHNpemUvMiwgMiwgMjU1LCAyNTUsIDI1NSwgNTAsIDI1NSwgMjU1LCAyNTUsIDI1NSwgdHJ1ZSkKICAgICAgICAgICAgICAgICAgICByZW5kZXJlci5ncmFkaWVudCgyMCArIHRleHRzaXplLzIsY2VudGVyWzJdICsgMTUsIHRleHRzaXplLzIsIDIsIDI1NSwgMjU1LCAyNTUsIDI1NSwgMjU1LCAyNTUsIDI1NSwgNTAsIHRydWUpCiAgICAgICAgICAgICAgICAgICAgcmVuZGVyZXIudGV4dCgyMCwgY2VudGVyWzJdICsgMjAsIDI1NSwgMjU1LCAyNTUsIDI1NSwgImQiLCAwLCAidXNlcjogIi4uc3RyaW5nLmxvd2VyKHNob3dlZF9uYW1lKSkKICAgICAgICAgICAgICAgICAgICByZW5kZXJlci50ZXh0KDIwLCBjZW50ZXJbMl0gKyAzMCwgMjU1LCAyNTUsIDI1NSwgMjU1LCAiZCIsIDAsICJzdGF0ZTogIi4uY29uZGl0aW9uLi4iICIuLm1hdGguYWJzKGRlc3luY19hbW91bnQpLi4iwrAiKQogICAgICAgICAgICAgICAgICAgIHJlbmRlcmVyLnRleHQoMjAsIGNlbnRlclsyXSArIDQwLCAyNTUsIDI1NSwgMjU1LCAyNTUsICJkIiwgMCwgInRhcmdldDogIi4uc3RyaW5nLmxvd2VyKG5hbWUpLi4iICIuLm1hdGguYWJzKHRocmVhdF9kZXN5bmMpLi4iwrAiKQogICAgICAgICAgICAgICAgICAgIGlmIGx1YV9tZW51Lm1pc2MucmVzb2x2ZXI6Z2V0KCkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICByZW5kZXJlci50ZXh0KDIwLCBjZW50ZXJbMl0gKyA1MCwgMjU1LCAyNTUsIDI1NSwgMjU1LCAiZCIsIDAsICJyZXNvbHZlcjogIi4uc3RyaW5nLmxvd2VyKGx1YV9tZW51Lm1pc2MucmVzb2x2ZXJfdHlwZTpnZXQoKSkpCiAgICAgICAgICAgICAgICAgICAgZW5kIAogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgbG9jYWwgd3NfY2xhbnRhZyA9IHsKICAgICAgICAgICAgICAgICAgICAiZ2UiLAogICAgICAgICAgICAgICAgICAgICJnZW4iLAogICAgICAgICAgICAgICAgICAgICJnZW5lIiwKICAgICAgICAgICAgICAgICAgICAiZ2VuZXMiLAogICAgICAgICAgICAgICAgICAgICJnZW5lc2kiLAogICAgICAgICAgICAgICAgICAgICJnZW5lc2lzIiwKICAgICAgICAgICAgICAgICAgICAiZ2VuZXNpcyIsCiAgICAgICAgICAgICAgICAgICAgImdlbmVzaSIsCiAgICAgICAgICAgICAgICAgICAgImdlbmVzIiwKICAgICAgICAgICAgICAgICAgICAiZ2VuZSIsCiAgICAgICAgICAgICAgICAgICAgImdlbiIsCiAgICAgICAgICAgICAgICAgICAgImdlIiwKICAgICAgICAgICAgICAgICAgICAiZyIsCiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgbG9jYWwgaXRlciA9IDEKICAgICAgICAgICAgICAgIGxvY2FsIHdzdGltZSA9IDAKICAgICAgICAgICAgICAgIGxvY2FsIGZ1bmN0aW9uIHJvdGF0ZV9zdHJpbmcoKQogICAgICAgICAgICAgICAgICAgIGxvY2FsIHJldF9zdHIgPSB3c19jbGFudGFnW2l0ZXJdCiAgICAgICAgICAgICAgICAgICAgaWYgaXRlciA8IDEzIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgaXRlciA9IGl0ZXIgKyAxCiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICBpdGVyID0gMQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIHJldHVybiByZXRfc3RyCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBsb2NhbCBmdW5jdGlvbiBjbGFudGFnX2VuKCkKICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmLmNsYW50YWcsIGZhbHNlKQogICAgICAgICAgICAgICAgICAgIGlmIHdzdGltZSArIDAuMyA8IGdsb2JhbHMuY3VydGltZSgpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgY2xpZW50LnNldF9jbGFuX3RhZyhyb3RhdGVfc3RyaW5nKCkpCiAgICAgICAgICAgICAgICAgICAgICAgIHdzdGltZSA9IGdsb2JhbHMuY3VydGltZSgpCiAgICAgICAgICAgICAgICAgICAgZWxzZWlmIHdzdGltZSA+IGdsb2JhbHMuY3VydGltZSgpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgd3N0aW1lID0gZ2xvYmFscy5jdXJ0aW1lKCkKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIGxvY2FsIGZ1bmN0aW9uIGZhc3RsYWRkZXIoZSkKICAgICAgICAgICAgICAgICAgICBsb2NhbCBsb2NhbF9wbGF5ZXIgPSBlbnRpdHkuZ2V0X2xvY2FsX3BsYXllcigpCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgcGl0Y2gsIHlhdyA9IGNsaWVudC5jYW1lcmFfYW5nbGVzKCkKICAgICAgICAgICAgICAgICAgICBpZiBlbnRpdHkuZ2V0X3Byb3AobG9jYWxfcGxheWVyLCAibV9Nb3ZlVHlwZSIpID09IDkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBlLnlhdyA9IG1hdGguZmxvb3IoZS55YXcrMC41KQogICAgICAgICAgICAgICAgICAgICAgICBlLnJvbGwgPSAwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBlLmZvcndhcmRtb3ZlID09IDAgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGUuc2lkZW1vdmUgfj0gMCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUucGl0Y2ggPSA4OQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnlhdyA9IGUueWF3ICsgMTgwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGUuc2lkZW1vdmUgPCAwIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUuaW5fbW92ZWxlZnQgPSAwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLmluX21vdmVyaWdodCA9IDEKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGUuc2lkZW1vdmUgPiAwIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUuaW5fbW92ZWxlZnQgPSAxCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLmluX21vdmVyaWdodCA9IDAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGUuZm9yd2FyZG1vdmUgPiAwIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBwaXRjaCA8IDQ1IHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5waXRjaCA9IDg5CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUuaW5fbW92ZXJpZ2h0ID0gMQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLmluX21vdmVsZWZ0ID0gMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLmluX2ZvcndhcmQgPSAwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUuaW5fYmFjayA9IDEKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgZS5zaWRlbW92ZSA9PSAwIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUueWF3ID0gZS55YXcgKyA5MAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgZS5zaWRlbW92ZSA8IDAgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZS55YXcgPSBlLnlhdyArIDE1MAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgZS5zaWRlbW92ZSA+IDAgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZS55YXcgPSBlLnlhdyArIDMwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgZS5mb3J3YXJkbW92ZSA8IDAgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUucGl0Y2ggPSA4OQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUuaW5fbW92ZWxlZnQgPSAxCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5pbl9tb3ZlcmlnaHQgPSAwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5pbl9mb3J3YXJkID0gMQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUuaW5fYmFjayA9IDAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBlLnNpZGVtb3ZlID09IDAgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnlhdyA9IGUueWF3ICsgOTAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBlLnNpZGVtb3ZlID4gMCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUueWF3ID0gZS55YXcgKyAxNTAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBlLnNpZGVtb3ZlIDwgMCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUueWF3ID0gZS55YXcgKyAzMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBsb2NhbCBmdW5jdGlvbiB0aGlyZHBlcnNvbih2YWx1ZSkKICAgICAgICAgICAgICAgICAgICBpZiB2YWx1ZSB+PSBuaWwgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBjdmFyLmNhbV9pZGVhbGRpc3Q6c2V0X2ludCh2YWx1ZSkKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIGxvY2FsIGZ1bmN0aW9uIGFzcGVjdHJhdGlvKHZhbHVlKQogICAgICAgICAgICAgICAgICAgIGlmIHZhbHVlIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgY3Zhci5yX2FzcGVjdHJhdGlvOnNldF9mbG9hdCh2YWx1ZSkKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZCAKCiAgICAgICAgICAgICAgICBsb2NhbCBuYXRpdmVfR2V0Q2xpZW50RW50aXR5ID0gdnRhYmxlX2JpbmQoJ2NsaWVudC5kbGwnLCAnVkNsaWVudEVudGl0eUxpc3QwMDMnLCAzLCAndm9pZCooX190aGlzY2FsbCopKHZvaWQqLCBpbnQpJykKCiAgICAgICAgICAgICAgICBtYXRoLmNsYW1wID0gZnVuY3Rpb24gKHgsIGEsIGIpCiAgICAgICAgICAgICAgICAgICAgaWYgYSA+IHggdGhlbiByZXR1cm4gYQogICAgICAgICAgICAgICAgICAgIGVsc2VpZiBiIDwgeCB0aGVuIHJldHVybiBiCiAgICAgICAgICAgICAgICAgICAgZWxzZSByZXR1cm4geCBlbmQKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIGxvY2FsIGV4cHJlcyA9IHt9CgogICAgICAgICAgICAgICAgZXhwcmVzLmdldF9wcmV2X3NpbXRpbWUgPSBmdW5jdGlvbihlbnQpCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgZW50X3B0ciA9IG5hdGl2ZV9HZXRDbGllbnRFbnRpdHkoZW50KSAgICAKICAgICAgICAgICAgICAgICAgICBpZiBlbnRfcHRyIH49IG5pbCB0aGVuIAogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmZpLmNhc3QoJ2Zsb2F0KicsIGZmaS5jYXN0KCd1aW50cHRyX3QnLCBlbnRfcHRyKSArIDB4MjZDKVswXSAKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIGV4cHJlcy5yZXN0b3JlID0gZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIGZvciBpID0gMSwgNjQgZG8KICAgICAgICAgICAgICAgICAgICAgICAgcGxpc3Quc2V0KGksICJGb3JjZSBib2R5IHlhdyIsIGZhbHNlKQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgZXhwcmVzLmJvZHlfeWF3LCBleHByZXMuZXllX2FuZ2xlcyA9IHt9LCB7fQoKICAgICAgICAgICAgICAgIGV4cHJlcy5nZXRfbWF4X2Rlc3luYyA9IGZ1bmN0aW9uIChhbmltc3RhdGUpCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgc3BlZWRmYWN0b3IgPSBtYXRoLmNsYW1wKGFuaW1zdGF0ZS5mZWV0X3NwZWVkX2ZvcndhcmRzX29yX3NpZGV3YXlzLCAwLCAxKQogICAgICAgICAgICAgICAgICAgIGxvY2FsIGF2Z19zcGVlZGZhY3RvciA9IChhbmltc3RhdGUuc3RvcF90b19mdWxsX3J1bm5pbmdfZnJhY3Rpb24gKiAtMC4zIC0gMC4yKSAqIHNwZWVkZmFjdG9yICsgMQoKICAgICAgICAgICAgICAgICAgICBsb2NhbCBkdWNrX2Ftb3VudCA9IGFuaW1zdGF0ZS5kdWNrX2Ftb3VudAogICAgICAgICAgICAgICAgICAgIGlmIGR1Y2tfYW1vdW50ID4gMCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGF2Z19zcGVlZGZhY3RvciA9IGF2Z19zcGVlZGZhY3RvciArIChkdWNrX2Ftb3VudCAqIHNwZWVkZmFjdG9yICogKDAuNSAtIGF2Z19zcGVlZGZhY3RvcikpCiAgICAgICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgICAgIHJldHVybiBtYXRoLmNsYW1wKGF2Z19zcGVlZGZhY3RvciwgLjUsIDEpCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBleHByZXMuaGFuZGxlID0gZnVuY3Rpb24oY3VycmVudF90aHJlYXQpCiAgICAgICAgICAgICAgICAgICAgaWYgY3VycmVudF90aHJlYXQgPT0gbmlsIG9yIG5vdCBlbnRpdHkuaXNfYWxpdmUoY3VycmVudF90aHJlYXQpIG9yIGVudGl0eS5pc19kb3JtYW50KGN1cnJlbnRfdGhyZWF0KSB0aGVuIAogICAgICAgICAgICAgICAgICAgICAgICBleHByZXMucmVzdG9yZSgpCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAKICAgICAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICAgICAgaWYgZXhwcmVzLmJvZHlfeWF3W2N1cnJlbnRfdGhyZWF0XSA9PSBuaWwgdGhlbiAKICAgICAgICAgICAgICAgICAgICAgICAgZXhwcmVzLmJvZHlfeWF3W2N1cnJlbnRfdGhyZWF0XSwgZXhwcmVzLmV5ZV9hbmdsZXNbY3VycmVudF90aHJlYXRdID0ge30sIHt9CiAgICAgICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgICAgIGxvY2FsIHNpbXRpbWUgPSB0b3RpY2tzKGVudGl0eS5nZXRfcHJvcChjdXJyZW50X3RocmVhdCwgJ21fZmxTaW11bGF0aW9uVGltZScpKQogICAgICAgICAgICAgICAgICAgIGxvY2FsIHByZXZfc2ltdGltZSA9IHRvdGlja3MoZXhwcmVzLmdldF9wcmV2X3NpbXRpbWUoY3VycmVudF90aHJlYXQpKQogICAgICAgICAgICAgICAgICAgIGV4cHJlcy5ib2R5X3lhd1tjdXJyZW50X3RocmVhdF1bc2ltdGltZV0gPSBlbnRpdHkuZ2V0X3Byb3AoY3VycmVudF90aHJlYXQsICdtX2ZsUG9zZVBhcmFtZXRlcicsIDExKSAqIDEyMCAtIDYwCiAgICAgICAgICAgICAgICAgICAgZXhwcmVzLmV5ZV9hbmdsZXNbY3VycmVudF90aHJlYXRdW3NpbXRpbWVdID0gc2VsZWN0KDIsIGVudGl0eS5nZXRfcHJvcChjdXJyZW50X3RocmVhdCwgIm1fYW5nRXllQW5nbGVzIikpCgogICAgICAgICAgICAgICAgICAgIGlmIGV4cHJlcy5ib2R5X3lhd1tjdXJyZW50X3RocmVhdF1bcHJldl9zaW10aW1lXSB+PSBuaWwgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBlbnQgPSBjX2VudGl0eS5uZXcoY3VycmVudF90aHJlYXQpCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGFuaW1zdGF0ZSA9IGVudDpnZXRfYW5pbV9zdGF0ZSgpCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIG1heF9kZXN5bmMgPSBleHByZXMuZ2V0X21heF9kZXN5bmMoYW5pbXN0YXRlKQogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBQaXRjaCA9IGVudGl0eS5nZXRfcHJvcChjdXJyZW50X3RocmVhdCwgIm1fYW5nRXllQW5nbGVzWzBdIikKICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgcGl0Y2hfZSA9IFBpdGNoID4gLTMwIGFuZCBQaXRjaCA8IDQ5CiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGN1cnJfc2lkZSA9IGdsb2JhbHMudGlja2NvdW50KCkgJSA0ID4gMSBhbmQgMSBvciAtIDEKCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGx1YV9tZW51Lm1pc2MucmVzb2x2ZXJfdHlwZTpnZXQoKSA9PSAiU2FmZSIgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgc2hvdWxkX2NvcnJlY3QgPSAoc2ltdGltZSAtIHByZXZfc2ltdGltZSA+PSAxKSBhbmQgbWF0aC5hYnMobWF4X2Rlc3luYykgPCA0NSBhbmQgZXhwcmVzLmJvZHlfeWF3W2N1cnJlbnRfdGhyZWF0XVtwcmV2X3NpbXRpbWVdIH49IDAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHNob3VsZF9jb3JyZWN0IHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCB2YWx1ZSA9IG1hdGgucmFuZG9tKDAsIGV4cHJlcy5ib2R5X3lhd1tjdXJyZW50X3RocmVhdF1bcHJldl9zaW10aW1lXSAqIG1hdGgucmFuZG9tKC0xLCAxKSkgKiAuMjUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGlzdC5zZXQoY3VycmVudF90aHJlYXQsICdGb3JjZSBib2R5IHlhdycsIHRydWUpICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGlzdC5zZXQoY3VycmVudF90aHJlYXQsICdGb3JjZSBib2R5IHlhdyB2YWx1ZScsIHZhbHVlKSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGlzdC5zZXQoY3VycmVudF90aHJlYXQsICdGb3JjZSBib2R5IHlhdycsIGZhbHNlKSAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZWlmIGx1YV9tZW51Lm1pc2MucmVzb2x2ZXJfdHlwZTpnZXQoKSA9PSAiRXhwZXJpbWVudGFsIiB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBwaXRjaF9lIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZV9ib2R5ID0gMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlX2JvZHkgPSBjdXJyX3NpZGUgKiAobWF4X2Rlc3luYyAqIG1hdGgucmFuZG9tKDAsIDU4KSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxpc3Quc2V0KGN1cnJlbnRfdGhyZWF0LCAnRm9yY2UgYm9keSB5YXcnLCB0cnVlKSAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGlzdC5zZXQoY3VycmVudF90aHJlYXQsICdGb3JjZSBib2R5IHlhdyB2YWx1ZScsIHZhbHVlX2JvZHkpIAogICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBub3QgaXNfZGVmZW5zaXZlX3Jlc29sdmVyKGN1cnJlbnRfdGhyZWF0KSB0aGVuIHJldHVybiBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHBpdGNoX2UgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlX2JvZHkgPSAwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVfYm9keSA9IG1hdGgucmFuZG9tKDAsIGV4cHJlcy5ib2R5X3lhd1tjdXJyZW50X3RocmVhdF1bcHJldl9zaW10aW1lXSAqIG1hdGgucmFuZG9tKC0xLCAxKSkgKiAuMjUKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxpc3Quc2V0KGN1cnJlbnRfdGhyZWF0LCAnRm9yY2UgYm9keSB5YXcnLCB0cnVlKSAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGlzdC5zZXQoY3VycmVudF90aHJlYXQsICdGb3JjZSBib2R5IHlhdyB2YWx1ZScsIHZhbHVlX2JvZHkpIAogICAgICAgICAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgcGxpc3Quc2V0KGN1cnJlbnRfdGhyZWF0LCAnQ29ycmVjdGlvbiBhY3RpdmUnLCB0cnVlKQogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgbG9jYWwgZnVuY3Rpb24gcmVzb2x2ZXJfdXBkYXRlKCkKICAgICAgICAgICAgICAgICAgICBsb2NhbCBscCA9IGVudGl0eS5nZXRfbG9jYWxfcGxheWVyKCkKICAgICAgICAgICAgICAgICAgICBpZiBub3QgbHAgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgZW50aXRpZXMgPSBlbnRpdHkuZ2V0X3BsYXllcnModHJ1ZSkKICAgICAgICAgICAgICAgICAgICBpZiBub3QgZW50aXRpZXMgdGhlbiByZXR1cm4gZW5kCgogICAgICAgICAgICAgICAgICAgIGZvciBpID0gMSwgI2VudGl0aWVzIGRvCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIHRhcmdldCA9IGVudGl0aWVzW2ldCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIG5vdCB0YXJnZXQgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIG5vdCBlbnRpdHkuaXNfYWxpdmUodGFyZ2V0KSB0aGVuIHJldHVybiBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgZXhwcmVzLmhhbmRsZSh0YXJnZXQpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBsb2NhbCBwaHJhc2VzID0gewogICAgICAgICAgICAgICAgICAgICLilrbigKIgxLFsxLHEsWzEscSxbMSxxLFsxLHEsWzEscSxbMSxIO+9h++9he+9ju+9he+9k++9ie+9kyIsCiAgICAgICAgICAgICAgICAgICAgIuKZoSDvvYfvvYHvvY3vvYXvvZPvvYXvvY7vvZPvvYUg4ZutIO+9h++9he+9ju+9he+9k++9ie+9kyDimaEiLAogICAgICAgICAgICAgICAgICAgICLimZsg772H772B772N772F772T772F772O772T772FIOKZmyIsCiAgICAgICAgICAgICAgICAgICAgIu+9h++9he+9ju+9he+9k++9ie+9ky7vvYzvvZXvvYEg772H772B772W772FIO+9je+9hSDvvYEg772H772P772E772N772P772E772FIiwKICAgICAgICAgICAgICAgICAgICAi772F772T772U772LICDvvZPvvZXvvYnvvYPvvYnvvYTvvYXvvYQgIO+9l++9iO+9he+9jiAg772H772F772O772F772T772J772TLu+9jO+9le+9gSAg772S772F772M772F772B772T772F772EIiwKICAgICAgICAgICAgICAgICAgICAi4pmbIO+9gu+9jO+9ge+9je+9he+9jO+9he+9k++9kyDvvJEg77yTIO+8kyDvvJcg4pmbIiwKICAgICAgICAgICAgICAgICAgICAiKCDiuJ3iuJ3CtOqSs2DiuJ3iuJ0pIPCWua0g772H772F772O772F772T772J772TIOKZoSIsCiAgICAgICAgICAgICAgICAgICAgIvCWua0g772T772M772F772F772QIPCWua0iLAogICAgICAgICAgICAgICAgICAgICLiloTvuLvjg4filZDilZDilIHkuIDwn5KoIHBybzEwMCDvvYLvvYzvvYHvvY3vvYXvvYzvvYXvvZPvvZMiLAogICAgICAgICAgICAgICAgICAgICLvvZTvvYHvvZDvvZDvvYXvvYQg772C772ZIO+9h++9he+9ju+9he+9k++9ie+9kyDvvZLvvYXvvZPvvY/vvYzvvZbvvYXvvZIiLAogICAgICAgICAgICAgICAgICAgICLjgIzinKbJouG0h8m04bSHc8mqc+KcpuOAjSIsCiAgICAgICAgICAgICAgICAgICAgIsmi4bSHybThtIdzyapzIMqf4bSc4bSAIOG0j+G0ocm0cyDhtI3htIcg4bSAybThtIUg4bSAyp/KnyIsCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgbG9jYWwgdXNlcmlkX3RvX2VudGluZGV4LCBnZXRfbG9jYWxfcGxheWVyLCBpc19lbmVteSwgY29uc29sZV9jbWQgPSBjbGllbnQudXNlcmlkX3RvX2VudGluZGV4LCBlbnRpdHkuZ2V0X2xvY2FsX3BsYXllciwgZW50aXR5LmlzX2VuZW15LCBjbGllbnQuZXhlYwoKICAgICAgICAgICAgICAgIGxvY2FsIGZ1bmN0aW9uIG9uX3BsYXllcl9kZWF0aChlKQogICAgICAgICAgICAgICAgICAgIGlmIG5vdCBsdWFfbWVudS5taXNjLnNwYW1tZXJzOmdldCgiVHJhc2hUYWxrIikgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgICAgICAgICAgICAgaWYgbm90IGx1YV9tZW51Lm1haW4uZW5hYmxlOmdldCgpIHRoZW4gcmV0dXJuIGVuZAoKICAgICAgICAgICAgICAgICAgICBsb2NhbCB2aWN0aW1fdXNlcmlkLCBhdHRhY2tlcl91c2VyaWQgPSBlLnVzZXJpZCwgZS5hdHRhY2tlcgogICAgICAgICAgICAgICAgICAgIGlmIHZpY3RpbV91c2VyaWQgPT0gbmlsIG9yIGF0dGFja2VyX3VzZXJpZCA9PSBuaWwgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgdmljdGltX2VudGluZGV4ID0gdXNlcmlkX3RvX2VudGluZGV4KHZpY3RpbV91c2VyaWQpCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgYXR0YWNrZXJfZW50aW5kZXggPSB1c2VyaWRfdG9fZW50aW5kZXgoYXR0YWNrZXJfdXNlcmlkKQoKICAgICAgICAgICAgICAgICAgICBpZiBhdHRhY2tlcl9lbnRpbmRleCA9PSBnZXRfbG9jYWxfcGxheWVyKCkgYW5kIGlzX2VuZW15KHZpY3RpbV9lbnRpbmRleCkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBjbGllbnQuZGVsYXlfY2FsbCgyLCBmdW5jdGlvbigpIGNvbnNvbGVfY21kKCJzYXkgIiwgcGhyYXNlc1ttYXRoLnJhbmRvbSgxLCAjcGhyYXNlcyldKSBlbmQpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGNsaWVudC5zZXRfZXZlbnRfY2FsbGJhY2soInBsYXllcl9kZWF0aCIsIG9uX3BsYXllcl9kZWF0aCkKCiAgICAgICAgICAgICAgICBsb2NhbCBjb25maWdfaXRlbXMgPSB7bWVudSwgYW50aWFpbV9zeXN0ZW19CgogICAgICAgICAgICAgICAgbG9jYWwgcGFja2FnZSwgZGF0YSwgZW5jcnlwdGVkLCBkZWNyeXB0ZWQgPSBwdWkuc2V0dXAoY29uZmlnX2l0ZW1zKSwgIiIsICIiLCAiIgogICAgICAgICAgICAgICAgY29uZmlnID0ge30KCiAgICAgICAgICAgICAgICBjb25maWcuZXhwb3J0ID0gZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIGRhdGEgPSBwYWNrYWdlOnNhdmUoKQogICAgICAgICAgICAgICAgICAgIGVuY3J5cHRlZCA9IGJhc2U2NC5lbmNvZGUoanNvbi5zdHJpbmdpZnkoZGF0YSkpCiAgICAgICAgICAgICAgICAgICAgY2xpcGJvYXJkLnNldChlbmNyeXB0ZWQpCiAgICAgICAgICAgICAgICAgICAgcHJpbnQoIkV4cG9ydGVkIikKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIGNvbmZpZy5pbXBvcnQgPSBmdW5jdGlvbihpbnB1dCkKICAgICAgICAgICAgICAgICAgICBkZWNyeXB0ZWQgPSBqc29uLnBhcnNlKGJhc2U2NC5kZWNvZGUoaW5wdXQgfj0gbmlsIGFuZCBpbnB1dCBvciBjbGlwYm9hcmQuZ2V0KCkpKQogICAgICAgICAgICAgICAgICAgIHBhY2thZ2U6bG9hZChkZWNyeXB0ZWQpCiAgICAgICAgICAgICAgICAgICAgcHJpbnQoIkltcG9ydGVkIikKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIGJ1dHRvbV9pbXBvcnQgPSBjb25maWdfZ3JvdXA6YnV0dG9uKCJcdkltcG9ydCBDb25maWciLCBmdW5jdGlvbigpIAogICAgICAgICAgICAgICAgICAgIGNvbmZpZy5pbXBvcnQoKQogICAgICAgICAgICAgICAgZW5kKQoKICAgICAgICAgICAgICAgIGJ1dHRvbV9leHBvcnQgPSBjb25maWdfZ3JvdXA6YnV0dG9uKCJcdkV4cG9ydCBDb25maWciLCBmdW5jdGlvbigpIAogICAgICAgICAgICAgICAgICAgIGNvbmZpZy5leHBvcnQoKQogICAgICAgICAgICAgICAgZW5kKQoKICAgICAgICAgICAgICAgIGJ1dHRvbV9kZWZhdWx0ID0gY29uZmlnX2dyb3VwOmJ1dHRvbigiXHZEZWZhdWx0IENvbmZpZyIsIGZ1bmN0aW9uKCkgCiAgICAgICAgICAgICAgICAgICAgY29uZmlnLmltcG9ydCgiVzI1MWJHd3NXM3NpWlc1aFlteGxJanBtWVd4elpTd2llV0YzWDNSNWNHVWlPaUpFWldaaGRXeDBJaXdpYlc5a1gzUjVjR1VpT2lKUFptWWlMQ0prWldaZmVXRjNYM1poYkhWbElqbzVMQ0prWldabGJuTnBkbVZmY0dsMFkyZ2lPaUpQWm1ZaUxDSmliMlI1WDNOc2FXUmxjaUk2TFRFc0lubGhkMTl5WVc1a2IyMGlPakFzSW5CbFpXdGZaR1ZtSWpwbVlXeHpaU3dpWkdWbVpXNXphWFpsSWpwMGNuVmxMQ0ptYjNKalpWOWtaV1lpT25SeWRXVXNJbmxoZDE5a1pXeGhlU0k2TkN3aVpHVm1YMkp2WkhsZmVXRjNYM1I1Y0dVaU9pSkthWFIwWlhJaUxDSndhWFJqYUY5MllXeDFaU0k2TFRNNExDSmtaV1pmYlc5a1gzUjVjR1VpT2lKRFpXNTBaWElpTENKNVlYZGZkbUZzZFdVaU9qQXNJbVJsWmw5aWIyUjVYM05zYVdSbGNpSTZNU3dpWkdWbVgyMXZaRjlrYlNJNk56QXNJbUp2WkhsZmVXRjNYM1I1Y0dVaU9pSkthWFIwWlhJaUxDSjVZWGRmY21sbmFIUWlPamtzSW0xdlpGOWtiU0k2TUN3aWVXRjNYMnhsWm5RaU9qa3NJbVJsWm1WdWMybDJaVjkwZVhCbElqb2lRblZwYkdSbGNpSXNJbVJsWm1WdWMybDJaVjk1WVhjaU9pSlBabVlpZlN4N0ltVnVZV0pzWlNJNmRISjFaU3dpZVdGM1gzUjVjR1VpT2lKRVpXWmhkV3gwSWl3aWJXOWtYM1I1Y0dVaU9pSlBabVlpTENKa1pXWmZlV0YzWDNaaGJIVmxJam96TENKa1pXWmxibk5wZG1WZmNHbDBZMmdpT2lKUFptWWlMQ0ppYjJSNVgzTnNhV1JsY2lJNkxURXNJbmxoZDE5eVlXNWtiMjBpT2pBc0luQmxaV3RmWkdWbUlqcG1ZV3h6WlN3aVpHVm1aVzV6YVhabElqcDBjblZsTENKbWIzSmpaVjlrWldZaU9uUnlkV1VzSW5saGQxOWtaV3hoZVNJNk5Dd2laR1ZtWDJKdlpIbGZlV0YzWDNSNWNHVWlPaUpLYVhSMFpYSWlMQ0p3YVhSamFGOTJZV3gxWlNJNk1Dd2laR1ZtWDIxdlpGOTBlWEJsSWpvaVEyVnVkR1Z5SWl3aWVXRjNYM1poYkhWbElqb3dMQ0prWldaZlltOWtlVjl6Ykdsa1pYSWlPaTB4TENKa1pXWmZiVzlrWDJSdElqbzJPQ3dpWW05a2VWOTVZWGRmZEhsd1pTSTZJa3BwZEhSbGNpSXNJbmxoZDE5eWFXZG9kQ0k2TkN3aWJXOWtYMlJ0SWpvd0xDSjVZWGRmYkdWbWRDSTZOQ3dpWkdWbVpXNXphWFpsWDNSNWNHVWlPaUpDZFdsc1pHVnlJaXdpWkdWbVpXNXphWFpsWDNsaGR5STZJbE53YVc0aWZTeDdJbVZ1WVdKc1pTSTZabUZzYzJVc0lubGhkMTkwZVhCbElqb2lSR1ZtWVhWc2RDSXNJbTF2WkY5MGVYQmxJam9pVDJabUlpd2laR1ZtWDNsaGQxOTJZV3gxWlNJNk1Dd2laR1ZtWlc1emFYWmxYM0JwZEdOb0lqb2lUMlptSWl3aVltOWtlVjl6Ykdsa1pYSWlPakFzSW5saGQxOXlZVzVrYjIwaU9qQXNJbkJsWld0ZlpHVm1JanBtWVd4elpTd2laR1ZtWlc1emFYWmxJanBtWVd4elpTd2labTl5WTJWZlpHVm1JanBtWVd4elpTd2llV0YzWDJSbGJHRjVJam8wTENKa1pXWmZZbTlrZVY5NVlYZGZkSGx3WlNJNklrOW1aaUlzSW5CcGRHTm9YM1poYkhWbElqb3dMQ0prWldaZmJXOWtYM1I1Y0dVaU9pSlBabVlpTENKNVlYZGZkbUZzZFdVaU9qQXNJbVJsWmw5aWIyUjVYM05zYVdSbGNpSTZNQ3dpWkdWbVgyMXZaRjlrYlNJNk1Dd2lZbTlrZVY5NVlYZGZkSGx3WlNJNklrOW1aaUlzSW5saGQxOXlhV2RvZENJNk1Dd2liVzlrWDJSdElqb3dMQ0o1WVhkZmJHVm1kQ0k2TUN3aVpHVm1aVzV6YVhabFgzUjVjR1VpT2lKRVpXWmhkV3gwSWl3aVpHVm1aVzV6YVhabFgzbGhkeUk2SWs5bVppSjlMSHNpWlc1aFlteGxJanAwY25WbExDSjVZWGRmZEhsd1pTSTZJa1JsYkdGNUlpd2liVzlrWDNSNWNHVWlPaUpQWm1ZaUxDSmtaV1pmZVdGM1gzWmhiSFZsSWpvd0xDSmtaV1psYm5OcGRtVmZjR2wwWTJnaU9pSlNZVzVrYjIwaUxDSmliMlI1WDNOc2FXUmxjaUk2TVN3aWVXRjNYM0poYm1SdmJTSTZNVFVzSW5CbFpXdGZaR1ZtSWpwMGNuVmxMQ0prWldabGJuTnBkbVVpT25SeWRXVXNJbVp2Y21ObFgyUmxaaUk2Wm1Gc2MyVXNJbmxoZDE5a1pXeGhlU0k2TlN3aVpHVm1YMkp2WkhsZmVXRjNYM1I1Y0dVaU9pSkthWFIwWlhJaUxDSndhWFJqYUY5MllXeDFaU0k2TUN3aVpHVm1YMjF2WkY5MGVYQmxJam9pUTJWdWRHVnlJaXdpZVdGM1gzWmhiSFZsSWpvek1Dd2laR1ZtWDJKdlpIbGZjMnhwWkdWeUlqb3hMQ0prWldaZmJXOWtYMlJ0SWpvM055d2lZbTlrZVY5NVlYZGZkSGx3WlNJNklsTjBZWFJwWXlJc0lubGhkMTl5YVdkb2RDSTZNelFzSW0xdlpGOWtiU0k2TUN3aWVXRjNYMnhsWm5RaU9pMHpOQ3dpWkdWbVpXNXphWFpsWDNSNWNHVWlPaUpFWldaaGRXeDBJaXdpWkdWbVpXNXphWFpsWDNsaGR5STZJbE53YVc0aWZTeDdJbVZ1WVdKc1pTSTZkSEoxWlN3aWVXRjNYM1I1Y0dVaU9pSkVaV1poZFd4MElpd2liVzlrWDNSNWNHVWlPaUpEWlc1MFpYSWlMQ0prWldaZmVXRjNYM1poYkhWbElqb3pMQ0prWldabGJuTnBkbVZmY0dsMFkyZ2lPaUpQWm1ZaUxDSmliMlI1WDNOc2FXUmxjaUk2TFRFc0lubGhkMTl5WVc1a2IyMGlPakFzSW5CbFpXdGZaR1ZtSWpwbVlXeHpaU3dpWkdWbVpXNXphWFpsSWpwbVlXeHpaU3dpWm05eVkyVmZaR1ZtSWpwMGNuVmxMQ0o1WVhkZlpHVnNZWGtpT2pRc0ltUmxabDlpYjJSNVgzbGhkMTkwZVhCbElqb2lTbWwwZEdWeUlpd2ljR2wwWTJoZmRtRnNkV1VpT2pBc0ltUmxabDl0YjJSZmRIbHdaU0k2SWtObGJuUmxjaUlzSW5saGQxOTJZV3gxWlNJNk1Dd2laR1ZtWDJKdlpIbGZjMnhwWkdWeUlqb3RNaXdpWkdWbVgyMXZaRjlrYlNJNk5qRXNJbUp2WkhsZmVXRjNYM1I1Y0dVaU9pSkthWFIwWlhJaUxDSjVZWGRmY21sbmFIUWlPak1zSW0xdlpGOWtiU0k2Tnl3aWVXRjNYMnhsWm5RaU9qTXNJbVJsWm1WdWMybDJaVjkwZVhCbElqb2lRblZwYkdSbGNpSXNJbVJsWm1WdWMybDJaVjk1WVhjaU9pSlRjR2x1SW4wc2V5SmxibUZpYkdVaU9uUnlkV1VzSW5saGQxOTBlWEJsSWpvaVJHVnNZWGtpTENKdGIyUmZkSGx3WlNJNklrOW1aaUlzSW1SbFpsOTVZWGRmZG1Gc2RXVWlPamtzSW1SbFptVnVjMmwyWlY5d2FYUmphQ0k2SWs5bVppSXNJbUp2WkhsZmMyeHBaR1Z5SWpveExDSjVZWGRmY21GdVpHOXRJam93TENKd1pXVnJYMlJsWmlJNlptRnNjMlVzSW1SbFptVnVjMmwyWlNJNlptRnNjMlVzSW1admNtTmxYMlJsWmlJNmRISjFaU3dpZVdGM1gyUmxiR0Y1SWpvMExDSmtaV1pmWW05a2VWOTVZWGRmZEhsd1pTSTZJa3BwZEhSbGNpSXNJbkJwZEdOb1gzWmhiSFZsSWpvd0xDSmtaV1pmYlc5a1gzUjVjR1VpT2lKRFpXNTBaWElpTENKNVlYZGZkbUZzZFdVaU9qQXNJbVJsWmw5aWIyUjVYM05zYVdSbGNpSTZMVEVzSW1SbFpsOXRiMlJmWkcwaU9qY3dMQ0ppYjJSNVgzbGhkMTkwZVhCbElqb2lTbWwwZEdWeUlpd2llV0YzWDNKcFoyaDBJam96Tnl3aWJXOWtYMlJ0SWpveE1Dd2llV0YzWDJ4bFpuUWlPaTB5T0N3aVpHVm1aVzV6YVhabFgzUjVjR1VpT2lKQ2RXbHNaR1Z5SWl3aVpHVm1aVzV6YVhabFgzbGhkeUk2SWxOd2FXNGlmU3g3SW1WdVlXSnNaU0k2ZEhKMVpTd2llV0YzWDNSNWNHVWlPaUpFWld4aGVTSXNJbTF2WkY5MGVYQmxJam9pVDJabUlpd2laR1ZtWDNsaGQxOTJZV3gxWlNJNk5pd2laR1ZtWlc1emFYWmxYM0JwZEdOb0lqb2lUMlptSWl3aVltOWtlVjl6Ykdsa1pYSWlPakVzSW5saGQxOXlZVzVrYjIwaU9qRTRMQ0p3WldWclgyUmxaaUk2Wm1Gc2MyVXNJbVJsWm1WdWMybDJaU0k2Wm1Gc2MyVXNJbVp2Y21ObFgyUmxaaUk2ZEhKMVpTd2llV0YzWDJSbGJHRjVJam8wTENKa1pXWmZZbTlrZVY5NVlYZGZkSGx3WlNJNklrcHBkSFJsY2lJc0luQnBkR05vWDNaaGJIVmxJam93TENKa1pXWmZiVzlrWDNSNWNHVWlPaUpEWlc1MFpYSWlMQ0o1WVhkZmRtRnNkV1VpT2pBc0ltUmxabDlpYjJSNVgzTnNhV1JsY2lJNkxURXNJbVJsWmw5dGIyUmZaRzBpT2pjMUxDSmliMlI1WDNsaGQxOTBlWEJsSWpvaVNtbDBkR1Z5SWl3aWVXRjNYM0pwWjJoMElqb3pOQ3dpYlc5a1gyUnRJam8wTnl3aWVXRjNYMnhsWm5RaU9pMHlPQ3dpWkdWbVpXNXphWFpsWDNSNWNHVWlPaUpDZFdsc1pHVnlJaXdpWkdWbVpXNXphWFpsWDNsaGR5STZJbE53YVc0aWZTeDdJbVZ1WVdKc1pTSTZkSEoxWlN3aWVXRjNYM1I1Y0dVaU9pSkVaV3hoZVNJc0ltMXZaRjkwZVhCbElqb2lUMlptSWl3aVpHVm1YM2xoZDE5MllXeDFaU0k2Tml3aVpHVm1aVzV6YVhabFgzQnBkR05vSWpvaVQyWm1JaXdpWW05a2VWOXpiR2xrWlhJaU9pMHhMQ0o1WVhkZmNtRnVaRzl0SWpvd0xDSndaV1ZyWDJSbFppSTZabUZzYzJVc0ltUmxabVZ1YzJsMlpTSTZabUZzYzJVc0ltWnZjbU5sWDJSbFppSTZkSEoxWlN3aWVXRjNYMlJsYkdGNUlqbzBMQ0prWldaZlltOWtlVjk1WVhkZmRIbHdaU0k2SWtwcGRIUmxjaUlzSW5CcGRHTm9YM1poYkhWbElqb3dMQ0prWldaZmJXOWtYM1I1Y0dVaU9pSkRaVzUwWlhJaUxDSjVZWGRmZG1Gc2RXVWlPakFzSW1SbFpsOWliMlI1WDNOc2FXUmxjaUk2TFRFc0ltUmxabDl0YjJSZlpHMGlPamMzTENKaWIyUjVYM2xoZDE5MGVYQmxJam9pU21sMGRHVnlJaXdpZVdGM1gzSnBaMmgwSWpvek9Td2liVzlrWDJSdElqbzBOQ3dpZVdGM1gyeGxablFpT2kweE9Td2laR1ZtWlc1emFYWmxYM1I1Y0dVaU9pSkNkV2xzWkdWeUlpd2laR1ZtWlc1emFYWmxYM2xoZHlJNklsTndhVzRpZlYxZCIpCiAgICAgICAgICAgICAgICBlbmQpCgogICAgICAgICAgICAgICAgbG9jYWwgZnVuY3Rpb24gdXBkYXRlX21lbnUoKQogICAgICAgICAgICAgICAgICAgIGxvY2FsIGFBID0gewogICAgICAgICAgICAgICAgICAgICAgICB7MjAwLDIwMCwyMDAsIDI1NSAqIG1hdGguYWJzKDEgKiBtYXRoLmNvcygyICogbWF0aC5waSAqIGdsb2JhbHMuY3VydGltZSgpLzQgKyA4MCAvIDMwKSl9LAogICAgICAgICAgICAgICAgICAgICAgICB7MjAwLDIwMCwyMDAsIDI1NSAqIG1hdGguYWJzKDEgKiBtYXRoLmNvcygyICogbWF0aC5waSAqIGdsb2JhbHMuY3VydGltZSgpLzQgKyA3NSAvIDMwKSl9LAogICAgICAgICAgICAgICAgICAgICAgICB7MjAwLDIwMCwyMDAsIDI1NSAqIG1hdGguYWJzKDEgKiBtYXRoLmNvcygyICogbWF0aC5waSAqIGdsb2JhbHMuY3VydGltZSgpLzQgKyA3MCAvIDMwKSl9LAogICAgICAgICAgICAgICAgICAgICAgICB7MjAwLDIwMCwyMDAsIDI1NSAqIG1hdGguYWJzKDEgKiBtYXRoLmNvcygyICogbWF0aC5waSAqIGdsb2JhbHMuY3VydGltZSgpLzQgKyA2NSAvIDMwKSl9LAogICAgICAgICAgICAgICAgICAgICAgICB7MjAwLDIwMCwyMDAsIDI1NSAqIG1hdGguYWJzKDEgKiBtYXRoLmNvcygyICogbWF0aC5waSAqIGdsb2JhbHMuY3VydGltZSgpLzQgKyA2MCAvIDMwKSl9LAogICAgICAgICAgICAgICAgICAgICAgICB7MjAwLDIwMCwyMDAsIDI1NSAqIG1hdGguYWJzKDEgKiBtYXRoLmNvcygyICogbWF0aC5waSAqIGdsb2JhbHMuY3VydGltZSgpLzQgKyA1NSAvIDMwKSl9LAogICAgICAgICAgICAgICAgICAgICAgICB7MjAwLDIwMCwyMDAsIDI1NSAqIG1hdGguYWJzKDEgKiBtYXRoLmNvcygyICogbWF0aC5waSAqIGdsb2JhbHMuY3VydGltZSgpLzQgKyA1MCAvIDMwKSl9LAogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgbGFiZWxfdGV4dCA9IHN0cmluZy5mb3JtYXQoIuKcrSBHRU5FU0lTIFxhRkZGRkZGRkbinK0iLCByZ2JhX3RvX2hleCh1bnBhY2soYUFbMV0pKSwgcmdiYV90b19oZXgodW5wYWNrKGFBWzJdKSksIHJnYmFfdG9faGV4KHVucGFjayhhQVszXSkpLCByZ2JhX3RvX2hleCh1bnBhY2soYUFbNF0pKSwgcmdiYV90b19oZXgodW5wYWNrKGFBWzVdKSksIHJnYmFfdG9faGV4KHVucGFjayhhQVs2XSkpLCByZ2JhX3RvX2hleCh1bnBhY2soYUFbN10pKSkKICAgICAgICAgICAgICAgICAgICBsdWFfbWVudS5tYWluLmVuYWJsZTpzZXQobGFiZWxfdGV4dCkKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIGNsaWVudC5zZXRfZXZlbnRfY2FsbGJhY2soInNldHVwX2NvbW1hbmQiLCBmdW5jdGlvbihjbWQpCiAgICAgICAgICAgICAgICAgICAgaWYgbm90IGx1YV9tZW51Lm1haW4uZW5hYmxlOmdldCgpIHRoZW4gcmV0dXJuIGVuZAogICAgICAgICAgICAgICAgICAgIGFhX3NldHVwKGNtZCkKICAgICAgICAgICAgICAgICAgICBpZiBsdWFfbWVudS5taXNjLmZhc3RfbGFkZGVyOmdldCgpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgZmFzdGxhZGRlcihjbWQpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgaWYgbHVhX21lbnUubWlzYy50ZWxlcG9ydDpnZXQoKSBhbmQgbHVhX21lbnUubWlzYy50ZWxlcG9ydF9rZXk6Z2V0KCkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBhdXRvX3RwKGNtZCkKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBpZiBsdWFfbWVudS5taXNjLnJlc29sdmVyOmdldCgpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZXJfdXBkYXRlKCkKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZCkKCiAgICAgICAgICAgICAgICBjbGllbnQuc2V0X2V2ZW50X2NhbGxiYWNrKCdwcmVfcmVuZGVyJywgZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIGlmIG5vdCBsdWFfbWVudS5tYWluLmVuYWJsZTpnZXQoKSB0aGVuIHJldHVybiBlbmQKICAgICAgICAgICAgICAgICAgICBpZiBsdWFfbWVudS5taXNjLmFuaW1hdGlvbjpnZXQoKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGFuaW1fYnJlYWtlcigpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQpCgogICAgICAgICAgICAgICAgY2xpZW50LnNldF9ldmVudF9jYWxsYmFjaygncGFpbnRfdWknLCBmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgaGlkZV9vcmlnaW5hbF9tZW51KGZhbHNlKQogICAgICAgICAgICAgICAgICAgIHVwZGF0ZV9tZW51KCkKICAgICAgICAgICAgICAgIGVuZCkKCiAgICAgICAgICAgICAgICBjbGllbnQuc2V0X2V2ZW50X2NhbGxiYWNrKCdwYWludCcsIGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICBpZiBub3QgbHVhX21lbnUubWFpbi5lbmFibGU6Z2V0KCkgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgICAgICAgICAgICAgaWYgbHVhX21lbnUubWlzYy5zcGFtbWVyczpnZXQoIkNsYW50YWciKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGNsYW50YWdfZW4oKQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGlmIG5vdCBlbnRpdHkuaXNfYWxpdmUoZW50aXR5LmdldF9sb2NhbF9wbGF5ZXIoKSkgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgICAgICAgICAgICAgaWYgbHVhX21lbnUubWlzYy5jcm9zc19pbmQ6Z2V0KCkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBzY3JlZW5faW5kaWNhdG9yKCkKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICB0aGlyZHBlcnNvbihsdWFfbWVudS5taXNjLnRoaXJkX3BlcnNvbjpnZXQoKSBhbmQgbHVhX21lbnUubWlzYy50aGlyZF9wZXJzb25fdmFsdWU6Z2V0KCkgb3IgbmlsKQogICAgICAgICAgICAgICAgICAgIGFzcGVjdHJhdGlvKGx1YV9tZW51Lm1pc2MuYXNwZWN0cmF0aW86Z2V0KCkgYW5kIGx1YV9tZW51Lm1pc2MuYXNwZWN0cmF0aW9fdmFsdWU6Z2V0KCkvMTAwIG9yIG5pbCkKICAgICAgICAgICAgICAgICAgICBpZiBsdWFfbWVudS5taXNjLnZlbG9jaXR5X3dpbmRvdzpnZXQoKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHZlbG9jaXR5X2luZCgpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgaWYgbHVhX21lbnUubWlzYy5kZWZlbnNpdmVfd2luZG93OmdldCgpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgZGVmZW5zaXZlX2luZCgpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgcmFnZWJvdF9sb2dzKCkKICAgICAgICAgICAgICAgICAgICBpZiBsdWFfbWVudS5taXNjLmluZm9fcGFuZWw6Z2V0KCkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBpbmZvX3BhbmVsKCkKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICB0ZXh0X2ZhZGVfYW5pbWF0aW9uKHhfaW5kLzIsIHlfaW5kLTIwLCAtMSwge3I9MjAwLCBnPTIwMCwgYj0yMDAsIGE9MjU1fSwge3I9MTUwLCBnPTE1MCwgYj0xNTAsIGE9MjU1fSwgImdlbmVzaXMiLCAiY2RiIikKICAgICAgICAgICAgICAgIGVuZCkKCiAgICAgICAgICAgICAgICBsdWFfbWVudS5taXNjLnJlc29sdmVyOnNldF9jYWxsYmFjayhmdW5jdGlvbihzZWxmKQogICAgICAgICAgICAgICAgICAgIGlmIG5vdCBzZWxmOmdldCgpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgZXhwcmVzLnJlc3RvcmUoKQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kLCB0cnVlKQoKICAgICAgICAgICAgICAgIGNsaWVudC5zZXRfZXZlbnRfY2FsbGJhY2soJ3NodXRkb3duJywgZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIGhpZGVfb3JpZ2luYWxfbWVudSh0cnVlKQogICAgICAgICAgICAgICAgICAgIHRoaXJkcGVyc29uKDE1MCkKICAgICAgICAgICAgICAgICAgICBhc3BlY3RyYXRpbygwKQogICAgICAgICAgICAgICAgICAgIGV4cHJlcy5yZXN0b3JlKCkKICAgICAgICAgICAgICAgIGVuZCkKCiAgICAgICAgICAgICAgICBjbGllbnQuc2V0X2V2ZW50X2NhbGxiYWNrKCdyb3VuZF9wcmVzdGFydCcsIGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICBsb2dzID0ge30KICAgICAgICAgICAgICAgICAgICBpZiBsdWFfbWVudS5taXNjLmxvZ190eXBlOmdldCgiU2NyZWVuIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICByZW5kZXJlci5sb2coIkFudGktQWltIERhdGEgUmVzZXR0ZWQiKQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kKQo="}
