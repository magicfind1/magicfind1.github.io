{"status":200,"content":"LS0gQHJlZ2lvbiBMVUFTRVRUSU5HUyBzdGFydApsb2NhbCBsdWFfbmFtZSA9ICJibHVoZ2FuZyIKbG9jYWwgbHVhX2NvbG9yID0ge3IgPSAxOTAsIGcgPSAxOTAsIGIgPSAyNTV9CmxvY2FsIG9iZXhfZGF0YSA9IG9iZXhfZmV0Y2ggYW5kIG9iZXhfZmV0Y2goKSBvciB7dXNlcm5hbWUgPSAnQWRtaW4nLCBidWlsZCA9ICdEZXYnLCBkaXNjb3JkPScnfQogICAgCmxvY2FsIGx1YV9iYW5uZXIgPSBbWyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICDilojilojilojilojilojilojilZcg4paI4paI4pWXICAgICDilojilojilZcgICDilojilojilZfilojilojilZcgIOKWiOKWiOKVlyDilojilojilojilojilojilojilZcgIOKWiOKWiOKWiOKWiOKWiOKVlyDilojilojilojilZcgICDilojilojilZcg4paI4paI4paI4paI4paI4paI4pWXICAgIOKWiOKWiOKVlyAgICAg4paI4paI4pWXICAg4paI4paI4pWXIOKWiOKWiOKWiOKWiOKWiOKVlyAKICAgIOKWiOKWiOKVlOKVkOKVkOKWiOKWiOKVl+KWiOKWiOKVkSAgICAg4paI4paI4pWRICAg4paI4paI4pWR4paI4paI4pWRICDilojilojilZHilojilojilZTilZDilZDilZDilZDilZ0g4paI4paI4pWU4pWQ4pWQ4paI4paI4pWX4paI4paI4paI4paI4pWXICDilojilojilZHilojilojilZTilZDilZDilZDilZDilZ0gICAg4paI4paI4pWRICAgICDilojilojilZEgICDilojilojilZHilojilojilZTilZDilZDilojilojilZcKICAgIOKWiOKWiOKWiOKWiOKWiOKWiOKVlOKVneKWiOKWiOKVkSAgICAg4paI4paI4pWRICAg4paI4paI4pWR4paI4paI4paI4paI4paI4paI4paI4pWR4paI4paI4pWRICDilojilojilojilZfilojilojilojilojilojilojilojilZHilojilojilZTilojilojilZcg4paI4paI4pWR4paI4paI4pWRICDilojilojilojilZcgICDilojilojilZEgICAgIOKWiOKWiOKVkSAgIOKWiOKWiOKVkeKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVkQogICAg4paI4paI4pWU4pWQ4pWQ4paI4paI4pWX4paI4paI4pWRICAgICDilojilojilZEgICDilojilojilZHilojilojilZTilZDilZDilojilojilZHilojilojilZEgICDilojilojilZHilojilojilZTilZDilZDilojilojilZHilojilojilZHilZrilojilojilZfilojilojilZHilojilojilZEgICDilojilojilZEgICDilojilojilZEgICAgIOKWiOKWiOKVkSAgIOKWiOKWiOKVkeKWiOKWiOKVlOKVkOKVkOKWiOKWiOKVkQogICAg4paI4paI4paI4paI4paI4paI4pWU4pWd4paI4paI4paI4paI4paI4paI4paI4pWX4pWa4paI4paI4paI4paI4paI4paI4pWU4pWd4paI4paI4pWRICDilojilojilZHilZrilojilojilojilojilojilojilZTilZ3ilojilojilZEgIOKWiOKWiOKVkeKWiOKWiOKVkSDilZrilojilojilojilojilZHilZrilojilojilojilojilojilojilZTilZ3ilojilojilZfilojilojilojilojilojilojilojilZfilZrilojilojilojilojilojilojilZTilZ3ilojilojilZEgIOKWiOKWiOKVkQogICAg4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWdIOKVmuKVkOKVkOKVkOKVkOKVkOKVkOKVnSDilZrilZDilZDilZDilZDilZDilZ0g4pWa4pWQ4pWdICDilZrilZDilZ0g4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWdIOKVmuKVkOKVnSAg4pWa4pWQ4pWd4pWa4pWQ4pWdICDilZrilZDilZDilZDilZ0g4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWdIOKVmuKVkOKVneKVmuKVkOKVkOKVkOKVkOKVkOKVkOKVnSDilZrilZDilZDilZDilZDilZDilZ0g4pWa4pWQ4pWdICDilZrilZDilZ0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIApdXQotLSBAcmVnaW9uIExVQVNFVFRJTkdTIGVuZAoKCi0tIEByZWdpb24gREVQRU5ERU5DSUVTIHN0YXJ0CmxvY2FsIGZ1bmN0aW9uIHRyeV9yZXF1aXJlKG1vZHVsZSwgbXNnKQogICAgbG9jYWwgc3VjY2VzcywgcmVzdWx0ID0gcGNhbGwocmVxdWlyZSwgbW9kdWxlKQogICAgaWYgc3VjY2VzcyB0aGVuIHJldHVybiByZXN1bHQgZWxzZSByZXR1cm4gZXJyb3IobXNnKSBlbmQKZW5kCgpsb2NhbCBpbWFnZXMgPSB0cnlfcmVxdWlyZSgiZ2FtZXNlbnNlL2ltYWdlcyIsICJEb3dubG9hZCBpbWFnZXMgbGlicmFyeTogaHR0cHM6Ly9nYW1lc2Vuc2UucHViL2ZvcnVtcy92aWV3dG9waWMucGhwP2lkPTIyOTE3IikKbG9jYWwgYml0ID0gdHJ5X3JlcXVpcmUoImJpdCIpCmxvY2FsIGJhc2U2NCA9IHRyeV9yZXF1aXJlKCJnYW1lc2Vuc2UvYmFzZTY0IiwgIkRvd25sb2FkIGJhc2U2NCBlbmNvZGUvZGVjb2RlIGxpYnJhcnk6IGh0dHBzOi8vZ2FtZXNlbnNlLnB1Yi9mb3J1bXMvdmlld3RvcGljLnBocD9pZD0yMTYxOSIpCmxvY2FsIGFudGlhaW1fZnVuY3MgPSB0cnlfcmVxdWlyZSgiZ2FtZXNlbnNlL2FudGlhaW1fZnVuY3MiLCAiRG93bmxvYWQgYW50aS1haW0gZnVuY3Rpb25zIGxpYnJhcnk6IGh0dHBzOi8vZ2FtZXNlbnNlLnB1Yi9mb3J1bXMvdmlld3RvcGljLnBocD9pZD0yOTY2NSIpCmxvY2FsIGZmaSA9IHRyeV9yZXF1aXJlKCJmZmkiLCAiRmFpbGVkIHRvIHJlcXVpcmUgRkZJLCBwbGVhc2UgbWFrZSBzdXJlIEFsbG93IHVuc2FmZSBzY3JpcHRzIGlzIGVuYWJsZWQhIikKbG9jYWwgdmVjdG9yID0gdHJ5X3JlcXVpcmUoInZlY3RvciIsICJNaXNzaW5nIHZlY3RvciIpCmxvY2FsIGh0dHAgPSB0cnlfcmVxdWlyZSgiZ2FtZXNlbnNlL2h0dHAiLCAiRG93bmxvYWQgSFRUUCBsaWJyYXJ5OiBodHRwczovL2dhbWVzZW5zZS5wdWIvZm9ydW1zL3ZpZXd0b3BpYy5waHA/aWQ9MjE2MTkiKQpsb2NhbCBjbGlwYm9hcmQgPSB0cnlfcmVxdWlyZSgiZ2FtZXNlbnNlL2NsaXBib2FyZCIsICJEb3dubG9hZCBDbGlwYm9hcmQgbGlicmFyeTogaHR0cHM6Ly9nYW1lc2Vuc2UucHViL2ZvcnVtcy92aWV3dG9waWMucGhwP2lkPTI4Njc4IikKbG9jYWwgZW50ID0gdHJ5X3JlcXVpcmUoImdhbWVzZW5zZS9lbnRpdHkiLCAiRG93bmxvYWQgRW50aXR5IE9iamVjdCBsaWJyYXJ5OiBodHRwczovL2dhbWVzZW5zZS5wdWIvZm9ydW1zL3ZpZXd0b3BpYy5waHA/aWQ9Mjc1MjkiKQpsb2NhbCBjc2dvX3dlYXBvbnMgPSB0cnlfcmVxdWlyZSgiZ2FtZXNlbnNlL2NzZ29fd2VhcG9ucyIsICJEb3dubG9hZCBDUzpHTyB3ZWFwb24gZGF0YSBsaWJyYXJ5OiBodHRwczovL2dhbWVzZW5zZS5wdWIvZm9ydW1zL3ZpZXd0b3BpYy5waHA/aWQ9MTg4MDciKQpsb2NhbCBlbnQgPSB0cnlfcmVxdWlyZSgiZ2FtZXNlbnNlL2VudGl0eSIpCmxvY2FsIHN0ZWFtd29ya3MgPSB0cnlfcmVxdWlyZSgiZ2FtZXNlbnNlL3N0ZWFtd29ya3MiKSBvciBlcnJvcignTWlzc2luZyBodHRwczovL2dhbWVzZW5zZS5wdWIvZm9ydW1zL3ZpZXd0b3BpYy5waHA/aWQ9MjY1MjYnKQotLSBAcmVnaW9uIERFUEVOREVOQ0lFUyBlbmQKCi0tIEByZWdpb24gREFUQUJBU0UgJiBPQkVYIHN0YXJ0Cgpsb2NhbCBsb2dpbiA9IHsKICAgIHVzZXJuYW1lID0gb2JleF9kYXRhLnVzZXJuYW1lLAogICAgdmVyc2lvbiA9ICIxLjAuMCIsCiAgICBidWlsZCA9IG9iZXhfZGF0YS5idWlsZCwKfQoKaWYgbG9naW4uYnVpbGQgPT0gJ1VzZXInIHRoZW4KICAgIGxvZ2luLmJ1aWxkID0gJ0xpdmUnCmVuZAoKY2xpZW50LmV4ZWMoImNsZWFyIikKY2xpZW50LmNvbG9yX2xvZygyNTUsIDI1NSwgMjU1LCAiIFxuIFxuIFxuIFxuIFxuICIpCmNsaWVudC5jb2xvcl9sb2cobHVhX2NvbG9yLnIsIGx1YV9jb2xvci5nLCBsdWFfY29sb3IuYiwgbHVhX2Jhbm5lcikKY2xpZW50LmNvbG9yX2xvZygyNTUsIDI1NSwgMjU1LCAiIFxuIFxuIFxuIFxuIFxuICIpCmNsaWVudC5jb2xvcl9sb2coMjU1LCAyNTUsIDI1NSwgIldlbGNvbWUgdG9cMCIpCmNsaWVudC5jb2xvcl9sb2cobHVhX2NvbG9yLnIsIGx1YV9jb2xvci5nLCBsdWFfY29sb3IuYiwgIiBibHVoZ2FuZ1wwIikKY2xpZW50LmNvbG9yX2xvZygyNTUsIDI1NSwgMjU1LCAiLCAiIC4uIGxvZ2luLnVzZXJuYW1lKQpsb2NhbCBsdWEgPSB7fQpsdWEuZGF0YWJhc2UgPSB7CiAgICBjb25maWdzID0gIjoiIC4uIGx1YV9uYW1lIC4uICI6OmNvbmZpZ3M6Igp9CmxvY2FsIHByZXNldHMgPSB7fQotLSBAcmVnaW9uIFVTRVJEQVRBIGVuZAoKZmZpLmNkZWYgW1sKICAgIHR5cGVkZWYgdW5zaWduZWQgbG9uZyBkd29yZDsKICAgIHR5cGVkZWYgdW5zaWduZWQgaW50IHNpemVfdDsKCiAgICB0eXBlZGVmIHN0cnVjdCB7CiAgICAgICAgdWludDhfdCByLCBnLCBiLCBhOwogICAgfSBjb2xvcl90OwpdXQoKLS0gQHJlZ2lvbiBSRUZFUkVOQ0VTIHN0YXJ0CmxvY2FsIHJlZnMgPSB7CiAgICBsZWdpdCA9IHVpLnJlZmVyZW5jZSgiTEVHSVQiLCAiQWltYm90IiwgIkVuYWJsZWQiKSwKICAgIGRtZ092ZXJyaWRlID0ge3VpLnJlZmVyZW5jZSgiUkFHRSIsICJBaW1ib3QiLCAiTWluaW11bSBkYW1hZ2Ugb3ZlcnJpZGUiKX0sCiAgICBmYWtlRHVjayA9IHVpLnJlZmVyZW5jZSgiUkFHRSIsICJPdGhlciIsICJEdWNrIHBlZWsgYXNzaXN0IiksCiAgICBtaW5EbWcgPSB1aS5yZWZlcmVuY2UoIlJBR0UiLCAiQWltYm90IiwgIk1pbmltdW0gZGFtYWdlIiksCiAgICBoaXRDaGFuY2UgPSB1aS5yZWZlcmVuY2UoIlJBR0UiLCAiQWltYm90IiwgIk1pbmltdW0gaGl0IGNoYW5jZSIpLAogICAgc2FmZVBvaW50ID0gdWkucmVmZXJlbmNlKCJSQUdFIiwgIkFpbWJvdCIsICJGb3JjZSBzYWZlIHBvaW50IiksCiAgICBmb3JjZUJhaW0gPSB1aS5yZWZlcmVuY2UoIlJBR0UiLCAiQWltYm90IiwgIkZvcmNlIGJvZHkgYWltIiksCiAgICBkdExpbWl0ID0gdWkucmVmZXJlbmNlKCJSQUdFIiwgIkFpbWJvdCIsICJEb3VibGUgdGFwIGZha2UgbGFnIGxpbWl0IiksCiAgICBxdWlja1BlZWsgPSB7dWkucmVmZXJlbmNlKCJSQUdFIiwgIk90aGVyIiwgIlF1aWNrIHBlZWsgYXNzaXN0Iil9LAogICAgZHQgPSB7dWkucmVmZXJlbmNlKCJSQUdFIiwgIkFpbWJvdCIsICJEb3VibGUgdGFwIil9LAogICAgZW5hYmxlZCA9IHVpLnJlZmVyZW5jZSgiQUEiLCAiQW50aS1haW1ib3QgYW5nbGVzIiwgIkVuYWJsZWQiKSwKICAgIHBpdGNoID0ge3VpLnJlZmVyZW5jZSgiQUEiLCAiQW50aS1haW1ib3QgYW5nbGVzIiwgInBpdGNoIil9LAogICAgcm9sbCA9IHVpLnJlZmVyZW5jZSgiQUEiLCAiQW50aS1haW1ib3QgYW5nbGVzIiwgInJvbGwiKSwKICAgIHlhd0Jhc2UgPSB1aS5yZWZlcmVuY2UoIkFBIiwgIkFudGktYWltYm90IGFuZ2xlcyIsICJZYXcgYmFzZSIpLAogICAgeWF3ID0ge3VpLnJlZmVyZW5jZSgiQUEiLCAiQW50aS1haW1ib3QgYW5nbGVzIiwgIllhdyIpfSwKICAgIGZsTGltaXQgPSB1aS5yZWZlcmVuY2UoIkFBIiwgIkZha2UgbGFnIiwgIkxpbWl0IiksCiAgICBmc0JvZHlZYXcgPSB1aS5yZWZlcmVuY2UoIkFBIiwgImFudGktYWltYm90IGFuZ2xlcyIsICJGcmVlc3RhbmRpbmcgYm9keSB5YXciKSwKICAgIGVkZ2VZYXcgPSB1aS5yZWZlcmVuY2UoIkFBIiwgIkFudGktYWltYm90IGFuZ2xlcyIsICJFZGdlIHlhdyIpLAogICAgeWF3Sml0dGVyID0ge3VpLnJlZmVyZW5jZSgiQUEiLCAiQW50aS1haW1ib3QgYW5nbGVzIiwgIllhdyBqaXR0ZXIiKX0sCiAgICBib2R5WWF3ID0ge3VpLnJlZmVyZW5jZSgiQUEiLCAiQW50aS1haW1ib3QgYW5nbGVzIiwgIkJvZHkgeWF3Iil9LAogICAgZnJlZVN0YW5kID0ge3VpLnJlZmVyZW5jZSgiQUEiLCAiQW50aS1haW1ib3QgYW5nbGVzIiwgIkZyZWVzdGFuZGluZyIpfSwKICAgIG9zID0ge3VpLnJlZmVyZW5jZSgiQUEiLCAiT3RoZXIiLCAiT24gc2hvdCBhbnRpLWFpbSIpfSwKICAgIHNsb3cgPSB7dWkucmVmZXJlbmNlKCJBQSIsICJPdGhlciIsICJTbG93IG1vdGlvbiIpfSwKICAgIGZha2VMYWcgPSB7dWkucmVmZXJlbmNlKCJBQSIsICJGYWtlIGxhZyIsICJMaW1pdCIpfSwKICAgIGxlZ01vdmVtZW50ID0gdWkucmVmZXJlbmNlKCJBQSIsICJPdGhlciIsICJMZWcgbW92ZW1lbnQiKSwKICAgIGluZGljYXRvcnMgPSB7dWkucmVmZXJlbmNlKCJWSVNVQUxTIiwgIk90aGVyIEVTUCIsICJGZWF0dXJlIGluZGljYXRvcnMiKX0sCiAgICBwaW5nID0ge3VpLnJlZmVyZW5jZSgiTUlTQyIsICJNaXNjZWxsYW5lb3VzIiwgIlBpbmcgc3Bpa2UiKX0sCn0KLS0gQHJlZ2lvbiBSRUZFUkVOQ0VTIGVuZAoKLS0gQHJlZ2lvbiBWQVJJQUJMRVMgc3RhcnQKbG9jYWwgdmFycyA9IHsKICAgIGxvY2FsUGxheWVyID0gMCwKICAgIGhpdGdyb3VwX25hbWVzID0geyAnR2VuZXJpYycsICdIZWFkJywgJ0NoZXN0JywgJ1N0b21hY2gnLCAnTGVmdCBhcm0nLCAnUmlnaHQgYXJtJywgJ0xlZnQgbGVnJywgJ1JpZ2h0IGxlZycsICdOZWNrJywgJz8nLCAnR2VhcicgfSwKICAgIGFhU3RhdGVzID0geyJHbG9iYWwiLCAiU3RhbmRpbmciLCAiTW92aW5nIiwgIlNsb3d3YWxraW5nIiwgIkNyb3VjaGluZyIsICJBaXIiLCAiQWlyLUNyb3VjaGluZyIsICJMZWdpdC1BQSJ9LAogICAgcFN0YXRlcyA9IHsiRyIsICJTIiwgIk0iLCAiU1ciLCAiQyIsICJBIiwgIkFDIiwgIkxBIn0sCglzVG9JbnQgPSB7WyJHbG9iYWwiXSA9IDEsIFsiU3RhbmRpbmciXSA9IDIsIFsiTW92aW5nIl0gPSAzLCBbIlNsb3d3YWxraW5nIl0gPSA0LCBbIkNyb3VjaGluZyJdID0gNSwgWyJBaXIiXSA9IDYsIFsiQWlyLUNyb3VjaGluZyJdID0gNyxbIkxlZ2l0LUFBIl0gPSA4fSwKICAgIGludFRvUyA9IHtbMV0gPSAiR2xvYmFsIiwgWzJdID0gIlN0YW5kIiwgWzNdID0gIk1vdmUiLCBbNF0gPSAiU2xvd3dhbGsiLCBbNV0gPSAiQ3JvdWNoIiwgWzZdID0gIkFpciIsIFs3XSA9ICJBaXIrQyIsIFs4XSA9ICJMZWdpdCJ9LAogICAgY3VycmVudFRhYiA9IDEsCiAgICBhY3RpdmVTdGF0ZSA9IDEsCiAgICBwU3RhdGUgPSAxLAogICAgc2hvdWxkX2Rpc2FibGUgPSBmYWxzZSwKICAgIGRlZmVuc2l2ZV91bnRpbCA9IDAsCiAgICBkZWZlbnNpdmVfcHJldl9zaW0gPSAwLAogICAgZnMgPSBmYWxzZSwKICAgIGNob2tlMSA9IDAsCiAgICBjaG9rZTIgPSAwLAogICAgY2hva2UzID0gMCwKICAgIGNob2tlNCA9IDAsCiAgICBzd2l0Y2ggPSBmYWxzZSwKfQoKbG9jYWwga2lsbCA9IHsi0L3RjtGF0LDQuSDQv9GP0YLQutGDINGB0YvQvSDRiNCw0LHQvtC70LTRiyDRkdCx0LDQvdC+0LkiLAoi0YHQvtGB0LXRiNGMINGF0YPQttC1INC80LXQs9C40L7QvdGB0LrQuNGFINGG0YvQv9C+0YfQtdC6IiwKItC+0LzQsyBuaWNlIHNtYWxsIHBpc3VuY2hpayIsCiLRgtGLINC90LjRhdGD0Y8g0L3QtSDQu9C10LTQttC10L3QtCIsCiJPV05FRCBCWSBMRUdFTkRJQ0sg0YHRi9C9INGI0LvRjtGF0Lgg0ZHQsdCw0L3QvtC5IiwKItC/0L7Qt9Cy0L7Qu9GMINC80L7QtdC5INC/0LjRgdC10YfQutC1INC40YHRgdC70LXQtNC+0LLQsNGC0Ywg0L3QtdC00YDRiyDRiNCw0YXRgtGLINGC0LLQvtC10Lkg0LzQsNGC0LXRgNC4IiwKItGG0LXQu9GD0Lkg0L/QuNGB0LjRh9C60YMgZnVja2luZyBubyBsZWdlbmQiLAoi0YHRg9C60LAg0LXQsdCw0L3Ri9C5IE5PIExFR0VORCDQsdC10Lcg0LHQu9GO0YXQs9C10L3QsyDQu9GD0LAiLAoi0YLQstC+0Y8g0L/QuNGB0LjRh9C60LAg0YLQsNC60LDRjyDQttC1INC80LDQu9C10L3RjNC60LDRjyDQutCw0Log0LggaXFzaGU0a2EiLAoi0LIg0YHQu9C10LTRg9GJ0LXQuSDRgNCw0Lcg0LLRi9C50LPRgNCw0LXRiNGMINC70LXQtNC20LXQvdC00LAiLAoi0JHQm9Cu0KXQk9CV0J3QkyDQm9Cj0JAg0JLQk9CV0KLQkNCZINCS0KvQkdCb0K/QlNCsINCV0JHQkNCd0JDQryDQo9CW0JUgMjAyMyDQkNCjIiwKIkFyZSB5b3UgbGVnZW5kPyDQn9GA0L7QudC00LjRgtC1INC/0YDQvtCy0LXRgNC60YMg0L3QsCDQv9C40YHQtdGH0LrRgyDQtNC70Y8g0YPRgtC+0YfQvdC10L3QuNGPINCy0L7Qv9GA0L7RgdCwIC0gQHRvcDFidHciLAoi0JLQqyDQotCQ0JrQntCZINCW0JUg0KLQkNCd0KbQntCgINCa0JDQmiDQm9Cv0KHQotCY0KfQmtCYIE5PTEVHRU5ESUNLSSIsCiLQotCy0L7RjyDQvNCw0YLRjCDRgtCw0LrQsNGPINC20LUg0LbQuNGA0L3QsNGPINC60LDQuiBpZGxlIGxlZ2VuZCAoMTQwKSIsCiLQvdCw0LrQvtC90YfQsNC7INC90LAg0YLQstC+0Y4g0LvRi9GB0LjQvdC60YMg0L7QvdCwINC60LDQuiDRgyDQsdCw0YLRjNC60LAg0YjQsNC80LXQu9C40YHQuNC60LAiLAoi0YHRg9C60LAg0LXQsdCw0L3Ri9C5IE5PIExFR0VORCDQsdC10Lcg0LHQu9GO0YXQs9C10L3QsyDQu9GD0LAiLAoi0YLQstC+0Y8g0LzQsNC80LDRiNCwINC/0YDQuNCz0L7RgtC+0LLQuNC70LAg0LzQvdC1INCy0LrRg9GB0L3Ri9C1INCx0YPRgtC10YDQsdGA0L7QtNC40LrQuCDQutCw0Log0YMgZ2FjaGkgbm9sZWdlbmQiLAoi0YLRiyDQvtGH0LXQvdGMINGF0L7RgNC+0YjQviDQu9C40LbQtdGI0Ywg0L/Rj9GC0L7Rh9C60Lgg0L3QsNGD0YfQuCDQutC70L7QutC10LTQuNC60LAgbGVnZW5kaWNrYSIsCiLRiNC70Y7RhdCwINC10LHQsNC90LDRjyDRgtCw0Log0LbQtSDRgdC00L7RhdC70LAg0LrQsNC6INCx0LDQsdC60LAg0YTQuNC/0L/QsCDQuCDQvNCw0YPRgtCwIiwKItGB0YvQvSDRiNC70Y7RhdC4INGDINGC0LXQsdGPINGC0LDQutC40LUg0LbQtSDQutC+0LzQv9GM0Y7RgtC10YDQuNC60Lgg0LrQsNC6INGDIHZhbmlubyBub2xlZ2VuZCIsCiLRgtCy0L7RjyDQvNCw0LzQsNGI0LAg0LvQuNC20LXRgiDQvNC+0YDQvtC20LXQvdC90L7QtSDQvtC5INCx0LvRj9GC0Ywg0Y3RgtC+INC20LUg0LzQvtGPINC/0LjRgdC10YfQutCwIiwKItCn0YLQvtCx0Ysg0LLRi9C50LPRgNGL0LLQsNGC0Ywg0LLRiyDQvtCx0Y/Qt9Cw0L3RiyDQtNC10YDQttCw0YLRjCDQsdGA0LXQvdC0IGJsdWhnYW5nJ2EiLAoi0YMg0YLQstC+0LXQuSDQvNCw0YLQtdGA0Lgg0YLQsNC60LDRjyDQttC1INGD0LfQutCw0Y8g0L/QuNC30LTQsCDQutCw0Log0LPQu9Cw0LfQsCBkNHNzaCBsZWdlbmQiLAoi0YLRiyDRgtCw0LrQvtC5INC20LUg0LXQsdCw0L3Ri9C5INC/0LXRgSDQutCw0LogIGw0Zm4gbm9sZWdlbmQiLAoi0LHQu9GO0YXQs9C10L3QsyDQu9GD0LAg0LLQs9C10YLQsNC5INGF0YPQudC90Y8pKSAtIGJpdC5seS9ibHVoZ2FuZ2x1YSIsCiLRgtCy0LDRgNGMINC80LEg0LDQvdGC0LjQv9C+0L/QsNC00LDQudC60Lgg0LLQs9C10YLQsNC10YjRjD8gLSBiaXQubHkvYmx1aGdhbmdsdWEiLAoi0LrQvtC90YTQuNCzINGC0LXQsdC1INCx0Ysg0L3QtSDQv9C+0LzQtdGI0LDQuyAtIGJpdC5seS9ibHVoZ2FuZ2x1YSIsCiLQvNC00LAg0LjQs9GA0LDQtdGI0Ywg0YLRiyDQutC+0L3QtdGH0L3QviDRhdGD0LXQstC+INC90LUg0YLQviDRh9GC0L4gZDRzc2ggbGVnZW5kaWNrIiwKItGA0LDQt9Cx0L7QvNCx0LjQuyDRgtC10LHQtSDQtdCx0LDRgdC+0YHQuNC90YMg0LrQsNC6INCx0L7QvNCx0Y/RgiB3YWxwZXIgbm9sZWdlbmQiLAoi0JHQm9Cu0KXQk9CV0J3QkyDQm9Cj0JAg0JLQk9CV0KLQkNCZINCS0KvQkdCb0K/QlNCsINCV0JHQkNCd0JDQryDQo9CW0JUgMjAyMyDQkNCjIiwKItGC0Ysg0L3QuNC60L7Qs9C00LAg0L3QtSDQsdGD0LTQtdGI0YwgbGVnZW5kINGBINGC0LDQutC+0Lkgc21hbGwgcGlzZTRrYSIsCiLQv9C+0LrQsCDRgtGLINGB0L7RgdC10YjRjCDRhdGD0Lkg0LzRiyDRh9C40LvQuNC8INC90LAg0L7RgdGC0YDQvtCy0LUgbGVnZW5kaWNrb3YiLAoi0YXQvtGH0LXRiNGMINC60YPQv9C40YLRjCBjb25maWcgYnkgbGVnZW5kaWNrPyDQn9Ce0KjQldCbINCd0JDQpdCj0Jkg0KHQq9CdINCo0JvQrtCl0Jgg0IHQkdCQ0J3QntCZIiwKItCt0KXQpdClINCa0JDQmiDQltCVINCQ0KXQo9CV0J3QndCeINCh0J7QodCV0KIg0KLQktCe0K8g0JzQkNCc0JDQqNCQINCc0J7QmSBQSVNVTjRJSyIsCiLQp9GC0L7QsdGLINCy0YvQudCz0YDRi9Cy0LDRgtGMINCy0Ysg0L7QsdGP0LfQsNC90Ysg0LTQtdGA0LbQsNGC0Ywg0LHRgNC10L3QtCBibHVoZ2FuZydhIiwKItGA0LDQvdC00LXRgNCw0L3QtNC10YDQsNC90LTQtdCy0YMg0YLQstC+0Y8g0LzQsNGC0Ywg0YjQu9GO0YXQsCDRgdC+0YHQsNC70LAg0L3QsNGP0LLRgyIsCiLQv9GD0LfQviDRgtCy0L7QtdC5INC80LDRgtC10YDQuCDRiNC70Y7RhdC4INGC0LDQutC+0LUg0LbQtSDQsdC+0LvRjNGI0L7QtSDQutCw0Log0YMgc2hpcmF6dSBub2xlZ2VuZCIsCiLQkNCl0JDQpdCl0JDQkCDQkdCb0K8g0KfQldCbINCi0Ksg0JjQk9Cg0JDQldCo0Kwg0KXQo9CW0JUgSE9MQVRWIiwKIk5FVyBNRVRBIEZVQ0tJTkcgTk8gTEVHRU5EPyIsCiLQodCe0KHQmCDQpdCj0Jkg0J/Qm9CQ0JrQodCQINCB0JHQkNCd0JDQryIsCiLQsdC70Y7RhdCz0LXQvdCzINC70YPQsCDQstCz0LXRgtCw0Lkg0YXRg9C50L3RjykpIC0gYml0Lmx5L2JsdWhnYW5nbHVhIiwKItGC0LLQsNGA0Ywg0LzQsSDQsNC90YLQuNC/0L7Qv9Cw0LTQsNC50LrQuCDQstCz0LXRgtCw0LXRiNGMPyAtIGJpdC5seS9ibHVoZ2FuZ2x1YSIsCiLQutC+0L3RhNC40LMg0YLQtdCx0LUg0LHRiyDQvdC1INC/0L7QvNC10YjQsNC7IC0gYml0Lmx5L2JsdWhnYW5nbHVhIiwKItCR0JvQrtCl0JPQldCd0JMg0JvQo9CQINCS0JPQldCi0JDQmSDQktCr0JHQm9Cv0JTQrCDQldCR0JDQndCQ0K8g0KPQltCVIDIwMjMg0JDQoyIsCiLQmNCX0JLQmNCd0K/QmdCh0K8g0KHQq9CdINCo0JvQrtCl0Jgg0IHQkdCQ0J3QntCZIiwKItCx0LvRjyDRgdC+0YDQuCDQv9C40YHRjNC60LAg0L3QsCDQv9GA0L7QsdC10Lsg0L3QsNC20LDQu9CwINCwINGC0Ysg0LrQsNC6INCx0L7QvNC2INC10LHQsNC90YvQuSDQt9C00L7RhSBieSBibHVoZ2FuZyIsCiLQktCr0JXQkdCQ0J3QkCDQkiDQn9Ce0J/QrdCf0J3QptCY0K4gRlVDS0lORyBOTyBMRUdFTkQiLAoi0IHQkdCQ0J3Qq9CZINCh0KvQnSDQqNCb0K7QpdCYINCi0Ksg0KXQntCn0JXQqNCsINCa0JDQmiDQktCY0KLQnNCQINCYINCh0KLQmNCS0JDQpdCQINCc0J3QlSDQn9Cg0J7QldCQ0KLQrCIsCiLRgdGL0L0g0YjQu9GO0YXQuCDRgtGLINC00YPQvNCw0Lsg0LzQvtGPINC/0LjRgdC10YfQutCwINGB0YDQsNCy0L3QuNGC0YHRjyDRgSDRgtCy0L7QtdC5PyIsCiLQtdGB0LvQuCDRhdC+0YfQtdGI0Ywg0Y8g0LzQvtCz0YMg0YLQtdCx0Y8g0L3QsCDRgdGC0YDQuNC80LUg0L7QsdC+0YHRgdCw0YLRjCIsCiLQp9GC0L7QsdGLINCy0YvQudCz0YDRi9Cy0LDRgtGMINCy0Ysg0L7QsdGP0LfQsNC90Ysg0LTQtdGA0LbQsNGC0Ywg0LHRgNC10L3QtCBibHVoZ2FuZydhIiwKItCi0Ksg0J3QlSDQl9Cd0JDQldCo0Kwg0JvQldCU0JbQldCd0JTQntCSPyDQgdCR0JDQndCr0Jkg0KHQq9CdINCo0JvQrtCl0Jgg0KEgMjAyMyDQm9CY0JLQndCYIiwKItGC0Ysg0YLQsNC6INC20LUg0LfQsNGE0LXQudC70LjRiNGMINC/0YDQvtCy0LXRgNC60YMg0L3QsCDQv9C40YHQtdGH0LrQuCDQutCw0LogbWlzaGF0IG5vbGVnZW5kIiwKItGC0Ysg0YLQsNC90YbRg9C10YjRjCDRgSDQsdGD0YLRi9C70LrQvtC5INC60LDQuiDQtdCx0LDQvdGL0LkgY2xvY2tlZCBsZWdlbmQ/IiwKItCx0LvRjyDRgdC+0YDQuCDQv9C40YHRjNC60LAg0L3QsCDQv9GA0L7QsdC10Lsg0L3QsNC20LDQu9CwINCwINGC0Ysg0LrQsNC6INCx0L7QvNC2INC10LHQsNC90YvQuSDQt9C00L7RhSBieSBibHVoZ2FuZyIsCiLQvdCw0YXRg9C5INGC0Ysg0L7RgiDQvNC10L3RjyDRg9Cx0LXQs9Cw0LXRiNGMINC60LDQuiDQsdCw0YLQtdC6IHZpcnR1YWwgbGVnZW5kIiwKItGB0YPQutCwINC10LHQsNC90YvQuSBOTyBMRUdFTkQg0LHQtdC3INCx0LvRjtGF0LPQtdC90LMg0LvRg9CwIiwKItC10YHQu9C4INGF0L7Rh9C10YjRjCDQvNC+0LbQtdGI0Ywg0L/RgNC40LrRg9C/0LjRgtGMINCw0LnRhNC+0L3Rh9C40LogNSBzINC60LDQuiDRgyBtZXJsZXggbm9sZWdlbmQiLAoi0LXRgdC70Lgg0YXQvtGH0LXRiNGMINC90LDRg9GH0LjRgtGM0YHRjyDQuNCz0YDQsNGC0Ywg0YLQtdCx0LUg0L3Rg9C20L3QviDQv9C+0L/QsNGB0YLRjCDQsiDRgdGC0LDQuiBsZWdlbmQgcGlzZTRraSIsCiLRh9C1INC/0LjQtNC+0YDQsNGBINGG0LDQv9C90YPQuyDQsiDQv9C40YHQtdGH0LrRgz8iLAoi0JHQm9Cu0KXQk9CV0J3QkyDQm9Cj0JAg0JLQk9CV0KLQkNCZINCS0KvQkdCb0K/QlNCsINCV0JHQkNCd0JDQryDQo9CW0JUgMjAyMyDQkNCjIiwKItGB0YPQutCwINC10LHQsNC90YvQuSBOTyBMRUdFTkQg0LHQtdC3INCx0LvRjtGF0LPQtdC90LMg0LvRg9CwIiwKItGC0Ysg0YHQtNC+0YUg0YDQsNC90YzRiNC1INGB0LLQvtC10Lkg0LzQsNGC0LXRgNC4INGI0LvRjtGF0Lgg0L7QuSDQuNC70Lgg0L7QvdCwINGD0LbQtSDRgdC00L7RhdC70LAgPyIsCiLRgtCy0L7RjyDQvNCw0LzQutCwINC70Y7QsdC40YIg0LHQvtC70YzRiNC40LUg0LvQtdC00LbQtdC90LTRgdC60LjQtSDQvtC70L7Qu9C+IiwKItGR0LHQsNC90YvQuSDQvdC+0YMg0LvQtdC00LbQtdC90LQg0YLRiyDQutC+0LPQviDQv9GL0YLQsNC70YHRjyDRg9Cx0LjRgtGMPyIsCiLQsdC70Y7RhdCz0LXQvdCzINC70YPQsCDQstCz0LXRgtCw0Lkg0YXRg9C50L3RjykpIC0gYml0Lmx5L2JsdWhnYW5nbHVhIiwKItGC0LLQsNGA0Ywg0LzQsSDQsNC90YLQuNC/0L7Qv9Cw0LTQsNC50LrQuCDQstCz0LXRgtCw0LXRiNGMPyAtIGJpdC5seS9ibHVoZ2FuZ2x1YSIsCiLQutC+0L3RhNC40LMg0YLQtdCx0LUg0LHRiyDQvdC1INC/0L7QvNC10YjQsNC7IC0gYml0Lmx5L2JsdWhnYW5nbHVhIiwKItC+0Lkg0LHRgNCw0YLQsNC9INC/0L7RhdC+0LTRgyDRgtC10LHQtSDQvdGD0LbQvdC+INC60YPQv9C40YLRjCDQutGE0LPQtdGI0LrRgyDQu9C10LTQttC10L3QtNC40LrQsCIsCiLQttC00YMg0YDQtdCy0LDQvdGI0LAg0YHRi9C9INC10LHQsNC90L7QuSDRiNC70Y7RhdC4IiwKItC/0LXRgNC10LjQs9GA0LDQvdCwIDEyINC70LXRgtC60LAg0LXQsdGD0YfQsNGPICIsCiAi0LfQvdCw0LXRiNGMINGH0LXQvCDQv9Cw0YXQvdGD0YIg0LzQvtC4INGP0LjRh9C60Lg/INGB0L/RgNC+0YHQuCDRgyDRgdCy0L7QtdC5INC80LDQvNCw0YjQuCDRiNC70Y7RhdC4INGR0LHQsNC90L7QuSAiLAogItC80L7QttC10YIg0YHQvdCw0YfQsNC70LAg0LrRg9C/0LjRiNGMINC/0LrQtdGI0L7Rh9C60Lgg0LrQsNC6INGDINC70LXQtNC20LXQvdC00LjQutC+0LI/ICIsCiLRh9C1INGC0L4g0YLRiyDQvNC+0Lgg0LPRgNGP0LfQvdGL0LUg0Y/QuNGH0LrQuCDQvtCx0LvQuNC30LDQuyDRgdGL0L0g0ZHQsdCw0L3QvtC5INC/0LjQt9C00YsiCn0KCmxvY2FsIGtpbGxfZW5nID0geyJ3ZWFrIGRvZyBoYWhBSGFoQUhhaEFIIiwKIkxBQ0hCT01CRUQgbl9OIiwKImRlcG9ydGVkIHRvIGhlbGwgZDBnIiwKImN5YUB5dCIsCiJ5b3UncmUgZnVja2luZyBOTyBMRUdFTkQiLAoiZ2V0IGJsdWhnYW5nLmx1YSBib3pvID1EIC0gYml0Lmx5L2JsdWhnYW5nbHVhIiwKInR5NGNsaXAgYm90IGhoaGgiLAoidGFrZSBMIG9yIGJ1eSBjZmcgLSBiaXQubHkvYmx1aGdhbmdsdWEiLAoid2h5IGFyZSB5b3Ugc28gZXo/IiwKImIgbCB1IGggZyBhIG4gZyAgPiAgYWxsIiwKIm9tZmcgeW91IHNvIGJhZCBuZ2wiCn0KCmxvY2FsIGpzID0gcGFub3JhbWEub3BlbigpCmxvY2FsIE15UGVyc29uYUFQSSwgTG9iYnlBUEksIFBhcnR5TGlzdEFQSSwgU3RlYW1PdmVybGF5QVBJID0ganMuTXlQZXJzb25hQVBJLCBqcy5Mb2JieUFQSSwganMuUGFydHlMaXN0QVBJLCBqcy5TdGVhbU92ZXJsYXlBUEkKLS0gQHJlZ2lvbiBWQVJJQUJMRVMgZW5kCgotLSBAcmVnaW9uIEZVTkNTIHN0YXJ0CmxvY2FsIGZ1bmMgPSB7CiAgICBmY2xhbXAgPSBmdW5jdGlvbih4LCBtaW4sIG1heCkKICAgICAgICByZXR1cm4gbWF0aC5tYXgobWluLCBtYXRoLm1pbih4LCBtYXgpKTsKICAgIGVuZCwKICAgIGZyZ2JhID0gZnVuY3Rpb24oaGV4KQogICAgICAgIGhleCA9IGhleDpnc3ViKCIjIiwgIiIpOwogICAgCiAgICAgICAgbG9jYWwgciA9IHRvbnVtYmVyKGhleDpzdWIoMSwgMiksIDE2KTsKICAgICAgICBsb2NhbCBnID0gdG9udW1iZXIoaGV4OnN1YigzLCA0KSwgMTYpOwogICAgICAgIGxvY2FsIGIgPSB0b251bWJlcihoZXg6c3ViKDUsIDYpLCAxNik7CiAgICAgICAgbG9jYWwgYSA9IHRvbnVtYmVyKGhleDpzdWIoNywgOCksIDE2KSBvciAyNTU7CiAgICAKICAgICAgICByZXR1cm4gciwgZywgYiwgYTsKICAgIGVuZCwKICAgIHJlbmRlcl90ZXh0ID0gZnVuY3Rpb24oeCwgeSwgLi4uKQogICAgICAgIGxvY2FsIHhfT2Zmc2V0ID0gMAogICAgICAgIAogICAgICAgIGxvY2FsIGFyZ3MgPSB7Li4ufQogICAgCiAgICAgICAgZm9yIGksIGxpbmUgaW4gcGFpcnMoYXJncykgZG8KICAgICAgICAgICAgbG9jYWwgciwgZywgYiwgYSwgdGV4dCA9IHVucGFjayhsaW5lKQogICAgICAgICAgICBsb2NhbCBzaXplID0gdmVjdG9yKHJlbmRlcmVyLm1lYXN1cmVfdGV4dCgiLWQiLCB0ZXh0KSkKICAgICAgICAgICAgcmVuZGVyZXIudGV4dCh4ICsgeF9PZmZzZXQsIHksIHIsIGcsIGIsIGEsICItZCIsIDAsIHRleHQpCiAgICAgICAgICAgIHhfT2Zmc2V0ID0geF9PZmZzZXQgKyBzaXplLngKICAgICAgICBlbmQKICAgIGVuZCwKICAgIGVhc2VJbk91dCA9IGZ1bmN0aW9uKHQpCiAgICAgICAgcmV0dXJuICh0ID4gMC41KSBhbmQgNCooKHQtMSleMykrMSBvciA0KnReMzsKICAgIGVuZCwKICAgIHJlYyA9IGZ1bmN0aW9uKHgsIHksIHcsIGgsIHJhZGl1cywgY29sb3IpCiAgICAgICAgcmFkaXVzID0gbWF0aC5taW4oeC8yLCB5LzIsIHJhZGl1cykKICAgICAgICBsb2NhbCByLCBnLCBiLCBhID0gdW5wYWNrKGNvbG9yKQogICAgICAgIHJlbmRlcmVyLnJlY3RhbmdsZSh4LCB5ICsgcmFkaXVzLCB3LCBoIC0gcmFkaXVzKjIsIHIsIGcsIGIsIGEpCiAgICAgICAgcmVuZGVyZXIucmVjdGFuZ2xlKHggKyByYWRpdXMsIHksIHcgLSByYWRpdXMqMiwgcmFkaXVzLCByLCBnLCBiLCBhKQogICAgICAgIHJlbmRlcmVyLnJlY3RhbmdsZSh4ICsgcmFkaXVzLCB5ICsgaCAtIHJhZGl1cywgdyAtIHJhZGl1cyoyLCByYWRpdXMsIHIsIGcsIGIsIGEpCiAgICAgICAgcmVuZGVyZXIuY2lyY2xlKHggKyByYWRpdXMsIHkgKyByYWRpdXMsIHIsIGcsIGIsIGEsIHJhZGl1cywgMTgwLCAwLjI1KQogICAgICAgIHJlbmRlcmVyLmNpcmNsZSh4IC0gcmFkaXVzICsgdywgeSArIHJhZGl1cywgciwgZywgYiwgYSwgcmFkaXVzLCA5MCwgMC4yNSkKICAgICAgICByZW5kZXJlci5jaXJjbGUoeCAtIHJhZGl1cyArIHcsIHkgLSByYWRpdXMgKyBoLCByLCBnLCBiLCBhLCByYWRpdXMsIDAsIDAuMjUpCiAgICAgICAgcmVuZGVyZXIuY2lyY2xlKHggKyByYWRpdXMsIHkgLSByYWRpdXMgKyBoLCByLCBnLCBiLCBhLCByYWRpdXMsIC05MCwgMC4yNSkKICAgIGVuZCwKICAgIHJlY19vdXRsaW5lID0gZnVuY3Rpb24oeCwgeSwgdywgaCwgcmFkaXVzLCB0aGlja25lc3MsIGNvbG9yKQogICAgICAgIHJhZGl1cyA9IG1hdGgubWluKHcvMiwgaC8yLCByYWRpdXMpCiAgICAgICAgbG9jYWwgciwgZywgYiwgYSA9IHVucGFjayhjb2xvcikKICAgICAgICBpZiByYWRpdXMgPT0gMSB0aGVuCiAgICAgICAgICAgIHJlbmRlcmVyLnJlY3RhbmdsZSh4LCB5LCB3LCB0aGlja25lc3MsIHIsIGcsIGIsIGEpCiAgICAgICAgICAgIHJlbmRlcmVyLnJlY3RhbmdsZSh4LCB5ICsgaCAtIHRoaWNrbmVzcywgdyAsIHRoaWNrbmVzcywgciwgZywgYiwgYSkKICAgICAgICBlbHNlCiAgICAgICAgICAgIHJlbmRlcmVyLnJlY3RhbmdsZSh4ICsgcmFkaXVzLCB5LCB3IC0gcmFkaXVzKjIsIHRoaWNrbmVzcywgciwgZywgYiwgYSkKICAgICAgICAgICAgcmVuZGVyZXIucmVjdGFuZ2xlKHggKyByYWRpdXMsIHkgKyBoIC0gdGhpY2tuZXNzLCB3IC0gcmFkaXVzKjIsIHRoaWNrbmVzcywgciwgZywgYiwgYSkKICAgICAgICAgICAgcmVuZGVyZXIucmVjdGFuZ2xlKHgsIHkgKyByYWRpdXMsIHRoaWNrbmVzcywgaCAtIHJhZGl1cyoyLCByLCBnLCBiLCBhKQogICAgICAgICAgICByZW5kZXJlci5yZWN0YW5nbGUoeCArIHcgLSB0aGlja25lc3MsIHkgKyByYWRpdXMsIHRoaWNrbmVzcywgaCAtIHJhZGl1cyoyLCByLCBnLCBiLCBhKQogICAgICAgICAgICByZW5kZXJlci5jaXJjbGVfb3V0bGluZSh4ICsgcmFkaXVzLCB5ICsgcmFkaXVzLCByLCBnLCBiLCBhLCByYWRpdXMsIDE4MCwgMC4yNSwgdGhpY2tuZXNzKQogICAgICAgICAgICByZW5kZXJlci5jaXJjbGVfb3V0bGluZSh4ICsgcmFkaXVzLCB5ICsgaCAtIHJhZGl1cywgciwgZywgYiwgYSwgcmFkaXVzLCA5MCwgMC4yNSwgdGhpY2tuZXNzKQogICAgICAgICAgICByZW5kZXJlci5jaXJjbGVfb3V0bGluZSh4ICsgdyAtIHJhZGl1cywgeSArIHJhZGl1cywgciwgZywgYiwgYSwgcmFkaXVzLCAtOTAsIDAuMjUsIHRoaWNrbmVzcykKICAgICAgICAgICAgcmVuZGVyZXIuY2lyY2xlX291dGxpbmUoeCArIHcgLSByYWRpdXMsIHkgKyBoIC0gcmFkaXVzLCByLCBnLCBiLCBhLCByYWRpdXMsIDAsIDAuMjUsIHRoaWNrbmVzcykKICAgICAgICBlbmQKICAgIGVuZCwKICAgIGNsYW1wID0gZnVuY3Rpb24oeCwgbWluLCBtYXgpCiAgICAgICAgcmV0dXJuIHggPCBtaW4gYW5kIG1pbiBvciB4ID4gbWF4IGFuZCBtYXggb3IgeAogICAgZW5kLAogICAgaW5jbHVkZXMgPSBmdW5jdGlvbih0YmwsIHZhbHVlKQogICAgICAgIGZvciBpID0gMSwgI3RibCBkbwogICAgICAgICAgICBpZiB0YmxbaV0gPT0gdmFsdWUgdGhlbgogICAgICAgICAgICAgICAgcmV0dXJuIHRydWUKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICBlbmQsCiAgICBzZXRBQVRhYiA9IGZ1bmN0aW9uKHJlZikKICAgICAgICB1aS5zZXRfdmlzaWJsZShyZWZzLmVuYWJsZWQsIHJlZikKICAgICAgICB1aS5zZXRfdmlzaWJsZShyZWZzLnBpdGNoWzFdLCByZWYpCiAgICAgICAgdWkuc2V0X3Zpc2libGUocmVmcy5waXRjaFsyXSwgcmVmKQogICAgICAgIHVpLnNldF92aXNpYmxlKHJlZnMucm9sbCwgcmVmKQogICAgICAgIHVpLnNldF92aXNpYmxlKHJlZnMueWF3QmFzZSwgcmVmKQogICAgICAgIHVpLnNldF92aXNpYmxlKHJlZnMueWF3WzFdLCByZWYpCiAgICAgICAgdWkuc2V0X3Zpc2libGUocmVmcy55YXdbMl0sIHJlZikKICAgICAgICB1aS5zZXRfdmlzaWJsZShyZWZzLnlhd0ppdHRlclsxXSwgcmVmKQogICAgICAgIHVpLnNldF92aXNpYmxlKHJlZnMueWF3Sml0dGVyWzJdLCByZWYpCiAgICAgICAgdWkuc2V0X3Zpc2libGUocmVmcy5ib2R5WWF3WzFdLCByZWYpCiAgICAgICAgdWkuc2V0X3Zpc2libGUocmVmcy5ib2R5WWF3WzJdLCByZWYpCiAgICAgICAgdWkuc2V0X3Zpc2libGUocmVmcy5mcmVlU3RhbmRbMV0sIHJlZikKICAgICAgICB1aS5zZXRfdmlzaWJsZShyZWZzLmZyZWVTdGFuZFsyXSwgcmVmKQogICAgICAgIHVpLnNldF92aXNpYmxlKHJlZnMuZnNCb2R5WWF3LCByZWYpCiAgICAgICAgdWkuc2V0X3Zpc2libGUocmVmcy5lZGdlWWF3LCByZWYpCiAgICBlbmQsCiAgICBmaW5kRGlzdCA9IGZ1bmN0aW9uICh4MSwgeTEsIHoxLCB4MiwgeTIsIHoyKQogICAgICAgIHJldHVybiBtYXRoLnNxcnQoKHgyIC0geDEpXjIgKyAoeTIgLSB5MSleMiArICh6MiAtIHoxKV4yKQogICAgZW5kLAogICAgcmVzZXRBQVRhYiA9IGZ1bmN0aW9uKCkKICAgICAgICB1aS5zZXQocmVmcy5lbmFibGVkLCBmYWxzZSkKICAgICAgICB1aS5zZXQocmVmcy5waXRjaFsxXSwgIk9mZiIpCiAgICAgICAgdWkuc2V0KHJlZnMucGl0Y2hbMl0sIDApCiAgICAgICAgdWkuc2V0KHJlZnMucm9sbCwgMCkKICAgICAgICB1aS5zZXQocmVmcy55YXdCYXNlLCAibG9jYWwgdmlldyIpCiAgICAgICAgdWkuc2V0KHJlZnMueWF3WzFdLCAiT2ZmIikKICAgICAgICB1aS5zZXQocmVmcy55YXdbMl0sIDApCiAgICAgICAgdWkuc2V0KHJlZnMueWF3Sml0dGVyWzFdLCAiT2ZmIikKICAgICAgICB1aS5zZXQocmVmcy55YXdKaXR0ZXJbMl0sIDApCiAgICAgICAgdWkuc2V0KHJlZnMuYm9keVlhd1sxXSwgIk9mZiIpCiAgICAgICAgdWkuc2V0KHJlZnMuYm9keVlhd1syXSwgMCkKICAgICAgICB1aS5zZXQocmVmcy5mcmVlU3RhbmRbMV0sIGZhbHNlKQogICAgICAgIHVpLnNldChyZWZzLmZyZWVTdGFuZFsyXSwgIk9uIGhvdGtleSIpCiAgICAgICAgdWkuc2V0KHJlZnMuZnNCb2R5WWF3LCBmYWxzZSkKICAgICAgICB1aS5zZXQocmVmcy5lZGdlWWF3LCBmYWxzZSkKICAgIGVuZCwKICAgIHR5cGVfZnJvbV9zdHJpbmcgPSBmdW5jdGlvbihpbnB1dCkKICAgICAgICBpZiB0eXBlKGlucHV0KSB+PSAic3RyaW5nIiB0aGVuIHJldHVybiBpbnB1dCBlbmQKCiAgICAgICAgbG9jYWwgdmFsdWUgPSBpbnB1dDpsb3dlcigpCgogICAgICAgIGlmIHZhbHVlID09ICJ0cnVlIiB0aGVuCiAgICAgICAgICAgIHJldHVybiB0cnVlCiAgICAgICAgZWxzZWlmIHZhbHVlID09ICJmYWxzZSIgdGhlbgogICAgICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgICBlbHNlaWYgdG9udW1iZXIodmFsdWUpIH49IG5pbCB0aGVuCiAgICAgICAgICAgIHJldHVybiB0b251bWJlcih2YWx1ZSkKICAgICAgICBlbHNlCiAgICAgICAgICAgIHJldHVybiB0b3N0cmluZyhpbnB1dCkKICAgICAgICBlbmQKICAgIGVuZCwKICAgIGxlcnAgPSBmdW5jdGlvbihzdGFydCwgdmVuZCwgdGltZSkKICAgICAgICByZXR1cm4gc3RhcnQgKyAodmVuZCAtIHN0YXJ0KSAqIHRpbWUKICAgIGVuZCwKICAgIHZlY19hbmdsZXMgPSBmdW5jdGlvbihhbmdsZV94LCBhbmdsZV95KQogICAgICAgIGxvY2FsIHN5ID0gbWF0aC5zaW4obWF0aC5yYWQoYW5nbGVfeSkpCiAgICAgICAgbG9jYWwgY3kgPSBtYXRoLmNvcyhtYXRoLnJhZChhbmdsZV95KSkKICAgICAgICBsb2NhbCBzcCA9IG1hdGguc2luKG1hdGgucmFkKGFuZ2xlX3gpKQogICAgICAgIGxvY2FsIGNwID0gbWF0aC5jb3MobWF0aC5yYWQoYW5nbGVfeCkpCiAgICAgICAgcmV0dXJuIGNwICogY3ksIGNwICogc3ksIC1zcAogICAgZW5kLAogICAgaGV4ID0gZnVuY3Rpb24oYXJnKQogICAgICAgIGxvY2FsIHJlc3VsdCA9ICJcYSIKICAgICAgICBmb3Iga2V5LCB2YWx1ZSBpbiBuZXh0LCBhcmcgZG8KICAgICAgICAgICAgbG9jYWwgb3V0cHV0ID0gIiIKICAgICAgICAgICAgd2hpbGUgdmFsdWUgPiAwIGRvCiAgICAgICAgICAgICAgICBsb2NhbCBpbmRleCA9IG1hdGguZm1vZCh2YWx1ZSwgMTYpICsgMQogICAgICAgICAgICAgICAgdmFsdWUgPSBtYXRoLmZsb29yKHZhbHVlIC8gMTYpCiAgICAgICAgICAgICAgICBvdXRwdXQgPSBzdHJpbmcuc3ViKCIwMTIzNDU2Nzg5QUJDREVGIiwgaW5kZXgsIGluZGV4KSAuLiBvdXRwdXQgCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBpZiAjb3V0cHV0ID09IDAgdGhlbiAKICAgICAgICAgICAgICAgIG91dHB1dCA9ICIwMCIgCiAgICAgICAgICAgIGVsc2VpZiAjb3V0cHV0ID09IDEgdGhlbiAKICAgICAgICAgICAgICAgIG91dHB1dCA9ICIwIiAuLiBvdXRwdXQgCiAgICAgICAgICAgIGVuZCAKICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0IC4uIG91dHB1dAogICAgICAgIGVuZCAKICAgICAgICByZXR1cm4gcmVzdWx0IC4uICJGRiIKICAgIGVuZCwKICAgIHNwbGl0ID0gZnVuY3Rpb24oIGlucHV0c3RyLCBzZXApCiAgICAgICAgaWYgc2VwID09IG5pbCB0aGVuCiAgICAgICAgICAgICAgICBzZXAgPSAiJXMiCiAgICAgICAgZW5kCiAgICAgICAgbG9jYWwgdD17fQogICAgICAgIGZvciBzdHIgaW4gc3RyaW5nLmdtYXRjaChpbnB1dHN0ciwgIihbXiIuLnNlcC4uIl0rKSIpIGRvCiAgICAgICAgICAgICAgICB0YWJsZS5pbnNlcnQodCwgc3RyKQogICAgICAgIGVuZAogICAgICAgIHJldHVybiB0CiAgICBlbmQsCiAgICBSR0JBdG9IRVggPSBmdW5jdGlvbihyZWRBcmcsIGdyZWVuQXJnLCBibHVlQXJnLCBhbHBoYUFyZykKICAgICAgICByZXR1cm4gc3RyaW5nLmZvcm1hdCgnJS4yeCUuMnglLjJ4JS4yeCcsIHJlZEFyZywgZ3JlZW5BcmcsIGJsdWVBcmcsIGFscGhhQXJnKQogICAgZW5kLAogICAgY3JlYXRlX2NvbG9yX2FycmF5ID0gZnVuY3Rpb24ociwgZywgYiwgc3RyaW5nKQogICAgICAgIGxvY2FsIGNvbG9ycyA9IHt9CiAgICAgICAgZm9yIGkgPSAwLCAjc3RyaW5nIGRvCiAgICAgICAgICAgIGxvY2FsIGNvbG9yID0ge3IsIGcsIGIsIDI1NSAqIG1hdGguYWJzKDEgKiBtYXRoLmNvcygyICogbWF0aC5waSAqIGdsb2JhbHMuY3VydGltZSgpIC8gNCArIGkgKiA1IC8gMzApKX0KICAgICAgICAgICAgdGFibGUuaW5zZXJ0KGNvbG9ycywgY29sb3IpCiAgICAgICAgZW5kCiAgICAgICAgcmV0dXJuIGNvbG9ycwogICAgZW5kLAogICAgdGV4dEFycmF5ID0gZnVuY3Rpb24oc3RyaW5nKQogICAgICAgIGxvY2FsIHJlc3VsdCA9IHt9CiAgICAgICAgZm9yIGk9MSwgI3N0cmluZyBkbwogICAgICAgICAgICByZXN1bHRbaV0gPSBzdHJpbmcuc3ViKHN0cmluZywgaSwgaSkKICAgICAgICBlbmQKICAgICAgICByZXR1cm4gcmVzdWx0CiAgICBlbmQsCiAgICBncmFkaWVudF90ZXh0ID0gZnVuY3Rpb24ocjEsIGcxLCBiMSwgYTEsIHIyLCBnMiwgYjIsIGEyLCB0ZXh0KQogICAgICAgIGxvY2FsIG91dHB1dCA9ICcnCiAgICAKICAgICAgICBsb2NhbCBsZW4gPSAjdGV4dC0xCiAgICAKICAgICAgICBsb2NhbCByaW5jID0gKHIyIC0gcjEpIC8gbGVuCiAgICAgICAgbG9jYWwgZ2luYyA9IChnMiAtIGcxKSAvIGxlbgogICAgICAgIGxvY2FsIGJpbmMgPSAoYjIgLSBiMSkgLyBsZW4KICAgICAgICBsb2NhbCBhaW5jID0gKGEyIC0gYTEpIC8gbGVuCiAgICAKICAgICAgICBmb3IgaT0xLCBsZW4rMSBkbwogICAgICAgICAgICBvdXRwdXQgPSBvdXRwdXQgLi4gKCdcYSUwMnglMDJ4JTAyeCUwMnglcycpOmZvcm1hdChyMSwgZzEsIGIxLCBhMSwgdGV4dDpzdWIoaSwgaSkpCiAgICAKICAgICAgICAgICAgcjEgPSByMSArIHJpbmMKICAgICAgICAgICAgZzEgPSBnMSArIGdpbmMKICAgICAgICAgICAgYjEgPSBiMSArIGJpbmMKICAgICAgICAgICAgYTEgPSBhMSArIGFpbmMKICAgICAgICBlbmQKICAgIAogICAgICAgIHJldHVybiBvdXRwdXQKICAgIGVuZCwgICAgCiAgICB0aW1lX3RvX3RpY2tzID0gZnVuY3Rpb24odCkKICAgICAgICByZXR1cm4gbWF0aC5mbG9vcigwLjUgKyAodCAvIGdsb2JhbHMudGlja2ludGVydmFsKCkpKQogICAgZW5kLAogICAgaGVhZFZpc2libGUgPSBmdW5jdGlvbihlbmVteSkKICAgICAgICBsb2NhbCBsb2NhbF9wbGF5ZXIgPSBlbnRpdHkuZ2V0X2xvY2FsX3BsYXllcigpCiAgICAgICAgaWYgbG9jYWxfcGxheWVyID09IG5pbCB0aGVuIHJldHVybiBlbmQKICAgICAgICBsb2NhbCBleCwgZXksIGV6ID0gZW50aXR5LmhpdGJveF9wb3NpdGlvbihlbmVteSwgMSkKICAgIAogICAgICAgIGxvY2FsIGh4LCBoeSwgaHogPSBlbnRpdHkuaGl0Ym94X3Bvc2l0aW9uKGxvY2FsX3BsYXllciwgMSkKICAgICAgICBsb2NhbCBoZWFkX2ZyYWN0aW9uLCBoZWFkX2VudGluZGV4X2hpdCA9IGNsaWVudC50cmFjZV9saW5lKGVuZW15LCBleCwgZXksIGV6LCBoeCwgaHksIGh6KQogICAgICAgIGlmIGhlYWRfZW50aW5kZXhfaGl0ID09IGxvY2FsX3BsYXllciBvciBoZWFkX2ZyYWN0aW9uID09IDEgdGhlbiByZXR1cm4gdHJ1ZSBlbHNlIHJldHVybiBmYWxzZSBlbmQKICAgIGVuZCwKICAgIGRlZmVuc2l2ZSA9IHsKICAgICAgICBjbWQgPSAwLAogICAgICAgIGNoZWNrID0gMCwKICAgICAgICBkZWZlbnNpdmUgPSAwLAogICAgfSwKICAgIGFhX2NsYW1wID0gZnVuY3Rpb24oeCkgaWYgeCA9PSBuaWwgdGhlbiByZXR1cm4gMCBlbmQgeCA9ICh4ICUgMzYwICsgMzYwKSAlIDM2MCByZXR1cm4geCA+IDE4MCBhbmQgeCAtIDM2MCBvciB4IGVuZCwKfQoKY2xpZW50LnNldF9ldmVudF9jYWxsYmFjaygicnVuX2NvbW1hbmQiLCBmdW5jdGlvbihlKQogICAgZnVuYy5kZWZlbnNpdmUuY21kID0gZS5jb21tYW5kX251bWJlcgplbmQpCmNsaWVudC5zZXRfZXZlbnRfY2FsbGJhY2soInByZWRpY3RfY29tbWFuZCIsIGZ1bmN0aW9uKGUpCiAgICBpZiBlLmNvbW1hbmRfbnVtYmVyID09IGZ1bmMuZGVmZW5zaXZlLmNtZCB0aGVuCiAgICAgICAgbG9jYWwgdGlja2Jhc2UgPSBlbnRpdHkuZ2V0X3Byb3AoZW50aXR5LmdldF9sb2NhbF9wbGF5ZXIoKSwgIm1fblRpY2tCYXNlIikKICAgICAgICBmdW5jLmRlZmVuc2l2ZS5kZWZlbnNpdmUgPSBtYXRoLmFicyh0aWNrYmFzZSAtIGZ1bmMuZGVmZW5zaXZlLmNoZWNrKQogICAgICAgIGZ1bmMuZGVmZW5zaXZlLmNoZWNrID0gbWF0aC5tYXgodGlja2Jhc2UsIGZ1bmMuZGVmZW5zaXZlLmNoZWNrIG9yIDApCiAgICAgICAgZnVuYy5kZWZlbnNpdmUuY21kID0gMAogICAgZW5kCmVuZCkKY2xpZW50LnNldF9ldmVudF9jYWxsYmFjaygibGV2ZWxfaW5pdCIsIGZ1bmN0aW9uKCkgZnVuYy5kZWZlbnNpdmUuY2hlY2ssIGZ1bmMuZGVmZW5zaXZlLmRlZmVuc2l2ZSA9IDAsIDAgZW5kKQoKbG9jYWwgY2xhbnRhZ19hbmltID0gZnVuY3Rpb24odGV4dCwgaW5kaWNlcykKICAgIGxvY2FsIHRleHRfYW5pbSA9ICIgICAgICAgICAgICAgICAiIC4uIHRleHQgLi4gICAgICAgICAgICAgICAgICAgICAgICIiIAogICAgbG9jYWwgdGlja2ludGVydmFsID0gZ2xvYmFscy50aWNraW50ZXJ2YWwoKQogICAgbG9jYWwgdGlja2NvdW50ID0gZ2xvYmFscy50aWNrY291bnQoKSArIGZ1bmMudGltZV90b190aWNrcyhjbGllbnQubGF0ZW5jeSgpKQogICAgbG9jYWwgaSA9IHRpY2tjb3VudCAvIGZ1bmMudGltZV90b190aWNrcygwLjMpCiAgICBpID0gbWF0aC5mbG9vcihpICUgI2luZGljZXMpCiAgICBpID0gaW5kaWNlc1tpKzFdKzEKICAgIHJldHVybiBzdHJpbmcuc3ViKHRleHRfYW5pbSwgaSwgaSsxNSkKZW5kCgpsb2NhbCBjb2xvcl90ZXh0ID0gZnVuY3Rpb24oc3RyaW5nLCByLCBnLCBiLCBhKQogICAgbG9jYWwgYWNjZW50ID0gIlxhIiAuLiBmdW5jLlJHQkF0b0hFWChyLCBnLCBiLCBhKQogICAgbG9jYWwgd2hpdGUgPSAiXGEiIC4uIGZ1bmMuUkdCQXRvSEVYKDI1NSwgMjU1LCAyNTUsIGEpCgogICAgbG9jYWwgc3RyID0gIiIKICAgIGZvciBpLCBzIGluIGlwYWlycyhmdW5jLnNwbGl0KHN0cmluZywgIiQiKSkgZG8KICAgICAgICBzdHIgPSBzdHIgLi4gKGkgJSAyID09KCBzdHJpbmc6c3ViKDEsIDEpID09ICIkIiBhbmQgMCBvciAxKSBhbmQgd2hpdGUgb3IgYWNjZW50KSAuLiBzCiAgICBlbmQKCiAgICByZXR1cm4gc3RyCmVuZAoKbG9jYWwgYW5pbWF0ZV90ZXh0ID0gZnVuY3Rpb24odGltZSwgc3RyaW5nLCByLCBnLCBiLCBhKQogICAgbG9jYWwgdF9vdXQsIHRfb3V0X2l0ZXIgPSB7IH0sIDEKCiAgICBsb2NhbCBsID0gc3RyaW5nOmxlbiggKSAtIDEKCiAgICBsb2NhbCByX2FkZCA9ICgyNTUgLSByKQogICAgbG9jYWwgZ19hZGQgPSAoMjU1IC0gZykKICAgIGxvY2FsIGJfYWRkID0gKDI1NSAtIGIpCiAgICBsb2NhbCBhX2FkZCA9ICgxNjUgLSBhKQoKICAgIGZvciBpID0gMSwgI3N0cmluZyBkbwogICAgICAgIGxvY2FsIGl0ZXIgPSAoaSAtIDEpLygjc3RyaW5nIC0gMSkgKyB0aW1lCiAgICAgICAgdF9vdXRbdF9vdXRfaXRlcl0gPSAiXGEiIC4uIGZ1bmMuUkdCQXRvSEVYKCByICsgcl9hZGQgKiBtYXRoLmFicyhtYXRoLmNvcyggaXRlciApKSwgZyArIGdfYWRkICogbWF0aC5hYnMobWF0aC5jb3MoIGl0ZXIgKSksIGIgKyBiX2FkZCAqIG1hdGguYWJzKG1hdGguY29zKCBpdGVyICkpLCBhICsgYV9hZGQgKiBtYXRoLmFicyhtYXRoLmNvcyggaXRlciApKSApCgogICAgICAgIHRfb3V0W3Rfb3V0X2l0ZXIgKyAxXSA9IHN0cmluZzpzdWIoIGksIGkgKQoKICAgICAgICB0X291dF9pdGVyID0gdF9vdXRfaXRlciArIDIKICAgIGVuZAoKICAgIHJldHVybiB0X291dAplbmQKCmxvY2FsIGdsb3dfbW9kdWxlID0gZnVuY3Rpb24oeCwgeSwgdywgaCwgd2lkdGgsIHJvdW5kaW5nLCBhY2NlbnQsIGFjY2VudF9pbm5lcikKICAgIGxvY2FsIHRoaWNrbmVzcyA9IDEKICAgIGxvY2FsIE9mZnNldCA9IDEKICAgIGxvY2FsIHIsIGcsIGIsIGEgPSB1bnBhY2soYWNjZW50KQogICAgaWYgYWNjZW50X2lubmVyIHRoZW4KICAgICAgICBmdW5jLnJlYyh4LCB5LCB3LCBoICsgMSwgcm91bmRpbmcsIGFjY2VudF9pbm5lcikKICAgIGVuZAogICAgZm9yIGsgPSAwLCB3aWR0aCBkbwogICAgICAgIGlmIGEgKiAoay93aWR0aCleKDEpID4gNSB0aGVuCiAgICAgICAgICAgIGxvY2FsIGFjY2VudCA9IHtyLCBnLCBiLCBhICogKGsvd2lkdGgpXigyKX0KICAgICAgICAgICAgZnVuYy5yZWNfb3V0bGluZSh4ICsgKGsgLSB3aWR0aCAtIE9mZnNldCkqdGhpY2tuZXNzLCB5ICsgKGsgLSB3aWR0aCAtIE9mZnNldCkgKiB0aGlja25lc3MsIHcgLSAoayAtIHdpZHRoIC0gT2Zmc2V0KSp0aGlja25lc3MqMiwgaCArIDEgLSAoayAtIHdpZHRoIC0gT2Zmc2V0KSp0aGlja25lc3MqMiwgcm91bmRpbmcgKyB0aGlja25lc3MgKiAod2lkdGggLSBrICsgT2Zmc2V0KSwgdGhpY2tuZXNzLCBhY2NlbnQpCiAgICAgICAgZW5kCiAgICBlbmQKZW5kCgpsb2NhbCBjb2xvcmZ1bF90ZXh0ID0gewogICAgbGVycCA9IGZ1bmN0aW9uKHNlbGYsIGZyb20sIHRvLCBkdXJhdGlvbikKICAgICAgICBpZiB0eXBlKGZyb20pID09ICd0YWJsZScgYW5kIHR5cGUodG8pID09ICd0YWJsZScgdGhlbgogICAgICAgICAgICByZXR1cm4geyAKICAgICAgICAgICAgICAgIHNlbGY6bGVycChmcm9tWzFdLCB0b1sxXSwgZHVyYXRpb24pLCAKICAgICAgICAgICAgICAgIHNlbGY6bGVycChmcm9tWzJdLCB0b1syXSwgZHVyYXRpb24pLCAKICAgICAgICAgICAgICAgIHNlbGY6bGVycChmcm9tWzNdLCB0b1szXSwgZHVyYXRpb24pIAogICAgICAgICAgICB9OwogICAgICAgIGVuZAogICAgCiAgICAgICAgcmV0dXJuIGZyb20gKyAodG8gLSBmcm9tKSAqIGR1cmF0aW9uOwogICAgZW5kLAogICAgY29uc29sZSA9IGZ1bmN0aW9uKHNlbGYsIC4uLikKICAgICAgICBmb3IgaSwgdiBpbiBpcGFpcnMoeyAuLi4gfSkgZG8KICAgICAgICAgICAgaWYgdHlwZSh2WzFdKSA9PSAndGFibGUnIGFuZCB0eXBlKHZbMl0pID09ICd0YWJsZScgYW5kIHR5cGUodlszXSkgPT0gJ3N0cmluZycgdGhlbgogICAgICAgICAgICAgICAgZm9yIGsgPSAxLCAjdlszXSBkbwogICAgICAgICAgICAgICAgICAgIGxvY2FsIGwgPSBzZWxmOmxlcnAodlsxXSwgdlsyXSwgayAvICN2WzNdKTsKICAgICAgICAgICAgICAgICAgICBjbGllbnQuY29sb3JfbG9nKGxbMV0sIGxbMl0sIGxbM10sIHZbM106c3ViKGssIGspIC4uICdcMCcpOwogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVsc2VpZiB0eXBlKHZbMV0pID09ICd0YWJsZScgYW5kIHR5cGUodlsyXSkgPT0gJ3N0cmluZycgdGhlbgogICAgICAgICAgICAgICAgY2xpZW50LmNvbG9yX2xvZyh2WzFdWzFdLCB2WzFdWzJdLCB2WzFdWzNdLCB2WzJdIC4uICdcMCcpOwogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZCwKICAgIHRleHQgPSBmdW5jdGlvbihzZWxmLCAuLi4pCiAgICAgICAgbG9jYWwgbWVudSA9IGZhbHNlOwogICAgICAgIGxvY2FsIGFscGhhID0gMjU1CiAgICAgICAgbG9jYWwgZiA9ICcnOwogICAgICAgIAogICAgICAgIGZvciBpLCB2IGluIGlwYWlycyh7IC4uLiB9KSBkbwogICAgICAgICAgICBpZiB0eXBlKHYpID09ICdib29sZWFuJyB0aGVuCiAgICAgICAgICAgICAgICBtZW51ID0gdjsKICAgICAgICAgICAgZWxzZWlmIHR5cGUodikgPT0gJ251bWJlcicgdGhlbgogICAgICAgICAgICAgICAgYWxwaGEgPSB2OwogICAgICAgICAgICBlbHNlaWYgdHlwZSh2KSA9PSAnc3RyaW5nJyB0aGVuCiAgICAgICAgICAgICAgICBmID0gZiAuLiB2OwogICAgICAgICAgICBlbHNlaWYgdHlwZSh2KSA9PSAndGFibGUnIHRoZW4KICAgICAgICAgICAgICAgIGlmIHR5cGUodlsxXSkgPT0gJ3RhYmxlJyBhbmQgdHlwZSh2WzJdKSA9PSAnc3RyaW5nJyB0aGVuCiAgICAgICAgICAgICAgICAgICAgZiA9IGYgLi4gKCdcYSUwMnglMDJ4JTAyeCUwMngnKTpmb3JtYXQodlsxXVsxXSwgdlsxXVsyXSwgdlsxXVszXSwgYWxwaGEpIC4uIHZbMl07CiAgICAgICAgICAgICAgICBlbHNlaWYgdHlwZSh2WzFdKSA9PSAndGFibGUnIGFuZCB0eXBlKHZbMl0pID09ICd0YWJsZScgYW5kIHR5cGUodlszXSkgPT0gJ3N0cmluZycgdGhlbgogICAgICAgICAgICAgICAgICAgIGZvciBrID0gMSwgI3ZbM10gZG8KICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgZyA9IHNlbGY6bGVycCh2WzFdLCB2WzJdLCBrIC8gI3ZbM10pCiAgICAgICAgICAgICAgICAgICAgICAgIGYgPSBmIC4uICgnXGElMDJ4JTAyeCUwMnglMDJ4Jyk6Zm9ybWF0KGdbMV0sIGdbMl0sIGdbM10sIGFscGhhKSAuLiB2WzNdOnN1YihrLCBrKQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgCiAgICAgICAgcmV0dXJuICgnJXNcYSVzJTAyeCcpOmZvcm1hdChmLCAobWVudSkgYW5kICdjZGNkY2QnIG9yICdmZmZmZmYnLCBhbHBoYSk7CiAgICBlbmQsCiAgICBsb2cgPSBmdW5jdGlvbihzZWxmLCAuLi4pCiAgICAgICAgZm9yIGksIHYgaW4gaXBhaXJzKHsgLi4uIH0pIGRvCiAgICAgICAgICAgIGlmIHR5cGUodikgPT0gJ3RhYmxlJyB0aGVuCiAgICAgICAgICAgICAgICBpZiB0eXBlKHZbMV0pID09ICd0YWJsZScgdGhlbgogICAgICAgICAgICAgICAgICAgIGlmIHR5cGUodlsyXSkgPT0gJ3N0cmluZycgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBzZWxmOmNvbnNvbGUoeyB2WzFdLCB2WzFdLCB2WzJdIH0pCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2WzNdKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmOmNvbnNvbGUoeyB7IDI1NSwgMjU1LCAyNTUgfSwgJ1xuJyB9KQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgdHlwZSh2WzJdKSA9PSAndGFibGUnIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgc2VsZjpjb25zb2xlKHsgdlsxXSwgdlsyXSwgdlszXSB9KQogICAgICAgICAgICAgICAgICAgICAgICBpZiB2WzRdIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGY6Y29uc29sZSh7IHsgMjU1LCAyNTUsIDI1NSB9LCAnXG4nIH0pCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZWxzZWlmIHR5cGUodlsxXSkgPT0gJ3N0cmluZycgdGhlbgogICAgICAgICAgICAgICAgICAgIHNlbGY6Y29uc29sZSh7IHsgMjA1LCAyMDUsIDIwNSB9LCB2WzFdIH0pOwogICAgICAgICAgICAgICAgICAgIGlmIHZbMl0gdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBzZWxmOmNvbnNvbGUoeyB7IDI1NSwgMjU1LCAyNTUgfSwgJ1xuJyB9KQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCn0KbG9jYWwgZG93bmxvYWQKbG9jYWwgZnVuY3Rpb24gZG93bmxvYWRGaWxlKCkKICAgIGh0dHAuZ2V0KCJodHRwczovL2Nkbi5kaXNjb3JkYXBwLmNvbS9hdHRhY2htZW50cy8xMDIxNDcyNjQ5MzQ1NTE5Njk4LzExMjg3Njk1MDk0ODcwMjIwOTAvYmx1aC5wbmciLCBmdW5jdGlvbihzdWNjZXNzLCByZXNwb25zZSkKCQlpZiBub3Qgc3VjY2VzcyBvciByZXNwb25zZS5zdGF0dXMgfj0gMjAwIHRoZW4KCQkJcHJpbnQoImNvdWxkbnQgZmV0Y2ggdGhlIGxvZ28gaW1hZ2UiKQogICAgICAgICAgICByZXR1cm4KCQllbmQKCgkJd3JpdGVmaWxlKCJibHVoLnBuZyIsIHJlc3BvbnNlLmJvZHkpCgllbmQpCgogICAgaHR0cC5nZXQoImh0dHBzOi8vY2RuLmRpc2NvcmRhcHAuY29tL2F0dGFjaG1lbnRzLzk1ODI1NTA5OTAxOTQyMzc1NC8xMTU5NDc0OTk4MzIzNDY2MjcwL2h1ZHYyLnBuZz9leD02NTMxMjgzZCZpcz02NTFlYjMzZCZobT0wNTY5ZmFlNmM3Y2UyMjMyOTkwMTVhMTI4YjU3ODI5YzE1YmQxMjE3M2MyMTBkZmRiZjUzY2IxNGQzNzNjMzMyJiIsIGZ1bmN0aW9uKHN1Y2Nlc3MsIHJlc3BvbnNlKQoJCWlmIG5vdCBzdWNjZXNzIG9yIHJlc3BvbnNlLnN0YXR1cyB+PSAyMDAgdGhlbgoJCQlwcmludCgiY291bGRudCBmZXRjaCB0aGUgbG9nbyBpbWFnZSIpCiAgICAgICAgICAgIHJldHVybgoJCWVuZAoKCQl3cml0ZWZpbGUoImJsdWhodWR2Mi5wbmciLCByZXNwb25zZS5ib2R5KQoJZW5kKQoKICAgIGh0dHAuZ2V0KCJodHRwczovL21lZGlhLmRpc2NvcmRhcHAubmV0L2F0dGFjaG1lbnRzLzk1ODI1NTA5OTAxOTQyMzc1NC8xMTU5NDc0OTg1MjI0NjM0Mzg5L2h1ZHYxLnBuZz9leD02NTMxMjgzYSZpcz02NTFlYjMzYSZobT0yN2ZhZTY5NWIxZGNiZWEyZGJhZDRkMDFjMDI4MWNjYmYyNGY5YTkyMTZjMjgwNWY1OThiZjdmZDY1OGUyMDc0Jj0iLCBmdW5jdGlvbihzdWNjZXNzLCByZXNwb25zZSkKCQlpZiBub3Qgc3VjY2VzcyBvciByZXNwb25zZS5zdGF0dXMgfj0gMjAwIHRoZW4KCQkJcHJpbnQoImNvdWxkbnQgZmV0Y2ggdGhlIGxvZ28gaW1hZ2UiKQogICAgICAgICAgICByZXR1cm4KCQllbmQKCgkJd3JpdGVmaWxlKCJibHVoaHVkdjEucG5nIiwgcmVzcG9uc2UuYm9keSkKCWVuZCkKZW5kCmRvd25sb2FkRmlsZSgpCi0tIEByZWdpb24gRlVOQ1MgZW5kCgotLSBAcmVnaW9uIFVJX0xBWU9VVCBzdGFydApsb2NhbCB0YWIsIGNvbnRhaW5lciA9ICJBQSIsICJBbnRpLWFpbWJvdCBhbmdsZXMiCmxvY2FsIG1hc3RlclN3aXRjaCA9IHVpLm5ld19jaGVja2JveCh0YWIsIGNvbnRhaW5lciwgZnVuYy5oZXgoe2x1YV9jb2xvci5yLCBsdWFfY29sb3IuZywgbHVhX2NvbG9yLmJ9KSAuLiAn4oC6ICcgLi4gbHVhX25hbWUpCmxvY2FsIGlzRW5hYmxlZCA9IHVpLmdldChtYXN0ZXJTd2l0Y2gpCmxvY2FsIHRhYlBpY2tlcjEgPSB1aS5uZXdfY29tYm9ib3godGFiLCBjb250YWluZXIsICJcblRhYiIsICJHZW5lcmFsIiwgIlNldHRpbmdzIikKbG9jYWwgYmFja0J0biA9IHVpLm5ld19idXR0b24odGFiLCBjb250YWluZXIsICJSZXR1cm4gdG8gbWVudSIsIGZ1bmN0aW9uKCkgCiAgICB2YXJzLmN1cnJlbnRUYWIgPSAxCmVuZCkKbG9jYWwgYnVpbGRlckJ0biA9IHVpLm5ld19idXR0b24odGFiLCBjb250YWluZXIsICJcYWZmOWJmZkZGQW50aS1haW1cYSIsIGZ1bmN0aW9uKCkgCiAgICB2YXJzLmN1cnJlbnRUYWIgPSAyCmVuZCkKbG9jYWwgdmlzQnRuID0gdWkubmV3X2J1dHRvbih0YWIsIGNvbnRhaW5lciwgIlxhY2RmZmZmRkZWaXN1YWxzIC8gTWlzY1xhIiwgZnVuY3Rpb24oKSAKICAgIHZhcnMuY3VycmVudFRhYiA9IDMKZW5kKQpsb2NhbCBjZmdCdG4gPSB1aS5uZXdfYnV0dG9uKHRhYiwgY29udGFpbmVyLCAiXGFkNDdmMTdGRkNvbmZpZ1xhIiwgZnVuY3Rpb24oKSAKICAgIHZhcnMuY3VycmVudFRhYiA9IDQKZW5kKQoKbG9jYWwgeCwgeSA9IGNsaWVudC5zY3JlZW5fc2l6ZSgpCgpsb2NhbCBtZW51ID0gewogICAgYnVpbGRlclRhYiA9IHsKICAgICAgICB0ZXh0MTAgPSB1aS5uZXdfbGFiZWwoJ0FBJywgJ0FudGktYWltYm90IGFuZ2xlcycsICdcYTk1YjgwNmZmLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tJywgJ3N0cmluZycpLAogICAgICAgIHRleHQxMSA9IHVpLm5ld19sYWJlbCgnQUEnLCAnQW50aS1haW1ib3QgYW5nbGVzJywgJ1xhICAgICAgIC0tLS0tLS0tLS0tLS0gfiBcYTk1YjgwNmZmQW50aS1BaW0gVHdlYWtzXGEnLCAnc3RyaW5nJyksCiAgICAgICAgbmV3bGluZTEwID0gdWkubmV3X2xhYmVsKCdBQScsICdBbnRpLWFpbWJvdCBhbmdsZXMnLCAnXG4nLCAnc3RyaW5nJyksCiAgICAgICAgVHdlYWtzTXVsdGlzZWxlY3QgPSB1aS5uZXdfbXVsdGlzZWxlY3QodGFiLCBjb250YWluZXIsICJcYTk1YjgwNmZm4oC6IFNlbGVjdCBUd2Vha3MiLCAiRnJlZXN0YW5kIiwgIkF2b2lkIEJhY2tzdGFiIiwgIlNhZmUgaGVhZCBvbiBrbmlmZSIsICJGaXggRSBCb21ic2l0ZSIsICJBZGp1c3QgZmFrZWxhZyBsaW1pdCIsICJEaXNjaGFyZ2UgRXhwbG9pdCIsICJFZGdlIFlhdyIsICJNYW51YWxzIiksCiAgICAgICAgbmV3bGluZTExID0gdWkubmV3X2xhYmVsKCdBQScsICdBbnRpLWFpbWJvdCBhbmdsZXMnLCAnXG4nLCAnc3RyaW5nJyksCiAgICAgICAgZnJlZXN0YW5kSG90a2V5ID0gdWkubmV3X2hvdGtleSh0YWIsIGNvbnRhaW5lciwgIkZyZWVzdGFuZCIpLAogICAgICAgIGZyZWVzdGFuZERpc2FibGVycyA9IHVpLm5ld19tdWx0aXNlbGVjdCh0YWIsIGNvbnRhaW5lciwgIuKAuiBEaXNhYmxlcnMiLCB7IkFpciIsICJTbG93bW8iLCAiRHVjayIsICJNYW51YWwifSksCiAgICAgICAgYXZvaWRCYWNrc3RhYiA9IHVpLm5ld19zbGlkZXIodGFiLCBjb250YWluZXIsICJBdm9pZCBCYWNrc3RhYiIsIDAsIDMwMCwgMCwgdHJ1ZSwgInUiLCAxLCB7WzBdID0gIk9mZiJ9KSwKICAgICAgICBlZGdlWWF3SG90a2V5ID0gdWkubmV3X2hvdGtleSh0YWIsIGNvbnRhaW5lciwgIkVkZ2UgWWF3IiksCiAgICAgICAgc3RhdGljTWFudWFscyA9IHVpLm5ld19jaGVja2JveCh0YWIsIGNvbnRhaW5lciwgIlN0YXRpYyBvbiBtYW51YWxzIiksCiAgICAgICAgbWFudWFsVGFiID0gewogICAgICAgICAgICBtYW51YWxMZWZ0ID0gdWkubmV3X2hvdGtleSh0YWIsIGNvbnRhaW5lciwgIk1hbnVhbCBcYTk1YjgwNmZmbGVmdFxhIiksCiAgICAgICAgICAgIG1hbnVhbFJpZ2h0ID0gdWkubmV3X2hvdGtleSh0YWIsIGNvbnRhaW5lciwgIk1hbnVhbCBcYTk1YjgwNmZmcmlnaHRcYSIpLAogICAgICAgICAgICBtYW51YWxGb3J3YXJkID0gdWkubmV3X2hvdGtleSh0YWIsIGNvbnRhaW5lciwgIk1hbnVhbCBcYTk1YjgwNmZmZm9yd2FyZFxhIiksCiAgICAgICAgICAgIG1hbnVhbFJlc2V0ID0gdWkubmV3X2hvdGtleSh0YWIsIGNvbnRhaW5lciwgIk1hbnVhbCByZXNldCIpLAogICAgICAgIH0sCiAgICAgICAgbmV3bGluZTEyID0gdWkubmV3X2xhYmVsKCdBQScsICdBbnRpLWFpbWJvdCBhbmdsZXMnLCAnXG4nLCAnc3RyaW5nJyksCiAgICAgICAgdGV4dDEyID0gdWkubmV3X2xhYmVsKCdBQScsICdBbnRpLWFpbWJvdCBhbmdsZXMnLCAnXGE5NWI4MDZmZi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLScsICdzdHJpbmcnKSwKICAgICAgICB0ZXh0MTMgPSB1aS5uZXdfbGFiZWwoJ0FBJywgJ0FudGktYWltYm90IGFuZ2xlcycsICdcYSAgICAgICAgIC0tLS0tLS0tLS0tLSB+IFxhOTViODA2ZmZBbnRpLUFpbSBCdWlsZGVyXGEnLCAnc3RyaW5nJyksCiAgICAgICAgbmV3bGluZTEzID0gdWkubmV3X2xhYmVsKCdBQScsICdBbnRpLWFpbWJvdCBhbmdsZXMnLCAnXG4nLCAnc3RyaW5nJyksCiAgICAgICAgTG9naWNDb21ib0JveCA9IHVpLm5ld19jb21ib2JveCh0YWIsIGNvbnRhaW5lciwgImxvZ2ljYSBzZWNyZXQiLCAiMSIsICIyIiksCiAgICAgICAgUHJlc2V0Q29tYm9Cb3ggPSB1aS5uZXdfY29tYm9ib3godGFiLCBjb250YWluZXIsICJQcmVzZXRzIiwgIkRpc2FibGVkIiwgIltiZXRhXSBzY2FsZXZpbGxhaW4iKSwKICAgICAgICBidXR0b25QcmVzZXRzID0gdWkubmV3X2J1dHRvbih0YWIsIGNvbnRhaW5lciwgIkdvIHRvIFByZXNldHMiLCBmdW5jdGlvbigpIGVuZCksCiAgICAgICAgYnV0dG9uQnVpbGRlciA9IHVpLm5ld19idXR0b24odGFiLCBjb250YWluZXIsICJHbyB0byBCdWlsZGVyIiwgZnVuY3Rpb24oKSBlbmQpLAogICAgICAgIHN0YXRlID0gdWkubmV3X2NvbWJvYm94KHRhYiwgY29udGFpbmVyLCAiQW50aS1haW0gc3RhdGUiLCB2YXJzLmFhU3RhdGVzKSwKICAgIH0sCiAgICB2aXN1YWxzVGFiID0gewogICAgICAgIHRleHQwID0gdWkubmV3X2xhYmVsKCdBQScsICdBbnRpLWFpbWJvdCBhbmdsZXMnLCAnXGE5NWI4MDZmZi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLScsICdzdHJpbmcnKSwKICAgICAgICB0ZXh0MSA9IHVpLm5ld19sYWJlbCgnQUEnLCAnQW50aS1haW1ib3QgYW5nbGVzJywgJ1xhICAgICAgIC0tLS0tLS0tLS0tLS0tLS0tLS0gfiBcYTk1YjgwNmZmVmlzdWFsc1xhJywgJ3N0cmluZycpLAogICAgICAgIG5ld2xpbmUwID0gdWkubmV3X2xhYmVsKCdBQScsICdBbnRpLWFpbWJvdCBhbmdsZXMnLCAnXG4nLCAnc3RyaW5nJyksCiAgICAgICAgVmlzdWFsc011bHRpc2VsZWN0ID0gdWkubmV3X211bHRpc2VsZWN0KHRhYiwgY29udGFpbmVyLCAiXGE5NWI4MDZmZuKAuiBTZWxlY3QgVmlzdWFscyIsICJDcm9zc2hhaXIgSW5kaWNhdG9ycyIsICJibHVoZ2FuZyBtZW51IiwgIkNyb3NzaGFpciBBcnJvd3MiLCAiT24gc2NyZWVuIGxvZ3MiKSwKICAgICAgICBuZXdsaW5lMSA9IHVpLm5ld19sYWJlbCgnQUEnLCAnQW50aS1haW1ib3QgYW5nbGVzJywgJ1xuJywgJ3N0cmluZycpLAogICAgICAgIHdhdGVybWFyayA9IHVpLm5ld19jb21ib2JveCh0YWIsIGNvbnRhaW5lciwgIldhdGVybWFyayIsICJEZWZhdWx0IiwgIk9sZCIpLAogICAgICAgIHdhdGVybWFya1Bvc2l0aW9uID0gdWkubmV3X2NvbWJvYm94KHRhYiwgY29udGFpbmVyLCAiXG4gd2F0ZXJtYXJrIHBvc2l0aW9uIiwgIkxlZnQiLCAiQm90dG9tIiwgIlJpZ2h0IiksCiAgICAgICAgaW5kaWNhdG9ycyA9IHVpLm5ld19jb21ib2JveCh0YWIsIGNvbnRhaW5lciwgIkluZGljYXRvcnMiLCAiRGlzYWJsZWQiLCAiU29mdCIsICJQaXhlbCIpLAogICAgICAgIGluZGljYXRvcnNDbHIgPSB1aS5uZXdfY29sb3JfcGlja2VyKHRhYiwgY29udGFpbmVyLCAiTWFpbiBDb2xvciIsIGx1YV9jb2xvci5yLCBsdWFfY29sb3IuZywgbHVhX2NvbG9yLmIsIDI1NSksCiAgICAgICAgaW5kaWNhdG9yc1N0eWxlID0gdWkubmV3X211bHRpc2VsZWN0KHRhYiwgY29udGFpbmVyLCAiXG4gRWxlbWVudHMiLCAiTmFtZSIsICJTdGF0ZSIsICJEb3VibGV0YXAiLCAiSGlkZXNob3RzIiwgIkZyZWVzdGFuZCIsICJTYWZlcG9pbnQiLCAiQm9keSBhaW0iLCAiRmFrZWR1Y2siKSwKICAgICAgICB3YXRlcm1hcmtDbHIgPSB1aS5uZXdfY29sb3JfcGlja2VyKHRhYiwgY29udGFpbmVyLCAiV2F0ZXJtYXJrIENvbG9yIiwgbHVhX2NvbG9yLnIsIGx1YV9jb2xvci5nLCBsdWFfY29sb3IuYiwgMjU1KSwKICAgICAgICBodWQgPSB1aS5uZXdfY29tYm9ib3godGFiLCBjb250YWluZXIsICJibHVoZ2FuZyBtZW51IiwgIkRpc2FibGVkIiwgInYxIiwgInYyIiksCiAgICAgICAgaHVkWCA9IHVpLm5ld19zbGlkZXIodGFiLCBjb250YWluZXIsICJXaWR0aCIsIC0xMDAsIDM4NDAsIDAsIHRydWUsICJweCIpLAogICAgICAgIGh1ZFkgPSB1aS5uZXdfc2xpZGVyKHRhYiwgY29udGFpbmVyLCAiSGVpZ2h0IiwgLTEwMCwgMjE2MCwgeSAtIHkvMiwgdHJ1ZSwgInB4IiksCiAgICAgICAgYXJyb3dDbHIgPSB1aS5uZXdfY29sb3JfcGlja2VyKHRhYiwgY29udGFpbmVyLCAiQXJyb3cgQ29sb3IiLCBsdWFfY29sb3IuciwgbHVhX2NvbG9yLmcsIGx1YV9jb2xvci5iLCAyNTUpLAogICAgICAgIGFycm93SW5kaWNhdG9yU3R5bGUgPSB1aS5uZXdfY29tYm9ib3godGFiLCBjb250YWluZXIsICJBcnJvd3MiLCAiLSIsICJUZWFtc2tlZXQiLCAiU3RhbmRhcnQiKSwKICAgICAgICBsb2dzID0gdWkubmV3X2NoZWNrYm94KHRhYiwgY29udGFpbmVyLCAiT24gU2NyZWVuIExvZ3MiKSwKICAgICAgICBsb2dzQ2xyID0gdWkubmV3X2NvbG9yX3BpY2tlcih0YWIsIGNvbnRhaW5lciwgIkxvZ3MgQ29sb3IiLCBsdWFfY29sb3IuciwgbHVhX2NvbG9yLmcsIGx1YV9jb2xvci5iLCAyNTUpLAogICAgICAgIGxvZ09mZnNldCA9IHVpLm5ld19zbGlkZXIodGFiLCBjb250YWluZXIsICJPZmZzZXQiLCAwLCA1MDAsIDEwMCwgdHJ1ZSwgInB4IiwgMSksCiAgICAgICAgbmV3bGluZTIgPSB1aS5uZXdfbGFiZWwoJ0FBJywgJ0FudGktYWltYm90IGFuZ2xlcycsICdcbicsICdzdHJpbmcnKSwKICAgICAgICB0ZXh0MiA9IHVpLm5ld19sYWJlbCgnQUEnLCAnQW50aS1haW1ib3QgYW5nbGVzJywgJ1xhOTViODA2ZmYtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0nLCAnc3RyaW5nJyksCiAgICAgICAgdGV4dDMgPSB1aS5uZXdfbGFiZWwoJ0FBJywgJ0FudGktYWltYm90IGFuZ2xlcycsICdcYSAgICAgICAgIC0tLS0tLS0tLS0tLS0tLS0tLS0gfiBcYTk1YjgwNmZmTWlzY1xhJywgJ3N0cmluZycpLAogICAgICAgIG5ld2xpbmUzID0gdWkubmV3X2xhYmVsKCdBQScsICdBbnRpLWFpbWJvdCBhbmdsZXMnLCAnXG4nLCAnc3RyaW5nJyksCiAgICAgICAgTWlzY011bHRpc2VsZWN0ID0gdWkubmV3X211bHRpc2VsZWN0KHRhYiwgY29udGFpbmVyLCAiXGE5NWI4MDZmZuKAuiBTZWxlY3QgTWlzYyIsICJGYXN0IGxhZGRlciIsICJBbmltIGJyZWFrZXJzIiwgIk1pbiBETUcgaW5kaWNhdG9yIiwgIk9sZCBjb25zb2xlIGxvZ3MiLCAiQ2xhbnRhZyIsICJUcmFzaHRhbGsiLCAiQ29uc29sZSBmaWx0ZXIiKSwKICAgICAgICBuZXdsaW5lNCA9IHVpLm5ld19sYWJlbCgnQUEnLCAnQW50aS1haW1ib3QgYW5nbGVzJywgJ1xuJywgJ3N0cmluZycpLAogICAgICAgIGZhc3RMYWRkZXIgPSB1aS5uZXdfbXVsdGlzZWxlY3QodGFiLCBjb250YWluZXIsICJGYXN0IGxhZGRlciIsICJBc2NlbmRpbmciLCAiRGVzY2VuZGluZyIpLAogICAgICAgIGFuaW1hdGlvbnMgPSB1aS5uZXdfbXVsdGlzZWxlY3QodGFiLCBjb250YWluZXIsICJBbmltYXRpb24gYnJlYWtlcnMiLCAiU3RhdGljIGxlZ3MiLCAiSW4gYWlyIiwgIk9uIGxhbmQiLCAiTGVnIGZ1Y2tlciIsICJBbGxhaCBsZWdzIiwgIkhhcmFtIGxlZ3MiLCAiQmxlbmQgbGVncyIpLAogICAgICAgIGRldlByaW50ID0gdWkubmV3X2NoZWNrYm94KHRhYiwgY29udGFpbmVyLCAiT2xkIGNvbnNvbGUgbG9ncyIpLAogICAgICAgIHRyYXNoVGFsayA9IHVpLm5ld19jaGVja2JveCh0YWIsIGNvbnRhaW5lciwgIlRyYXNodGFsayIpLAogICAgICAgIFRyYXNoVGFsa0xhbmd1YWdlID0gdWkubmV3X2NvbWJvYm94KHRhYiwgY29udGFpbmVyLCAiXG4gbGFuZ3VhZ2UiLCAiUnVzc2lhbiIsICJFbmdsaXNoIiksCiAgICAgICAgbmV3bGluZTQgPSB1aS5uZXdfbGFiZWwoJ0FBJywgJ0FudGktYWltYm90IGFuZ2xlcycsICdcbicsICdzdHJpbmcnKSwKICAgICAgICBuZXdsaW5lNDEgPSB1aS5uZXdfbGFiZWwoJ0FBJywgJ0FudGktYWltYm90IGFuZ2xlcycsICdcbicsICdzdHJpbmcnKSwKICAgICAgICBuZXdsaW5lNDIgPSB1aS5uZXdfbGFiZWwoJ0FBJywgJ0FudGktYWltYm90IGFuZ2xlcycsICdcbicsICdzdHJpbmcnKSwKICAgICAgICBuZXdsaW5lNDMgPSB1aS5uZXdfbGFiZWwoJ0FBJywgJ0FudGktYWltYm90IGFuZ2xlcycsICdcbicsICdzdHJpbmcnKSwKICAgICAgICBuZXdsaW5lNDQgPSB1aS5uZXdfbGFiZWwoJ0FBJywgJ0FudGktYWltYm90IGFuZ2xlcycsICdcbicsICdzdHJpbmcnKSwKICAgICAgICBuZXdsaW5lNDUgPSB1aS5uZXdfbGFiZWwoJ0FBJywgJ0FudGktYWltYm90IGFuZ2xlcycsICdcbicsICdzdHJpbmcnKSwKICAgICAgICBuZXdsaW5lNDYgPSB1aS5uZXdfbGFiZWwoJ0FBJywgJ0FudGktYWltYm90IGFuZ2xlcycsICdcbicsICdzdHJpbmcnKSwKICAgICAgICBuZXdsaW5lNDcgPSB1aS5uZXdfbGFiZWwoJ0FBJywgJ0FudGktYWltYm90IGFuZ2xlcycsICdcbicsICdzdHJpbmcnKSwKICAgICAgICBuZXdsaW5lNDggPSB1aS5uZXdfbGFiZWwoJ0FBJywgJ0FudGktYWltYm90IGFuZ2xlcycsICdcbicsICdzdHJpbmcnKSwKICAgICAgICBuZXdsaW5lNDkgPSB1aS5uZXdfbGFiZWwoJ0FBJywgJ0FudGktYWltYm90IGFuZ2xlcycsICdcbicsICdzdHJpbmcnKSwKICAgICAgICBuZXdsaW5lNTAgPSB1aS5uZXdfbGFiZWwoJ0FBJywgJ0FudGktYWltYm90IGFuZ2xlcycsICdcbicsICdzdHJpbmcnKSwKICAgICAgICBuZXdsaW5lNTEgPSB1aS5uZXdfbGFiZWwoJ0FBJywgJ0FudGktYWltYm90IGFuZ2xlcycsICdcbicsICdzdHJpbmcnKSwKICAgICAgICBuZXdsaW5lNTIgPSB1aS5uZXdfbGFiZWwoJ0FBJywgJ0FudGktYWltYm90IGFuZ2xlcycsICdcbicsICdzdHJpbmcnKSwKICAgICAgICBuZXdsaW5lNTMgPSB1aS5uZXdfbGFiZWwoJ0FBJywgJ0FudGktYWltYm90IGFuZ2xlcycsICdcbicsICdzdHJpbmcnKSwKICAgICAgICBuZXdsaW5lNTQgPSB1aS5uZXdfbGFiZWwoJ0FBJywgJ0FudGktYWltYm90IGFuZ2xlcycsICdcbicsICdzdHJpbmcnKSwKICAgICAgICBuZXdsaW5lNTUgPSB1aS5uZXdfbGFiZWwoJ0FBJywgJ0FudGktYWltYm90IGFuZ2xlcycsICdcbicsICdzdHJpbmcnKSwKICAgICAgICBuZXdsaW5lNTYgPSB1aS5uZXdfbGFiZWwoJ0FBJywgJ0FudGktYWltYm90IGFuZ2xlcycsICdcbicsICdzdHJpbmcnKSwKICAgICAgICBuZXdsaW5lNTcgPSB1aS5uZXdfbGFiZWwoJ0FBJywgJ0FudGktYWltYm90IGFuZ2xlcycsICdcbicsICdzdHJpbmcnKSwKICAgICAgICBuZXdsaW5lNTggPSB1aS5uZXdfbGFiZWwoJ0FBJywgJ0FudGktYWltYm90IGFuZ2xlcycsICdcbicsICdzdHJpbmcnKSwKICAgIH0sCiAgICBjb25maWdUYWIgPSB7CiAgICAgICAgbGlzdCA9IHVpLm5ld19saXN0Ym94KHRhYiwgY29udGFpbmVyLCAiQ29uZmlncyIsICIiKSwKICAgICAgICBuYW1lID0gdWkubmV3X3RleHRib3godGFiLCBjb250YWluZXIsICJDb25maWcgbmFtZSIsICIiKSwKICAgICAgICBsb2FkID0gdWkubmV3X2J1dHRvbih0YWIsIGNvbnRhaW5lciwgIkxvYWQiLCBmdW5jdGlvbigpIGVuZCksCiAgICAgICAgc2F2ZSA9IHVpLm5ld19idXR0b24odGFiLCBjb250YWluZXIsICJTYXZlIiwgZnVuY3Rpb24oKSBlbmQpLAogICAgICAgIGRlbGV0ZSA9IHVpLm5ld19idXR0b24odGFiLCBjb250YWluZXIsICJEZWxldGUiLCBmdW5jdGlvbigpIGVuZCksCiAgICAgICAgaW1wb3J0ID0gdWkubmV3X2J1dHRvbih0YWIsIGNvbnRhaW5lciwgIkltcG9ydCIsIGZ1bmN0aW9uKCkgZW5kKSwKICAgICAgICBleHBvcnQgPSB1aS5uZXdfYnV0dG9uKHRhYiwgY29udGFpbmVyLCAiRXhwb3J0IiwgZnVuY3Rpb24oKSBlbmQpCiAgICB9LAogICAgY29uZmlnVGFiMiA9IHsKICAgICAgICBXYXJuaW5nQ29uZmlnID0gdWkubmV3X2NoZWNrYm94KHRhYiwgY29udGFpbmVyLCAiKiBUaGVyZSdzIG5vdGhpbmcgYmVjYXVzZSBBQSBwcmVzZXQgaXMgYWN0aXZlIiksCiAgICAgICAgV2FybmluZ0NvbmZpZzIgPSB1aS5uZXdfY2hlY2tib3godGFiLCBjb250YWluZXIsICIqIERpc2FibGUgcHJlc2V0IHRvIGFjdGl2YXRlIENvbmZpZyBBQSBidWlsZGVyIikKICAgIH0sCiAgICBHZW5lcmFsVGFiID0gewogICAgICAgIG5ld2xpbmUxID0gdWkubmV3X2xhYmVsKCdBQScsICdBbnRpLWFpbWJvdCBhbmdsZXMnLCAnXG4nLCAnc3RyaW5nJyksCiAgICAgICAgdGV4dDEgPSB1aS5uZXdfbGFiZWwoJ0FBJywgJ0FudGktYWltYm90IGFuZ2xlcycsICdibHVoZ2FuZy5sdWEgXGE5NWI4MDZmZltiZXRhXSBidWlsZCcsICdzdHJpbmcnKSwKICAgICAgICB0ZXh0MiA9IHVpLm5ld19sYWJlbCgnQUEnLCAnQW50aS1haW1ib3QgYW5nbGVzJywgJ2xhc3QgdXBkIH4gMDYuMTAuMjAyMycsICdzdHJpbmcnKSwKICAgICAgICB0ZXh0MyA9IHVpLm5ld19sYWJlbCgnQUEnLCAnQW50aS1haW1ib3QgYW5nbGVzJywgJ2lmIHlvdSBmaW5kIGEgYnVnLCBvcGVuIGRpc2NvcmQgdGlja2V0JywgJ3N0cmluZycpLAogICAgICAgIG5ld2xpbmUyID0gdWkubmV3X2xhYmVsKCdBQScsICdBbnRpLWFpbWJvdCBhbmdsZXMnLCAnXG4nLCAnc3RyaW5nJyksCiAgICAgICAgZGlzY29yZCA9IHVpLm5ld19idXR0b24odGFiLCBjb250YWluZXIsICJDb3B5IGRpc2NvcmQgbGluayBpbiBjbGlwYm9hcmQiLCBmdW5jdGlvbigpIGNsaXBib2FyZC5zZXQoImh0dHBzOi8vZGlzY29yZC5nZy9HU3pta01mSzZIIikgZW5kKQogICAgfQp9Cgpsb2NhbCBhYUJ1aWxkZXIgPSB7fQpsb2NhbCBhYUNvbnRhaW5lciA9IHt9CmZvciBpPTEsICN2YXJzLmFhU3RhdGVzIGRvCiAgICBhYUNvbnRhaW5lcltpXSA9IGZ1bmMuaGV4KHsyMDAsMjAwLDIwMH0pIC4uICIoIiAuLiBmdW5jLmhleCh7MjIyLDU1LDU1fSkgLi4gIiIgLi4gdmFycy5wU3RhdGVzW2ldIC4uICIiIC4uIGZ1bmMuaGV4KHsyMDAsMjAwLDIwMH0pIC4uICIpIiAuLiBmdW5jLmhleCh7MTU1LDE1NSwxNTV9KSAuLiAiICIKICAgIGFhQnVpbGRlcltpXSA9IHsKICAgICAgICBlbmFibGVTdGF0ZSA9IHVpLm5ld19jaGVja2JveCh0YWIsIGNvbnRhaW5lciwgIkVuYWJsZSAiIC4uIGZ1bmMuaGV4KHtsdWFfY29sb3IuciwgbHVhX2NvbG9yLmcsIGx1YV9jb2xvci5ifSkgLi4gdmFycy5hYVN0YXRlc1tpXSAuLiBmdW5jLmhleCh7MjAwLDIwMCwyMDB9KSAuLiAiIHN0YXRlIiksCiAgICAgICAgcGl0Y2ggPSB1aS5uZXdfY29tYm9ib3godGFiLCBjb250YWluZXIsICJQaXRjaFxuIiAuLiBhYUNvbnRhaW5lcltpXSwgIk9mZiIsICJEZWZhdWx0IiwgIlVwIiwgIkRvd24iLCAiTWluaW1hbCIsICJSYW5kb20iLCAiQ3VzdG9tIiksCiAgICAgICAgcGl0Y2hTbGlkZXIgPSB1aS5uZXdfc2xpZGVyKHRhYiwgY29udGFpbmVyLCAiXG5QaXRjaCBhZGQiIC4uIGFhQ29udGFpbmVyW2ldLCAtODksIDg5LCAwLCB0cnVlLCAiwrAiLCAxKSwKICAgICAgICB5YXdCYXNlID0gdWkubmV3X2NvbWJvYm94KHRhYiwgY29udGFpbmVyLCAiWWF3IGJhc2VcbiIgLi4gYWFDb250YWluZXJbaV0sICJMb2NhbCB2aWV3IiwgIkF0IHRhcmdldHMiKSwKICAgICAgICB5YXcgPSB1aS5uZXdfY29tYm9ib3godGFiLCBjb250YWluZXIsICJZYXdcbiIgLi4gYWFDb250YWluZXJbaV0sICJPZmYiLCAiMTgwIiwgIlNwaW4iLCAiMTgwIFoiKSwKICAgICAgICB5YXdDb25kaXRpb24gPSB1aS5uZXdfY29tYm9ib3godGFiLCBjb250YWluZXIsICJZYXcgY29uZGl0aW9uXG4iIC4uIGFhQ29udGFpbmVyW2ldLCAiU3RhdGljIiwgIkwgJiBSIiwgIlNsb3ciLCAiSG9sZCIpLAogICAgICAgIHlhd1N0YXRpYyA9IHVpLm5ld19zbGlkZXIodGFiLCBjb250YWluZXIsICJcbnlhdyBsaW1pdCIgLi4gYWFDb250YWluZXJbaV0sIC0xODAsIDE4MCwgMCwgdHJ1ZSwgIsKwIiwgMSksCiAgICAgICAgeWF3TGVmdCA9IHVpLm5ld19zbGlkZXIodGFiLCBjb250YWluZXIsICJMZWZ0XG55YXciIC4uIGFhQ29udGFpbmVyW2ldLCAtMTgwLCAxODAsIDAsIHRydWUsICLCsCIsIDEpLAogICAgICAgIHlhd1JpZ2h0ID0gdWkubmV3X3NsaWRlcih0YWIsIGNvbnRhaW5lciwgIlJpZ2h0XG55YXciIC4uIGFhQ29udGFpbmVyW2ldLCAtMTgwLCAxODAsIDAsIHRydWUsICLCsCIsIDEpLAogICAgICAgIHlhd1NwZWVkID0gdWkubmV3X3NsaWRlcih0YWIsIGNvbnRhaW5lciwgIlNwZWVkXG55YXciIC4uIGFhQ29udGFpbmVyW2ldLCAxLCAxNCwgNiwgMCksCiAgICAgICAgeWF3Sml0dGVyID0gdWkubmV3X2NvbWJvYm94KHRhYiwgY29udGFpbmVyLCAiWWF3IGppdHRlclxuIiAuLiBhYUNvbnRhaW5lcltpXSwgIk9mZiIsICJPZmZzZXQiLCAiQ2VudGVyIiwgIjMtV2F5IiwgIlJhbmRvbSIpLAogICAgICAgIHlhd0ppdHRlckNvbmRpdGlvbiA9IHVpLm5ld19jb21ib2JveCh0YWIsIGNvbnRhaW5lciwgIllhdyBqaXR0ZXIgY29uZGl0aW9uXG4iIC4uIGFhQ29udGFpbmVyW2ldLCAiU3RhdGljIiwgIkwgJiBSIiksCiAgICAgICAgeWF3Sml0dGVyU3RhdGljID0gdWkubmV3X3NsaWRlcih0YWIsIGNvbnRhaW5lciwgIlxueWF3IGppdHRlciBsaW1pdCIgLi4gYWFDb250YWluZXJbaV0sIC0xODAsIDE4MCwgMCwgdHJ1ZSwgIsKwIiwgMSksCiAgICAgICAgeWF3Sml0dGVyTGVmdCA9IHVpLm5ld19zbGlkZXIodGFiLCBjb250YWluZXIsICJMZWZ0XG55YXcgaml0dGVyIiAuLiBhYUNvbnRhaW5lcltpXSwgLTE4MCwgMTgwLCAwLCB0cnVlLCAiwrAiLCAxKSwKICAgICAgICB5YXdKaXR0ZXJSaWdodCA9IHVpLm5ld19zbGlkZXIodGFiLCBjb250YWluZXIsICJSaWdodFxueWF3IGppdHRlciIgLi4gYWFDb250YWluZXJbaV0sIC0xODAsIDE4MCwgMCwgdHJ1ZSwgIsKwIiwgMSksCiAgICAgICAgeWF3Sml0dGVyRGlzYWJsZXJzID0gdWkubmV3X211bHRpc2VsZWN0KHRhYiwgY29udGFpbmVyLCAiSml0dGVyIGRpc2FibGVyc1xuIiAuLiBhYUNvbnRhaW5lcltpXSwgIkhlYWQgc2FmZXR5IiwgIkhlaWdodCBhZHZhbnRhZ2UiKSwKICAgICAgICBib2R5WWF3ID0gdWkubmV3X2NvbWJvYm94KHRhYiwgY29udGFpbmVyLCAiQm9keSB5YXdcbiIgLi4gYWFDb250YWluZXJbaV0sICJPZmYiLCAiT3Bwb3NpdGUiLCAiSml0dGVyIiwgIlN0YXRpYyIpLAogICAgICAgIGJvZHlZYXdTbGlkZXIgPSB1aS5uZXdfc2xpZGVyKHRhYiwgY29udGFpbmVyLCAiXG5ib2R5IHlhdyBsaW1pdCIgLi4gYWFDb250YWluZXJbaV0sIC0xODAsIDE4MCwgMCwgdHJ1ZSwgIsKwIiwgMSksCiAgICAgICAgZGVmZW5zaXZlT3B0ID0gdWkubmV3X211bHRpc2VsZWN0KHRhYiwgY29udGFpbmVyLCAiRGVmZW5zaXZlIG9wdGlvbnNcbiIgLi4gYWFDb250YWluZXJbaV0sICJFbHVzaXZlIG1vZGUiLCAiQWx3YXlzIG9uIiksCiAgICAgICAgZGVmZW5zaXZlWWF3ID0gdWkubmV3X2NvbWJvYm94KHRhYiwgY29udGFpbmVyLCAiRGVmZW5zaXZlIHlhd1xuIiAuLiBhYUNvbnRhaW5lcltpXSwgIi0iLCAiUmFuZG9tIiwgIkppdHRlciIsICJDdXN0b20iKSwKICAgICAgICBkZWZlbnNpdmVZYXdTbGlkZXIgPSB1aS5uZXdfc2xpZGVyKHRhYiwgY29udGFpbmVyLCAiXG5EZWZlbnNpdmVZYXdTbGlkZXIiIC4uIGFhQ29udGFpbmVyW2ldLCAtMTgwLCAxODAsIDAsIHRydWUsICIiLCAxKSwKICAgICAgICBkZWZlbnNpdmVQaXRjaCA9IHVpLm5ld19jb21ib2JveCh0YWIsIGNvbnRhaW5lciwgIkRlZmVuc2l2ZSBwaXRjaFxuIiAuLiBhYUNvbnRhaW5lcltpXSwgIi0iLCAiQ3VzdG9tIiksCiAgICAgICAgZGVmZW5zaXZlUGl0Y2hTbGlkZXIgPSB1aS5uZXdfc2xpZGVyKHRhYiwgY29udGFpbmVyLCAiXG5EZWZlbnNpdmVQaXRjaFNsaWRlciIgLi4gYWFDb250YWluZXJbaV0sIC04OSwgODksIDAsIHRydWUsICLCsCIsIDEpLAogICAgfQplbmQKCmxvY2FsIHRyYXNodGFsayA9IGZ1bmN0aW9uKGUpCgogICAgbG9jYWwgdmljdGltX3VzZXJpZCwgYXR0YWNrZXJfdXNlcmlkID0gZS51c2VyaWQsIGUuYXR0YWNrZXIKICAgIGlmIHZpY3RpbV91c2VyaWQgPT0gbmlsIG9yIGF0dGFja2VyX3VzZXJpZCA9PSBuaWwgdGhlbgogICAgICAgIHJldHVybgogICAgZW5kCgogICAgbG9jYWwgdmljdGltX2VudGluZGV4ICAgPSBjbGllbnQudXNlcmlkX3RvX2VudGluZGV4KHZpY3RpbV91c2VyaWQpCiAgICBsb2NhbCBhdHRhY2tlcl9lbnRpbmRleCA9IGNsaWVudC51c2VyaWRfdG9fZW50aW5kZXgoYXR0YWNrZXJfdXNlcmlkKQogICAgaWYgYXR0YWNrZXJfZW50aW5kZXggPT0gZW50aXR5LmdldF9sb2NhbF9wbGF5ZXIoKSBhbmQgZW50aXR5LmlzX2VuZW15KHZpY3RpbV9lbnRpbmRleCkgdGhlbgogICAgICAgIGlmIHVpLmdldChtZW51LnZpc3VhbHNUYWIuVHJhc2hUYWxrTGFuZ3VhZ2UpID09ICJSdXNzaWFuIiB0aGVuCiAgICAgICAgICAgIGxvY2FsIHBocmFzZSA9IGtpbGxbbWF0aC5yYW5kb20oMSwgI2tpbGwpXQogICAgICAgICAgICBsb2NhbCBzYXkgPSAnc2F5ICcgLi4gcGhyYXNlCiAgICAgICAgICAgIGNsaWVudC5leGVjKHNheSkKICAgICAgICBlbHNlaWYgdWkuZ2V0KG1lbnUudmlzdWFsc1RhYi5UcmFzaFRhbGtMYW5ndWFnZSkgPT0gIkVuZ2xpc2giIHRoZW4KICAgICAgICAgICAgbG9jYWwgcGhyYXNlID0ga2lsbF9lbmdbbWF0aC5yYW5kb20oMSwgI2tpbGxfZW5nKV0KICAgICAgICAgICAgbG9jYWwgc2F5ID0gJ3NheSAnIC4uIHBocmFzZQogICAgICAgICAgICBjbGllbnQuZXhlYyhzYXkpCiAgICAgICAgZW5kCiAgICBlbmQKZW5kCgpsb2NhbCBmdW5jdGlvbiBnZXRDb25maWcobmFtZSkKICAgIGxvY2FsIGRhdGFiYXNlID0gZGF0YWJhc2UucmVhZChsdWEuZGF0YWJhc2UuY29uZmlncykgb3Ige30KCiAgICBmb3IgaSwgdiBpbiBwYWlycyhkYXRhYmFzZSkgZG8KICAgICAgICBpZiB2Lm5hbWUgPT0gbmFtZSB0aGVuCiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICBjb25maWcgPSB2LmNvbmZpZywKICAgICAgICAgICAgICAgIGluZGV4ID0gaQogICAgICAgICAgICB9CiAgICAgICAgZW5kCiAgICBlbmQKCiAgICBmb3IgaSwgdiBpbiBwYWlycyhwcmVzZXRzKSBkbwogICAgICAgIGlmIHYubmFtZSA9PSBuYW1lIHRoZW4KICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgIGNvbmZpZyA9IHYuY29uZmlnLAogICAgICAgICAgICAgICAgaW5kZXggPSBpCiAgICAgICAgICAgIH0KICAgICAgICBlbmQKICAgIGVuZAoKICAgIHJldHVybiBmYWxzZQplbmQKbG9jYWwgZnVuY3Rpb24gc2F2ZUNvbmZpZyhuYW1lKQogICAgbG9jYWwgZGIgPSBkYXRhYmFzZS5yZWFkKGx1YS5kYXRhYmFzZS5jb25maWdzKSBvciB7fQogICAgbG9jYWwgY29uZmlnID0ge30KCiAgICBpZiBuYW1lOm1hdGNoKCJbXiV3XSIpIH49IG5pbCB0aGVuCiAgICAgICAgcmV0dXJuCiAgICBlbmQKCiAgICBmb3Iga2V5LCB2YWx1ZSBpbiBwYWlycyh2YXJzLnBTdGF0ZXMpIGRvCiAgICAgICAgY29uZmlnW3ZhbHVlXSA9IHt9CiAgICAgICAgZm9yIGssIHYgaW4gcGFpcnMoYWFCdWlsZGVyW2tleV0pIGRvCiAgICAgICAgICAgIGNvbmZpZ1t2YWx1ZV1ba10gPSB1aS5nZXQodikKICAgICAgICBlbmQKICAgIGVuZAoKICAgIGxvY2FsIGNmZyA9IGdldENvbmZpZyhuYW1lKQoKICAgIGlmIG5vdCBjZmcgdGhlbgogICAgICAgIHRhYmxlLmluc2VydChkYiwgeyBuYW1lID0gbmFtZSwgY29uZmlnID0gY29uZmlnIH0pCiAgICBlbHNlCiAgICAgICAgZGJbY2ZnLmluZGV4XS5jb25maWcgPSBjb25maWcKICAgIGVuZAoKICAgIGRhdGFiYXNlLndyaXRlKGx1YS5kYXRhYmFzZS5jb25maWdzLCBkYikKZW5kCmxvY2FsIGZ1bmN0aW9uIGRlbGV0ZUNvbmZpZyhuYW1lKQogICAgbG9jYWwgZGIgPSBkYXRhYmFzZS5yZWFkKGx1YS5kYXRhYmFzZS5jb25maWdzKSBvciB7fQoKICAgIGZvciBpLCB2IGluIHBhaXJzKGRiKSBkbwogICAgICAgIGlmIHYubmFtZSA9PSBuYW1lIHRoZW4KICAgICAgICAgICAgdGFibGUucmVtb3ZlKGRiLCBpKQogICAgICAgICAgICBicmVhawogICAgICAgIGVuZAogICAgZW5kCgogICAgZm9yIGksIHYgaW4gcGFpcnMocHJlc2V0cykgZG8KICAgICAgICBpZiB2Lm5hbWUgPT0gbmFtZSB0aGVuCiAgICAgICAgICAgIHJldHVybiBmYWxzZQogICAgICAgIGVuZAogICAgZW5kCgogICAgZGF0YWJhc2Uud3JpdGUobHVhLmRhdGFiYXNlLmNvbmZpZ3MsIGRiKQplbmQKbG9jYWwgZnVuY3Rpb24gZ2V0Q29uZmlnTGlzdCgpCiAgICBsb2NhbCBkYXRhYmFzZSA9IGRhdGFiYXNlLnJlYWQobHVhLmRhdGFiYXNlLmNvbmZpZ3MpIG9yIHt9CiAgICBsb2NhbCBjb25maWcgPSB7fQoKICAgIGZvciBpLCB2IGluIHBhaXJzKHByZXNldHMpIGRvCiAgICAgICAgdGFibGUuaW5zZXJ0KGNvbmZpZywgdi5uYW1lKQogICAgZW5kCgogICAgZm9yIGksIHYgaW4gcGFpcnMoZGF0YWJhc2UpIGRvCiAgICAgICAgdGFibGUuaW5zZXJ0KGNvbmZpZywgdi5uYW1lKQogICAgZW5kCgogICAgcmV0dXJuIGNvbmZpZwplbmQKbG9jYWwgZnVuY3Rpb24gdHlwZUZyb21TdHJpbmcoaW5wdXQpCiAgICBpZiB0eXBlKGlucHV0KSB+PSAic3RyaW5nIiB0aGVuIHJldHVybiBpbnB1dCBlbmQKCiAgICBsb2NhbCB2YWx1ZSA9IGlucHV0Omxvd2VyKCkKCiAgICBpZiB2YWx1ZSA9PSAidHJ1ZSIgdGhlbgogICAgICAgIHJldHVybiB0cnVlCiAgICBlbHNlaWYgdmFsdWUgPT0gImZhbHNlIiB0aGVuCiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICBlbHNlaWYgdG9udW1iZXIodmFsdWUpIH49IG5pbCB0aGVuCiAgICAgICAgcmV0dXJuIHRvbnVtYmVyKHZhbHVlKQogICAgZWxzZQogICAgICAgIHJldHVybiB0b3N0cmluZyhpbnB1dCkKICAgIGVuZAplbmQKbG9jYWwgaW5zcGVjdCA9IHRyeV9yZXF1aXJlKCdnYW1lc2Vuc2UvaW5zcGVjdCcpCmxvY2FsIGZ1bmN0aW9uIGxvYWRTZXR0aW5ncyhlKQogICAgZm9yIGtleSwgdmFsdWUgaW4gcGFpcnModmFycy5wU3RhdGVzKSBkbwogICAgICAgIGZvciBrLCB2IGluIHBhaXJzKGFhQnVpbGRlcltrZXldKSBkbwogICAgICAgICAgICBpZiAoZVt2YWx1ZV1ba10gfj0gbmlsKSB0aGVuCiAgICAgICAgICAgICAgICB1aS5zZXQodiwgZVt2YWx1ZV1ba10pCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZCAKICAgIGVuZAplbmQKbG9jYWwgYWxwaCA9ICJiYXNlNjQiCmxvY2FsIGZ1bmN0aW9uIGltcG9ydFNldHRpbmdzKCkKICAgIGxvY2FsIGZyb21idWZmZXIgPSBjbGlwYm9hcmQuZ2V0KCkKICAgIGxvY2FsIGRlY29kZSA9IGJhc2U2NC5kZWNvZGUoZnJvbWJ1ZmZlciwgYWxwaCkKICAgIGxvY2FsIHRvVGFibGUgPSBqc29uLnBhcnNlKGRlY29kZSkKICAgIGxvYWRTZXR0aW5ncyh0b1RhYmxlLmNvbmZpZykKZW5kCmxvY2FsIGZ1bmN0aW9uIGltcG9ydFByZXNldCgpCiAgICBsb2NhbCBmcm9tYnVmZmVyID0gImV5SnBibVJsZUNJNk55d2lZMjl1Wm1sbklqcDdJa3hCSWpwN0luQnBkR05vSWpvaVQyWm1JaXdpY0dsMFkyaFRiR2xrWlhJaU9qQXNJbUp2WkhsWllYZFRiR2xrWlhJaU9qQXNJbmxoZDBwcGRIUmxja3hsWm5RaU9qQXNJbmxoZDBwcGRIUmxjbEpwWjJoMElqb3dMQ0ppYjJSNVdXRjNJam9pVDJabUlpd2laR1ZtWlc1emFYWmxVR2wwWTJnaU9pSXRJaXdpWkdWbVpXNXphWFpsVUdsMFkyaFRiR2xrWlhJaU9qQXNJbVZ1WVdKc1pWTjBZWFJsSWpwbVlXeHpaU3dpWkdWbVpXNXphWFpsV1dGM0lqb2lMU0lzSW5saGQxSnBaMmgwSWpvd0xDSjVZWGRLYVhSMFpYSkVhWE5oWW14bGNuTWlPbnQ5TENKNVlYZFRkR0YwYVdNaU9qQXNJbmxoZHlJNklrOW1aaUlzSW5saGQwTnZibVJwZEdsdmJpSTZJbE4wWVhScFl5SXNJbmxoZDBwcGRIUmxja052Ym1ScGRHbHZiaUk2SWxOMFlYUnBZeUlzSW5saGQwcHBkSFJsY2lJNklrOW1aaUlzSW5saGQxTndaV1ZrSWpvMkxDSjVZWGRLYVhSMFpYSlRkR0YwYVdNaU9qQXNJbVJsWm1WdWMybDJaVTl3ZENJNmUzMHNJbmxoZDB4bFpuUWlPakFzSW1SbFptVnVjMmwyWlZsaGQxTnNhV1JsY2lJNk1Dd2llV0YzUW1GelpTSTZJa3h2WTJGc0lIWnBaWGNpZlN3aVUxY2lPbnNpY0dsMFkyZ2lPaUpQWm1ZaUxDSndhWFJqYUZOc2FXUmxjaUk2TUN3aVltOWtlVmxoZDFOc2FXUmxjaUk2TUN3aWVXRjNTbWwwZEdWeVRHVm1kQ0k2TUN3aWVXRjNTbWwwZEdWeVVtbG5hSFFpT2pBc0ltSnZaSGxaWVhjaU9pSlBabVlpTENKa1pXWmxibk5wZG1WUWFYUmphQ0k2SWkwaUxDSmtaV1psYm5OcGRtVlFhWFJqYUZOc2FXUmxjaUk2TUN3aVpXNWhZbXhsVTNSaGRHVWlPbVpoYkhObExDSmtaV1psYm5OcGRtVlpZWGNpT2lJdElpd2llV0YzVW1sbmFIUWlPakFzSW5saGQwcHBkSFJsY2tScGMyRmliR1Z5Y3lJNmUzMHNJbmxoZDFOMFlYUnBZeUk2TUN3aWVXRjNJam9pVDJabUlpd2llV0YzUTI5dVpHbDBhVzl1SWpvaVUzUmhkR2xqSWl3aWVXRjNTbWwwZEdWeVEyOXVaR2wwYVc5dUlqb2lVM1JoZEdsaklpd2llV0YzU21sMGRHVnlJam9pVDJabUlpd2llV0YzVTNCbFpXUWlPallzSW5saGQwcHBkSFJsY2xOMFlYUnBZeUk2TUN3aVpHVm1aVzV6YVhabFQzQjBJanA3ZlN3aWVXRjNUR1ZtZENJNk1Dd2laR1ZtWlc1emFYWmxXV0YzVTJ4cFpHVnlJam93TENKNVlYZENZWE5sSWpvaVRHOWpZV3dnZG1sbGR5SjlMQ0pUSWpwN0luQnBkR05vSWpvaVJHVm1ZWFZzZENJc0luQnBkR05vVTJ4cFpHVnlJam93TENKaWIyUjVXV0YzVTJ4cFpHVnlJam90TVN3aWVXRjNTbWwwZEdWeVRHVm1kQ0k2TUN3aWVXRjNTbWwwZEdWeVVtbG5hSFFpT2pBc0ltSnZaSGxaWVhjaU9pSkthWFIwWlhJaUxDSmtaV1psYm5OcGRtVlFhWFJqYUNJNklpMGlMQ0prWldabGJuTnBkbVZRYVhSamFGTnNhV1JsY2lJNk1Dd2laVzVoWW14bFUzUmhkR1VpT25SeWRXVXNJbVJsWm1WdWMybDJaVmxoZHlJNklpMGlMQ0o1WVhkU2FXZG9kQ0k2TkRJc0lubGhkMHBwZEhSbGNrUnBjMkZpYkdWeWN5STZlMzBzSW5saGQxTjBZWFJwWXlJNk1Dd2llV0YzSWpvaU1UZ3dJaXdpZVdGM1EyOXVaR2wwYVc5dUlqb2lUQ0FtSUZJaUxDSjVZWGRLYVhSMFpYSkRiMjVrYVhScGIyNGlPaUpUZEdGMGFXTWlMQ0o1WVhkS2FYUjBaWElpT2lKUFptWWlMQ0o1WVhkVGNHVmxaQ0k2Tml3aWVXRjNTbWwwZEdWeVUzUmhkR2xqSWpvd0xDSmtaV1psYm5OcGRtVlBjSFFpT250OUxDSjVZWGRNWldaMElqb3RNak1zSW1SbFptVnVjMmwyWlZsaGQxTnNhV1JsY2lJNk1Dd2llV0YzUW1GelpTSTZJa0YwSUhSaGNtZGxkSE1pZlN3aVFVTWlPbnNpY0dsMFkyZ2lPaUpFWldaaGRXeDBJaXdpY0dsMFkyaFRiR2xrWlhJaU9qQXNJbUp2WkhsWllYZFRiR2xrWlhJaU9pMHhMQ0o1WVhkS2FYUjBaWEpNWldaMElqb3dMQ0o1WVhkS2FYUjBaWEpTYVdkb2RDSTZNQ3dpWW05a2VWbGhkeUk2SWtwcGRIUmxjaUlzSW1SbFptVnVjMmwyWlZCcGRHTm9Jam9pTFNJc0ltUmxabVZ1YzJsMlpWQnBkR05vVTJ4cFpHVnlJam90TkRVc0ltVnVZV0pzWlZOMFlYUmxJanAwY25WbExDSmtaV1psYm5OcGRtVlpZWGNpT2lJdElpd2llV0YzVW1sbmFIUWlPak00TENKNVlYZEthWFIwWlhKRWFYTmhZbXhsY25NaU9udDlMQ0o1WVhkVGRHRjBhV01pT2pBc0lubGhkeUk2SWpFNE1DSXNJbmxoZDBOdmJtUnBkR2x2YmlJNklrd2dKaUJTSWl3aWVXRjNTbWwwZEdWeVEyOXVaR2wwYVc5dUlqb2lVM1JoZEdsaklpd2llV0YzU21sMGRHVnlJam9pVDJabUlpd2llV0YzVTNCbFpXUWlPallzSW5saGQwcHBkSFJsY2xOMFlYUnBZeUk2TUN3aVpHVm1aVzV6YVhabFQzQjBJanBiSWtGc2QyRjVjeUJ2YmlKZExDSjVZWGRNWldaMElqb3RNVFlzSW1SbFptVnVjMmwyWlZsaGQxTnNhV1JsY2lJNk1Dd2llV0YzUW1GelpTSTZJa0YwSUhSaGNtZGxkSE1pZlN3aVFTSTZleUp3YVhSamFDSTZJa1JsWm1GMWJIUWlMQ0p3YVhSamFGTnNhV1JsY2lJNk1Dd2lZbTlrZVZsaGQxTnNhV1JsY2lJNkxURXNJbmxoZDBwcGRIUmxja3hsWm5RaU9qQXNJbmxoZDBwcGRIUmxjbEpwWjJoMElqb3dMQ0ppYjJSNVdXRjNJam9pU21sMGRHVnlJaXdpWkdWbVpXNXphWFpsVUdsMFkyZ2lPaUl0SWl3aVpHVm1aVzV6YVhabFVHbDBZMmhUYkdsa1pYSWlPamc1TENKbGJtRmliR1ZUZEdGMFpTSTZkSEoxWlN3aVpHVm1aVzV6YVhabFdXRjNJam9pTFNJc0lubGhkMUpwWjJoMElqb3pPQ3dpZVdGM1NtbDBkR1Z5UkdsellXSnNaWEp6SWpwN2ZTd2llV0YzVTNSaGRHbGpJam93TENKNVlYY2lPaUl4T0RBaUxDSjVZWGREYjI1a2FYUnBiMjRpT2lKTUlDWWdVaUlzSW5saGQwcHBkSFJsY2tOdmJtUnBkR2x2YmlJNklsTjBZWFJwWXlJc0lubGhkMHBwZEhSbGNpSTZJazltWmlJc0lubGhkMU53WldWa0lqbzJMQ0o1WVhkS2FYUjBaWEpUZEdGMGFXTWlPakFzSW1SbFptVnVjMmwyWlU5d2RDSTZXeUpCYkhkaGVYTWdiMjRpWFN3aWVXRjNUR1ZtZENJNkxUTXpMQ0prWldabGJuTnBkbVZaWVhkVGJHbGtaWElpT2pBc0lubGhkMEpoYzJVaU9pSkJkQ0IwWVhKblpYUnpJbjBzSWswaU9uc2ljR2wwWTJnaU9pSkVaV1poZFd4MElpd2ljR2wwWTJoVGJHbGtaWElpT2pBc0ltSnZaSGxaWVhkVGJHbGtaWElpT2kweExDSjVZWGRLYVhSMFpYSk1aV1owSWpvd0xDSjVZWGRLYVhSMFpYSlNhV2RvZENJNk1Dd2lZbTlrZVZsaGR5STZJa3BwZEhSbGNpSXNJbVJsWm1WdWMybDJaVkJwZEdOb0lqb2lMU0lzSW1SbFptVnVjMmwyWlZCcGRHTm9VMnhwWkdWeUlqb3dMQ0psYm1GaWJHVlRkR0YwWlNJNmRISjFaU3dpWkdWbVpXNXphWFpsV1dGM0lqb2lMU0lzSW5saGQxSnBaMmgwSWpvek55d2llV0YzU21sMGRHVnlSR2x6WVdKc1pYSnpJanA3ZlN3aWVXRjNVM1JoZEdsaklqb3dMQ0o1WVhjaU9pSXhPREFpTENKNVlYZERiMjVrYVhScGIyNGlPaUpNSUNZZ1VpSXNJbmxoZDBwcGRIUmxja052Ym1ScGRHbHZiaUk2SWxOMFlYUnBZeUlzSW5saGQwcHBkSFJsY2lJNklrOW1aaUlzSW5saGQxTndaV1ZrSWpvekxDSjVZWGRLYVhSMFpYSlRkR0YwYVdNaU9qQXNJbVJsWm1WdWMybDJaVTl3ZENJNmUzMHNJbmxoZDB4bFpuUWlPaTB5T1N3aVpHVm1aVzV6YVhabFdXRjNVMnhwWkdWeUlqb3dMQ0o1WVhkQ1lYTmxJam9pUVhRZ2RHRnlaMlYwY3lKOUxDSkRJanA3SW5CcGRHTm9Jam9pUkdWbVlYVnNkQ0lzSW5CcGRHTm9VMnhwWkdWeUlqb3dMQ0ppYjJSNVdXRjNVMnhwWkdWeUlqb3RNU3dpZVdGM1NtbDBkR1Z5VEdWbWRDSTZNQ3dpZVdGM1NtbDBkR1Z5VW1sbmFIUWlPakFzSW1KdlpIbFpZWGNpT2lKS2FYUjBaWElpTENKa1pXWmxibk5wZG1WUWFYUmphQ0k2SWkwaUxDSmtaV1psYm5OcGRtVlFhWFJqYUZOc2FXUmxjaUk2TFRRMUxDSmxibUZpYkdWVGRHRjBaU0k2ZEhKMVpTd2laR1ZtWlc1emFYWmxXV0YzSWpvaUxTSXNJbmxoZDFKcFoyaDBJam95TXl3aWVXRjNTbWwwZEdWeVJHbHpZV0pzWlhKeklqcDdmU3dpZVdGM1UzUmhkR2xqSWpveU9Dd2llV0YzSWpvaU1UZ3dJaXdpZVdGM1EyOXVaR2wwYVc5dUlqb2lVMnh2ZHlJc0lubGhkMHBwZEhSbGNrTnZibVJwZEdsdmJpSTZJbE4wWVhScFl5SXNJbmxoZDBwcGRIUmxjaUk2SWs5bVppSXNJbmxoZDFOd1pXVmtJam96TENKNVlYZEthWFIwWlhKVGRHRjBhV01pT2pBc0ltUmxabVZ1YzJsMlpVOXdkQ0k2V3lKQmJIZGhlWE1nYjI0aVhTd2llV0YzVEdWbWRDSTZMVEU1TENKa1pXWmxibk5wZG1WWllYZFRiR2xrWlhJaU9qQXNJbmxoZDBKaGMyVWlPaUpCZENCMFlYSm5aWFJ6SW4wc0lrY2lPbnNpY0dsMFkyZ2lPaUpFWldaaGRXeDBJaXdpY0dsMFkyaFRiR2xrWlhJaU9qQXNJbUp2WkhsWllYZFRiR2xrWlhJaU9pMHhMQ0o1WVhkS2FYUjBaWEpNWldaMElqb3dMQ0o1WVhkS2FYUjBaWEpTYVdkb2RDSTZNQ3dpWW05a2VWbGhkeUk2SWtwcGRIUmxjaUlzSW1SbFptVnVjMmwyWlZCcGRHTm9Jam9pTFNJc0ltUmxabVZ1YzJsMlpWQnBkR05vVTJ4cFpHVnlJam93TENKbGJtRmliR1ZUZEdGMFpTSTZkSEoxWlN3aVpHVm1aVzV6YVhabFdXRjNJam9pTFNJc0lubGhkMUpwWjJoMElqb3pPU3dpZVdGM1NtbDBkR1Z5UkdsellXSnNaWEp6SWpwN2ZTd2llV0YzVTNSaGRHbGpJam93TENKNVlYY2lPaUl4T0RBaUxDSjVZWGREYjI1a2FYUnBiMjRpT2lKVGJHOTNJaXdpZVdGM1NtbDBkR1Z5UTI5dVpHbDBhVzl1SWpvaVUzUmhkR2xqSWl3aWVXRjNTbWwwZEdWeUlqb2lUMlptSWl3aWVXRjNVM0JsWldRaU9qVXNJbmxoZDBwcGRIUmxjbE4wWVhScFl5STZNQ3dpWkdWbVpXNXphWFpsVDNCMElqcDdmU3dpZVdGM1RHVm1kQ0k2TFRJNExDSmtaV1psYm5OcGRtVlpZWGRUYkdsa1pYSWlPakFzSW5saGQwSmhjMlVpT2lKQmRDQjBZWEpuWlhSekluMTlmUT09IgogICAgbG9jYWwgZGVjb2RlID0gYmFzZTY0LmRlY29kZShmcm9tYnVmZmVyLCBhbHBoKQogICAgbG9jYWwgdG9UYWJsZSA9IGpzb24ucGFyc2UoZGVjb2RlKQogICAgbG9hZFNldHRpbmdzKHRvVGFibGUuY29uZmlnKQplbmQKbG9jYWwgZnVuY3Rpb24gaW1wb3J0UHJlc2V0Q2xlYXIoKQogICAgbG9jYWwgZnJvbWJ1ZmZlciA9ICJleUpwYm1SbGVDSTZPQ3dpWTI5dVptbG5JanA3SWt4QklqcDdJbkJwZEdOb0lqb2lUMlptSWl3aWNHbDBZMmhUYkdsa1pYSWlPakFzSW1KdlpIbFpZWGRUYkdsa1pYSWlPakFzSW5saGQwcHBkSFJsY2t4bFpuUWlPakFzSW5saGQwcHBkSFJsY2xKcFoyaDBJam93TENKaWIyUjVXV0YzSWpvaVQyWm1JaXdpWkdWbVpXNXphWFpsVUdsMFkyZ2lPaUl0SWl3aVpHVm1aVzV6YVhabFVHbDBZMmhUYkdsa1pYSWlPakFzSW1WdVlXSnNaVk4wWVhSbElqcG1ZV3h6WlN3aVpHVm1aVzV6YVhabFdXRjNJam9pTFNJc0lubGhkMUpwWjJoMElqb3dMQ0o1WVhkS2FYUjBaWEpFYVhOaFlteGxjbk1pT250OUxDSjVZWGRUZEdGMGFXTWlPakFzSW5saGR5STZJazltWmlJc0lubGhkME52Ym1ScGRHbHZiaUk2SWxOMFlYUnBZeUlzSW5saGQwcHBkSFJsY2tOdmJtUnBkR2x2YmlJNklsTjBZWFJwWXlJc0lubGhkMHBwZEhSbGNpSTZJazltWmlJc0lubGhkMU53WldWa0lqbzJMQ0o1WVhkS2FYUjBaWEpUZEdGMGFXTWlPakFzSW1SbFptVnVjMmwyWlU5d2RDSTZlMzBzSW5saGQweGxablFpT2pBc0ltUmxabVZ1YzJsMlpWbGhkMU5zYVdSbGNpSTZNQ3dpZVdGM1FtRnpaU0k2SWt4dlkyRnNJSFpwWlhjaWZTd2lVMWNpT25zaWNHbDBZMmdpT2lKUFptWWlMQ0p3YVhSamFGTnNhV1JsY2lJNk1Dd2lZbTlrZVZsaGQxTnNhV1JsY2lJNk1Dd2llV0YzU21sMGRHVnlUR1ZtZENJNk1Dd2llV0YzU21sMGRHVnlVbWxuYUhRaU9qQXNJbUp2WkhsWllYY2lPaUpQWm1ZaUxDSmtaV1psYm5OcGRtVlFhWFJqYUNJNklpMGlMQ0prWldabGJuTnBkbVZRYVhSamFGTnNhV1JsY2lJNk1Dd2laVzVoWW14bFUzUmhkR1VpT21aaGJITmxMQ0prWldabGJuTnBkbVZaWVhjaU9pSXRJaXdpZVdGM1VtbG5hSFFpT2pBc0lubGhkMHBwZEhSbGNrUnBjMkZpYkdWeWN5STZlMzBzSW5saGQxTjBZWFJwWXlJNk1Dd2llV0YzSWpvaVQyWm1JaXdpZVdGM1EyOXVaR2wwYVc5dUlqb2lVM1JoZEdsaklpd2llV0YzU21sMGRHVnlRMjl1WkdsMGFXOXVJam9pVTNSaGRHbGpJaXdpZVdGM1NtbDBkR1Z5SWpvaVQyWm1JaXdpZVdGM1UzQmxaV1FpT2pZc0lubGhkMHBwZEhSbGNsTjBZWFJwWXlJNk1Dd2laR1ZtWlc1emFYWmxUM0IwSWpwN2ZTd2llV0YzVEdWbWRDSTZNQ3dpWkdWbVpXNXphWFpsV1dGM1UyeHBaR1Z5SWpvd0xDSjVZWGRDWVhObElqb2lURzlqWVd3Z2RtbGxkeUo5TENKVElqcDdJbkJwZEdOb0lqb2lUMlptSWl3aWNHbDBZMmhUYkdsa1pYSWlPakFzSW1KdlpIbFpZWGRUYkdsa1pYSWlPakFzSW5saGQwcHBkSFJsY2t4bFpuUWlPakFzSW5saGQwcHBkSFJsY2xKcFoyaDBJam93TENKaWIyUjVXV0YzSWpvaVQyWm1JaXdpWkdWbVpXNXphWFpsVUdsMFkyZ2lPaUl0SWl3aVpHVm1aVzV6YVhabFVHbDBZMmhUYkdsa1pYSWlPakFzSW1WdVlXSnNaVk4wWVhSbElqcG1ZV3h6WlN3aVpHVm1aVzV6YVhabFdXRjNJam9pTFNJc0lubGhkMUpwWjJoMElqb3dMQ0o1WVhkS2FYUjBaWEpFYVhOaFlteGxjbk1pT250OUxDSjVZWGRUZEdGMGFXTWlPakFzSW5saGR5STZJazltWmlJc0lubGhkME52Ym1ScGRHbHZiaUk2SWxOMFlYUnBZeUlzSW5saGQwcHBkSFJsY2tOdmJtUnBkR2x2YmlJNklsTjBZWFJwWXlJc0lubGhkMHBwZEhSbGNpSTZJazltWmlJc0lubGhkMU53WldWa0lqbzJMQ0o1WVhkS2FYUjBaWEpUZEdGMGFXTWlPakFzSW1SbFptVnVjMmwyWlU5d2RDSTZlMzBzSW5saGQweGxablFpT2pBc0ltUmxabVZ1YzJsMlpWbGhkMU5zYVdSbGNpSTZNQ3dpZVdGM1FtRnpaU0k2SWt4dlkyRnNJSFpwWlhjaWZTd2lRVU1pT25zaWNHbDBZMmdpT2lKUFptWWlMQ0p3YVhSamFGTnNhV1JsY2lJNk1Dd2lZbTlrZVZsaGQxTnNhV1JsY2lJNk1Dd2llV0YzU21sMGRHVnlUR1ZtZENJNk1Dd2llV0YzU21sMGRHVnlVbWxuYUhRaU9qQXNJbUp2WkhsWllYY2lPaUpQWm1ZaUxDSmtaV1psYm5OcGRtVlFhWFJqYUNJNklpMGlMQ0prWldabGJuTnBkbVZRYVhSamFGTnNhV1JsY2lJNk1Dd2laVzVoWW14bFUzUmhkR1VpT21aaGJITmxMQ0prWldabGJuTnBkbVZaWVhjaU9pSXRJaXdpZVdGM1VtbG5hSFFpT2pBc0lubGhkMHBwZEhSbGNrUnBjMkZpYkdWeWN5STZlMzBzSW5saGQxTjBZWFJwWXlJNk1Dd2llV0YzSWpvaVQyWm1JaXdpZVdGM1EyOXVaR2wwYVc5dUlqb2lVM1JoZEdsaklpd2llV0YzU21sMGRHVnlRMjl1WkdsMGFXOXVJam9pVTNSaGRHbGpJaXdpZVdGM1NtbDBkR1Z5SWpvaVQyWm1JaXdpZVdGM1UzQmxaV1FpT2pZc0lubGhkMHBwZEhSbGNsTjBZWFJwWXlJNk1Dd2laR1ZtWlc1emFYWmxUM0IwSWpwN2ZTd2llV0YzVEdWbWRDSTZNQ3dpWkdWbVpXNXphWFpsV1dGM1UyeHBaR1Z5SWpvd0xDSjVZWGRDWVhObElqb2lURzlqWVd3Z2RtbGxkeUo5TENKQklqcDdJbkJwZEdOb0lqb2lUMlptSWl3aWNHbDBZMmhUYkdsa1pYSWlPakFzSW1KdlpIbFpZWGRUYkdsa1pYSWlPakFzSW5saGQwcHBkSFJsY2t4bFpuUWlPakFzSW5saGQwcHBkSFJsY2xKcFoyaDBJam93TENKaWIyUjVXV0YzSWpvaVQyWm1JaXdpWkdWbVpXNXphWFpsVUdsMFkyZ2lPaUl0SWl3aVpHVm1aVzV6YVhabFVHbDBZMmhUYkdsa1pYSWlPakFzSW1WdVlXSnNaVk4wWVhSbElqcG1ZV3h6WlN3aVpHVm1aVzV6YVhabFdXRjNJam9pTFNJc0lubGhkMUpwWjJoMElqb3dMQ0o1WVhkS2FYUjBaWEpFYVhOaFlteGxjbk1pT250OUxDSjVZWGRUZEdGMGFXTWlPakFzSW5saGR5STZJazltWmlJc0lubGhkME52Ym1ScGRHbHZiaUk2SWxOMFlYUnBZeUlzSW5saGQwcHBkSFJsY2tOdmJtUnBkR2x2YmlJNklsTjBZWFJwWXlJc0lubGhkMHBwZEhSbGNpSTZJazltWmlJc0lubGhkMU53WldWa0lqbzJMQ0o1WVhkS2FYUjBaWEpUZEdGMGFXTWlPakFzSW1SbFptVnVjMmwyWlU5d2RDSTZlMzBzSW5saGQweGxablFpT2pBc0ltUmxabVZ1YzJsMlpWbGhkMU5zYVdSbGNpSTZNQ3dpZVdGM1FtRnpaU0k2SWt4dlkyRnNJSFpwWlhjaWZTd2lUU0k2ZXlKd2FYUmphQ0k2SWs5bVppSXNJbkJwZEdOb1UyeHBaR1Z5SWpvd0xDSmliMlI1V1dGM1UyeHBaR1Z5SWpvd0xDSjVZWGRLYVhSMFpYSk1aV1owSWpvd0xDSjVZWGRLYVhSMFpYSlNhV2RvZENJNk1Dd2lZbTlrZVZsaGR5STZJazltWmlJc0ltUmxabVZ1YzJsMlpWQnBkR05vSWpvaUxTSXNJbVJsWm1WdWMybDJaVkJwZEdOb1UyeHBaR1Z5SWpvd0xDSmxibUZpYkdWVGRHRjBaU0k2Wm1Gc2MyVXNJbVJsWm1WdWMybDJaVmxoZHlJNklpMGlMQ0o1WVhkU2FXZG9kQ0k2TUN3aWVXRjNTbWwwZEdWeVJHbHpZV0pzWlhKeklqcDdmU3dpZVdGM1UzUmhkR2xqSWpvd0xDSjVZWGNpT2lKUFptWWlMQ0o1WVhkRGIyNWthWFJwYjI0aU9pSlRkR0YwYVdNaUxDSjVZWGRLYVhSMFpYSkRiMjVrYVhScGIyNGlPaUpUZEdGMGFXTWlMQ0o1WVhkS2FYUjBaWElpT2lKUFptWWlMQ0o1WVhkVGNHVmxaQ0k2Tml3aWVXRjNTbWwwZEdWeVUzUmhkR2xqSWpvd0xDSmtaV1psYm5OcGRtVlBjSFFpT250OUxDSjVZWGRNWldaMElqb3dMQ0prWldabGJuTnBkbVZaWVhkVGJHbGtaWElpT2pBc0lubGhkMEpoYzJVaU9pSk1iMk5oYkNCMmFXVjNJbjBzSWtNaU9uc2ljR2wwWTJnaU9pSlBabVlpTENKd2FYUmphRk5zYVdSbGNpSTZNQ3dpWW05a2VWbGhkMU5zYVdSbGNpSTZNQ3dpZVdGM1NtbDBkR1Z5VEdWbWRDSTZNQ3dpZVdGM1NtbDBkR1Z5VW1sbmFIUWlPakFzSW1KdlpIbFpZWGNpT2lKUFptWWlMQ0prWldabGJuTnBkbVZRYVhSamFDSTZJaTBpTENKa1pXWmxibk5wZG1WUWFYUmphRk5zYVdSbGNpSTZNQ3dpWlc1aFlteGxVM1JoZEdVaU9tWmhiSE5sTENKa1pXWmxibk5wZG1WWllYY2lPaUl0SWl3aWVXRjNVbWxuYUhRaU9qQXNJbmxoZDBwcGRIUmxja1JwYzJGaWJHVnljeUk2ZTMwc0lubGhkMU4wWVhScFl5STZNQ3dpZVdGM0lqb2lUMlptSWl3aWVXRjNRMjl1WkdsMGFXOXVJam9pVTNSaGRHbGpJaXdpZVdGM1NtbDBkR1Z5UTI5dVpHbDBhVzl1SWpvaVUzUmhkR2xqSWl3aWVXRjNTbWwwZEdWeUlqb2lUMlptSWl3aWVXRjNVM0JsWldRaU9qWXNJbmxoZDBwcGRIUmxjbE4wWVhScFl5STZNQ3dpWkdWbVpXNXphWFpsVDNCMElqcDdmU3dpZVdGM1RHVm1kQ0k2TUN3aVpHVm1aVzV6YVhabFdXRjNVMnhwWkdWeUlqb3dMQ0o1WVhkQ1lYTmxJam9pVEc5allXd2dkbWxsZHlKOUxDSkhJanA3SW5CcGRHTm9Jam9pVDJabUlpd2ljR2wwWTJoVGJHbGtaWElpT2pBc0ltSnZaSGxaWVhkVGJHbGtaWElpT2pBc0lubGhkMHBwZEhSbGNreGxablFpT2pBc0lubGhkMHBwZEhSbGNsSnBaMmgwSWpvd0xDSmliMlI1V1dGM0lqb2lUMlptSWl3aVpHVm1aVzV6YVhabFVHbDBZMmdpT2lJdElpd2laR1ZtWlc1emFYWmxVR2wwWTJoVGJHbGtaWElpT2pBc0ltVnVZV0pzWlZOMFlYUmxJanAwY25WbExDSmtaV1psYm5OcGRtVlpZWGNpT2lJdElpd2llV0YzVW1sbmFIUWlPakFzSW5saGQwcHBkSFJsY2tScGMyRmliR1Z5Y3lJNmUzMHNJbmxoZDFOMFlYUnBZeUk2TUN3aWVXRjNJam9pVDJabUlpd2llV0YzUTI5dVpHbDBhVzl1SWpvaVUzUmhkR2xqSWl3aWVXRjNTbWwwZEdWeVEyOXVaR2wwYVc5dUlqb2lVM1JoZEdsaklpd2llV0YzU21sMGRHVnlJam9pVDJabUlpd2llV0YzVTNCbFpXUWlPallzSW5saGQwcHBkSFJsY2xOMFlYUnBZeUk2TUN3aVpHVm1aVzV6YVhabFQzQjBJanA3ZlN3aWVXRjNUR1ZtZENJNk1Dd2laR1ZtWlc1emFYWmxXV0YzVTJ4cFpHVnlJam93TENKNVlYZENZWE5sSWpvaVRHOWpZV3dnZG1sbGR5SjlmWDA9IgogICAgbG9jYWwgZGVjb2RlID0gYmFzZTY0LmRlY29kZShmcm9tYnVmZmVyLCBhbHBoKQogICAgbG9jYWwgdG9UYWJsZSA9IGpzb24ucGFyc2UoZGVjb2RlKQogICAgbG9hZFNldHRpbmdzKHRvVGFibGUuY29uZmlnKQplbmQKbG9jYWwgZnVuY3Rpb24gZXhwb3J0U2V0dGluZ3MobmFtZSkKICAgIGxvY2FsIGNvbmZpZyA9IGdldENvbmZpZyhuYW1lKQogICAgbG9jYWwgdG9TdHJpbmcgPSBqc29uLnN0cmluZ2lmeShjb25maWcpCiAgICBsb2NhbCB0b0V4cG9ydCA9IGJhc2U2NC5lbmNvZGUodG9TdHJpbmcsIGFscGgpCiAgICBjbGlwYm9hcmQuc2V0KHRvRXhwb3J0KQplbmQKbG9jYWwgZnVuY3Rpb24gbG9hZENvbmZpZyhuYW1lKQogICAgbG9jYWwgY29uZmlnID0gZ2V0Q29uZmlnKG5hbWUpCiAgICBsb2FkU2V0dGluZ3MoY29uZmlnLmNvbmZpZykKZW5kCi0tIEByZWdpb24gVUlfTEFZT1VUIGVuZAoKLS0gQHJlZ2lvbiBOT1RJRklDQVRJT05fQU5JTSBzdGFydApsb2NhbCBhbmltX3RpbWUgPSAwLjUKbG9jYWwgbWF4X25vdGlmcyA9IDYKbG9jYWwgZGF0YSA9IHt9CmxvY2FsIG5vdGlmaWNhdGlvbnMgPSB7CgogICAgbmV3ID0gZnVuY3Rpb24oc3RyaW5nLCByLCBnLCBiKQogICAgICAgIHRhYmxlLmluc2VydChkYXRhLCB7CiAgICAgICAgICAgIHRpbWUgPSBnbG9iYWxzLmN1cnRpbWUoKSwKICAgICAgICAgICAgc3RyaW5nID0gc3RyaW5nLAogICAgICAgICAgICBjb2xvciA9IHtyLCBnLCBiLCAyNTV9LAogICAgICAgICAgICBmcmFjdGlvbiA9IDAKICAgICAgICB9KQogICAgICAgIGxvY2FsIHRpbWUgPSA1CiAgICAgICAgZm9yIGkgPSAjZGF0YSwgMSwgLTEgZG8KICAgICAgICAgICAgbG9jYWwgbm90aWYgPSBkYXRhW2ldCiAgICAgICAgICAgIGlmICNkYXRhIC0gaSArIDEgPiBtYXhfbm90aWZzIGFuZCBub3RpZi50aW1lICsgdGltZSAtIGdsb2JhbHMuY3VydGltZSgpID4gMCB0aGVuCiAgICAgICAgICAgICAgICBub3RpZi50aW1lID0gZ2xvYmFscy5jdXJ0aW1lKCkgLSB0aW1lCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kLAoKICAgIHJlbmRlciA9IGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCB4LCB5ID0gY2xpZW50LnNjcmVlbl9zaXplKCkKICAgICAgICBsb2NhbCB0b19yZW1vdmUgPSB7fQogICAgICAgIGxvY2FsIE9mZnNldCA9IDAKICAgICAgICBmb3IgaSA9IDEsICNkYXRhIGRvCiAgICAgICAgICAgIGxvY2FsIG5vdGlmID0gZGF0YVtpXQoKICAgICAgICAgICAgbG9jYWwgZGF0YSA9IHtyb3VuZGluZyA9IDQsIHNpemUgPSAzLCBnbG93ID0gMiwgdGltZSA9IDJ9CgogICAgICAgICAgICBpZiBub3RpZi50aW1lICsgZGF0YS50aW1lIC0gZ2xvYmFscy5jdXJ0aW1lKCkgPiAwIHRoZW4KICAgICAgICAgICAgICAgIG5vdGlmLmZyYWN0aW9uID0gZnVuYy5jbGFtcChub3RpZi5mcmFjdGlvbiArIGdsb2JhbHMuZnJhbWV0aW1lKCkgLyBhbmltX3RpbWUsIDAsIDEpCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIG5vdGlmLmZyYWN0aW9uID0gZnVuYy5jbGFtcChub3RpZi5mcmFjdGlvbiAtIGdsb2JhbHMuZnJhbWV0aW1lKCkgLyBhbmltX3RpbWUsIDAsIDEpCiAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgaWYgbm90aWYuZnJhY3Rpb24gPD0gMCBhbmQgbm90aWYudGltZSArIGRhdGEudGltZSAtIGdsb2JhbHMuY3VydGltZSgpIDw9IDAgdGhlbgogICAgICAgICAgICAgICAgdGFibGUuaW5zZXJ0KHRvX3JlbW92ZSwgaSkKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGxvY2FsIGZyYWN0aW9uID0gZnVuYy5lYXNlSW5PdXQobm90aWYuZnJhY3Rpb24pCgogICAgICAgICAgICBsb2NhbCByLCBnLCBiLCBhID0gdW5wYWNrKG5vdGlmLmNvbG9yKQogICAgICAgICAgICBsb2NhbCBzdHJpbmcgPSBjb2xvcl90ZXh0KG5vdGlmLnN0cmluZywgciwgZywgYiwgYSAqIGZyYWN0aW9uKQoKICAgICAgICAgICAgbG9jYWwgc3Rydywgc3RyaCA9IHJlbmRlcmVyLm1lYXN1cmVfdGV4dCgiIiwgc3RyaW5nKQogICAgICAgICAgICBsb2NhbCBzdHJ3MiA9IHJlbmRlcmVyLm1lYXN1cmVfdGV4dCgiYiIsICIiKQoKICAgICAgICAgICAgbG9jYWwgcGFkZGluZ3gsIHBhZGRpbmd5ID0gNywgZGF0YS5zaXplCiAgICAgICAgICAgIGxvY2FsIG9mZnNldFkgPSB1aS5nZXQobWVudS52aXN1YWxzVGFiLmxvZ09mZnNldCkKCiAgICAgICAgICAgIE9mZnNldCA9IE9mZnNldCArIChzdHJoICsgcGFkZGluZ3kqMiArIAltYXRoLnNxcnQoZGF0YS5nbG93LzEwKSoxMCArIDUpICogZnJhY3Rpb24KICAgICAgICAgICAgZ2xvd19tb2R1bGUoeC8yIC0gKHN0cncgKyBzdHJ3MikvMiAtIHBhZGRpbmd4LCB5IC0gb2Zmc2V0WSAtIHN0cmgvMiAtIHBhZGRpbmd5IC0gT2Zmc2V0LCBzdHJ3ICsgc3RydzIgKyBwYWRkaW5neCoyLCBzdHJoICsgcGFkZGluZ3kqMiwgZGF0YS5nbG93LCBkYXRhLnJvdW5kaW5nLCB7ciwgZywgYiwgNDUgKiBmcmFjdGlvbn0sIHsyNSwyNSwyNSwxNDAgKiBmcmFjdGlvbn0pCiAgICAgICAgICAgIHJlbmRlcmVyLnRleHQoeC8yICsgc3RydzIvMiwgeSAtIG9mZnNldFkgLSBPZmZzZXQsIDI1NSwgMjU1LCAyNTUsIDI1NSAqIGZyYWN0aW9uLCAiYyIsIDAsIHN0cmluZykKICAgICAgICBlbmQKCiAgICAgICAgZm9yIGkgPSAjdG9fcmVtb3ZlLCAxLCAtMSBkbwogICAgICAgICAgICB0YWJsZS5yZW1vdmUoZGF0YSwgdG9fcmVtb3ZlW2ldKQogICAgICAgIGVuZAogICAgZW5kLAoKICAgIGNsZWFyID0gZnVuY3Rpb24oKQogICAgICAgIGRhdGEgPSB7fQogICAgZW5kCn0KCmxvY2FsIGZ1bmN0aW9uIG9uSGl0KGUpCiAgICBsb2NhbCBncm91cCA9IHZhcnMuaGl0Z3JvdXBfbmFtZXNbZS5oaXRncm91cCArIDFdIG9yICc/JwoJbG9jYWwgciwgZywgYiwgYSA9IHVpLmdldChtZW51LnZpc3VhbHNUYWIubG9nc0NscikKICAgIGlmIGVudGl0eS5nZXRfcHJvcChlLnRhcmdldCwgJ21faUhlYWx0aCcpIDw9IDAgdGhlbgoJICAgIG5vdGlmaWNhdGlvbnMubmV3KHN0cmluZy5mb3JtYXQoIktpbGxlZCAlcyAkJXMkIGZvciAkJWQkIGRhbWFnZSIsIGVudGl0eS5nZXRfcGxheWVyX25hbWUoZS50YXJnZXQpLCBncm91cDpsb3dlcigpLCBlLmRhbWFnZSksIHIsIGcsIGIpCiAgICBlbHNlCiAgICAgICAgbm90aWZpY2F0aW9ucy5uZXcoc3RyaW5nLmZvcm1hdCgiSGl0ICVzJ3MgJCVzJCBmb3IgJCVkJCBkYW1hZ2UgKCQlZCQgaGVhbHRoIHJlbWFpbmluZykiLCBlbnRpdHkuZ2V0X3BsYXllcl9uYW1lKGUudGFyZ2V0KSwgZ3JvdXA6bG93ZXIoKSwgZS5kYW1hZ2UsIGVudGl0eS5nZXRfcHJvcChlLnRhcmdldCwgJ21faUhlYWx0aCcpKSwgciwgZywgYikgCiAgICBlbmQKCmVuZAoKbG9jYWwgZnVuY3Rpb24gb25NaXNzKGUpCiAgICBsb2NhbCBncm91cCA9IHZhcnMuaGl0Z3JvdXBfbmFtZXNbZS5oaXRncm91cCArIDFdIG9yICc/JwogICAgbG9jYWwgcGluZyA9IG1hdGgubWluKDk5OSwgY2xpZW50LnJlYWxfbGF0ZW5jeSgpICogMTAwMCkKICAgIGxvY2FsIHBpbmdfY29sID0gKHBpbmcgPj0gMTAwKSBhbmQgeyAyNTUsIDAsIDAgfSBvciB7IDE1MCwgMjAwLCA2MCB9CiAgICBsb2NhbCBoYyA9IG1hdGguZmxvb3IoZS5oaXRfY2hhbmNlICsgMC41KTsKICAgIGxvY2FsIGhjX2NvbCA9IChoYyA8IHVpLmdldChyZWZzLmhpdENoYW5jZSkpIGFuZCB7IDI1NSwgMCwgMCB9IG9yIHsgMTUwLCAyMDAsIDYwIH07CiAgICBlLnJlYXNvbiA9IGUucmVhc29uID09ICI/IiBhbmQgInJlc29sdmVyIiBvciBlLnJlYXNvbgoJbm90aWZpY2F0aW9ucy5uZXcoc3RyaW5nLmZvcm1hdCgiTWlzc2VkICVzJ3MgJCVzJCBkdWUgdG8gJCVzJCIsIGVudGl0eS5nZXRfcGxheWVyX25hbWUoZS50YXJnZXQpLCBncm91cDpsb3dlcigpLCBlLnJlYXNvbiksIDI1NSwgMTIwLCAxMjApCmVuZAotLSBAcmVnaW9uIE5PVElGSUNBVElPTl9BTklNIGVuZAoKLS0gQHJlZ2lvbiBBQV9DQUxMQkFDS1Mgc3RhcnQKbG9jYWwgYWEgPSB7CglpZ25vcmUgPSBmYWxzZSwKCW1hbnVhbEFBPSAwLAoJaW5wdXQgPSAwLAp9CmNsaWVudC5zZXRfZXZlbnRfY2FsbGJhY2soInBsYXllcl9jb25uZWN0X2Z1bGwiLCBmdW5jdGlvbigpIAoJYWEuaWdub3JlID0gZmFsc2UKCWFhLm1hbnVhbEFBPSAwCglhYS5pbnB1dCA9IGdsb2JhbHMuY3VydGltZSgpCmVuZCkKCmxvY2FsIGNsYW50YWcgPSB7CiAgICBzdGVhbSA9IHN0ZWFtd29ya3MuSVN0ZWFtRnJpZW5kcywKICAgIHByZXZfY3QgPSAiIiwKICAgIG9yaWdfY3QgPSAiIiwKICAgIGVuYiA9IGZhbHNlLAp9Cgpsb2NhbCBmdW5jdGlvbiBnZXRfb3JpZ2luYWxfY2xhbnRhZygpCiAgICBsb2NhbCBjbGFuX2lkID0gY3Zhci5jbF9jbGFuaWQuZ2V0X2ludCgpCiAgICBpZiBjbGFuX2lkID09IDAgdGhlbiByZXR1cm4gIlwwIiBlbmQKCiAgICBsb2NhbCBjbGFuX2NvdW50ID0gY2xhbnRhZy5zdGVhbS5HZXRDbGFuQ291bnQoKQogICAgZm9yIGkgPSAwLCBjbGFuX2NvdW50IGRvIAogICAgICAgIGxvY2FsIGdyb3VwX2lkID0gY2xhbnRhZy5zdGVhbS5HZXRDbGFuQnlJbmRleChpKQogICAgICAgIGlmIGdyb3VwX2lkID09IGNsYW5faWQgdGhlbgogICAgICAgICAgICByZXR1cm4gY2xhbnRhZy5zdGVhbS5HZXRDbGFuVGFnKGdyb3VwX2lkKQogICAgICAgIGVuZAogICAgZW5kCmVuZAoKbG9jYWwgY3VycmVudF90aWNrID0gZnVuYy50aW1lX3RvX3RpY2tzKGdsb2JhbHMucmVhbHRpbWUoKSkKY2xpZW50LnNldF9ldmVudF9jYWxsYmFjaygic2V0dXBfY29tbWFuZCIsIGZ1bmN0aW9uKGNtZCkKICAgIHZhcnMubG9jYWxQbGF5ZXIgPSBlbnRpdHkuZ2V0X2xvY2FsX3BsYXllcigpCgogICAgaWYgbm90IHZhcnMubG9jYWxQbGF5ZXIgb3Igbm90IGVudGl0eS5pc19hbGl2ZSh2YXJzLmxvY2FsUGxheWVyKSBvciBub3QgdWkuZ2V0KG1hc3RlclN3aXRjaCkgdGhlbiByZXR1cm4gZW5kCglsb2NhbCBmbGFncyA9IGVudGl0eS5nZXRfcHJvcCh2YXJzLmxvY2FsUGxheWVyLCAibV9mRmxhZ3MiKQogICAgbG9jYWwgb25ncm91bmQgPSBiaXQuYmFuZChmbGFncywgMSkgfj0gMCBhbmQgY21kLmluX2p1bXAgPT0gMAoJbG9jYWwgdmFsdmUgPSBlbnRpdHkuZ2V0X3Byb3AoZW50aXR5LmdldF9nYW1lX3J1bGVzKCksICJtX2JJc1ZhbHZlRFMiKQoJbG9jYWwgb3JpZ2luID0gdmVjdG9yKGVudGl0eS5nZXRfcHJvcCh2YXJzLmxvY2FsUGxheWVyLCAibV92ZWNPcmlnaW4iKSkKCWxvY2FsIHZlbG9jaXR5ID0gdmVjdG9yKGVudGl0eS5nZXRfcHJvcCh2YXJzLmxvY2FsUGxheWVyLCAibV92ZWNWZWxvY2l0eSIpKQoJbG9jYWwgY2FtZXJhID0gdmVjdG9yKGNsaWVudC5jYW1lcmFfYW5nbGVzKCkpCglsb2NhbCBleWUgPSB2ZWN0b3IoY2xpZW50LmV5ZV9wb3NpdGlvbigpKQoJbG9jYWwgc3BlZWQgPSBtYXRoLnNxcnQoKHZlbG9jaXR5LnggKiB2ZWxvY2l0eS54KSArICh2ZWxvY2l0eS55ICogdmVsb2NpdHkueSkgKyAodmVsb2NpdHkueiAqIHZlbG9jaXR5LnopKQogICAgbG9jYWwgd2VhcG9uID0gZW50aXR5LmdldF9wbGF5ZXJfd2VhcG9uKCkKCWxvY2FsIHBTdGlsbCA9IG1hdGguc3FydCh2ZWxvY2l0eS54IF4gMiArIHZlbG9jaXR5LnkgXiAyKSA8IDUKICAgIGxvY2FsIGJvZHlZYXcgPSBlbnRpdHkuZ2V0X3Byb3AodmFycy5sb2NhbFBsYXllciwgIm1fZmxQb3NlUGFyYW1ldGVyIiwgMTEpICogMTIwIC0gNjAKCiAgICBsb2NhbCB3ZWFwb24gPSBlbnRpdHkuZ2V0X3BsYXllcl93ZWFwb24odmFycy5sb2NhbFBsYXllcikKCiAgICBsb2NhbCBpc1Nsb3cgPSB1aS5nZXQocmVmcy5zbG93WzFdKSBhbmQgdWkuZ2V0KHJlZnMuc2xvd1syXSkKCWxvY2FsIGlzT3MgPSB1aS5nZXQocmVmcy5vc1sxXSkgYW5kIHVpLmdldChyZWZzLm9zWzJdKQoJbG9jYWwgaXNGZCA9IHVpLmdldChyZWZzLmZha2VEdWNrKQoJbG9jYWwgaXNEdCA9IHVpLmdldChyZWZzLmR0WzFdKSBhbmQgdWkuZ2V0KHJlZnMuZHRbMl0pCiAgICBsb2NhbCBpc0xlZ2l0QUEgPSB1aS5nZXQoYWFCdWlsZGVyWzhdLmVuYWJsZVN0YXRlKSBhbmQgY2xpZW50LmtleV9zdGF0ZSgweDQ1KQogICAgbG9jYWwgaXNEZWZlbnNpdmUgPSAoZnVuYy5kZWZlbnNpdmUuZGVmZW5zaXZlID4gMSBhbmQgZnVuYy5kZWZlbnNpdmUuZGVmZW5zaXZlIDwgMTQpCiAgICBsb2NhbCBzYWZlS25pZmUgPSBmdW5jLmluY2x1ZGVzKHVpLmdldChtZW51LmJ1aWxkZXJUYWIuVHdlYWtzTXVsdGlzZWxlY3QpLCAiU2FmZSBoZWFkIG9uIGtuaWZlIikgYW5kIGVudGl0eS5nZXRfY2xhc3NuYW1lKHdlYXBvbikgPT0gIkNLbmlmZSIKCiAgICAtLSBzZWFyY2ggZm9yIHN0YXRlcwogICAgdmFycy5wU3RhdGUgPSAxCiAgICBpZiBwU3RpbGwgdGhlbiB2YXJzLnBTdGF0ZSA9IDIgZW5kCiAgICBpZiBub3QgcFN0aWxsIHRoZW4gdmFycy5wU3RhdGUgPSAzIGVuZAogICAgaWYgaXNTbG93IHRoZW4gdmFycy5wU3RhdGUgPSA0IGVuZAogICAgaWYgZW50aXR5LmdldF9wcm9wKHZhcnMubG9jYWxQbGF5ZXIsICJtX2ZsRHVja0Ftb3VudCIpID4gMC4xIHRoZW4gdmFycy5wU3RhdGUgPSA1IGVuZAogICAgaWYgbm90IG9uZ3JvdW5kIHRoZW4gdmFycy5wU3RhdGUgPSA2IGVuZAogICAgaWYgbm90IG9uZ3JvdW5kIGFuZCBlbnRpdHkuZ2V0X3Byb3AodmFycy5sb2NhbFBsYXllciwgIm1fZmxEdWNrQW1vdW50IikgPiAwLjEgdGhlbiB2YXJzLnBTdGF0ZSA9IDcgZW5kCgogICAgaWYgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0uZW5hYmxlU3RhdGUpID09IGZhbHNlIGFuZCB2YXJzLnBTdGF0ZSB+PSAxIHRoZW4KICAgICAgICB2YXJzLnBTdGF0ZSA9IDEKICAgIGVuZAoKICAgIGlmIGlzTGVnaXRBQSBhbmQgbm90IHZhcnMuc2hvdWxkX2Rpc2FibGUgdGhlbgogICAgICAgIHZhcnMucFN0YXRlID0gOAogICAgZW5kCgogICAgbG9jYWwgbmV4dEF0dGFjayA9IGVudGl0eS5nZXRfcHJvcCh2YXJzLmxvY2FsUGxheWVyLCAibV9mbE5leHRBdHRhY2siKQogICAgbG9jYWwgbmV4dFByaW1hcnlBdHRhY2sgPSBlbnRpdHkuZ2V0X3Byb3AoZW50aXR5LmdldF9wbGF5ZXJfd2VhcG9uKHZhcnMubG9jYWxQbGF5ZXIpLCAibV9mbE5leHRQcmltYXJ5QXR0YWNrIikKICAgIGxvY2FsIGR0QWN0aXZlID0gZmFsc2UKICAgIGxvY2FsIGlzRmwgPSB1aS5nZXQodWkucmVmZXJlbmNlKCJBQSIsICJGYWtlIGxhZyIsICJFbmFibGVkIikpCiAgICBsb2NhbCBpc0ZsMiA9IHVpLmdldCh1aS5yZWZlcmVuY2UoIkFBIiwgIkZha2UgbGFnIiwgIkVuYWJsZWQiKSkgYW5kIG5vdCBpc0R0IGFuZCBub3QgaXNPcwogICAgaWYgbmV4dFByaW1hcnlBdHRhY2sgfj0gbmlsIHRoZW4KICAgICAgICBkdEFjdGl2ZSA9IG5vdCAobWF0aC5tYXgobmV4dFByaW1hcnlBdHRhY2ssIG5leHRBdHRhY2spID4gZ2xvYmFscy5jdXJ0aW1lKCkpCiAgICBlbmQKCiAgICBsb2NhbCBzaWRlX3lhdyA9IDIKICAgIGlmIGNtZC5jaG9rZWRjb21tYW5kcyA9PSAwIHRoZW4KICAgICAgICB2YXJzLmNob2tlMSA9IHZhcnMuY2hva2UxICsgMQogICAgICAgIHZhcnMuY2hva2UyID0gdmFycy5jaG9rZTIgKyAxCiAgICAgICAgdmFycy5jaG9rZTMgPSB2YXJzLmNob2tlMyArIDEKICAgICAgICB2YXJzLmNob2tlNCA9IHZhcnMuY2hva2U0ICsgMQogICAgZW5kCiAgICBpZiB2YXJzLmNob2tlMSA+PSA1IHRoZW4KICAgICAgICB2YXJzLmNob2tlMSA9IDAKICAgIGVuZAogICAgaWYgdmFycy5jaG9rZTIgPj0gOCB0aGVuCiAgICAgICAgdmFycy5jaG9rZTIgPSAwCiAgICBlbmQKICAgIGlmIHZhcnMuY2hva2UzID49IDggdGhlbgogICAgICAgIHZhcnMuY2hva2UzID0gNQogICAgZW5kCgogICAgaWYgZ2xvYmFscy50aWNrY291bnQoKSAlIHVpLmdldChhYUJ1aWxkZXJbdmFycy5wU3RhdGVdLnlhd1NwZWVkKSA9PSAxIHRoZW4KICAgICAgICB2YXJzLnN3aXRjaCA9IG5vdCB2YXJzLnN3aXRjaAogICAgZW5kCgogICAgbG9jYWwgdGlja2NvdW50ID0gZ2xvYmFscy50aWNrY291bnQoKQoKICAgIGxvY2FsIHNpZGUgPSBib2R5WWF3ID4gMCBhbmQgMSBvciAtMQoKICAgICAgICAtLSBtYW51YWwgYWEKICAgICAgICBsb2NhbCBpc1N0YXRpYyA9IHVpLmdldChtZW51LmJ1aWxkZXJUYWIuc3RhdGljTWFudWFscykKCiAgICAgICAgdWkuc2V0KG1lbnUuYnVpbGRlclRhYi5tYW51YWxUYWIubWFudWFsTGVmdCwgIk9uIGhvdGtleSIpCiAgICAgICAgdWkuc2V0KG1lbnUuYnVpbGRlclRhYi5tYW51YWxUYWIubWFudWFsUmlnaHQsICJPbiBob3RrZXkiKQogICAgICAgIHVpLnNldChtZW51LmJ1aWxkZXJUYWIubWFudWFsVGFiLm1hbnVhbFJlc2V0LCAiT24gaG90a2V5IikKICAgICAgICB1aS5zZXQobWVudS5idWlsZGVyVGFiLm1hbnVhbFRhYi5tYW51YWxGb3J3YXJkLCAiT24gaG90a2V5IikKCiAgICAgICAgaWYgYWEuaW5wdXQgKyAwLjE4MiA8IGdsb2JhbHMuY3VydGltZSgpIHRoZW4KICAgICAgICAgICAgaWYgYWEubWFudWFsQUEgPT0gMCB0aGVuCiAgICAgICAgICAgICAgICBpZiB1aS5nZXQobWVudS5idWlsZGVyVGFiLm1hbnVhbFRhYi5tYW51YWxMZWZ0KSB0aGVuCiAgICAgICAgICAgICAgICAgICAgYWEubWFudWFsQUEgPSAxCiAgICAgICAgICAgICAgICAgICAgYWEuaW5wdXQgPSBnbG9iYWxzLmN1cnRpbWUoKSAgICAKICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy5waXRjaFsxXSwgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0ucGl0Y2gpKQogICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnBpdGNoWzJdLCB1aS5nZXQoYWFCdWlsZGVyW3ZhcnMucFN0YXRlXS5waXRjaFNsaWRlcikpCiAgICAgICAgICAgICAgICBlbHNlaWYgdWkuZ2V0KG1lbnUuYnVpbGRlclRhYi5tYW51YWxUYWIubWFudWFsUmlnaHQpIHRoZW4KICAgICAgICAgICAgICAgICAgICBhYS5tYW51YWxBQSA9IDIKICAgICAgICAgICAgICAgICAgICBhYS5pbnB1dCA9IGdsb2JhbHMuY3VydGltZSgpCiAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMucGl0Y2hbMV0sIHVpLmdldChhYUJ1aWxkZXJbdmFycy5wU3RhdGVdLnBpdGNoKSkKICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy5waXRjaFsyXSwgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0ucGl0Y2hTbGlkZXIpKQogICAgICAgICAgICAgICAgZWxzZWlmIHVpLmdldChtZW51LmJ1aWxkZXJUYWIubWFudWFsVGFiLm1hbnVhbEZvcndhcmQpIHRoZW4KICAgICAgICAgICAgICAgICAgICBhYS5tYW51YWxBQSA9IDMKICAgICAgICAgICAgICAgICAgICBhYS5pbnB1dCA9IGdsb2JhbHMuY3VydGltZSgpCiAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMucGl0Y2hbMV0sIHVpLmdldChhYUJ1aWxkZXJbdmFycy5wU3RhdGVdLnBpdGNoKSkKICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy5waXRjaFsyXSwgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0ucGl0Y2hTbGlkZXIpKSAgCiAgICAgICAgICAgICAgICBlbHNlaWYgdWkuZ2V0KG1lbnUuYnVpbGRlclRhYi5tYW51YWxUYWIubWFudWFsUmVzZXQpIHRoZW4KICAgICAgICAgICAgICAgICAgICBhYS5tYW51YWxBQSA9IDAKICAgICAgICAgICAgICAgICAgICBhYS5pbnB1dCA9IGdsb2JhbHMuY3VydGltZSgpCiAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMucGl0Y2hbMV0sIHVpLmdldChhYUJ1aWxkZXJbdmFycy5wU3RhdGVdLnBpdGNoKSkKICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy5waXRjaFsyXSwgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0ucGl0Y2hTbGlkZXIpKSAgCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZWxzZWlmIGFhLm1hbnVhbEFBID09IDEgdGhlbgogICAgICAgICAgICAgICAgaWYgdWkuZ2V0KG1lbnUuYnVpbGRlclRhYi5tYW51YWxUYWIubWFudWFsUmlnaHQpIHRoZW4KICAgICAgICAgICAgICAgICAgICBhYS5tYW51YWxBQSA9IDIKICAgICAgICAgICAgICAgICAgICBhYS5pbnB1dCA9IGdsb2JhbHMuY3VydGltZSgpCiAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMucGl0Y2hbMV0sIHVpLmdldChhYUJ1aWxkZXJbdmFycy5wU3RhdGVdLnBpdGNoKSkKICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy5waXRjaFsyXSwgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0ucGl0Y2hTbGlkZXIpKSAgCiAgICAgICAgICAgICAgICBlbHNlaWYgdWkuZ2V0KG1lbnUuYnVpbGRlclRhYi5tYW51YWxUYWIubWFudWFsRm9yd2FyZCkgdGhlbgogICAgICAgICAgICAgICAgICAgIGFhLm1hbnVhbEFBID0gMwogICAgICAgICAgICAgICAgICAgIGFhLmlucHV0ID0gZ2xvYmFscy5jdXJ0aW1lKCkKICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy5waXRjaFsxXSwgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0ucGl0Y2gpKQogICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnBpdGNoWzJdLCB1aS5nZXQoYWFCdWlsZGVyW3ZhcnMucFN0YXRlXS5waXRjaFNsaWRlcikpICAKICAgICAgICAgICAgICAgIGVsc2VpZiB1aS5nZXQobWVudS5idWlsZGVyVGFiLm1hbnVhbFRhYi5tYW51YWxMZWZ0KSB0aGVuCiAgICAgICAgICAgICAgICAgICAgYWEubWFudWFsQUEgPSAwCiAgICAgICAgICAgICAgICAgICAgYWEuaW5wdXQgPSBnbG9iYWxzLmN1cnRpbWUoKQogICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnBpdGNoWzFdLCB1aS5nZXQoYWFCdWlsZGVyW3ZhcnMucFN0YXRlXS5waXRjaCkpCiAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMucGl0Y2hbMl0sIHVpLmdldChhYUJ1aWxkZXJbdmFycy5wU3RhdGVdLnBpdGNoU2xpZGVyKSkgIAogICAgICAgICAgICAgICAgZWxzZWlmIHVpLmdldChtZW51LmJ1aWxkZXJUYWIubWFudWFsVGFiLm1hbnVhbFJlc2V0KSB0aGVuCiAgICAgICAgICAgICAgICAgICAgYWEubWFudWFsQUEgPSAwCiAgICAgICAgICAgICAgICAgICAgYWEuaW5wdXQgPSBnbG9iYWxzLmN1cnRpbWUoKSAgICAKICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy5waXRjaFsxXSwgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0ucGl0Y2gpKQogICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnBpdGNoWzJdLCB1aS5nZXQoYWFCdWlsZGVyW3ZhcnMucFN0YXRlXS5waXRjaFNsaWRlcikpICAKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbHNlaWYgYWEubWFudWFsQUEgPT0gMiB0aGVuCiAgICAgICAgICAgICAgICBpZiB1aS5nZXQobWVudS5idWlsZGVyVGFiLm1hbnVhbFRhYi5tYW51YWxMZWZ0KSB0aGVuCiAgICAgICAgICAgICAgICAgICAgYWEubWFudWFsQUEgPSAxCiAgICAgICAgICAgICAgICAgICAgYWEuaW5wdXQgPSBnbG9iYWxzLmN1cnRpbWUoKQogICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnBpdGNoWzFdLCB1aS5nZXQoYWFCdWlsZGVyW3ZhcnMucFN0YXRlXS5waXRjaCkpCiAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMucGl0Y2hbMl0sIHVpLmdldChhYUJ1aWxkZXJbdmFycy5wU3RhdGVdLnBpdGNoU2xpZGVyKSkgIAogICAgICAgICAgICAgICAgZWxzZWlmIHVpLmdldChtZW51LmJ1aWxkZXJUYWIubWFudWFsVGFiLm1hbnVhbEZvcndhcmQpIHRoZW4KICAgICAgICAgICAgICAgICAgICBhYS5tYW51YWxBQSA9IDMKICAgICAgICAgICAgICAgICAgICBhYS5pbnB1dCA9IGdsb2JhbHMuY3VydGltZSgpCiAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMucGl0Y2hbMV0sIHVpLmdldChhYUJ1aWxkZXJbdmFycy5wU3RhdGVdLnBpdGNoKSkKICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy5waXRjaFsyXSwgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0ucGl0Y2hTbGlkZXIpKSAgCiAgICAgICAgICAgICAgICBlbHNlaWYgdWkuZ2V0KG1lbnUuYnVpbGRlclRhYi5tYW51YWxUYWIubWFudWFsUmlnaHQpIHRoZW4KICAgICAgICAgICAgICAgICAgICBhYS5tYW51YWxBQSA9IDAKICAgICAgICAgICAgICAgICAgICBhYS5pbnB1dCA9IGdsb2JhbHMuY3VydGltZSgpCiAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMucGl0Y2hbMV0sIHVpLmdldChhYUJ1aWxkZXJbdmFycy5wU3RhdGVdLnBpdGNoKSkKICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy5waXRjaFsyXSwgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0ucGl0Y2hTbGlkZXIpKSAgCiAgICAgICAgICAgICAgICBlbHNlaWYgdWkuZ2V0KG1lbnUuYnVpbGRlclRhYi5tYW51YWxUYWIubWFudWFsUmVzZXQpIHRoZW4KICAgICAgICAgICAgICAgICAgICBhYS5tYW51YWxBQSA9IDAKICAgICAgICAgICAgICAgICAgICBhYS5pbnB1dCA9IGdsb2JhbHMuY3VydGltZSgpICAgIAogICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnBpdGNoWzFdLCB1aS5nZXQoYWFCdWlsZGVyW3ZhcnMucFN0YXRlXS5waXRjaCkpCiAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMucGl0Y2hbMl0sIHVpLmdldChhYUJ1aWxkZXJbdmFycy5wU3RhdGVdLnBpdGNoU2xpZGVyKSkgIAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVsc2VpZiBhYS5tYW51YWxBQSA9PSAzIHRoZW4KICAgICAgICAgICAgICAgIGlmIHVpLmdldChtZW51LmJ1aWxkZXJUYWIubWFudWFsVGFiLm1hbnVhbEZvcndhcmQpIHRoZW4KICAgICAgICAgICAgICAgICAgICBhYS5tYW51YWxBQSA9IDAKICAgICAgICAgICAgICAgICAgICBhYS5pbnB1dCA9IGdsb2JhbHMuY3VydGltZSgpCiAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMucGl0Y2hbMV0sIHVpLmdldChhYUJ1aWxkZXJbdmFycy5wU3RhdGVdLnBpdGNoKSkKICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy5waXRjaFsyXSwgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0ucGl0Y2hTbGlkZXIpKSAgCiAgICAgICAgICAgICAgICBlbHNlaWYgdWkuZ2V0KG1lbnUuYnVpbGRlclRhYi5tYW51YWxUYWIubWFudWFsTGVmdCkgdGhlbgogICAgICAgICAgICAgICAgICAgIGFhLm1hbnVhbEFBID0gMQogICAgICAgICAgICAgICAgICAgIGFhLmlucHV0ID0gZ2xvYmFscy5jdXJ0aW1lKCkKICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy5waXRjaFsxXSwgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0ucGl0Y2gpKQogICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnBpdGNoWzJdLCB1aS5nZXQoYWFCdWlsZGVyW3ZhcnMucFN0YXRlXS5waXRjaFNsaWRlcikpICAKICAgICAgICAgICAgICAgIGVsc2VpZiB1aS5nZXQobWVudS5idWlsZGVyVGFiLm1hbnVhbFRhYi5tYW51YWxSaWdodCkgdGhlbgogICAgICAgICAgICAgICAgICAgIGFhLm1hbnVhbEFBID0gMgogICAgICAgICAgICAgICAgICAgIGFhLmlucHV0ID0gZ2xvYmFscy5jdXJ0aW1lKCkKICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy5waXRjaFsxXSwgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0ucGl0Y2gpKQogICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnBpdGNoWzJdLCB1aS5nZXQoYWFCdWlsZGVyW3ZhcnMucFN0YXRlXS5waXRjaFNsaWRlcikpICAKICAgICAgICAgICAgICAgIGVsc2VpZiB1aS5nZXQobWVudS5idWlsZGVyVGFiLm1hbnVhbFRhYi5tYW51YWxSZXNldCkgdGhlbgogICAgICAgICAgICAgICAgICAgIGFhLm1hbnVhbEFBID0gMAogICAgICAgICAgICAgICAgICAgIGFhLmlucHV0ID0gZ2xvYmFscy5jdXJ0aW1lKCkgICAgCiAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMucGl0Y2hbMV0sIHVpLmdldChhYUJ1aWxkZXJbdmFycy5wU3RhdGVdLnBpdGNoKSkKICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy5waXRjaFsyXSwgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0ucGl0Y2hTbGlkZXIpKSAgCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCgogICAgICAgICAgICBpZiBhYS5tYW51YWxBQSA9PSAxIG9yIGFhLm1hbnVhbEFBID09IDIgb3IgYWEubWFudWFsQUEgPT0gMyB0aGVuCiAgICAgICAgICAgICAgICBhYS5pZ25vcmUgPSB0cnVlCgogICAgICAgICAgICAgICAgaWYgaXNTdGF0aWMgdGhlbgogICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnlhd0ppdHRlclsxXSwgIk9mZiIpCiAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMueWF3Sml0dGVyWzJdLCAwKQogICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLmJvZHlZYXdbMV0sICJTdGF0aWMiKQogICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLmJvZHlZYXdbMl0sIC0xODApCgogICAgICAgICAgICAgICAgICAgIGlmIGFhLm1hbnVhbEFBID09IDEgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy55YXdCYXNlLCAibG9jYWwgdmlldyIpCiAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnlhd1sxXSwgIjE4MCIpCiAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnlhd1syXSwgLTkwKQogICAgICAgICAgICAgICAgICAgIGVsc2VpZiBhYS5tYW51YWxBQSA9PSAyIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMueWF3QmFzZSwgImxvY2FsIHZpZXciKQogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy55YXdbMV0sICIxODAiKQogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy55YXdbMl0sIDkwKQogICAgICAgICAgICAgICAgICAgIGVsc2VpZiBhYS5tYW51YWxBQSA9PSAzIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMueWF3QmFzZSwgImxvY2FsIHZpZXciKQogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy55YXdbMV0sICIxODAiKQogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy55YXdbMl0sIDE4MCkKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVsc2VpZiBub3QgaXNTdGF0aWMgYW5kIHVpLmdldChhYUJ1aWxkZXJbdmFycy5wU3RhdGVdLmVuYWJsZVN0YXRlKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgaWYgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0ueWF3Sml0dGVyKSA9PSAiMy1XYXkiIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMueWF3Sml0dGVyWzFdLCAiQ2VudGVyIikKICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMueWF3Sml0dGVyWzJdLCAoc2lkZSA9PSAxIGFuZCB1aS5nZXQoYWFCdWlsZGVyW3ZhcnMucFN0YXRlXS55YXdKaXR0ZXJMZWZ0KSptYXRoLnJhbmRvbSgtMSwgMSkgIG9yIHVpLmdldChhYUJ1aWxkZXJbdmFycy5wU3RhdGVdLnlhd0ppdHRlclJpZ2h0KSptYXRoLnJhbmRvbSgtMSwgMSkgKSkKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0ueWF3Sml0dGVyKSA9PSAiTCAmIFIiIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMueWF3Sml0dGVyWzFdLCAiQ2VudGVyIikKICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMueWF3Sml0dGVyWzJdLCAoc2lkZSA9PSAxIGFuZCB1aS5nZXQoYWFCdWlsZGVyW3ZhcnMucFN0YXRlXS55YXdKaXR0ZXJMZWZ0KSBvciB1aS5nZXQoYWFCdWlsZGVyW3ZhcnMucFN0YXRlXS55YXdKaXR0ZXJSaWdodCkpKQogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMueWF3Sml0dGVyWzFdLCB1aS5nZXQoYWFCdWlsZGVyW3ZhcnMucFN0YXRlXS55YXdKaXR0ZXIpKQogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy55YXdKaXR0ZXJbMl0sIHVpLmdldChhYUJ1aWxkZXJbdmFycy5wU3RhdGVdLnlhd0ppdHRlclN0YXRpYykpCiAgICAgICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgICAgIGlmIHVpLmdldChhYUJ1aWxkZXJbdmFycy5wU3RhdGVdLnlhd0NvbmRpdGlvbikgPT0gIkwgJiBSIiB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLmJvZHlZYXdbMV0sICJKaXR0ZXIiKQogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy5ib2R5WWF3WzJdLCAtMSkKICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLmJvZHlZYXdbMV0sICJTdGF0aWMiKQogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy5ib2R5WWF3WzJdLCAtMTgwKQogICAgICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgICAgICBpZiBhYS5tYW51YWxBQSA9PSAxIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMueWF3QmFzZSwgImxvY2FsIHZpZXciKQogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy55YXdbMV0sICIxODAiKQogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy55YXdbMl0sIC05MCkKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgYWEubWFudWFsQUEgPT0gMiB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnlhd0Jhc2UsICJsb2NhbCB2aWV3IikKICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMueWF3WzFdLCAiMTgwIikgICAgIAogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy55YXdbMl0sIDkwKQogICAgICAgICAgICAgICAgICAgIGVsc2VpZiBhYS5tYW51YWxBQSA9PSAzIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMueWF3QmFzZSwgImxvY2FsIHZpZXciKQogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy55YXdbMV0sICIxODAiKQogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy55YXdbMl0sIDE4MCkKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBhYS5pZ25vcmUgPSBmYWxzZQogICAgICAgICAgICBlbmQKICAgICAgICBlbHNlaWYgYWEuaW5wdXQgPiBnbG9iYWxzLmN1cnRpbWUoKSB0aGVuCiAgICAgICAgLS0gICAgYWEuaWdub3JlID0gZmFsc2UKICAgICAgICAtLSAgICBhYS5tYW51YWxBQSA9IDAKICAgICAgICAgICAgYWEuaW5wdXQgPSBnbG9iYWxzLmN1cnRpbWUoKQogICAgICAgIGVuZAoKICAgIC0tIGNoZWNrIGhlaWdodCBhZHZhbnRhZ2UgYW5kIGhlYWQgc2FmZXR5CiAgICBsb2NhbCBoZWlnaHRBZHZhbnRhZ2UgPSBmYWxzZQogICAgbG9jYWwgc2FmZXR5QWxlcnQgPSBmYWxzZQogICAgbG9jYWwgZW5lbWllcyA9IGVudGl0eS5nZXRfcGxheWVycyh0cnVlKQoJZm9yIGk9MSwgI2VuZW1pZXMgZG8KICAgICAgICBpZiBlbnRpdHkuaXNfZG9ybWFudChlbmVtaWVzW2ldKSB0aGVuIGhlaWdodEFsZXJ0ID0gZmFsc2Ugc2lkZXdheXNBbGVydCA9IGZhbHNlIHJldHVybiBlbmQKCQlsb2NhbCBwbGF5ZXJYLCBwbGF5ZXJZLCBwbGF5ZXJaICA9IGVudGl0eS5nZXRfcHJvcChlbmVtaWVzW2ldLCAibV92ZWNPcmlnaW4iKQoJCWxvY2FsIHBsYXllckZsYWdzID0gZW50aXR5LmdldF9wcm9wKGVuZW1pZXNbaV0sICJtX2ZGbGFncyIpCgkJbG9jYWwgcGxheWVyT25Hcm91bmQgPSBiaXQuYmFuZChwbGF5ZXJGbGFncywgMSkgfj0gMAoJCWxvY2FsIGxlbmd0aERpc3RhbmNlID0gbWF0aC5zcXJ0KChwbGF5ZXJYIC0gb3JpZ2luLngpXjIgKyAocGxheWVyWSAtIG9yaWdpbi55KV4yICsgKHBsYXllclogLSBvcmlnaW4ueileMikKCQlpZiAoKHBsYXllclogKyAxMDAgPCBvcmlnaW4ueikgYW5kIGxlbmd0aERpc3RhbmNlIDw9IDMwMCkgdGhlbgoJCQloZWlnaHRBZHZhbnRhZ2UgPSB0cnVlCgkJZWxzZQoJCQloZWlnaHRBZHZhbnRhZ2UgPSBmYWxzZQoJCWVuZAoKICAgICAgICBpZiAoKGJvZHlZYXcgPj0gNDAgb3IgYm9keVlhdyA8PSAtNDApIGFuZCBmdW5jLmhlYWRWaXNpYmxlKGVuZW1pZXNbaV0pKSB0aGVuCgkJCXNhZmV0eUFsZXJ0ID0gdHJ1ZQoJCWVsc2UKCQkJc2FmZXR5QWxlcnQgPSBmYWxzZQoJCWVuZAoJZW5kCgogICAgaWYgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0uZW5hYmxlU3RhdGUpIHRoZW4KCiAgICAgICAgaWYgZnVuYy5pbmNsdWRlcyh1aS5nZXQoYWFCdWlsZGVyW3ZhcnMucFN0YXRlXS5kZWZlbnNpdmVPcHQpLCAiQWx3YXlzIG9uIikgdGhlbgogICAgICAgICAgICBjbWQuZm9yY2VfZGVmZW5zaXZlID0gdHJ1ZQogICAgICAgIGVuZAoKICAgICAgICBpZiBmdW5jLmluY2x1ZGVzKHVpLmdldChhYUJ1aWxkZXJbdmFycy5wU3RhdGVdLmRlZmVuc2l2ZU9wdCksICJFbHVzaXZlIG1vZGUiKSB0aGVuCiAgICAgICAgICAgIHVpLnNldChyZWZzLmR0WzNdLCAiRGVmZW5zaXZlIikKCiAgICAgICAgICAgIGlmIHRpY2tjb3VudCAlIDMgPT0gMSB0aGVuCiAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy5kdFszXSwgIk9mZmVuc2l2ZSIpCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBjbWQuZm9yY2VfZGVmZW5zaXZlID0gdGlja2NvdW50ICUgMyB+PSAxCiAgICAgICAgZW5kCiAgICAgICAgCgogICAgICAgIGlmIGFhLmlnbm9yZSB0aGVuIHJldHVybiBlbmQKCiAgICAgICAgaWYgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0uZGVmZW5zaXZlUGl0Y2gpID09ICJDdXN0b20iIGFuZCBpc0RlZmVuc2l2ZSB0aGVuCiAgICAgICAgICAgIHVpLnNldChyZWZzLnBpdGNoWzFdLCAiQ3VzdG9tIikKICAgICAgICAgICAgdWkuc2V0KHJlZnMucGl0Y2hbMl0sIHVpLmdldChhYUJ1aWxkZXJbdmFycy5wU3RhdGVdLmRlZmVuc2l2ZVBpdGNoU2xpZGVyKSkKICAgICAgICBlbHNlCiAgICAgICAgICAgIHVpLnNldChyZWZzLnBpdGNoWzFdLCB1aS5nZXQoYWFCdWlsZGVyW3ZhcnMucFN0YXRlXS5waXRjaCkpCiAgICAgICAgICAgIHVpLnNldChyZWZzLnBpdGNoWzJdLCB1aS5nZXQoYWFCdWlsZGVyW3ZhcnMucFN0YXRlXS5waXRjaFNsaWRlcikpCiAgICAgICAgZW5kICAgICAgICAgICAgICAgIAoKICAgICAgICB1aS5zZXQocmVmcy55YXdCYXNlLCB1aS5nZXQoYWFCdWlsZGVyW3ZhcnMucFN0YXRlXS55YXdCYXNlKSkKCiAgICAgICAgdWkuc2V0KHJlZnMueWF3WzFdLCB1aS5nZXQoYWFCdWlsZGVyW3ZhcnMucFN0YXRlXS55YXcpKQoKICAgICAgICBpZiB1aS5nZXQoYWFCdWlsZGVyW3ZhcnMucFN0YXRlXS5kZWZlbnNpdmVZYXcpID09ICJSYW5kb20iIGFuZCBpc0RlZmVuc2l2ZSB0aGVuCiAgICAgICAgICAgIGxvY2FsIHJhbmRvbXlhdyA9IGNsaWVudC5yYW5kb21faW50KDYxLCAxODApCiAgICAgICAgICAgIHVpLnNldChyZWZzLnlhd1syXSwgZnVuYy5hYV9jbGFtcCgodGlja2NvdW50ICUgNiA8IDMgYW5kIHJhbmRvbXlhdyBvciAtcmFuZG9teWF3KSkpCiAgICAgICAgZWxzZWlmIHVpLmdldChhYUJ1aWxkZXJbdmFycy5wU3RhdGVdLmRlZmVuc2l2ZVlhdykgPT0gIkppdHRlciIgYW5kIGlzRGVmZW5zaXZlIHRoZW4KICAgICAgICAgICAgdWkuc2V0KHJlZnMueWF3WzJdLCB0aWNrY291bnQgJSAzID09IDAgYW5kIGNsaWVudC5yYW5kb21faW50KDkwLCAtOTApIG9yIHRpY2tjb3VudCAlIDMgPT0gMSBhbmQgMTgwIG9yIHRpY2tjb3VudCAlIDMgPT0gMiBhbmQgY2xpZW50LnJhbmRvbV9pbnQoLTkwLCA5MCkgb3IgMCkKICAgICAgICBlbHNlaWYgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0uZGVmZW5zaXZlWWF3KSA9PSAiQ3VzdG9tIiBhbmQgaXNEZWZlbnNpdmUgdGhlbgotLSAgICAgICAgICAgIHVpLnNldChyZWZzLnlhd1syXSwgIkN1c3RvbSIpCiAgICAgICAgICAgIHVpLnNldChyZWZzLnlhd1syXSwgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0uZGVmZW5zaXZlWWF3U2xpZGVyKSkKICAgICAgICBlbHNlaWYgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0ueWF3Q29uZGl0aW9uKSA9PSAiTCAmIFIiIHRoZW4KCiAgICAgICAgICAgIHVpLnNldChyZWZzLnlhd1syXSwoc2lkZSA9PSAxIGFuZCB1aS5nZXQoYWFCdWlsZGVyW3ZhcnMucFN0YXRlXS55YXdMZWZ0KSBvciB1aS5nZXQoYWFCdWlsZGVyW3ZhcnMucFN0YXRlXS55YXdSaWdodCkpKQoKICAgICAgICBlbHNlaWYgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0ueWF3Q29uZGl0aW9uKSA9PSAiSG9sZCIgdGhlbgoKICAgICAgICAgICAgaWYgdmFycy5jaG9rZTIgPT0gMCB0aGVuCiAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy55YXdbMl0sIHVpLmdldChhYUJ1aWxkZXJbdmFycy5wU3RhdGVdLnlhd1JpZ2h0KSkKICAgICAgICAgICAgZWxzZWlmIHZhcnMuY2hva2UyID09IDEgdGhlbgogICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMueWF3WzJdLCB1aS5nZXQoYWFCdWlsZGVyW3ZhcnMucFN0YXRlXS55YXdMZWZ0KSkKICAgICAgICAgICAgZWxzZWlmIHZhcnMuY2hva2UyID09IDIgdGhlbgogICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMueWF3WzJdLCB1aS5nZXQoYWFCdWlsZGVyW3ZhcnMucFN0YXRlXS55YXdMZWZ0KSkKICAgICAgICAgICAgZWxzZWlmIHZhcnMuY2hva2UyID09IDMgdGhlbgogICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMueWF3WzJdLCB1aS5nZXQoYWFCdWlsZGVyW3ZhcnMucFN0YXRlXS55YXdMZWZ0KSkKICAgICAgICAgICAgZWxzZWlmIHZhcnMuY2hva2UyID09IDQgdGhlbgogICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMueWF3WzJdLCB1aS5nZXQoYWFCdWlsZGVyW3ZhcnMucFN0YXRlXS55YXdSaWdodCkpCiAgICAgICAgICAgIGVsc2VpZiB2YXJzLmNob2tlMiA9PSA1IHRoZW4KICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnlhd1syXSwgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0ueWF3TGVmdCkpCiAgICAgICAgICAgIGVsc2VpZiB2YXJzLmNob2tlMiA9PSA2IHRoZW4KICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnlhd1syXSwgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0ueWF3UmlnaHQpKQogICAgICAgICAgICBlbHNlaWYgdmFycy5jaG9rZTIgPT0gNyB0aGVuCiAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy55YXdbMl0sIHVpLmdldChhYUJ1aWxkZXJbdmFycy5wU3RhdGVdLnlhd1JpZ2h0KSkKICAgICAgICAgICAgZW5kCgogICAgICAgIGVsc2VpZiB1aS5nZXQoYWFCdWlsZGVyW3ZhcnMucFN0YXRlXS55YXdDb25kaXRpb24pID09ICJTbG93IiB0aGVuCiAgICAgICAgICAgIHVpLnNldChyZWZzLnlhd1syXSwgdmFycy5zd2l0Y2ggYW5kIHVpLmdldChhYUJ1aWxkZXJbdmFycy5wU3RhdGVdLnlhd0xlZnQpIG9yIHVpLmdldChhYUJ1aWxkZXJbdmFycy5wU3RhdGVdLnlhd1JpZ2h0KSkKICAgICAgICAgICAgc2lkZV95YXcgPSAwCiAgICAgICAgZWxzZQogICAgICAgICAgICB1aS5zZXQocmVmcy55YXdbMl0sIHVpLmdldChhYUJ1aWxkZXJbdmFycy5wU3RhdGVdLnlhd1N0YXRpYykpCiAgICAgICAgICAgIHNpZGVfeWF3ID0gMgogICAgICAgIGVuZAoKICAgICAgICBsb2NhbCBzd2l0Y2ggPSBmYWxzZQogICAgICAgIGlmICgoZnVuYy5pbmNsdWRlcyh1aS5nZXQoYWFCdWlsZGVyW3ZhcnMucFN0YXRlXS55YXdKaXR0ZXJEaXNhYmxlcnMpLCAiSGVpZ2h0IGFkdmFudGFnZSIgKSBhbmQgaGVpZ2h0QWR2YW50YWdlKSBvciAoZnVuYy5pbmNsdWRlcyh1aS5nZXQoYWFCdWlsZGVyW3ZhcnMucFN0YXRlXS55YXdKaXR0ZXJEaXNhYmxlcnMpLCAiSGVhZCBzYWZldHkiKSBhbmQgc2FmZXR5QWxlcnQpKSB0aGVuCiAgICAgICAgICAgIHVpLnNldChyZWZzLnlhd0ppdHRlclsxXSwgIk9mZiIpIAogICAgICAgIGVsc2VpZiB1aS5nZXQoYWFCdWlsZGVyW3ZhcnMucFN0YXRlXS55YXdKaXR0ZXIpID09ICIzLVdheSIgdGhlbgogICAgICAgICAgICB1aS5zZXQocmVmcy55YXdKaXR0ZXJbMV0sICJDZW50ZXIiKQogICAgICAgIGVsc2UKICAgICAgICAgICAgdWkuc2V0KHJlZnMueWF3Sml0dGVyWzFdLCB1aS5nZXQoYWFCdWlsZGVyW3ZhcnMucFN0YXRlXS55YXdKaXR0ZXIpKQogICAgICAgIGVuZAogICAgICAgIGlmIHVpLmdldChhYUJ1aWxkZXJbdmFycy5wU3RhdGVdLnlhd0ppdHRlckNvbmRpdGlvbikgPT0gIkwgJiBSIiB0aGVuCiAgICAgICAgICAgIGlmIHVpLmdldChhYUJ1aWxkZXJbdmFycy5wU3RhdGVdLnlhd0ppdHRlcikgPT0gIjMtV2F5IiB0aGVuCiAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy55YXdKaXR0ZXJbMl0sIChzaWRlID09IDEgYW5kIHVpLmdldChhYUJ1aWxkZXJbdmFycy5wU3RhdGVdLnlhd0ppdHRlckxlZnQpKm1hdGgucmFuZG9tKC0xLCAxKSAgb3IgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0ueWF3Sml0dGVyUmlnaHQpKm1hdGgucmFuZG9tKC0xLCAxKSApKQogICAgICAgICAgICBlbHNlaWYgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0ueWF3Sml0dGVyKSA9PSAiU2xvdyBKaXR0ZXIiIHRoZW4KICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnlhd1syXSwgc3dpdGNoIGFuZCB1aS5nZXQoYWFCdWlsZGVyW3ZhcnMucFN0YXRlXS55YXdKaXR0ZXJSaWdodCkgb3IgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0ueWF3Sml0dGVyTGVmdCkpCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnlhd0ppdHRlclsyXSwgKHNpZGUgPT0gMSBhbmQgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0ueWF3Sml0dGVyTGVmdCkgb3IgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0ueWF3Sml0dGVyUmlnaHQpKSkKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIAogICAgICAgIGVsc2UKICAgICAgICAgICAgaWYgIHVpLmdldChhYUJ1aWxkZXJbdmFycy5wU3RhdGVdLnlhd0ppdHRlcikgPT0gIjMtV2F5IiB0aGVuCiAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy55YXdKaXR0ZXJbMl0sIHVpLmdldChhYUJ1aWxkZXJbdmFycy5wU3RhdGVdLnlhd0ppdHRlclN0YXRpYykqbWF0aC5yYW5kb20oLTEsIDEpICkKICAgICAgICAgICAgZWxzZWlmIHVpLmdldChhYUJ1aWxkZXJbdmFycy5wU3RhdGVdLnlhd0ppdHRlcikgPT0gIlNsb3cgSml0dGVyIiB0aGVuCiAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy55YXdbMl0sIHN3aXRjaCBhbmQgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0ueWF3Sml0dGVyU3RhdGljKSBvciAtdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0ueWF3Sml0dGVyU3RhdGljKSkKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMueWF3Sml0dGVyWzJdLCB1aS5nZXQoYWFCdWlsZGVyW3ZhcnMucFN0YXRlXS55YXdKaXR0ZXJTdGF0aWMpICkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCgogICAgICAgIGlmIHVpLmdldChhYUJ1aWxkZXJbdmFycy5wU3RhdGVdLnlhd0NvbmRpdGlvbikgPT0gIlNsb3ciIHRoZW4KICAgICAgICAgICAgdWkuc2V0KHJlZnMuYm9keVlhd1sxXSwgIlN0YXRpYyIpCiAgICAgICAgICAgIHVpLnNldChyZWZzLmJvZHlZYXdbMl0sIDApCiAgICAgICAgZWxzZWlmIHVpLmdldChhYUJ1aWxkZXJbdmFycy5wU3RhdGVdLnlhd0NvbmRpdGlvbikgPT0gIkhvbGQiIHRoZW4KICAgICAgICAgICAgdWkuc2V0KHJlZnMuYm9keVlhd1sxXSwgIlN0YXRpYyIpCiAgICAgICAgICAgIHVpLnNldChyZWZzLmJvZHlZYXdbMl0sIDApCiAgICAgICAgZWxzZQogICAgICAgICAgICB1aS5zZXQocmVmcy5ib2R5WWF3WzFdLCB1aS5nZXQoYWFCdWlsZGVyW3ZhcnMucFN0YXRlXS5ib2R5WWF3KSkKICAgICAgICAgICAgdWkuc2V0KHJlZnMuYm9keVlhd1syXSwgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0uYm9keVlhd1NsaWRlcikpCiAgICAgICAgZW5kCgogICAgICAgIGlmIHJldmVyc2VkIGFuZCB1aS5nZXQoYWFCdWlsZGVyW3ZhcnMucFN0YXRlXS5hbnRpQnJ1dGVTZXQpIHRoZW4KICAgICAgICAgICAgdWkuc2V0KHJlZnMueWF3WzJdLCBhbmdsZSkKICAgICAgICBlbmQKCiAgICAgICAgdWkuc2V0KHJlZnMuZnNCb2R5WWF3LCBmYWxzZSkKICAgIGVsc2VpZiBub3QgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0uZW5hYmxlU3RhdGUpIHRoZW4KICAgICAgICB1aS5zZXQocmVmcy5waXRjaFsxXSwgIk9mZiIpCiAgICAgICAgdWkuc2V0KHJlZnMueWF3QmFzZSwgIkxvY2FsIHZpZXciKQogICAgICAgIHVpLnNldChyZWZzLnlhd1sxXSwgIk9mZiIpCiAgICAgICAgdWkuc2V0KHJlZnMueWF3WzJdLCAwKQogICAgICAgIHVpLnNldChyZWZzLnlhd0ppdHRlclsxXSwgIk9mZiIpCiAgICAgICAgdWkuc2V0KHJlZnMueWF3Sml0dGVyWzJdLCAwKQogICAgICAgIHVpLnNldChyZWZzLmJvZHlZYXdbMV0sICJPZmYiKQogICAgICAgIHVpLnNldChyZWZzLmJvZHlZYXdbMl0sIDApCiAgICAgICAgdWkuc2V0KHJlZnMuZnNCb2R5WWF3LCBmYWxzZSkKICAgICAgICB1aS5zZXQocmVmcy5lZGdlWWF3LCBmYWxzZSkKICAgICAgICB1aS5zZXQocmVmcy5yb2xsLCAwKQogICAgZW5kCgogICAgLS1zYWZlIHNhZmUKICAgIGlmIGZ1bmMuaW5jbHVkZXModWkuZ2V0KG1lbnUuYnVpbGRlclRhYi5Ud2Vha3NNdWx0aXNlbGVjdCksICJTYWZlIGhlYWQgb24ga25pZmUiKSB0aGVuCiAgICAgICAgaWYgZW50aXR5LmdldF9jbGFzc25hbWUoZW50aXR5LmdldF9wbGF5ZXJfd2VhcG9uKGVudGl0eS5nZXRfbG9jYWxfcGxheWVyKCkpKSA9PSAiQ0tuaWZlIiBhbmQgdmFycy5wU3RhdGUgPT0gNyB0aGVuCiAgICAgICAgICAgIHVpLnNldChyZWZzLnBpdGNoWzFdLCAiRGVmYXVsdCIpCiAgICAgICAgICAgIHVpLnNldChyZWZzLnlhd0Jhc2UsICJBdCB0YXJnZXRzIikKICAgICAgICAgICAgdWkuc2V0KHJlZnMueWF3WzFdLCAiMTgwIikKICAgICAgICAgICAgdWkuc2V0KHJlZnMueWF3WzJdLCAwKQogICAgICAgICAgICB1aS5zZXQocmVmcy55YXdKaXR0ZXJbMV0sICJPZmYiKQogICAgICAgICAgICB1aS5zZXQocmVmcy55YXdKaXR0ZXJbMl0sIDApCiAgICAgICAgICAgIHVpLnNldChyZWZzLmJvZHlZYXdbMV0sICJTdGF0aWMiKQogICAgICAgICAgICB1aS5zZXQocmVmcy5ib2R5WWF3WzJdLCAwKQogICAgICAgICAgICB1aS5zZXQocmVmcy5mc0JvZHlZYXcsIGZhbHNlKQogICAgICAgICAgICB1aS5zZXQocmVmcy5lZGdlWWF3LCBmYWxzZSkKICAgICAgICAgICAgdWkuc2V0KHJlZnMucm9sbCwgMCkKICAgICAgICBlbmQKICAgIGVuZAoKICAgIC0tIGZpeCBoaWRlc2hvdHMKCWlmIGZ1bmMuaW5jbHVkZXModWkuZ2V0KG1lbnUuYnVpbGRlclRhYi5Ud2Vha3NNdWx0aXNlbGVjdCksICJBZGp1c3QgZmFrZWxhZyBsaW1pdCIpIHRoZW4KCQlpZiBpc09zIGFuZCBub3QgaXNEdCBhbmQgbm90IGlzRmQgdGhlbgogICAgICAgICAgICBpZiBub3QgaHNTYXZlZCB0aGVuCiAgICAgICAgICAgICAgICBoc1ZhbHVlID0gdWkuZ2V0KHJlZnMuZmFrZUxhZ1sxXSkKICAgICAgICAgICAgICAgIGhzU2F2ZWQgPSB0cnVlCiAgICAgICAgICAgIGVuZAoJCQl1aS5zZXQocmVmcy5mYWtlTGFnWzFdLCAxKQoJCWVsc2VpZiBoc1NhdmVkIHRoZW4KCQkJdWkuc2V0KHJlZnMuZmFrZUxhZ1sxXSwgaHNWYWx1ZSkKICAgICAgICAgICAgaHNTYXZlZCA9IGZhbHNlCgkJZW5kCgllbmQKCiAgICBkaXN0YW5jZV9rbmlmZSA9IHt9CiAgICBkaXN0YW5jZV9rbmlmZS5hbnRpX2tuaWZlX2Rpc3QgPSBmdW5jdGlvbiAoeDEsIHkxLCB6MSwgeDIsIHkyLCB6MikKICAgICAgICByZXR1cm4gbWF0aC5zcXJ0KCh4MiAtIHgxKV4yICsgKHkyIC0geTEpXjIgKyAoejIgLSB6MSleMikKICAgIGVuZAoKCiAgICAtLSBBdm9pZCBiYWNrc3RhYgogICAgaWYgdWkuZ2V0KG1lbnUuYnVpbGRlclRhYi5hdm9pZEJhY2tzdGFiKSB+PSAwIGFuZCBmdW5jLmluY2x1ZGVzKHVpLmdldChtZW51LmJ1aWxkZXJUYWIuVHdlYWtzTXVsdGlzZWxlY3QpLCAiQXZvaWQgQmFja3N0YWIiKSB0aGVuCiAgICAgICAgbG9jYWwgcGxheWVycyA9IGVudGl0eS5nZXRfcGxheWVycyh0cnVlKQogICAgICAgIGxvY2FsIGx4LCBseSwgbHogPSBlbnRpdHkuZ2V0X3Byb3AoZW50aXR5LmdldF9sb2NhbF9wbGF5ZXIoKSwgIm1fdmVjT3JpZ2luIikKICAgICAgICBpZiBwbGF5ZXJzID09IG5pbCB0aGVuIHJldHVybiBlbmQKICAgICAgICBmb3IgaT0xLCAjcGxheWVycyBkbwogICAgICAgICAgICBsb2NhbCB4LCB5LCB6ID0gZW50aXR5LmdldF9wcm9wKHBsYXllcnNbaV0sICJtX3ZlY09yaWdpbiIpCiAgICAgICAgICAgIGxvY2FsIGRpc3RhbmNlID0gZGlzdGFuY2Vfa25pZmUuYW50aV9rbmlmZV9kaXN0KGx4LCBseSwgbHosIHgsIHksIHopCiAgICAgICAgICAgIGxvY2FsIHdlYXBvbiA9IGVudGl0eS5nZXRfcGxheWVyX3dlYXBvbihwbGF5ZXJzW2ldKQogICAgICAgICAgICBpZiBlbnRpdHkuZ2V0X2NsYXNzbmFtZSh3ZWFwb24pID09ICJDS25pZmUiIGFuZCBkaXN0YW5jZSA8PSB1aS5nZXQobWVudS5idWlsZGVyVGFiLmF2b2lkQmFja3N0YWIpIHRoZW4KICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnlhd1syXSwgMTgwKQogICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMueWF3QmFzZSwgIkF0IHRhcmdldHMiKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAogICAgCiAgICAtLSBkdCBkaXNjaGFyZ2UKICAgIGlmIGZ1bmMuaW5jbHVkZXModWkuZ2V0KG1lbnUuYnVpbGRlclRhYi5Ud2Vha3NNdWx0aXNlbGVjdCksICJEaXNjaGFyZ2UgRXhwbG9pdCIpIHRoZW4KICAgICAgICBpZiBkdEVuYWJsZWQgPT0gbmlsIHRoZW4KICAgICAgICAgICAgZHRFbmFibGVkID0gdHJ1ZQogICAgICAgIGVuZAogICAgICAgIGxvY2FsIGVuZW1pZXMgPSBlbnRpdHkuZ2V0X3BsYXllcnModHJ1ZSkKICAgICAgICBsb2NhbCB2aXMgPSBmYWxzZQogICAgICAgIGxvY2FsIGhlYWx0aCA9IGVudGl0eS5nZXRfcHJvcCh2YXJzLmxvY2FsUGxheWVyLCAibV9pSGVhbHRoIikKICAgICAgICBmb3IgaT0xLCAjZW5lbWllcyBkbwogICAgICAgICAgICBsb2NhbCBlbnRpbmRleCA9IGVuZW1pZXNbaV0KICAgICAgICAgICAgbG9jYWwgYm9keV94LGJvZHlfeSxib2R5X3ogPSBlbnRpdHkuaGl0Ym94X3Bvc2l0aW9uKGVudGluZGV4LCAxKQogICAgICAgICAgICBpZiBjbGllbnQudmlzaWJsZShib2R5X3gsIGJvZHlfeSwgYm9keV96ICsgMjApIHRoZW4KICAgICAgICAgICAgICAgIHZpcyA9IHRydWUKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCQoKICAgICAgICBpZiB2aXMgdGhlbgogICAgICAgICAgICB1aS5zZXQocmVmcy5kdFsxXSxmYWxzZSkKICAgICAgICAgICAgY2xpZW50LmRlbGF5X2NhbGwoMC4wMSwgZnVuY3Rpb24oKSAKICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLmR0WzFdLHRydWUpCiAgICAgICAgICAgIGVuZCkKICAgICAgICBlbmQKICAgIGVsc2UKICAgICAgICBpZiBkdEVuYWJsZWQgPT0gdHJ1ZSB0aGVuCiAgICAgICAgICAgIHVpLnNldChyZWZzLmR0WzFdLCBkdEVuYWJsZWQpCiAgICAgICAgICAgIGR0RW5hYmxlZCA9IGZhbHNlCiAgICAgICAgZW5kCiAgICBlbmQKICAgIAogICAgLS0gZmFzdCBsYWRkZXIKICAgIGlmIGZ1bmMuaW5jbHVkZXModWkuZ2V0KG1lbnUudmlzdWFsc1RhYi5NaXNjTXVsdGlzZWxlY3QpLCAiRmFzdCBsYWRkZXIiKSB0aGVuCiAgICAgICAgbG9jYWwgcGl0Y2gsIHlhdyA9IGNsaWVudC5jYW1lcmFfYW5nbGVzKCkKICAgICAgICBpZiBlbnRpdHkuZ2V0X3Byb3AodmFycy5sb2NhbFBsYXllciwgIm1fTW92ZVR5cGUiKSA9PSA5IHRoZW4KICAgICAgICAgICAgY21kLnlhdyA9IG1hdGguZmxvb3IoY21kLnlhdyswLjUpCiAgICAgICAgICAgIGNtZC5yb2xsID0gMAogICAgCiAgICAgICAgICAgIGlmIGZ1bmMuaW5jbHVkZXModWkuZ2V0KG1lbnUudmlzdWFsc1RhYi5mYXN0TGFkZGVyKSwgIkFzY2VuZGluZyIpIHRoZW4KICAgICAgICAgICAgICAgIGlmIGNtZC5mb3J3YXJkbW92ZSA+IDAgdGhlbgogICAgICAgICAgICAgICAgICAgIGlmIHBpdGNoIDwgNDUgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBjbWQucGl0Y2ggPSA4OQogICAgICAgICAgICAgICAgICAgICAgICBjbWQuaW5fbW92ZXJpZ2h0ID0gMQogICAgICAgICAgICAgICAgICAgICAgICBjbWQuaW5fbW92ZWxlZnQgPSAwCiAgICAgICAgICAgICAgICAgICAgICAgIGNtZC5pbl9mb3J3YXJkID0gMAogICAgICAgICAgICAgICAgICAgICAgICBjbWQuaW5fYmFjayA9IDEKICAgICAgICAgICAgICAgICAgICAgICAgaWYgY21kLnNpZGVtb3ZlID09IDAgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY21kLnlhdyA9IGNtZC55YXcgKyA5MAogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgaWYgY21kLnNpZGVtb3ZlIDwgMCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbWQueWF3ID0gY21kLnlhdyArIDE1MAogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgaWYgY21kLnNpZGVtb3ZlID4gMCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbWQueWF3ID0gY21kLnlhdyArIDMwCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVuZCAKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICAgICAgaWYgZnVuYy5pbmNsdWRlcyh1aS5nZXQobWVudS52aXN1YWxzVGFiLmZhc3RMYWRkZXIpLCAiRGVzY2VuZGluZyIpIHRoZW4KICAgICAgICAgICAgICAgIGlmIGNtZC5mb3J3YXJkbW92ZSA8IDAgdGhlbgogICAgICAgICAgICAgICAgICAgIGNtZC5waXRjaCA9IDg5CiAgICAgICAgICAgICAgICAgICAgY21kLmluX21vdmVsZWZ0ID0gMQogICAgICAgICAgICAgICAgICAgIGNtZC5pbl9tb3ZlcmlnaHQgPSAwCiAgICAgICAgICAgICAgICAgICAgY21kLmluX2ZvcndhcmQgPSAxCiAgICAgICAgICAgICAgICAgICAgY21kLmluX2JhY2sgPSAwCiAgICAgICAgICAgICAgICAgICAgaWYgY21kLnNpZGVtb3ZlID09IDAgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBjbWQueWF3ID0gY21kLnlhdyArIDkwCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgaWYgY21kLnNpZGVtb3ZlID4gMCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGNtZC55YXcgPSBjbWQueWF3ICsgMTUwCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgaWYgY21kLnNpZGVtb3ZlIDwgMCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGNtZC55YXcgPSBjbWQueWF3ICsgMzAKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAoKICAgIC0tIGVkZ2V5YXcKICAgIGlmIGZ1bmMuaW5jbHVkZXModWkuZ2V0KG1lbnUuYnVpbGRlclRhYi5Ud2Vha3NNdWx0aXNlbGVjdCksICJFZGdlIFlhdyIpIHRoZW4KICAgICAgICB1aS5zZXQocmVmcy5lZGdlWWF3LCB1aS5nZXQobWVudS5idWlsZGVyVGFiLmVkZ2VZYXdIb3RrZXkpKQogICAgZW5kCgogICAgdWkuc2V0X2NhbGxiYWNrKG1lbnUuYnVpbGRlclRhYi5Ud2Vha3NNdWx0aXNlbGVjdCwgZnVuY3Rpb24oKQogICAgICAgIGlmIGZ1bmMuaW5jbHVkZXModWkuZ2V0KG1lbnUudmlzdWFsc1RhYi5NaXNjTXVsdGlzZWxlY3QpLCAiQ29uc29sZSBmaWx0ZXIiKSB0aGVuCiAgICAgICAgICAgIGN2YXIuY29uX2ZpbHRlcl90ZXh0OnNldF9zdHJpbmcoImNvb2wgdGV4dCIpCiAgICAgICAgICAgIGN2YXIuY29uX2ZpbHRlcl9lbmFibGU6c2V0X2ludCgxKQogICAgICAgIGVsc2UKICAgICAgICAgICAgY3Zhci5jb25fZmlsdGVyX2VuYWJsZTpzZXRfaW50KDApCiAgICAgICAgZW5kCiAgICBlbmQpCmVuZCkKCmNsaWVudC5zZXRfZXZlbnRfY2FsbGJhY2soInNldHVwX2NvbW1hbmQiLCBmdW5jdGlvbihlKQogICAgaWYgbm90IHZhcnMubG9jYWxQbGF5ZXIgb3Igbm90IGVudGl0eS5pc19hbGl2ZSh2YXJzLmxvY2FsUGxheWVyKSBvciBub3QgdWkuZ2V0KG1hc3RlclN3aXRjaCkgdGhlbiByZXR1cm4gZW5kCglsb2NhbCBmbGFncyA9IGVudGl0eS5nZXRfcHJvcCh2YXJzLmxvY2FsUGxheWVyLCAibV9mRmxhZ3MiKQogICAgbG9jYWwgb25ncm91bmQgPSBiaXQuYmFuZChmbGFncywgMSkgfj0gMCBhbmQgZS5pbl9qdW1wID09IDAKICAgIGxvY2FsIGlzU2xvdyA9IHVpLmdldChyZWZzLnNsb3dbMV0pIGFuZCB1aS5nZXQocmVmcy5zbG93WzJdKQoKICAgIGxvY2FsIGFpciA9IGZ1bmMuaW5jbHVkZXModWkuZ2V0KG1lbnUuYnVpbGRlclRhYi5mcmVlc3RhbmREaXNhYmxlcnMpLCAiQWlyIikgYW5kIG5vdCBvbmdyb3VuZAogICAgbG9jYWwgZHVjayA9IGZ1bmMuaW5jbHVkZXModWkuZ2V0KG1lbnUuYnVpbGRlclRhYi5mcmVlc3RhbmREaXNhYmxlcnMpLCAiRHVjayIpIGFuZCBlbnRpdHkuZ2V0X3Byb3AodmFycy5sb2NhbFBsYXllciwgIm1fZmxEdWNrQW1vdW50IikgPiAwLjEKICAgIGxvY2FsIHNsb3cgPSBmdW5jLmluY2x1ZGVzKHVpLmdldChtZW51LmJ1aWxkZXJUYWIuZnJlZXN0YW5kRGlzYWJsZXJzKSwgIlNsb3dtbyIpIGFuZCBpc1Nsb3cKICAgIGxvY2FsIG1hbnVsID0gZnVuYy5pbmNsdWRlcyh1aS5nZXQobWVudS5idWlsZGVyVGFiLmZyZWVzdGFuZERpc2FibGVycyksICJNYW51YWwiKSBhbmQgKGFhLm1hbnVhbEFBID09IDIgb3IgYWEubWFudWFsQUEgPT0gMSkgYW5kIGFhLmlnbm9yZQogICAgbG9jYWwgZnNfZGlzYWJsZXIgPSBhaXIgb3IgZHVjayBvciBzbG93IG9yIG1hbnVsCgogICAgaWYgdWkuZ2V0KG1lbnUuYnVpbGRlclRhYi5mcmVlc3RhbmRIb3RrZXkpIGFuZCBmdW5jLmluY2x1ZGVzKHVpLmdldChtZW51LmJ1aWxkZXJUYWIuVHdlYWtzTXVsdGlzZWxlY3QpLCAiRnJlZXN0YW5kIikgYW5kIG5vdCBmc19kaXNhYmxlciB0aGVuCiAgICAgICAgdmFycy5mcyA9IHRydWUKICAgICAgICB1aS5zZXQocmVmcy5mcmVlU3RhbmRbMl0sICJBbHdheXMgb24iKQogICAgICAgIHVpLnNldChyZWZzLmZyZWVTdGFuZFsxXSwgdHJ1ZSkKICAgIGVsc2UKICAgICAgICB2YXJzLmZzID0gZmFsc2UKICAgICAgICB1aS5zZXQocmVmcy5mcmVlU3RhbmRbMV0sIGZhbHNlKQogICAgICAgIHVpLnNldChyZWZzLmZyZWVTdGFuZFsyXSwgIk9uIGhvdGtleSIpCiAgICBlbmQgICAgCmVuZCkKCmxvY2FsIGZ1bmN0aW9uIGNvbW1hbmQyKGUpCiAgICBpZiBmdW5jLmluY2x1ZGVzKHVpLmdldChtZW51LmJ1aWxkZXJUYWIuVHdlYWtzTXVsdGlzZWxlY3QpLCAiRml4IEUgQm9tYnNpdGUiKSB0aGVuCiAgICAgICAgaWYgZS5pbl91c2UgPT0gMCB0aGVuCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGVuZAoKICAgICAgICBsb2NhbCBtZSA9IGVudGl0eS5nZXRfbG9jYWxfcGxheWVyKCkKCiAgICAgICAgaWYgbWUgPT0gbmlsIHRoZW4KICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZW5kCgogICAgICAgIGxvY2FsIG1fYkluQm9tYlpvbmUgPSBlbnRpdHkuZ2V0X3Byb3AobWUsICJtX2JJbkJvbWJab25lIikKCiAgICAgICAgaWYgbV9iSW5Cb21iWm9uZSA9PSAxIHRoZW4KICAgICAgICAgICAgZS5pbl91c2UgPSAwCiAgICAgICAgZW5kCiAgICBlbmQKZW5kCgpjbGllbnQuc2V0X2V2ZW50X2NhbGxiYWNrKCJzZXR1cF9jb21tYW5kIiwgY29tbWFuZDIpCmxvY2FsIGZ1bmN0aW9uIGNsYW50YWdfc2V0KCkKICAgIGxvY2FsIGx1YV9uYW1lID0gIiNibHVoZ2FuZy5MVUEiCiAgICBpZiBmdW5jLmluY2x1ZGVzKHVpLmdldChtZW51LnZpc3VhbHNUYWIuTWlzY011bHRpc2VsZWN0KSwgIkNsYW50YWciKSB0aGVuCiAgICAgICAgaWYgdWkuZ2V0KHVpLnJlZmVyZW5jZSgiTWlzYyIsICJNaXNjZWxsYW5lb3VzIiwgIkNsYW4gdGFnIHNwYW1tZXIiKSkgdGhlbiByZXR1cm4gZW5kCgoJCWxvY2FsIGNsYW5fdGFnID0gY2xhbnRhZ19hbmltKGx1YV9uYW1lLCB7MCwgMSwgMiwgMywgNCwgNSwgNiwgNywgOCwgOSwgMTAsIDExLCAxMSwgMTEsIDExLCAxMiwgMTMsIDE0LCAxNSwgMTYsIDE3LCAxOCwgMTksIDIwLCAyMSwgMjIsIDIzLCAyNCwgMjV9KQoKICAgICAgICBpZiBlbnRpdHkuZ2V0X3Byb3AoZW50aXR5LmdldF9nYW1lX3J1bGVzKCksICJtX2dhbWVQaGFzZSIpID09IDUgdGhlbgogICAgICAgICAgICBjbGFuX3RhZyA9IGNsYW50YWdfYW5pbSgnI2JsdWhnYW5nLkxVQScsIHsxM30pCiAgICAgICAgICAgIGNsaWVudC5zZXRfY2xhbl90YWcoY2xhbl90YWcpCiAgICAgICAgZWxzZWlmIGVudGl0eS5nZXRfcHJvcChlbnRpdHkuZ2V0X2dhbWVfcnVsZXMoKSwgIm1fdGltZVVudGlsTmV4dFBoYXNlU3RhcnRzIikgfj0gMCB0aGVuCiAgICAgICAgICAgIGNsYW5fdGFnID0gY2xhbnRhZ19hbmltKCcjYmx1aGdhbmcuTFVBJywgezEzfSkKICAgICAgICAgICAgY2xpZW50LnNldF9jbGFuX3RhZyhjbGFuX3RhZykKICAgICAgICBlbHNlaWYgY2xhbl90YWcgfj0gY2xhbnRhZy5wcmV2X2N0ICB0aGVuCiAgICAgICAgICAgIGNsaWVudC5zZXRfY2xhbl90YWcoY2xhbl90YWcpCiAgICAgICAgZW5kCgogICAgICAgIGNsYW50YWcucHJldl9jdCA9IGNsYW5fdGFnCiAgICAgICAgY2xhbnRhZy5lbmIgPSB0cnVlCiAgICBlbHNlaWYgY2xhbnRhZy5lbmIgPT0gdHJ1ZSB0aGVuCiAgICAgICAgY2xpZW50LnNldF9jbGFuX3RhZyhnZXRfb3JpZ2luYWxfY2xhbnRhZygpKQogICAgICAgIGNsYW50YWcuZW5iID0gZmFsc2UKICAgIGVuZAplbmQKCmNsYW50YWcucGFpbnQgPSBmdW5jdGlvbigpCiAgICBpZiBlbnRpdHkuZ2V0X2xvY2FsX3BsYXllcigpIH49IG5pbCB0aGVuCiAgICAgICAgaWYgZ2xvYmFscy50aWNrY291bnQoKSAlIDIgPT0gMCB0aGVuCiAgICAgICAgICAgIGNsYW50YWdfc2V0KCkKICAgICAgICBlbmQKICAgIGVuZAplbmQKCmNsYW50YWcucnVuX2NvbW1hbmQgPSBmdW5jdGlvbihlKQogICAgaWYgZW50aXR5LmdldF9sb2NhbF9wbGF5ZXIoKSB+PSBuaWwgdGhlbiAKICAgICAgICBpZiBlLmNob2tlZGNvbW1hbmRzID09IDAgdGhlbgogICAgICAgICAgICBjbGFudGFnX3NldCgpCiAgICAgICAgZW5kCiAgICBlbmQKZW5kCgpjbGFudGFnLnBsYXllcl9jb25uZWN0X2Z1bGwgPSBmdW5jdGlvbihlKQogICAgaWYgY2xpZW50LnVzZXJpZF90b19lbnRpbmRleChlLnVzZXJpZCkgPT0gZW50aXR5LmdldF9sb2NhbF9wbGF5ZXIoKSB0aGVuIAogICAgICAgIGNsYW50YWcub3JpZ19jdCA9IGdldF9vcmlnaW5hbF9jbGFudGFnKCkKICAgIGVuZAplbmQKCmNsYW50YWcuc2h1dGRvd24gPSBmdW5jdGlvbigpCiAgICBjbGllbnQuc2V0X2NsYW5fdGFnKGdldF9vcmlnaW5hbF9jbGFudGFnKCkpCmVuZAoKY2xpZW50LnNldF9ldmVudF9jYWxsYmFjaygicGFpbnQiLCBjbGFudGFnLnBhaW50KQpjbGllbnQuc2V0X2V2ZW50X2NhbGxiYWNrKCJydW5fY29tbWFuZCIsIGNsYW50YWcucnVuX2NvbW1hbmQpCmNsaWVudC5zZXRfZXZlbnRfY2FsbGJhY2soInBsYXllcl9jb25uZWN0X2Z1bGwiLCBjbGFudGFnLnBsYXllcl9jb25uZWN0X2Z1bGwpCmNsaWVudC5zZXRfZXZlbnRfY2FsbGJhY2soInNodXRkb3duIiwgY2xhbnRhZy5zaHV0ZG93bikKCnVpLnNldF9jYWxsYmFjayhtZW51LnZpc3VhbHNUYWIudHJhc2hUYWxrLCBmdW5jdGlvbigpIAogICAgaWYgZnVuYy5pbmNsdWRlcyh1aS5nZXQobWVudS52aXN1YWxzVGFiLk1pc2NNdWx0aXNlbGVjdCksICJUcmFzaHRhbGsiKSB0aGVuCiAgICAgICAgbG9jYWwgY2FsbGJhY2sgPSB1aS5nZXQobWVudS52aXN1YWxzVGFiLnRyYXNoVGFsaykgYW5kIGNsaWVudC5zZXRfZXZlbnRfY2FsbGJhY2sgb3IgY2xpZW50LnVuc2V0X2V2ZW50X2NhbGxiYWNrCiAgICAgICAgY2FsbGJhY2soJ3BsYXllcl9kZWF0aCcsIHRyYXNodGFsaykKICAgIGVuZAplbmQpCgp1aS5zZXRfY2FsbGJhY2sobWVudS52aXN1YWxzVGFiLmxvZ3MsIGZ1bmN0aW9uKCkgCiAgICBsb2NhbCBjYWxsYmFjayA9IHVpLmdldChtZW51LnZpc3VhbHNUYWIubG9ncykgYW5kIGNsaWVudC5zZXRfZXZlbnRfY2FsbGJhY2sgb3IgY2xpZW50LnVuc2V0X2V2ZW50X2NhbGxiYWNrCiAgICBjYWxsYmFjaygiYWltX21pc3MiLCBvbk1pc3MpCiAgICBjYWxsYmFjaygiYWltX2hpdCIsIG9uSGl0KQplbmQpCgpjbGllbnQuc2V0X2V2ZW50X2NhbGxiYWNrKCJwbGF5ZXJfZGVhdGgiLCBmdW5jdGlvbihlKQogICAgbG9jYWwgdiwgYSA9IGUudXNlcmlkLCBlLmF0dGFja2VyCiAgICBsb2NhbCBscF9kZWF0aCA9IGNsaWVudC51c2VyaWRfdG9fZW50aW5kZXgodikKICAgIGlmIGxwX2RlYXRoIH49IGVudGl0eS5nZXRfbG9jYWxfcGxheWVyKCkgdGhlbiByZXR1cm4gZW5kCiAgICBjbGllbnQuZGVsYXlfY2FsbCgxLCBub3RpZmljYXRpb25zLmNsZWFyKQplbmQpCgpjbGllbnQuc2V0X2V2ZW50X2NhbGxiYWNrKCJwbGF5ZXJfY29ubmVjdF9mdWxsIiwgZnVuY3Rpb24oZSkKICAgIGlmIGNsaWVudC51c2VyaWRfdG9fZW50aW5kZXgoZS51c2VyaWQpID09IGVudGl0eS5nZXRfbG9jYWxfcGxheWVyKCkgdGhlbiAKICAgICAgICBub3RpZmljYXRpb25zLmNsZWFyKCkKICAgIGVuZAplbmQpCgpsb2NhbCBsZWdzVHlwZXMgPSB7WzFdID0gIk9mZiIsIFsyXSA9ICJBbHdheXMgc2xpZGUiLCBbM10gPSAiTmV2ZXIgc2xpZGUifQpsb2NhbCBncm91bmRfdGlja3MgPSAwCmNsaWVudC5zZXRfZXZlbnRfY2FsbGJhY2soInNldHVwX2NvbW1hbmQiLCBmdW5jdGlvbihlKQogICAgbG9jYWwgaXNfb25fZ3JvdW5kID0gZS5pbl9qdW1wID09IDAKICAgIGlmIGZ1bmMuaW5jbHVkZXModWkuZ2V0KG1lbnUudmlzdWFsc1RhYi5hbmltYXRpb25zKSwgIkxlZyBmdWNrZXIiKSB0aGVuCiAgICAgICAgaWYgZnVuYy5pbmNsdWRlcyh1aS5nZXQobWVudS52aXN1YWxzVGFiLmFuaW1hdGlvbnMpLCAiTGVnIGZ1Y2tlciIpIHRoZW4KICAgICAgICAgICAgdWkuc2V0KHJlZnMubGVnTW92ZW1lbnQsIGUuY29tbWFuZF9udW1iZXIgJSAzID09IDAgYW5kICJPZmYiIG9yICJBbHdheXMgc2xpZGUiKQogICAgICAgIGVuZAogICAgZW5kCmVuZCkKCmNsaWVudC5zZXRfZXZlbnRfY2FsbGJhY2soInByZV9yZW5kZXIiLCBmdW5jdGlvbigpCiAgICBsb2NhbCBscCA9IGVudGl0eS5nZXRfbG9jYWxfcGxheWVyKCkKICAgIGlmIG5vdCBscCB0aGVuIHJldHVybiBlbmQKICAgIGlmIG5vdCBmdW5jLmluY2x1ZGVzKHVpLmdldChtZW51LnZpc3VhbHNUYWIuTWlzY011bHRpc2VsZWN0KSwgIkFuaW0gYnJlYWtlcnMiKSB0aGVuIHJldHVybiBlbmQKICAgIGxvY2FsIGZsYWdzID0gZW50aXR5LmdldF9wcm9wKGxwLCAibV9mRmxhZ3MiKQogICAgZ3JvdW5kX3RpY2tzID0gYml0LmJhbmQoZmxhZ3MsIDEpID09IDAgYW5kIDAgb3IgKGdyb3VuZF90aWNrcyA8IDUgYW5kIGdyb3VuZF90aWNrcyArIDEgb3IgZ3JvdW5kX3RpY2tzKQoKICAgIGlmIGZ1bmMuaW5jbHVkZXModWkuZ2V0KG1lbnUudmlzdWFsc1RhYi5hbmltYXRpb25zKSwgIlN0YXRpYyBsZWdzIikgdGhlbgogICAgICAgIGVudGl0eS5zZXRfcHJvcChscCwgIm1fZmxQb3NlUGFyYW1ldGVyIiwgMSwgMCkgCiAgICBlbmQKCiAgICBpZiBmdW5jLmluY2x1ZGVzKHVpLmdldChtZW51LnZpc3VhbHNUYWIuYW5pbWF0aW9ucyksICJJbiBhaXIiKSBhbmQgYml0LmJhbmQoZmxhZ3MsIDEpID09IDAgdGhlbgogICAgICAgIGVudGl0eS5zZXRfcHJvcChscCwgIm1fZmxQb3NlUGFyYW1ldGVyIiwgMSwgNikgCiAgICBlbmQKCiAgICBpZiBmdW5jLmluY2x1ZGVzKHVpLmdldChtZW51LnZpc3VhbHNUYWIuYW5pbWF0aW9ucyksICJMZWcgZnVja2VyIikgdGhlbgogICAgICAgIGVudGl0eS5zZXRfcHJvcChscCwgIm1fZmxQb3NlUGFyYW1ldGVyIiwgMSwgZ2xvYmFscy50aWNrY291bnQoKSAlIDQgPiAxIGFuZCA1IC8gMTAgb3IgMSkKICAgIGVuZAoKICAgIGlmIGZ1bmMuaW5jbHVkZXModWkuZ2V0KG1lbnUudmlzdWFsc1RhYi5hbmltYXRpb25zKSwgIk9uIGxhbmQiKSB0aGVuCiAgICAgICAgZ3JvdW5kX3RpY2tzID0gYml0LmJhbmQoZmxhZ3MsIDEpID09IDEgYW5kIGdyb3VuZF90aWNrcyArIDEgb3IgMAoKICAgICAgICBpZiBncm91bmRfdGlja3MgPiAyMCBhbmQgZ3JvdW5kX3RpY2tzIDwgMTUwIHRoZW4KICAgICAgICAgICAgZW50aXR5LnNldF9wcm9wKGxwLCAibV9mbFBvc2VQYXJhbWV0ZXIiLCAwLjUsIDEyKQogICAgICAgIGVuZAogICAgZW5kCgogICAgaWYgZnVuYy5pbmNsdWRlcyh1aS5nZXQobWVudS52aXN1YWxzVGFiLmFuaW1hdGlvbnMpLCAiQWxsYWggbGVncyIpIHRoZW4KICAgICAgICBlbnRpdHkuc2V0X3Byb3AobHAsICJtX2ZsUG9zZVBhcmFtZXRlciIsIDEsIDcpCiAgICAgICAgdWkuc2V0KHJlZnMubGVnTW92ZW1lbnQsICJOZXZlciBzbGlkZSIpCiAgICBlbmQKCiAgICBpZiBmdW5jLmluY2x1ZGVzKHVpLmdldChtZW51LnZpc3VhbHNUYWIuYW5pbWF0aW9ucyksICJIYXJhbSBsZWdzIikgdGhlbgogICAgICAgIGxvY2FsIGxwID0gZW50LmdldF9sb2NhbF9wbGF5ZXIoKQogICAgICAgIGxvY2FsIG1fZkZsYWdzID0gbHA6Z2V0X3Byb3AoIm1fZkZsYWdzIikKICAgICAgICBsb2NhbCBpc19vbmdyb3VuZCA9IGJpdC5iYW5kKG1fZkZsYWdzLCAxKSB+PSAwIAogICAgICAgIAogICAgICAgIGlmIG5vdCBpc19vbmdyb3VuZCB0aGVuIAogICAgICAgICAgICBsb2NhbCBteV9hbmltbGF5ZXIgPSBscDpnZXRfYW5pbV9vdmVybGF5KDYpCiAgICAgICAgICAgIG15X2FuaW1sYXllci53ZWlnaHQgPSAxIAogICAgICAgICAgICBlbnRpdHkuc2V0X3Byb3AobHAsICJtX2ZsUG9zZVBhcmFtZXRlciIsIDEsIDYpIAogICAgICAgIGVuZAogICAgZW5kCgogICAgaWYgZnVuYy5pbmNsdWRlcyh1aS5nZXQobWVudS52aXN1YWxzVGFiLmFuaW1hdGlvbnMpLCAiQmxlbmQgbGVncyIpIHRoZW4KICAgICAgICBlbnRpdHkuc2V0X3Byb3AobHAsICJtX2ZsUG9zZVBhcmFtZXRlciIsIDAsIDgpCiAgICAgICAgZW50aXR5LnNldF9wcm9wKGxwLCAibV9mbFBvc2VQYXJhbWV0ZXIiLCAwLCA5KQogICAgICAgIGVudGl0eS5zZXRfcHJvcChscCwgIm1fZmxQb3NlUGFyYW1ldGVyIiwgMCwgMTApCiAgICBlbmQKZW5kKQotLSBAcmVnaW9uIEFBX0NBTExCQUNLUyBlbmQKCi0tIEByZWdpb24gSU5ESUNBVE9SUyBzdGFydApsb2NhbCBhbHBoYSA9IDAKbG9jYWwgc2NvcGVkRnJhY3Rpb24gPSAwCgpsb2NhbCBtYWluSW5kQ2xyID0ge3IgPSAwLCBnID0gMCwgYiA9IDAsIGEgPSAwfQpsb2NhbCBkdENsciA9IHtyID0gMCwgZyA9IDAsIGIgPSAwLCBhID0gMH0KbG9jYWwgY2hhcmdlQ2xyID0ge3IgPSAwLCBnID0gMCwgYiA9IDAsIGEgPSAwfQpsb2NhbCBjaGFyZ2VJbmQgPSB7dyA9IDAsIHggPSAwLCB5ID0gMjV9CmxvY2FsIHBzQ2xyID0ge3IgPSAwLCBnID0gMCwgYiA9IDAsIGEgPSAwfQpsb2NhbCBkdEluZCA9IHt3ID0gMCwgeCA9IDAsIHkgPSAyNX0KbG9jYWwgcXBJbmQgPSB7dyA9IDAsIHggPSAwLCB5ID0gMjUsIGEgPSAwfQpsb2NhbCBmZEluZCA9IHt3ID0gMCwgeCA9IDAsIHkgPSAyNSwgYSA9IDB9CmxvY2FsIHNwSW5kID0ge3cgPSAwLCB4ID0gMCwgeSA9IDI1LCBhID0gMH0KbG9jYWwgYmFJbmQgPSB7dyA9IDAsIHggPSAwLCB5ID0gMjUsIGEgPSAwfQpsb2NhbCBmc0luZCA9IHt3ID0gMCwgeCA9IDAsIHkgPSAyNSwgYSA9IDB9CmxvY2FsIG9zSW5kID0ge3cgPSAwLCB4ID0gMCwgeSA9IDI1LCBhID0gMH0KbG9jYWwgcHNJbmQgPSB7dyA9IDAsIHggPSAwLCB5ID0gMjV9CmxvY2FsIHdBbHBoYSA9IDAKbG9jYWwgdmFsdWUgPSAwCmxvY2FsIG9uY2UxID0gZmFsc2UKbG9jYWwgb25jZTIgPSBmYWxzZQpsb2NhbCBkdF9hID0gMApsb2NhbCBkdF95ID0gNDUKbG9jYWwgZHRfeCA9IDAKbG9jYWwgZHRfdyA9IDAKbG9jYWwgb3NfYSA9IDAKbG9jYWwgb3NfeSA9IDQ1CmxvY2FsIG9zX3ggPSAwCmxvY2FsIG9zX3cgPSAwCmxvY2FsIGZzX2EgPSAwCmxvY2FsIGZzX3kgPSA0NQpsb2NhbCBmc194ID0gMApsb2NhbCBmc193ID0gMApsb2NhbCBuX3ggPSAwCmxvY2FsIG4yX3ggPSAwCmxvY2FsIG4zX3ggPSAwCmxvY2FsIG40X3ggPSAwCmxvY2FsIHRlc3R4ID0gMApsb2NhbCBhYWEgPSAwCmxvY2FsIGxlbGUgPSAwCmxvY2FsIGhpdGxlciA9IHt9CmhpdGxlci5sZXJwID0gZnVuY3Rpb24oc3RhcnQsIHZlbmQsIHRpbWUpCiAgICByZXR1cm4gc3RhcnQgKyAodmVuZCAtIHN0YXJ0KSAqIHRpbWUKZW5kCmNsaWVudC5zZXRfZXZlbnRfY2FsbGJhY2soInBhaW50IiwgZnVuY3Rpb24oKQogICAgbG9jYWwgbG9jYWxfcGxheWVyID0gZW50aXR5LmdldF9sb2NhbF9wbGF5ZXIoKQogICAgaWYgbG9jYWxfcGxheWVyID09IG5pbCBvciBlbnRpdHkuaXNfYWxpdmUobG9jYWxfcGxheWVyKSA9PSBmYWxzZSB0aGVuIHJldHVybiBlbmQKICAgIGxvY2FsIHNpemVYLCBzaXplWSA9IGNsaWVudC5zY3JlZW5fc2l6ZSgpCiAgICBsb2NhbCB3ZWFwb24gPSBlbnRpdHkuZ2V0X3BsYXllcl93ZWFwb24obG9jYWxfcGxheWVyKQogICAgbG9jYWwgYm9keVlhdyA9IGVudGl0eS5nZXRfcHJvcChsb2NhbF9wbGF5ZXIsICJtX2ZsUG9zZVBhcmFtZXRlciIsIDExKSAqIDEyMCAtIDYwCiAgICBsb2NhbCBzaWRlID0gYm9keVlhdyA+IDAgYW5kIDEgb3IgLTEKICAgIGxvY2FsIHN0YXRlID0gdmFycy5pbnRUb1NbdmFycy5wU3RhdGVdOnVwcGVyKCkKICAgIGxvY2FsIG1haW5DbHIgPSB7fQogICAgbWFpbkNsci5yLCBtYWluQ2xyLmcsIG1haW5DbHIuYiwgbWFpbkNsci5hID0gdWkuZ2V0KG1lbnUudmlzdWFsc1RhYi5pbmRpY2F0b3JzQ2xyKQogICAgbG9jYWwgYXJyb3dDbHIgPSB7fQogICAgYXJyb3dDbHIuciwgYXJyb3dDbHIuZywgYXJyb3dDbHIuYiwgYXJyb3dDbHIuYSA9IHVpLmdldChtZW51LnZpc3VhbHNUYWIuYXJyb3dDbHIpCiAgICBsb2NhbCBmYWtlID0gbWF0aC5mbG9vcihhbnRpYWltX2Z1bmNzLmdldF9kZXN5bmMoMSkpCgogICAgaWYgdWkuZ2V0KG1lbnUudmlzdWFsc1RhYi53YXRlcm1hcmspID09ICJPbGQiIHRoZW4KICAgICAgICB3QWxwaGEgPSBmdW5jLmxlcnAod0FscGhhLCAyNTUsIGdsb2JhbHMuZnJhbWV0aW1lKCkgKiAzKQogICAgZWxzZQogICAgICAgIHdBbHBoYSA9IGZ1bmMubGVycCh3QWxwaGEsIDAsIGdsb2JhbHMuZnJhbWV0aW1lKCkgKiAxMSkKICAgIGVuZAoKICAgIGxvY2FsIHdhdGVybWFya0NsciA9IHt9CiAgICB3YXRlcm1hcmtDbHIuciwgd2F0ZXJtYXJrQ2xyLmcsIHdhdGVybWFya0Nsci5iID0gdWkuZ2V0KG1lbnUudmlzdWFsc1RhYi53YXRlcm1hcmtDbHIpCgogICAgaWYgcmVhZGZpbGUoImJsdWgucG5nIikgfj0gbmlsIGFuZCB1aS5nZXQobWVudS52aXN1YWxzVGFiLndhdGVybWFyaykgPT0gIk9sZCIgdGhlbgogICAgICAgIGxvY2FsIG1haW5ZID0gNAogICAgICAgIGxvY2FsIG1hcmdpblgsIG1hcmdpblkgPSByZW5kZXJlci5tZWFzdXJlX3RleHQoIi1kIiwgbHVhX25hbWU6dXBwZXIoKSkKICAgICAgICBsb2NhbCBwbmcgPSBpbWFnZXMubG9hZF9wbmcocmVhZGZpbGUoImJsdWgucG5nIikpCiAgICAgICAgcG5nOmRyYXcoNSwgc2l6ZVkvMiAtIDksIDYxLCA2NCwgMjU1LCAyNTUsIDI1NSwgd0FscGhhLCB0cnVlLCAiZiIpCiAgICAgICAgcmVuZGVyZXIudGV4dCg2OSwgc2l6ZVkvMiArIDE1LCAyNTUsIDI1NSwgMjU1LCB3QWxwaGEsICItZCIsIG5pbCwgbHVhX25hbWU6dXBwZXIoKSAuLiAiXGEiIC4uIGZ1bmMuUkdCQXRvSEVYKHdhdGVybWFya0Nsci5yLCB3YXRlcm1hcmtDbHIuZywgd2F0ZXJtYXJrQ2xyLmIsIHdBbHBoYSkgLi4gIi5MVUEiKQogICAgICAgIHJlbmRlcmVyLnRleHQoNjksIHNpemVZLzIgKyAyMywgMjU1LCAyNTUsIDI1NSwgd0FscGhhLCAiLWQiLCBuaWwsICJVU0VSIC0gIiAuLiBsb2dpbi51c2VybmFtZTp1cHBlcigpIC4uICJcYSIgLi4gZnVuYy5SR0JBdG9IRVgod2F0ZXJtYXJrQ2xyLnIsIHdhdGVybWFya0Nsci5nLCB3YXRlcm1hcmtDbHIuYiwgd0FscGhhKSAuLiAiIFsiIC4uIGxvZ2luLmJ1aWxkOnVwcGVyKCkgLi4gIl0iKQogICAgZW5kCiAgICAKICAgIGlmIHJlYWRmaWxlKCJibHVoaHVkdjEucG5nIikgfj0gbmlsIGFuZCB1aS5nZXQobWVudS52aXN1YWxzVGFiLmh1ZCkgPT0gInYxIiBhbmQgZnVuYy5pbmNsdWRlcyh1aS5nZXQobWVudS52aXN1YWxzVGFiLlZpc3VhbHNNdWx0aXNlbGVjdCksICJibHVoZ2FuZyBtZW51IikgdGhlbgogICAgICAgIGxvY2FsIHBuZyA9IGltYWdlcy5sb2FkX3BuZyhyZWFkZmlsZSgiYmx1aGh1ZHYxLnBuZyIpKQogICAgICAgIHBuZzpkcmF3KHVpLmdldChtZW51LnZpc3VhbHNUYWIuaHVkWCksIHVpLmdldChtZW51LnZpc3VhbHNUYWIuaHVkWSksIDI2NywgMTcyKQogICAgZW5kCgogICAgaWYgcmVhZGZpbGUoImJsdWhodWR2Mi5wbmciKSB+PSBuaWwgYW5kIHVpLmdldChtZW51LnZpc3VhbHNUYWIuaHVkKSA9PSAidjIiIGFuZCBmdW5jLmluY2x1ZGVzKHVpLmdldChtZW51LnZpc3VhbHNUYWIuVmlzdWFsc011bHRpc2VsZWN0KSwgImJsdWhnYW5nIG1lbnUiKSB0aGVuCiAgICAgICAgbG9jYWwgcG5nID0gaW1hZ2VzLmxvYWRfcG5nKHJlYWRmaWxlKCJibHVoaHVkdjIucG5nIikpCiAgICAgICAgcG5nOmRyYXcodWkuZ2V0KG1lbnUudmlzdWFsc1RhYi5odWRYKSwgdWkuZ2V0KG1lbnUudmlzdWFsc1RhYi5odWRZKSwgMjczLCAxNDIpCiAgICBlbmQKCgogICAgLS0gZHJhdyBhcnJvd3MKICAgIGlmIGZ1bmMuaW5jbHVkZXModWkuZ2V0KG1lbnUudmlzdWFsc1RhYi5WaXN1YWxzTXVsdGlzZWxlY3QpLCAiQ3Jvc3NoYWlyIEFycm93cyIpIHRoZW4KICAgICAgICBpZiB1aS5nZXQobWVudS52aXN1YWxzVGFiLmFycm93SW5kaWNhdG9yU3R5bGUpID09ICJTdGFuZGFydCIgdGhlbgogICAgICAgICAgICBhbHBoYSA9IChhYS5tYW51YWxBQSA9PSAyIG9yIGFhLm1hbnVhbEFBID09IDEpIGFuZCBmdW5jLmxlcnAoYWxwaGEsIDI1NSwgZ2xvYmFscy5mcmFtZXRpbWUoKSAqIDIwKSBvciBmdW5jLmxlcnAoYWxwaGEsIDAsIGdsb2JhbHMuZnJhbWV0aW1lKCkgKiAyMCkKICAgICAgICAgICAgcmVuZGVyZXIudGV4dChzaXplWCAvIDIgKyA0NSwgc2l6ZVkgLyAyIC0gMi41LCBhYS5tYW51YWxBQSA9PSAyIGFuZCBhcnJvd0Nsci5yIG9yIDIwMCwgYWEubWFudWFsQUEgPT0gMiBhbmQgYXJyb3dDbHIuZyBvciAyMDAsIGFhLm1hbnVhbEFBID09IDIgYW5kIGFycm93Q2xyLmIgb3IgMjAwLCBhbHBoYSwgImMrIiwgMCwgJz4nKQogICAgICAgICAgICByZW5kZXJlci50ZXh0KHNpemVYIC8gMiAtIDQ1LCBzaXplWSAvIDIgLSAyLjUsIGFhLm1hbnVhbEFBID09IDEgYW5kIGFycm93Q2xyLnIgb3IgMjAwLCBhYS5tYW51YWxBQSA9PSAxIGFuZCBhcnJvd0Nsci5nIG9yIDIwMCwgYWEubWFudWFsQUEgPT0gMSBhbmQgYXJyb3dDbHIuYiBvciAyMDAsIGFscGhhLCAiYysiLCAwLCAnPCcpCiAgICAgICAgZW5kCiAgICAKICAgICAgICBpZiB1aS5nZXQobWVudS52aXN1YWxzVGFiLmFycm93SW5kaWNhdG9yU3R5bGUpID09ICJUZWFtc2tlZXQiIHRoZW4KICAgICAgICAgICAgcmVuZGVyZXIudHJpYW5nbGUoc2l6ZVggLyAyICsgNTUsIHNpemVZIC8gMiArIDIsIHNpemVYIC8gMiArIDQyLCBzaXplWSAvIDIgLSA3LCBzaXplWCAvIDIgKyA0Miwgc2l6ZVkgLyAyICsgMTEsIAogICAgICAgICAgICBhYS5tYW51YWxBQSA9PSAyIGFuZCBhcnJvd0Nsci5yIG9yIDI1LCAKICAgICAgICAgICAgYWEubWFudWFsQUEgPT0gMiBhbmQgYXJyb3dDbHIuZyBvciAyNSwgCiAgICAgICAgICAgIGFhLm1hbnVhbEFBID09IDIgYW5kIGFycm93Q2xyLmIgb3IgMjUsIAogICAgICAgICAgICBhYS5tYW51YWxBQSA9PSAyIGFuZCBhcnJvd0Nsci5hIG9yIDE2MCkKICAgIAogICAgICAgICAgICByZW5kZXJlci50cmlhbmdsZShzaXplWCAvIDIgLSA1NSwgc2l6ZVkgLyAyICsgMiwgc2l6ZVggLyAyIC0gNDIsIHNpemVZIC8gMiAtIDcsIHNpemVYIC8gMiAtIDQyLCBzaXplWSAvIDIgKyAxMSwgCiAgICAgICAgICAgIGFhLm1hbnVhbEFBID09IDEgYW5kIGFycm93Q2xyLnIgb3IgMjUsIAogICAgICAgICAgICBhYS5tYW51YWxBQSA9PSAxIGFuZCBhcnJvd0Nsci5nIG9yIDI1LCAKICAgICAgICAgICAgYWEubWFudWFsQUEgPT0gMSBhbmQgYXJyb3dDbHIuYiBvciAyNSwgCiAgICAgICAgICAgIGFhLm1hbnVhbEFBID09IDEgYW5kIGFycm93Q2xyLmEgb3IgMTYwKQogICAgICAgIAogICAgICAgICAgICByZW5kZXJlci5yZWN0YW5nbGUoc2l6ZVggLyAyICsgMzgsIHNpemVZIC8gMiAtIDcsIDIsIDE4LCAKICAgICAgICAgICAgYm9keVlhdyA8IC0xMCBhbmQgYXJyb3dDbHIuciBvciAyNSwKICAgICAgICAgICAgYm9keVlhdyA8IC0xMCBhbmQgYXJyb3dDbHIuZyBvciAyNSwKICAgICAgICAgICAgYm9keVlhdyA8IC0xMCBhbmQgYXJyb3dDbHIuYiBvciAyNSwKICAgICAgICAgICAgYm9keVlhdyA8IC0xMCBhbmQgYXJyb3dDbHIuYSBvciAxNjApCiAgICAgICAgICAgIHJlbmRlcmVyLnJlY3RhbmdsZShzaXplWCAvIDIgLSA0MCwgc2l6ZVkgLyAyIC0gNywgMiwgMTgsCQkJCiAgICAgICAgICAgIGJvZHlZYXcgPiAxMCBhbmQgYXJyb3dDbHIuciBvciAyNSwKICAgICAgICAgICAgYm9keVlhdyA+IDEwIGFuZCBhcnJvd0Nsci5nIG9yIDI1LAogICAgICAgICAgICBib2R5WWF3ID4gMTAgYW5kIGFycm93Q2xyLmIgb3IgMjUsCiAgICAgICAgICAgIGJvZHlZYXcgPiAxMCBhbmQgYXJyb3dDbHIuYSBvciAxNjApCiAgICAgICAgZW5kCiAgICBlbmQKCiAgICAtLSBtb3ZlIG9uIHNjb3BlCiAgICBsb2NhbCBzY29wZUxldmVsID0gZW50aXR5LmdldF9wcm9wKHdlYXBvbiwgJ21fem9vbUxldmVsJykKICAgIGxvY2FsIHNjb3BlZCA9IGVudGl0eS5nZXRfcHJvcChsb2NhbF9wbGF5ZXIsICdtX2JJc1Njb3BlZCcpID09IDEKICAgIGxvY2FsIHJlc3VtZVpvb20gPSBlbnRpdHkuZ2V0X3Byb3AobG9jYWxfcGxheWVyLCAnbV9iUmVzdW1lWm9vbScpID09IDEKICAgIGxvY2FsIGlzVmFsaWQgPSB3ZWFwb24gfj0gbmlsIGFuZCBzY29wZUxldmVsIH49IG5pbAogICAgbG9jYWwgYWN0ID0gaXNWYWxpZCBhbmQgc2NvcGVMZXZlbCA+IDAgYW5kIHNjb3BlZCBhbmQgbm90IHJlc3VtZVpvb20KICAgIGxvY2FsIHRpbWUgPSBnbG9iYWxzLmZyYW1ldGltZSgpICogMzAKCiAgICBpZiBhY3QgdGhlbgogICAgICAgIGlmIHNjb3BlZEZyYWN0aW9uIDwgMSB0aGVuCiAgICAgICAgICAgIHNjb3BlZEZyYWN0aW9uID0gZnVuYy5sZXJwKHNjb3BlZEZyYWN0aW9uLCAxICsgMC4xLCB0aW1lKQogICAgICAgIGVsc2UKICAgICAgICAgICAgc2NvcGVkRnJhY3Rpb24gPSAxCiAgICAgICAgZW5kCiAgICBlbHNlCiAgICAgICAgc2NvcGVkRnJhY3Rpb24gPSBmdW5jLmxlcnAoc2NvcGVkRnJhY3Rpb24sIDAsIHRpbWUpCiAgICBlbmQKCiAgICAtLSBkcmF3IGluZGljYXRvcnMKICAgIGlmIHVpLmdldChtZW51LnZpc3VhbHNUYWIuaW5kaWNhdG9ycykgPT0gIlNvZnQiIGFuZCBmdW5jLmluY2x1ZGVzKHVpLmdldChtZW51LnZpc3VhbHNUYWIuVmlzdWFsc011bHRpc2VsZWN0KSwgIkNyb3NzaGFpciBJbmRpY2F0b3JzIikgdGhlbgogICAgICAgIGxvY2FsIGRwaSA9IHVpLmdldCh1aS5yZWZlcmVuY2UoIk1JU0MiLCAiU2V0dGluZ3MiLCAiRFBJIHNjYWxlIikpOmdzdWIoJyUlJywgJycpIC0gMTAwCiAgICAgICAgbG9jYWwgZ2xvYmFsRmxhZyA9ICJjZCIKICAgICAgICBsb2NhbCBnbG9iYWxNb3ZlWSA9IGdsb2JhbEZsYWcgPT0gImNkLSIgYW5kIDUgKyBkcGkvMTAgb3IgOSArIGRwaS8xMAogICAgICAgIGxvY2FsIGluZFgsIGluZFkgPSByZW5kZXJlci5tZWFzdXJlX3RleHQoZ2xvYmFsRmxhZywgIkRUIikKICAgICAgICBsb2NhbCB5RGVmYXVsdCA9IGZ1bmMuaW5jbHVkZXModWkuZ2V0KG1lbnUudmlzdWFsc1RhYi5pbmRpY2F0b3JzU3R5bGUpLCAiU3RhdGUiKSBhbmQgMTggb3IgOQogICAgICAgIGxvY2FsIGluZENvdW50ID0gMAogICAgICAgIGluZFkgPSBnbG9iYWxGbGFnID09ICJjZC0iIGFuZCBpbmRZIC0gMyBvciBpbmRZIC0gMgogICAgCiAgICAgICAgbG9jYWwgaXNDaGFyZ2VkID0gYW50aWFpbV9mdW5jcy5nZXRfZG91YmxlX3RhcCgpCiAgICAgICAgbG9jYWwgaXNGcyA9IHVpLmdldChtZW51LmJ1aWxkZXJUYWIuZnJlZXN0YW5kSG90a2V5KQogICAgICAgIGxvY2FsIGlzQmEgPSB1aS5nZXQocmVmcy5mb3JjZUJhaW0pCiAgICAgICAgbG9jYWwgaXNTcCA9IHVpLmdldChyZWZzLnNhZmVQb2ludCkKICAgICAgICBsb2NhbCBpc1FwID0gdWkuZ2V0KHJlZnMucXVpY2tQZWVrWzJdKQogICAgICAgIGxvY2FsIGlzU2xvdyA9IHVpLmdldChyZWZzLnNsb3dbMV0pIGFuZCB1aS5nZXQocmVmcy5zbG93WzJdKQogICAgICAgIGxvY2FsIGlzT3MgPSB1aS5nZXQocmVmcy5vc1sxXSkgYW5kIHVpLmdldChyZWZzLm9zWzJdKQogICAgICAgIGxvY2FsIGlzRmQgPSB1aS5nZXQocmVmcy5mYWtlRHVjaykKICAgICAgICBsb2NhbCBpc0R0ID0gdWkuZ2V0KHJlZnMuZHRbMV0pIGFuZCB1aS5nZXQocmVmcy5kdFsyXSkKICAgIAogICAgICAgIGxvY2FsIHN0YXRlID0gdmFycy5pbnRUb1NbdmFycy5wU3RhdGVdOnVwcGVyKCkKICAgIAogICAgICAgIGlmIGZ1bmMuaW5jbHVkZXModWkuZ2V0KG1lbnUudmlzdWFsc1RhYi5pbmRpY2F0b3JzU3R5bGUpLCAiTmFtZSIpIHRoZW4KICAgICAgICAgICAgbG9jYWwgbmFtZXgsIG5hbWV5ID0gcmVuZGVyZXIubWVhc3VyZV90ZXh0KGdsb2JhbEZsYWcsIGdsb2JhbEZsYWcgPT0gImNkLSIgYW5kIGx1YV9uYW1lOnVwcGVyKCkgb3IgbHVhX25hbWU6bG93ZXIoKSkKICAgICAgICAgICAgbG9jYWwgbG9nbyA9IGFuaW1hdGVfdGV4dChnbG9iYWxzLmN1cnRpbWUoKSwgZ2xvYmFsRmxhZyA9PSAiY2QtIiBhbmQgbHVhX25hbWU6dXBwZXIoKSBvciBsdWFfbmFtZTpsb3dlcigpLCBtYWluQ2xyLnIsIG1haW5DbHIuZywgbWFpbkNsci5iLCAyNTUpCiAgICAKICAgICAgICAgICAgcmVuZGVyZXIudGV4dChzaXplWC8yICsgKChuYW1leCArIDIpLzIpICogc2NvcGVkRnJhY3Rpb24sIHNpemVZLzIgKyAyMCAtIGRwaS8xMCwgMjU1LCAyNTUsIDI1NSwgMjU1LCBnbG9iYWxGbGFnLCBuaWwsIHVucGFjayhsb2dvKSkKICAgICAgICBlbmQgCiAgICAKICAgICAgICBpZiBmdW5jLmluY2x1ZGVzKHVpLmdldChtZW51LnZpc3VhbHNUYWIuaW5kaWNhdG9yc1N0eWxlKSwgIlN0YXRlIikgdGhlbgogICAgICAgICAgICBsb2NhbCBuYW1leCwgbmFtZXkgPSByZW5kZXJlci5tZWFzdXJlX3RleHQoZ2xvYmFsRmxhZywgZ2xvYmFsRmxhZyA9PSAiY2QtIiBhbmQgbHVhX25hbWU6dXBwZXIoKSBvciBsdWFfbmFtZTpsb3dlcigpKQogICAgICAgICAgICBsb2NhbCBzdGF0ZVgsIHN0YXRlWSA9IHJlbmRlcmVyLm1lYXN1cmVfdGV4dChnbG9iYWxGbGFnLCBzdGF0ZTpsb3dlcigpKQogICAgICAgICAgICBsb2NhbCBzdHJpbmcgPSBzdGF0ZTpsb3dlcigpCiAgICAgICAgICAgIHJlbmRlcmVyLnRleHQoc2l6ZVgvMiArIChzdGF0ZVggKyAyKS8yICogc2NvcGVkRnJhY3Rpb24sIHNpemVZLzIgKyAyMCArIG5hbWV5LzEuMiwgMjU1LCAyNTUsIDI1NSwgMjU1LCBnbG9iYWxGbGFnLCAwLCBzdHJpbmcpCiAgICAgICAgZW5kCiAgICAKICAgICAgICBpZiBmdW5jLmluY2x1ZGVzKHVpLmdldChtZW51LnZpc3VhbHNUYWIuaW5kaWNhdG9yc1N0eWxlKSwgIkRvdWJsZXRhcCIpIHRoZW4KICAgICAgICAgICAgaWYgaXNEdCB0aGVuIAogICAgICAgICAgICAgICAgZHRDbHIuYSA9IGZ1bmMubGVycChkdENsci5hLCAyNTUsIHRpbWUpCiAgICAgICAgICAgICAgICBpZiBkdEluZC55IDwgeURlZmF1bHQgKyBpbmRZICogaW5kQ291bnQgdGhlbgogICAgICAgICAgICAgICAgICAgIGR0SW5kLnkgPSBmdW5jLmxlcnAoZHRJbmQueSwgeURlZmF1bHQgKyBpbmRZICogaW5kQ291bnQgKyAxLCB0aW1lKQogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIGR0SW5kLnkgPSB5RGVmYXVsdCArIGluZFkgKiBpbmRDb3VudAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBjaGFyZ2VJbmQudyA9IDAuMQogICAgICAgICAgICAgICAgaWYgbm90IGlzQ2hhcmdlZCBhbmQgZnVuYy5kZWZlbnNpdmUuZGVmZW5zaXZlID4gMSB0aGVuCiAgICAgICAgICAgICAgICAgICAgZHRDbHIuciA9IGZ1bmMubGVycChkdENsci5yLCAxNDQsIHRpbWUpCiAgICAgICAgICAgICAgICAgICAgZHRDbHIuZyA9IGZ1bmMubGVycChkdENsci5nLCAyMzgsIHRpbWUpCiAgICAgICAgICAgICAgICAgICAgZHRDbHIuYiA9IGZ1bmMubGVycChkdENsci5iLCAxNDQsIHRpbWUpCiAgICAgICAgICAgICAgICBlbHNlaWYgbm90IGlzQ2hhcmdlZCB0aGVuCiAgICAgICAgICAgICAgICAgICAgZHRDbHIuciA9IGZ1bmMubGVycChkdENsci5yLCAyMjIsIHRpbWUpCiAgICAgICAgICAgICAgICAgICAgZHRDbHIuZyA9IGZ1bmMubGVycChkdENsci5nLCA1NSwgdGltZSkKICAgICAgICAgICAgICAgICAgICBkdENsci5iID0gZnVuYy5sZXJwKGR0Q2xyLmIsIDU1LCB0aW1lKQogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIGR0Q2xyLnIgPSBmdW5jLmxlcnAoZHRDbHIuciwgMTQ0LCB0aW1lKQogICAgICAgICAgICAgICAgICAgIGR0Q2xyLmcgPSBmdW5jLmxlcnAoZHRDbHIuZywgMjM4LCB0aW1lKQogICAgICAgICAgICAgICAgICAgIGR0Q2xyLmIgPSBmdW5jLmxlcnAoZHRDbHIuYiwgMTQ0LCB0aW1lKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBpbmRDb3VudCA9IGluZENvdW50ICsgMQogICAgICAgICAgICBlbHNlaWYgbm90IGlzRHQgdGhlbiAKICAgICAgICAgICAgICAgIGR0Q2xyLmEgPSBmdW5jLmxlcnAoZHRDbHIuYSwgMCwgdGltZSkKICAgICAgICAgICAgICAgIGR0SW5kLnkgPSBmdW5jLmxlcnAoZHRJbmQueSwgeURlZmF1bHQgLSA1LCB0aW1lKQogICAgICAgICAgICBlbmQKICAgIAogICAgICAgICAgICByZW5kZXJlci50ZXh0KHNpemVYIC8gMiArICgocmVuZGVyZXIubWVhc3VyZV90ZXh0KGdsb2JhbEZsYWcsIGdsb2JhbEZsYWcgPT0gImNkLSIgYW5kICJEVCIgb3IgImR0IikgKyAyKS8yKSAqIHNjb3BlZEZyYWN0aW9uICwgc2l6ZVkgLyAyICsgZHRJbmQueSArIDEzICsgZ2xvYmFsTW92ZVksIGR0Q2xyLnIsIGR0Q2xyLmcsIGR0Q2xyLmIsIGR0Q2xyLmEsIGdsb2JhbEZsYWcsIGR0SW5kLncsIGdsb2JhbEZsYWcgPT0gImNkLSIgYW5kICJEVCIgb3IgImR0IikKICAgICAgICBlbmQKICAgIAogICAgICAgIGlmIGZ1bmMuaW5jbHVkZXModWkuZ2V0KG1lbnUudmlzdWFsc1RhYi5pbmRpY2F0b3JzU3R5bGUpLCAiSGlkZXNob3RzIikgdGhlbgogICAgICAgICAgICBpZiBpc09zIHRoZW4gCiAgICAgICAgICAgICAgICBvc0luZC5hID0gZnVuYy5sZXJwKG9zSW5kLmEsIDI1NSwgdGltZSkKICAgICAgICAgICAgICAgIGlmIG9zSW5kLnkgPCB5RGVmYXVsdCArIGluZFkgKiBpbmRDb3VudCB0aGVuCiAgICAgICAgICAgICAgICAgICAgb3NJbmQueSA9IGZ1bmMubGVycChvc0luZC55LCB5RGVmYXVsdCArIGluZFkgKiBpbmRDb3VudCArIDEsIHRpbWUpCiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgb3NJbmQueSA9IHlEZWZhdWx0ICsgaW5kWSAqIGluZENvdW50CiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAKICAgICAgICAgICAgICAgIGluZENvdW50ID0gaW5kQ291bnQgKyAxCiAgICAgICAgICAgIGVsc2VpZiBub3QgaXNPcyB0aGVuCiAgICAgICAgICAgICAgICBvc0luZC5hID0gZnVuYy5sZXJwKG9zSW5kLmEsIDAsIHRpbWUpCiAgICAgICAgICAgICAgICBvc0luZC55ID0gZnVuYy5sZXJwKG9zSW5kLnksIHlEZWZhdWx0IC0gNSwgdGltZSkKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIHJlbmRlcmVyLnRleHQoc2l6ZVggLyAyICsgKChyZW5kZXJlci5tZWFzdXJlX3RleHQoZ2xvYmFsRmxhZywgZ2xvYmFsRmxhZyA9PSAiY2QtIiBhbmQgIkhTIiBvciAiaHMiKSArIDIpLzIpICogc2NvcGVkRnJhY3Rpb24sIHNpemVZIC8gMiArIG9zSW5kLnkgKyAxMyArIGdsb2JhbE1vdmVZLCAyNTUsIDI1NSwgMjU1LCBvc0luZC5hLCBnbG9iYWxGbGFnLCBvc0luZC53LCBnbG9iYWxGbGFnID09ICJjZC0iIGFuZCAiSFMiIG9yICJocyIpCiAgICAgICAgZW5kCiAgICAKICAgICAgICBpZiBmdW5jLmluY2x1ZGVzKHVpLmdldChtZW51LnZpc3VhbHNUYWIuaW5kaWNhdG9yc1N0eWxlKSwgIkZyZWVzdGFuZCIpIHRoZW4KICAgICAgICAgICAgaWYgaXNGcyB0aGVuIAogICAgICAgICAgICAgICAgZnNJbmQuYSA9IGZ1bmMubGVycChmc0luZC5hLCAyNTUsIHRpbWUpCiAgICAgICAgICAgICAgICBpZiBmc0luZC55IDwgeURlZmF1bHQgKyBpbmRZICogaW5kQ291bnQgdGhlbgogICAgICAgICAgICAgICAgICAgIGZzSW5kLnkgPSBmdW5jLmxlcnAoZnNJbmQueSwgeURlZmF1bHQgKyBpbmRZICogaW5kQ291bnQgKyAxLCB0aW1lKQogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIGZzSW5kLnkgPSB5RGVmYXVsdCArIGluZFkgKiBpbmRDb3VudAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBpbmRDb3VudCA9IGluZENvdW50ICsgMQogICAgICAgICAgICBlbHNlaWYgbm90IGlzRnMgdGhlbiAKICAgICAgICAgICAgICAgIGZzSW5kLmEgPSBmdW5jLmxlcnAoZnNJbmQuYSwgMCwgdGltZSkKICAgICAgICAgICAgICAgIGZzSW5kLnkgPSBmdW5jLmxlcnAoZnNJbmQueSwgeURlZmF1bHQgLSA1LCB0aW1lKQogICAgICAgICAgICBlbmQKICAgICAgICAgICAgbG9jYWwgZnNfY29sID0gdmFycy5mcyBhbmQgezI1NSwyNTUsMjU1fSBvciB7MjIyLDU1LDU1fQogICAgICAgICAgICByZW5kZXJlci50ZXh0KHNpemVYIC8gMiArIGZzSW5kLnggKyAoKHJlbmRlcmVyLm1lYXN1cmVfdGV4dChnbG9iYWxGbGFnLCBnbG9iYWxGbGFnID09ICJjZC0iIGFuZCAiRlMiIG9yICJmcyIpICsgMikvMikgKiBzY29wZWRGcmFjdGlvbiwgc2l6ZVkgLyAyICsgZnNJbmQueSArIDEzICsgZ2xvYmFsTW92ZVksIGZzX2NvbFsxXSwgZnNfY29sWzJdLCBmc19jb2xbM10sIGZzSW5kLmEsIGdsb2JhbEZsYWcsIGZzSW5kLncsIGdsb2JhbEZsYWcgPT0gImNkLSIgYW5kICJGUyIgb3IgImZzIikKICAgICAgICBlbmQKICAgIAogICAgICAgIGlmIGZ1bmMuaW5jbHVkZXModWkuZ2V0KG1lbnUudmlzdWFsc1RhYi5pbmRpY2F0b3JzU3R5bGUpLCAiU2FmZXBvaW50IikgdGhlbgogICAgICAgICAgICBpZiBpc1NwIHRoZW4gCiAgICAgICAgICAgICAgICBzcEluZC5hID0gZnVuYy5sZXJwKHNwSW5kLmEsIDI1NSwgdGltZSkKICAgICAgICAgICAgICAgIGlmIHNwSW5kLnkgPCB5RGVmYXVsdCArIGluZFkgKiBpbmRDb3VudCB0aGVuCiAgICAgICAgICAgICAgICAgICAgc3BJbmQueSA9IGZ1bmMubGVycChzcEluZC55LCB5RGVmYXVsdCArIGluZFkgKiBpbmRDb3VudCArIDEsIHRpbWUpCiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgc3BJbmQueSA9IHlEZWZhdWx0ICsgaW5kWSAqIGluZENvdW50CiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGluZENvdW50ID0gaW5kQ291bnQgKyAxCiAgICAgICAgICAgIGVsc2VpZiBub3QgaXNTcCB0aGVuIAogICAgICAgICAgICAgICAgc3BJbmQuYSA9IGZ1bmMubGVycChzcEluZC5hLCAwLCB0aW1lKQogICAgICAgICAgICAgICAgc3BJbmQueSA9IGZ1bmMubGVycChzcEluZC55LCB5RGVmYXVsdCAtIDUsIHRpbWUpCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICByZW5kZXJlci50ZXh0KHNpemVYIC8gMiArICgocmVuZGVyZXIubWVhc3VyZV90ZXh0KGdsb2JhbEZsYWcsIGdsb2JhbEZsYWcgPT0gImNkLSIgYW5kICJTUCIgb3IgInNwIikgKyAyKS8yKSAqIHNjb3BlZEZyYWN0aW9uLCBzaXplWSAvIDIgKyBzcEluZC55ICsgMTMgKyBnbG9iYWxNb3ZlWSwgMjU1LCAyNTUsIDI1NSwgc3BJbmQuYSwgZ2xvYmFsRmxhZywgMCwgZ2xvYmFsRmxhZyA9PSAiY2QtIiBhbmQgIlNQIiBvciAic3AiKQogICAgICAgIGVuZAogICAgCiAgICAgICAgaWYgZnVuYy5pbmNsdWRlcyh1aS5nZXQobWVudS52aXN1YWxzVGFiLmluZGljYXRvcnNTdHlsZSksICJCb2R5IGFpbSIpIHRoZW4KICAgICAgICAgICAgaWYgaXNCYSB0aGVuCiAgICAgICAgICAgICAgICBiYUluZC5hID0gZnVuYy5sZXJwKGJhSW5kLmEsIDI1NSwgdGltZSkKICAgICAgICAgICAgICAgIGlmIGJhSW5kLnkgPCB5RGVmYXVsdCArIGluZFkgKiBpbmRDb3VudCB0aGVuCiAgICAgICAgICAgICAgICAgICAgYmFJbmQueSA9IGZ1bmMubGVycChiYUluZC55LCB5RGVmYXVsdCArIGluZFkgKiBpbmRDb3VudCArIDEsIHRpbWUpCiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgYmFJbmQueSA9IHlEZWZhdWx0ICsgaW5kWSAqIGluZENvdW50CiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGluZENvdW50ID0gaW5kQ291bnQgKyAxCiAgICAgICAgICAgIGVsc2VpZiBub3QgaXNCYSB0aGVuIAogICAgICAgICAgICAgICAgYmFJbmQuYSA9IGZ1bmMubGVycChiYUluZC5hLCAwLCB0aW1lKQogICAgICAgICAgICAgICAgYmFJbmQueSA9IGZ1bmMubGVycChiYUluZC55LCB5RGVmYXVsdCAtIDUsIHRpbWUpCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICByZW5kZXJlci50ZXh0KHNpemVYIC8gMiArICgocmVuZGVyZXIubWVhc3VyZV90ZXh0KGdsb2JhbEZsYWcsIGdsb2JhbEZsYWcgPT0gImNkLSIgYW5kICJCQSIgb3IgImJhIikgKyAyKS8yKSAqIHNjb3BlZEZyYWN0aW9uLCBzaXplWSAvIDIgKyBiYUluZC55ICsgMTMgKyBnbG9iYWxNb3ZlWSwgMjU1LCAyNTUsIDI1NSwgYmFJbmQuYSwgZ2xvYmFsRmxhZywgMCwgZ2xvYmFsRmxhZyA9PSAiY2QtIiBhbmQgIkJBIiBvciAiYmEiKQogICAgICAgIGVuZAogICAgCiAgICAgICAgaWYgZnVuYy5pbmNsdWRlcyh1aS5nZXQobWVudS52aXN1YWxzVGFiLmluZGljYXRvcnNTdHlsZSksICJGYWtlZHVjayIpIHRoZW4KICAgICAgICAgICAgaWYgaXNGZCB0aGVuCiAgICAgICAgICAgICAgICBmZEluZC5hID0gZnVuYy5sZXJwKGZkSW5kLmEsIDI1NSwgdGltZSkKICAgICAgICAgICAgICAgIGlmIGZkSW5kLnkgPCB5RGVmYXVsdCArIGluZFkgKiBpbmRDb3VudCB0aGVuCiAgICAgICAgICAgICAgICAgICAgZmRJbmQueSA9IGZ1bmMubGVycChmZEluZC55LCB5RGVmYXVsdCArIGluZFkgKiBpbmRDb3VudCArIDEsIHRpbWUpCiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgZmRJbmQueSA9IHlEZWZhdWx0ICsgaW5kWSAqIGluZENvdW50CiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGluZENvdW50ID0gaW5kQ291bnQgKyAxCiAgICAgICAgICAgIGVsc2VpZiBub3QgaXNGZCB0aGVuIAogICAgICAgICAgICAgICAgZmRJbmQuYSA9IGZ1bmMubGVycChmZEluZC5hLCAwLCB0aW1lKQogICAgICAgICAgICAgICAgZmRJbmQueSA9IGZ1bmMubGVycChmZEluZC55LCB5RGVmYXVsdCAtIDUsIHRpbWUpCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICByZW5kZXJlci50ZXh0KHNpemVYIC8gMiArICgocmVuZGVyZXIubWVhc3VyZV90ZXh0KGdsb2JhbEZsYWcsIGdsb2JhbEZsYWcgPT0gImNkLSIgYW5kICJGRCIgb3IgImZkIikgKyAyKS8yKSAqIHNjb3BlZEZyYWN0aW9uLCBzaXplWSAvIDIgKyBmZEluZC55ICsgMTMgKyBnbG9iYWxNb3ZlWSwgMjU1LCAyNTUsIDI1NSwgZmRJbmQuYSwgZ2xvYmFsRmxhZywgMCwgZ2xvYmFsRmxhZyA9PSAiY2QtIiBhbmQgIkZEIiBvciAiZmQiKQogICAgICAgIGVuZAogICAgZW5kCiAgICAtLSBpbmRpY2F0b3IgZDRzc2gKICAgIAogICAgaWYgdWkuZ2V0KG1lbnUudmlzdWFsc1RhYi5pbmRpY2F0b3JzKSA9PSAiUGl4ZWwiIGFuZCBmdW5jLmluY2x1ZGVzKHVpLmdldChtZW51LnZpc3VhbHNUYWIuVmlzdWFsc011bHRpc2VsZWN0KSwgIkNyb3NzaGFpciBJbmRpY2F0b3JzIikgdGhlbgogICAgICAgIGxvY2FsIGJvZHl5YXcgPSBlbnRpdHkuZ2V0X3Byb3AoZW50aXR5LmdldF9sb2NhbF9wbGF5ZXIoKSwgIm1fZmxQb3NlUGFyYW1ldGVyIiwgMTEpICogMTIwIC0gNjAKICAgICAgICBsb2NhbCBzaWRlID0gYm9keXlhdyA+IDAgYW5kIDEgb3IgLTEKICAgIAogICAgICAgIGxvY2FsIG1yLG1nLG1iLG1hID0gdWkuZ2V0KG1lbnUudmlzdWFsc1RhYi5pbmRpY2F0b3JzQ2xyKQogICAgCiAgICAgICAgbG9jYWwgeCwgeSA9IGNsaWVudC5zY3JlZW5fc2l6ZSgpCiAgICAKICAgICAgICBsb2NhbCBtZSA9IGVudGl0eS5nZXRfbG9jYWxfcGxheWVyKCkKICAgIAogICAgICAgIGlmIG5vdCBlbnRpdHkuaXNfYWxpdmUobWUpIHRoZW4gcmV0dXJuIGVuZAogICAgCiAgICAgICAgbG9jYWwgaXNfY2hhcmdlZCA9IGFudGlhaW1fZnVuY3MuZ2V0X2RvdWJsZV90YXAoKQogICAgICAgIGxvY2FsIGlzX2R0ID0gdWkuZ2V0KHJlZnMuZHRbMV0pIGFuZCB1aS5nZXQocmVmcy5kdFsyXSkKICAgICAgICBsb2NhbCBpc19vcyA9IHVpLmdldChyZWZzLm9zWzFdKSBhbmQgdWkuZ2V0KHJlZnMub3NbMl0pCiAgICAgICAgbG9jYWwgaXNfZnMgPSB1aS5nZXQocmVmcy5lZGdlWWF3KQogICAgICAgIGxvY2FsIGlzX2JhID0gdWkuZ2V0KHJlZnMuZm9yY2VCYWltKQogICAgICAgIGxvY2FsIGlzX3NwID0gdWkuZ2V0KHJlZnMuc2FmZVBvaW50KQogICAgICAgIGxvY2FsIGlzX3FwID0gdWkuZ2V0KHJlZnMucXVpY2tQZWVrWzJdKQogICAgCiAgICAgICAgaWYgaXNfY2hhcmdlZCB0aGVuIGRyLGRnLGRiLGRhPTE2NywgMjUyLCAxMjEsMjU1IGVsc2VpZiBpc19vcyB0aGVuIGRyLGRnLGRiLGRhPTI1NSwyNTUsMjU1LDI1NSBlbHNlIGRyLGRnLGRiLGRhPTI1NSwwLDAsMjU1IGVuZDtpZiBpc19xcCB0aGVuIHFyLHFnLHFiLHFhPTI1NSwyNTUsMjU1LDI1NSBlbHNlIHFyLHFnLHFiLHFhPTI1NSwyNTUsMjU1LDE1MCBlbmQ7aWYgaXNfYmEgdGhlbiBicixiZyxiYixiYT0yNTUsMjU1LDI1NSwyNTUgZWxzZSBicixiZyxiYixiYT0yNTUsMjU1LDI1NSwxNTAgZW5kO2lmIGlzX2ZzIHRoZW4gZnIsZmcsZmIsZmE9MjU1LDI1NSwyNTUsMjU1IGVsc2UgZnIsZmcsZmIsZmE9MjU1LDI1NSwyNTUsMTUwIGVuZDtpZiBpc19zcCB0aGVuIHNyLHNnLHNiLHNhPTI1NSwyNTUsMjU1LDI1NSBlbHNlIHNyLHNnLHNiLHNhPTI1NSwyNTUsMjU1LDE1MCBlbmQKICAgICAgICAtLXNpbmVfaW4KICAgICAgICAKICAgIAogICAgICAgIGxvY2FsIF8sIHkyID0gY2xpZW50LnNjcmVlbl9zaXplKCkKICAgIAogICAgICAgIGxvY2FsIHJlYWx0aW1lID0gZ2xvYmFscy5yZWFsdGltZSgpICUgMwogICAgICAgIGxvY2FsIGFscGhhID0gbWF0aC5mbG9vcihtYXRoLnNpbihyZWFsdGltZSAqIDQpICogKDE4MCAvIDIgLSAxKSArIDE4MCAvIDIpIG9yIDE4MAogICAgCiAgICAgICAgbG9jYWwgZXhwX2luZCA9ICIiCiAgICAKICAgICAgICBpZiBpc19kdCB0aGVuCiAgICAgICAgICAgIGV4cF9pbmQgPSAiRFQiCiAgICAgICAgZWxzZWlmIGlzX29zIHRoZW4KICAgICAgICAgICAgZXhwX2luZCA9ICJIUyIKICAgICAgICBlbmQKICAgIAogICAgICAgIGxvY2FsIG1lID0gZW50aXR5LmdldF9sb2NhbF9wbGF5ZXIoKQogICAgICAgIGxvY2FsIHdwbiA9IGVudGl0eS5nZXRfcGxheWVyX3dlYXBvbihtZSkKICAgIAogICAgICAgIGxvY2FsIHNjb3BlX2xldmVsID0gZW50aXR5LmdldF9wcm9wKHdwbiwgJ21fem9vbUxldmVsJykKICAgICAgICBsb2NhbCBzY29wZWQgPSBlbnRpdHkuZ2V0X3Byb3AobWUsICdtX2JJc1Njb3BlZCcpID09IDEKICAgICAgICBsb2NhbCByZXN1bWVfem9vbSA9IGVudGl0eS5nZXRfcHJvcChtZSwgJ21fYlJlc3VtZVpvb20nKSA9PSAxCiAgICAKICAgICAgICBsb2NhbCBpc192YWxpZCA9IGVudGl0eS5pc19hbGl2ZShtZSkgYW5kIHdwbiB+PSBuaWwgYW5kIHNjb3BlX2xldmVsIH49IG5pbAogICAgICAgIGxvY2FsIGFjdCA9IGlzX3ZhbGlkIGFuZCBzY29wZV9sZXZlbCA+IDAgYW5kIHNjb3BlZCBhbmQgbm90IHJlc3VtZV96b29tCiAgICAKICAgICAgICBsb2NhbCBmbGFnID0gImMtIgogICAgICAgIGxvY2FsIHRpbmcgPSAwCiAgICAgICAgbG9jYWwgdGVzdHRpbmcgPSAwCiAgICAKICAgICAgICAtLWFuaW1hdGlvbiBzaGl0CiAgICAKICAgICAgICBpZiBpc19kdCBvciBpc19vcyB0aGVuCiAgICAgICAgICAgIG40X3ggPSBoaXRsZXIubGVycChuNF94LCA4LCBnbG9iYWxzLmZyYW1ldGltZSgpICogOCkKICAgICAgICBlbHNlCiAgICAgICAgICAgIG40X3ggPSBoaXRsZXIubGVycChuNF94LCAtMSwgZ2xvYmFscy5mcmFtZXRpbWUoKSAqIDgpCiAgICAgICAgZW5kCiAgICAKICAgICAgICBpZiBhY3QgdGhlbgogICAgICAgICAgICBmbGFnID0gIi0iCiAgICAgICAgICAgIHRpbmcgPSAyMwogICAgICAgICAgICB0ZXN0dGluZyA9IDExCiAgICAKICAgICAgICAgICAgdGVzdHggPSBoaXRsZXIubGVycCh0ZXN0eCwgMzAsIGdsb2JhbHMuZnJhbWV0aW1lKCkgKiA1KQogICAgCiAgICAgICAgICAgIG4yX3ggPSBoaXRsZXIubGVycChuMl94LCAxMSwgZ2xvYmFscy5mcmFtZXRpbWUoKSAqIDUpCiAgICAKICAgICAgICAgICAgbjNfeCA9IGhpdGxlci5sZXJwKG4zX3gsIDUsIGdsb2JhbHMuZnJhbWV0aW1lKCkgKiA1KQogICAgCiAgICAgICAgZWxzZQogICAgICAgICAgICB0ZXN0eCA9IGhpdGxlci5sZXJwKHRlc3R4LCAwLCBnbG9iYWxzLmZyYW1ldGltZSgpICogNSkKICAgIAogICAgICAgICAgICBuMl94ID0gaGl0bGVyLmxlcnAobjJfeCwgMCwgZ2xvYmFscy5mcmFtZXRpbWUoKSAqIDUpCiAgICAKICAgICAgICAgICAgbjNfeCA9IGhpdGxlci5sZXJwKG4zX3gsIDAsIGdsb2JhbHMuZnJhbWV0aW1lKCkgKiA1KQogICAgCiAgICAgICAgICAgIGZsYWcgPSAiYy0iCiAgICAgICAgICAgIHRpbmcgPSAyOAogICAgICAgIGVuZAogICAgCiAgICAgICAgaWYgaXNfZHQgdGhlbiBpZiBkdF9hPDI1NSB0aGVuIGR0X2E9ZHRfYSs1IGVuZDtpZiBkdF93PDEwIHRoZW4gZHRfdz1kdF93KzAuMjggZW5kO2lmIGR0X3k8MzYgdGhlbiBkdF95PWR0X3krMSBlbmQ7aWYgZnNfeDwxMSB0aGVuIGZzX3g9ZnNfeCswLjI1IGVuZCBlbHNlaWYgbm90IGlzX2R0IHRoZW4gaWYgZHRfYT4wIHRoZW4gZHRfYT1kdF9hLTUgZW5kO2lmIGR0X3c+MCB0aGVuIGR0X3c9ZHRfdy0wLjIgZW5kO2lmIGR0X3k+MjUgdGhlbiBkdF95PWR0X3ktMSBlbmQ7aWYgZnNfeD4wIHRoZW4gZnNfeD1mc194LTAuMjUgZW5kIGVuZDtpZiBpc19vcyBhbmQgbm90IGlzX2R0IHRoZW4gaWYgb3NfYTwyNTUgdGhlbiBvc19hPW9zX2ErNSBlbmQ7aWYgb3NfdzwxMiB0aGVuIG9zX3c9b3NfdyswLjI4IGVuZDtpZiBvc195PDM2IHRoZW4gb3NfeT1vc195KzEgZW5kO2lmIGZzX3g8MTIgdGhlbiBmc194PWZzX3grMC41IGVuZCBlbHNlaWYgbm90IGlzX29zIGFuZCBub3QgaXNfZHQgdGhlbiBpZiBvc19hPjAgdGhlbiBvc19hPW9zX2EtNSBlbmQ7aWYgb3Nfdz4wIHRoZW4gb3Nfdz1vc193LTAuMiBlbmQ7aWYgb3NfeT4yNSB0aGVuIG9zX3k9b3NfeS0xIGVuZDtpZiBmc194PjAgdGhlbiBmc194PWZzX3gtMC41IGVuZCBlbmQ7aWYgaXNfZnMgdGhlbiBpZiBmc193PDEwIHRoZW4gZnNfdz1mc193KzAuMzUgZW5kO2lmIGZzX2E8MjU1IHRoZW4gZnNfYT1mc19hKzUgZW5kO2lmIGR0X3g+LTcgdGhlbiBkdF94PWR0X3gtMC41IGVuZDtpZiBvc194Pi03IHRoZW4gb3NfeD1vc194LTAuNSBlbmQ7aWYgZnNfeTwzNiB0aGVuIGZzX3k9ZnNfeSsxIGVuZCBlbHNlaWYgbm90IGlzX2ZzIHRoZW4gaWYgZnNfYT4wIHRoZW4gZnNfYT1mc19hLTUgZW5kO2lmIGZzX3c+MCB0aGVuIGZzX3c9ZnNfdy0wLjIgZW5kO2lmIGR0X3g8MCB0aGVuIGR0X3g9ZHRfeCswLjUgZW5kO2lmIG9zX3g8MCB0aGVuIG9zX3g9b3NfeCswLjUgZW5kO2lmIGZzX3k+MjUgdGhlbiBmc195PWZzX3ktMSBlbmQgZW5kCiAgICAKICAgICAgICBpZiB1aS5nZXQobWVudS52aXN1YWxzVGFiLmluZGljYXRvcnMpID09ICJQaXhlbCIgYW5kIGZ1bmMuaW5jbHVkZXModWkuZ2V0KG1lbnUudmlzdWFsc1RhYi5WaXN1YWxzTXVsdGlzZWxlY3QpLCAiQ3Jvc3NoYWlyIEluZGljYXRvcnMiKSB0aGVuCiAgICAgICAgICAgIGlmIGlzX2R0IHRoZW4KICAgICAgICAgICAgICAgIHJlbmRlcmVyLnRleHQoeCAvIDIgLSAwLjUsIHkyIC8gMiArIG9zX3kgKyAxMCwgZHIsIGRnLCBkYiwgb3NfYSwgImMtIiwgb3NfdywgIiAiKQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICByZW5kZXJlci50ZXh0KHggLyAyIC0gMC41LCB5MiAvIDIgKyBvc195KyAxMCwgZHIsIGRnLCBkYiwgb3NfYSwgImMtIiwgb3NfdywgIk9TICIpCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICByZW5kZXJlci50ZXh0KHggLyAyIC0gMC41LCB5MiAvIDIgKyBkdF95KyAxMCwgZHIsIGRnLCBkYiwgZHRfYSwgImMtIiwgZHRfdywgIkRUIikKICAgIAogICAgICAgICAgICAtLXJlbmRlcmVyLnRleHQoeCAvIDIgLSAwLjUgKyBmc194ICsgbjNfeCwgeTIgLyAyICsgZnNfeSsgMTAsIDI1NSwgMjU1LCAyNTUsIGZzX2EsICJjLSIsIGZzX3csICJGUyIpCiAgICAKICAgICAgICAgICAgbG9jYWwgd3gsIHd5ID0gY2xpZW50LnNjcmVlbl9zaXplKCkKICAgICAgICAgICAgCiAgICAgICAgICAgIC0tcm91bmRfcmVjdCh3eCAtIDMwLCB3eSAtIHd5IC0gMTgwLCA4OSwgNTIsIDIzNSkKICAgIAogICAgICAgICAgICBsb2NhbCBkZXN5bmNfdHlwZSA9IGFudGlhaW1fZnVuY3MuZ2V0X292ZXJsYXAoZmxvYXQpCiAgICAgICAgICAgIGxvY2FsIGRlc3luY190eXBlMiA9IGFudGlhaW1fZnVuY3MuZ2V0X2Rlc3luYygyKQogICAgCiAgICAgICAgICAgIHJlbmRlcmVyLnRleHQoeCAvIDItMjgsIHkgLyAyICsgMjUsIG1yLG1nLG1iLCAyNTUsICItIiwgMCwgJ0JMVUhHQU5HJykKICAgICAgICAgICAgcmVuZGVyZXIudGV4dCh4IC8gMisxMywgeSAvIDIgKyAyNSwgMjU1LCAxNjEsIDE2MSwgMjU1LCAiLSIsIDAsIGxvZ2luLmJ1aWxkOnVwcGVyKCkpCiAgICAgICAgICAgIHJlbmRlcmVyLnRleHQod3ggLyAyLTEsIHkgLyAyICsgMzguNSAsIDI1NSwyNTUsMjU1LCAyNTUsICJjLSIsIDAsIHN0YXRlKQogICAgICAgICAgICByZW5kZXJlci50ZXh0KHggLyAyLTE1LCB5IC8gMiArIDQ3ICsgbjRfeCwgYnIsIGJnLCBiYiwgYmEsICJjLSIsIDAsICJCQUlNIikKICAgICAgICAgICAgcmVuZGVyZXIudGV4dCh4IC8gMiwgeSAvIDIgKyA0NyArIG40X3gsIHFyLHFnLHFiLHFhLCAiYy0iLCAwLCAiUVAiKQogICAgICAgICAgICByZW5kZXJlci50ZXh0KHggLyAyKzEwLCB5IC8gMiArIDQ3ICsgbjRfeCwgc3IsIHNnLCBzYiwgc2EsICJjLSIsIDAsICJTUCIpCiAgICAgICAgICAgIHJlbmRlcmVyLnRleHQoeCAvIDIrMjAsIHkgLyAyICsgNDcgKyBuNF94LCBmciwgZmcsIGZiLCBmYSwgImMtIiwgMCwgIkZTIikKICAgICAgICBlbmQKICAgIAogICAgICAgIGxvY2FsIGxvY2FscCA9IGVudGl0eS5nZXRfbG9jYWxfcGxheWVyKCkKICAgIAogICAgICAgIGxvY2FsIGJvZHl5YXcgPSBlbnRpdHkuZ2V0X3Byb3AobG9jYWxwLCAibV9mbFBvc2VQYXJhbWV0ZXIiLCAxMSkgKiAxMjAgLSA2MAogICAgICAgIC0tIOKvhyDir4gg4q+FIOKvhgogICAgCgllbmQKCiAgICAtLSBkcmF3IGRtZyBpbmRpY2F0b3IKICAgIGlmIGZ1bmMuaW5jbHVkZXModWkuZ2V0KG1lbnUudmlzdWFsc1RhYi5NaXNjTXVsdGlzZWxlY3QpLCAiTWluIERNRyBpbmRpY2F0b3IiKSBhbmQgZW50aXR5LmdldF9jbGFzc25hbWUod2VhcG9uKSB+PSAiQ0tuaWZlIiBhbmQgdWkuZ2V0KHJlZnMuZG1nT3ZlcnJpZGVbMV0pIGFuZCB1aS5nZXQocmVmcy5kbWdPdmVycmlkZVsyXSkgdGhlbgogICAgICAgIGxvY2FsIGRtZyA9IHVpLmdldChyZWZzLmRtZ092ZXJyaWRlWzNdKQogICAgICAgIHJlbmRlcmVyLnRleHQoc2l6ZVggLyAyICsgMiwgc2l6ZVkgLyAyIC0gMTQsIDI1NSwgMjU1LCAyNTUsIDI1NSwgImQiLCAwLCBkbWcpCiAgICBlbmQKCiAgICAtLSBkcmF3IHdhdGVybWFyawogICAgaWYgdWkuZ2V0KG1lbnUudmlzdWFsc1RhYi53YXRlcm1hcmspID09ICJEZWZhdWx0IiB0aGVuCiAgICAgICAgbG9jYWwgbWUgPSBlbnRpdHkuZ2V0X2xvY2FsX3BsYXllcigpCiAgICAgICAgaWYgbWUgPT0gbmlsIHRoZW4gcmV0dXJuIGVuZAogICAgICAgIGxvY2FsIHJyLGdnLGJiID0gODcsIDIzNSwgNjEKICAgICAgICBsb2NhbCB3aWR0aCwgaGVpZ2h0ID0gY2xpZW50LnNjcmVlbl9zaXplKCkKICAgICAgICBsb2NhbCByMiwgZzIsIGIyLCBhMiA9IDU1LCA1NSwgNTUsMjU1CiAgICAgICAgbG9jYWwgaGlnaGxpZ2h0X2ZyYWN0aW9uID0gIChnbG9iYWxzLnJlYWx0aW1lKCkgLyAyICUgMS4yICogMikgLSAxLjIKICAgICAgICBsb2NhbCBvdXRwdXQgPSAiIgogICAgICAgIGxvY2FsIHRleHRfdG9fZHJhdyA9ICJCIEwgVSBIIEcgQSBOIEciCiAgICAgICAgZm9yIGlkeCA9IDEsICN0ZXh0X3RvX2RyYXcgZG8KICAgICAgICAgICAgbG9jYWwgY2hhcmFjdGVyID0gdGV4dF90b19kcmF3OnN1YihpZHgsIGlkeCkKICAgICAgICAgICAgbG9jYWwgY2hhcmFjdGVyX2ZyYWN0aW9uID0gaWR4IC8gI3RleHRfdG9fZHJhdwogICAgICAgICAgICBsb2NhbCByMSwgZzEsIGIxLCBhMSA9IDI1NSwgMjU1LCAyNTUsIDI1NQogICAgICAgICAgICBsb2NhbCBoaWdobGlnaHRfZGVsdGEgPSAoY2hhcmFjdGVyX2ZyYWN0aW9uIC0gaGlnaGxpZ2h0X2ZyYWN0aW9uKQogICAgICAgICAgICBpZiBoaWdobGlnaHRfZGVsdGEgPj0gMCBhbmQgaGlnaGxpZ2h0X2RlbHRhIDw9IDEuNCB0aGVuCiAgICAgICAgICAgICAgICBpZiBoaWdobGlnaHRfZGVsdGEgPiAwLjcgdGhlbgogICAgICAgICAgICAgICAgaGlnaGxpZ2h0X2RlbHRhID0gMS40IC0gaGlnaGxpZ2h0X2RlbHRhCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGxvY2FsIHJfZnJhY3Rpb24sIGdfZnJhY3Rpb24sIGJfZnJhY3Rpb24sIGFfZnJhY3Rpb24gPSByMiAtIHIxLCBnMiAtIGcxLCBiMiAtIGIxCiAgICAgICAgICAgICAgICByMSA9IHIxICsgcl9mcmFjdGlvbiAqIGhpZ2hsaWdodF9kZWx0YSAvIDAuOAogICAgICAgICAgICAgICAgZzEgPSBnMSArIGdfZnJhY3Rpb24gKiBoaWdobGlnaHRfZGVsdGEgLyAwLjgKICAgICAgICAgICAgICAgIGIxID0gYjEgKyBiX2ZyYWN0aW9uICogaGlnaGxpZ2h0X2RlbHRhIC8gMC44CiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBvdXRwdXQgPSBvdXRwdXQgLi4gKCdcYSUwMnglMDJ4JTAyeCUwMnglcycpOmZvcm1hdChyMSwgZzEsIGIxLCAyNTUsIHRleHRfdG9fZHJhdzpzdWIoaWR4LCBpZHgpKQogICAgICAgIGVuZAogICAgICAgIG91dHB1dCA9IG91dHB1dAogICAgICAgIAogICAgICAgIGxvY2FsIHIsZyxiLGEgPSA4NywgMjM1LCA2MQogICAgICAgIGlmIHVpLmdldChtZW51LnZpc3VhbHNUYWIud2F0ZXJtYXJrUG9zaXRpb24pID09ICJMZWZ0IiB0aGVuCiAgICAgICAgICAgIHJlbmRlcmVyLnRleHQod2lkdGggLSAod2lkdGgtODApLCBoZWlnaHQgLSAoaGVpZ2h0LzIgLSBoZWlnaHQvMjApLCByLCBnLCBiLCAyNTUsICJjIiwgMCwgb3V0cHV0IC4uICcgXGFmYTU3NTdGRiBbYmV0YV0nKQogICAgICAgIGVsc2VpZiB1aS5nZXQobWVudS52aXN1YWxzVGFiLndhdGVybWFya1Bvc2l0aW9uKSA9PSAiQm90dG9tIiB0aGVuCiAgICAgICAgICAgIHJlbmRlcmVyLnRleHQod2lkdGggLSAod2lkdGgvMiksIGhlaWdodCAtIChoZWlnaHQvMzIpLCByLCBnLCBiLCAyNTUsICJjIiwgMCwgb3V0cHV0IC4uICcgXGFmYTU3NTdGRiBbYmV0YV0nKQogICAgICAgIGVsc2VpZiB1aS5nZXQobWVudS52aXN1YWxzVGFiLndhdGVybWFya1Bvc2l0aW9uKSA9PSAiUmlnaHQiIHRoZW4KICAgICAgICAgICAgcmVuZGVyZXIudGV4dCh3aWR0aC04MywgaGVpZ2h0IC0gKGhlaWdodC8yIC0gaGVpZ2h0LzIwKSwgciwgZywgYiwgMjU1LCAiYyIsIDAsIG91dHB1dCAuLiAnIFxhZmE1NzU3RkYgW2JldGFdJykKICAgICAgICBlbmQKICAgIGVuZAoKCiAgICAtLSBkcmF3IGxvZ3MKICAgIGxvY2FsIGNhbGxfYmFjayA9IHVpLmdldChtZW51LnZpc3VhbHNUYWIubG9ncykgYW5kIGNsaWVudC5zZXRfZXZlbnRfY2FsbGJhY2sgb3IgY2xpZW50LnVuc2V0X2V2ZW50X2NhbGxiYWNrCgogICAgbm90aWZpY2F0aW9ucy5yZW5kZXIoKQplbmQpCi0tIEByZWdpb24gSU5ESUNBVE9SUyBlbmQKCi0tQ29uc29sZQpsb2NhbCB1OCwgZGV2aWNlLCBsb2NhbGl6ZSwgc3VyZmFjZSwgbm90aWZ5ID0ge30sIHt9LCB7fSwge30sIHt9CgpkbyAKICAgIGZ1bmN0aW9uIHU4OmxlbihzKQogICAgICAgIHJldHVybiAjczpnc3ViKCJbXDEyOC1cMTkxXSIsICIiKTsKICAgIGVuZAoKICAgIGxvY2FsIHN0cmluZ19tb2Q7IGRvCiAgICAgICAgbG9jYWwgZmxvYXQgPSAwOwogICAgICAgIGxvY2FsIHRvX2FscGhhID0gMSAvIDI1NTsKCiAgICAgICAgbG9jYWwgZnVuY3Rpb24gZm4ocmdiLCBhbHBoYSkKICAgICAgICAgICAgcmV0dXJuIHN0cmluZy5mb3JtYXQoIiVzJTAyeCIsIHJnYiwgZmxvYXQgKiB0b251bWJlcihhbHBoYSwgMTYpKTsKICAgICAgICBlbmQKCiAgICAgICAgZnVuY3Rpb24gc3RyaW5nX21vZChzLCBhbHBoYSkKICAgICAgICAgICAgZmxvYXQgPSBhbHBoYSAqIHRvX2FscGhhOwogICAgICAgICAgICByZXR1cm4gczpnc3ViKCIoXGEleCV4JXgleCV4JXgpKCV4JXgpIiwgZm4pOwogICAgICAgIGVuZAogICAgZW5kCgogICAgZnVuY3Rpb24gZGV2aWNlOm9uX3VwZGF0ZSgpCiAgICAgICAgbG9jYWwgbmV3X3JlY3QgPSB2ZWN0b3IoY2xpZW50LnNjcmVlbl9zaXplKCkpOwoKICAgICAgICBpZiBuZXdfcmVjdCB+PSBzZWxmLnJlY3QgdGhlbgogICAgICAgICAgICBzZWxmLnJlY3QgPSBuZXdfcmVjdDsKICAgICAgICBlbmQKICAgIGVuZAoKICAgIGZ1bmN0aW9uIGRldmljZTpkcmF3X3RleHQoeCwgeSwgciwgZywgYiwgYSwgZmxhZ3MsIG1heF93aWR0aCwgLi4uKQogICAgICAgIGxvY2FsIHRleHQgPSB0YWJsZS5jb25jYXQgey4uLn07CiAgICAgICAgdGV4dCA9IHN0cmluZy5tb2QodGV4dCwgYSk7CgogICAgICAgIHJlbmRlcmVyLnRleHQoeCwgeSwgciwgZywgYiwgYSwgZmxhZ3MsIG1heF93aWR0aCwgdGV4dCk7CiAgICBlbmQKCiAgICBsb2NhbCBuYXRpdmVfQ29udmVydEFuc2lUb1VuaWNvZGUgPSB2dGFibGVfYmluZCgibG9jYWxpemUuZGxsIiwgIkxvY2FsaXplXzAwMSIsIDE1LCAiaW50KF9fdGhpc2NhbGwqKSh2b2lkKiB0aGlzcHRyLCBjb25zdCBjaGFyICphbnNpLCB3Y2hhcl90ICp1bmljb2RlLCBpbnQgYnVmZmVyX3NpemUpIikKICAgIGxvY2FsIG5hdGl2ZV9Db252ZXJ0VW5pY29kZVRvQW5zaSA9IHZ0YWJsZV9iaW5kKCJsb2NhbGl6ZS5kbGwiLCAiTG9jYWxpemVfMDAxIiwgMTYsICJpbnQoX190aGlzY2FsbCopKHZvaWQqIHRoaXNwdHIsIHdjaGFyX3QgKnVuaWNvZGUsIGNoYXIgKmFuc2ksIGludCBidWZmZXJfc2l6ZSkiKQoKICAgIGZ1bmN0aW9uIGxvY2FsaXplOmFuc2lfdG9fdW5pY29kZShhbnNpLCB1bmljb2RlLCBidWZmZXJfc2l6ZSkKICAgICAgICByZXR1cm4gbmF0aXZlX0NvbnZlcnRBbnNpVG9Vbmljb2RlKGFuc2ksIHVuaWNvZGUsIGJ1ZmZlcl9zaXplKTsKICAgIGVuZAoKICAgIGZ1bmN0aW9uIGxvY2FsaXplOnVuaWNvZGVfdG9fYW5zaShhbnNpLCB1bmljb2RlLCBidWZmZXJfc2l6ZSkKICAgICAgICByZXR1cm4gbmF0aXZlX0NvbnZlcnRVbmljb2RlVG9BbnNpKGFuc2ksIHVuaWNvZGUsIGJ1ZmZlcl9zaXplKTsKICAgIGVuZAoKICAgIGxvY2FsIG5hdGl2ZV9TZXRUZXh0Rm9udCA9IHZ0YWJsZV9iaW5kKCJ2Z3VpbWF0c3VyZmFjZS5kbGwiLCAiVkdVSV9TdXJmYWNlMDMxIiwgMjMsICJ2b2lkKihfX3RoaXNjYWxsKikodm9pZCAqdGhpc3B0ciwgZHdvcmQgZm9udF9pZCkiKTsKICAgIGxvY2FsIG5hdGl2ZV9TZXRUZXh0Q29sb3IgPSB2dGFibGVfYmluZCgidmd1aW1hdHN1cmZhY2UuZGxsIiwgIlZHVUlfU3VyZmFjZTAzMSIsIDI1LCAidm9pZCooX190aGlzY2FsbCopKHZvaWQgKnRoaXNwdHIsIGludCByLCBpbnQgZywgaW50IGIsIGludCBhKSIpOwogICAgbG9jYWwgbmF0aXZlX1NldFRleHRQb3MgPSB2dGFibGVfYmluZCgidmd1aW1hdHN1cmZhY2UuZGxsIiwgIlZHVUlfU3VyZmFjZTAzMSIsIDI2LCAidm9pZCooX190aGlzY2FsbCopKHZvaWQgKnRoaXNwdHIsIGludCB4LCBpbnQgeSkiKTsKICAgIGxvY2FsIG5hdGl2ZV9EcmF3UHJpbnRUZXh0ID0gdnRhYmxlX2JpbmQoInZndWltYXRzdXJmYWNlLmRsbCIsICJWR1VJX1N1cmZhY2UwMzEiLCAyOCwgInZvaWQqKF9fdGhpc2NhbGwqKSh2b2lkICp0aGlzcHRyLCBjb25zdCB3Y2hhcl90ICp0ZXh0LCBpbnQgbWF4bGVuLCBpbnQgZHJhd190eXBlKSIpOwoKICAgIGxvY2FsIG5hdGl2ZV9HZXRUZXh0U2l6ZSA9IHZ0YWJsZV9iaW5kKCJ2Z3VpbWF0c3VyZmFjZS5kbGwiLCAiVkdVSV9TdXJmYWNlMDMxIiwgNzksICJ2b2lkKF9fdGhpc2NhbGwqKSh2b2lkICp0aGlzcHRyLCBzaXplX3QgZm9udCwgY29uc3Qgd2NoYXJfdCAqdGV4dCwgaW50ICZ3aWRlLCBpbnQgJnRhbGwpIik7CgogICAgbG9jYWwgbmF0aXZlX0dldEZvbnROYW1lID0gdnRhYmxlX2JpbmQoInZndWltYXRzdXJmYWNlLmRsbCIsICJWR1VJX1N1cmZhY2UwMzEiLCAxMzQsICJjb25zdCBjaGFyKihfX3RoaXNjYWxsKikodm9pZCAqdGhpc3B0ciwgc2l6ZV90IGZvbnQpIik7CgogICAgbG9jYWwgYnVmZmVyID0gZmZpLm5ldygid2NoYXJfdFs2NTUzNV0iKTsKICAgIGxvY2FsIHdpZGUsIHRhbGwgPSBmZmkubmV3KCJpbnRbMV0iKSwgZmZpLm5ldygiaW50WzFdIik7CgogICAgbG9jYWwgdG9fYWxwaGEgPSAxIC8gMjU1OwoKICAgIGZ1bmN0aW9uIHN1cmZhY2U6Z2V0X2ZvbnRfbmFtZShmb250X2lkKQogICAgICAgIHJldHVybiBmZmkuc3RyaW5nKG5hdGl2ZV9HZXRGb250TmFtZShmb250X2lkKSk7CiAgICBlbmQKCiAgICBmdW5jdGlvbiBzdXJmYWNlOnRleHQoZm9udCwgeCwgeSwgciwgZywgYiwgYSwgLi4uKQogICAgICAgIGxvY2FsIHRleHQgPSB0YWJsZS5jb25jYXQgey4uLn07CiAgICAgICAgbG9jYWxpemU6YW5zaV90b191bmljb2RlKHRleHQsIGJ1ZmZlciwgNjU1MzUpOwoKICAgICAgICBuYXRpdmVfR2V0VGV4dFNpemUoZm9udCwgYnVmZmVyLCB3aWRlLCB0YWxsKTsKCiAgICAgICAgbmF0aXZlX1NldFRleHRGb250KGZvbnQpOwogICAgICAgIG5hdGl2ZV9TZXRUZXh0UG9zKHgsIHkpOwogICAgICAgIG5hdGl2ZV9TZXRUZXh0Q29sb3IociwgZywgYiwgYSk7CgogICAgICAgIG5hdGl2ZV9EcmF3UHJpbnRUZXh0KGJ1ZmZlciwgdTg6bGVuKHRleHQpLCAwKTsKCiAgICAgICAgcmV0dXJuIHdpZGVbMF0sIHRhbGxbMF07CiAgICBlbmQKCiAgICBmdW5jdGlvbiBzdXJmYWNlOmNvbG9yX3RleHQoZm9udCwgeCwgeSwgciwgZywgYiwgYSwgLi4uKQogICAgICAgIGxvY2FsIHRleHQgPSB0YWJsZS5jb25jYXQgey4uLn07CiAgICAgICAgbG9jYWwgaSwgaiA9IHRleHQ6ZmluZCAiXGEiOwoKICAgICAgICBpZiBpIH49IG5pbCB0aGVuCiAgICAgICAgICAgIHggPSB4ICsgc2VsZjp0ZXh0KGZvbnQsIHgsIHksIHIsIGcsIGIsIGEsIHRleHQ6c3ViKDEsIGkgLSAxKSkKCiAgICAgICAgICAgIHdoaWxlIGkgfj0gbmlsIGRvCiAgICAgICAgICAgICAgICBsb2NhbCBuZXdfciwgbmV3X2csIG5ld19iLCBuZXdfYSA9IHIsIGcsIGIsIGE7CgogICAgICAgICAgICAgICAgaWYgdGV4dDpzdWIoaSwgaiArIDcpID09ICJcYWRlZmF1bHQiIHRoZW4KICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gdGV4dDpzdWIoMSArIGogKyA3KTsKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICBsb2NhbCBoZXggPSB0ZXh0OnN1YihpICsgMSwgaiArIDgpOwogICAgICAgICAgICAgICAgICAgIHRleHQgPSB0ZXh0OnN1YigxICsgaiArIDgpOwoKICAgICAgICAgICAgICAgICAgICBuZXdfciwgbmV3X2csIG5ld19iLCBuZXdfYSA9IGZ1bmMuZnJnYmEoaGV4KTsKICAgICAgICAgICAgICAgICAgICBuZXdfYSA9IG5ld19hICogKGEgKiB0b19hbHBoYSk7CiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBpLCBqID0gdGV4dDpmaW5kICJcYSI7CgogICAgICAgICAgICAgICAgbG9jYWwgbmV3X3RleHQgPSB0ZXh0OwoKICAgICAgICAgICAgICAgIGlmIGkgfj0gbmlsIHRoZW4KICAgICAgICAgICAgICAgICAgICBuZXdfdGV4dCA9IHRleHQ6c3ViKDEsIGkgLSAxKTsKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIHggPSB4ICsgc2VsZjp0ZXh0KGZvbnQsIHgsIHksIG5ld19yLCBuZXdfZywgbmV3X2IsIG5ld19hLCBuZXdfdGV4dCk7CiAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIGVuZAoKICAgICAgICBzZWxmOnRleHQoZm9udCwgeCwgeSwgciwgZywgYiwgYSwgdGV4dCk7CiAgICBlbmQKCiAgICBsb2NhbCBuYXRpdmVfQ29uc29sZUlzVmlzaWJsZSA9IHZ0YWJsZV9iaW5kKCJlbmdpbmUuZGxsIiwgIlZFbmdpbmVDbGllbnQwMTQiLCAxMSwgImJvb2woX190aGlzY2FsbCopKHZvaWQqKSIpOwogICAgbG9jYWwgbmF0aXZlX0NvbG9yUHJpbnQgPSB2dGFibGVfYmluZCgidnN0ZGxpYi5kbGwiLCAiVkVuZ2luZUN2YXIwMDciLCAyNSwgInZvaWQoX19jZGVjbCopKHZvaWQqLCBjb25zdCBjb2xvcl90JiwgY29uc3QgY2hhciosIC4uLikiKTsKCiAgICBsb2NhbCBxdWV1ZSA9IHt9OwogICAgbG9jYWwgY3VycmVudDsKCiAgICBsb2NhbCB0aW1lcyA9IDY7CiAgICBsb2NhbCBkdXJhdGlvbiA9IDg7CgogICAgbG9jYWwgYnVmZmVyID0gZmZpLm5ldygiY29sb3JfdCIpOwogICAgbG9jYWwgdG9fYWxwaGEgPSAxIC8gMjU1OwoKICAgIGxvY2FsIGZ1bmN0aW9uIGNvbG9yX3ByaW50KHIsIGcsIGIsIGEsIC4uLikKICAgICAgICBidWZmZXIuciwgYnVmZmVyLmcsIGJ1ZmZlci5iLCBidWZmZXIuYSA9IHIsIGcsIGIsIGE7CiAgICAgICAgbmF0aXZlX0NvbG9yUHJpbnQoYnVmZmVyLCAuLi4pOwogICAgZW5kCgogICAgZnVuY3Rpb24gbm90aWZ5OmNvbG9yX2xvZyhyLCBnLCBiLCBhLCAuLi4pCiAgICAgICAgbG9jYWwgdGV4dCA9IHRhYmxlLmNvbmNhdCB7Li4ufTsKICAgICAgICBsb2NhbCBpLCBqID0gdGV4dDpmaW5kICJcYSI7CgogICAgICAgIGlmIGkgfj0gbmlsIHRoZW4KICAgICAgICAgICAgY29sb3JfcHJpbnQociwgZywgYiwgYSwgdGV4dDpzdWIoMSwgaSAtIDEpKTsKCiAgICAgICAgICAgIHdoaWxlIGkgfj0gbmlsIGRvCiAgICAgICAgICAgICAgICBsb2NhbCBuZXdfciwgbmV3X2csIG5ld19iLCBuZXdfYSA9IHIsIGcsIGIsIGE7CgogICAgICAgICAgICAgICAgaWYgdGV4dDpzdWIoaSwgaiArIDcpID09ICJcYWRlZmF1bHQiIHRoZW4KICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gdGV4dDpzdWIoMSArIGogKyA3KTsKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICBsb2NhbCBoZXggPSB0ZXh0OnN1YihpICsgMSwgaiArIDgpOwogICAgICAgICAgICAgICAgICAgIHRleHQgPSB0ZXh0OnN1YigxICsgaiArIDgpOwoKICAgICAgICAgICAgICAgICAgICBuZXdfciwgbmV3X2csIG5ld19iLCBuZXdfYSA9IHJnYmEoaGV4KTsKICAgICAgICAgICAgICAgICAgICBuZXdfYSA9IG5ld19hICogYSAqIHRvX2FscGhhOwogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgaSwgaiA9IHRleHQ6ZmluZCAiXGEiOwoKICAgICAgICAgICAgICAgIGxvY2FsIG5ld190ZXh0ID0gdGV4dDsKCiAgICAgICAgICAgICAgICBpZiBpIH49IG5pbCB0aGVuCiAgICAgICAgICAgICAgICAgICAgbmV3X3RleHQgPSB0ZXh0OnN1YigxLCBpIC0gMSk7CiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBjb2xvcl9wcmludChuZXdfciwgbmV3X2csIG5ld19iLCBuZXdfYSwgbmV3X3RleHQpOwogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIGNvbG9yX3ByaW50KDAsIDAsIDAsIDAsICJcbiIpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgZW5kCgogICAgICAgIGNvbG9yX3ByaW50KHIsIGcsIGIsIGEsIHRleHQgLi4gIlxuIik7CiAgICBlbmQKCiAgICBmdW5jdGlvbiBub3RpZnk6YWRkX3RvX3F1ZXVlKHIsIGcsIGIsIGEsIC4uLikKICAgICAgICBsb2NhbCB0ZXh0ID0gdGFibGUuY29uY2F0IHsuLi59OwoKICAgICAgICBsb2NhbCB0aGlzID0KICAgICAgICB7CiAgICAgICAgICAgIHRleHQgPSB0ZXh0LAogICAgICAgICAgICBjb2xvdXIgPSB7ciwgZywgYiwgYX0sCiAgICAgICAgICAgIGNvbG9yZWQgPSB0cnVlLAogICAgICAgICAgICBsaWZlcmVtYWluaW5nID0gZHVyYXRpb24KICAgICAgICB9OwoKICAgICAgICBxdWV1ZVsjcXVldWUgKyAxXSA9IHRoaXM7CgogICAgICAgIHdoaWxlICNxdWV1ZSA+IHRpbWVzIGRvCiAgICAgICAgICAgIHRhYmxlLnJlbW92ZShxdWV1ZSwgMSk7CiAgICAgICAgZW5kCgogICAgICAgIHJldHVybiB0aGlzOwogICAgZW5kCgogICAgZnVuY3Rpb24gbm90aWZ5OnNob3VsZF9kcmF3KCkKICAgICAgICBsb2NhbCBpc192aXNpYmxlID0gZmFsc2U7CiAgICAgICAgbG9jYWwgaG9zdF9mcmFtZXRpbWUgPSBnbG9iYWxzLmZyYW1ldGltZSgpOwoKICAgICAgICBpZiBub3QgbmF0aXZlX0NvbnNvbGVJc1Zpc2libGUoKSB0aGVuCiAgICAgICAgICAgIGZvciBpID0gI3F1ZXVlLCAxLCAtMSBkbwogICAgICAgICAgICAgICAgbG9jYWwgdiA9IHF1ZXVlW2ldOwogICAgICAgICAgICAgICAgdi5saWZlcmVtYWluaW5nID0gdi5saWZlcmVtYWluaW5nIC0gaG9zdF9mcmFtZXRpbWU7CgogICAgICAgICAgICAgICAgaWYgdi5saWZlcmVtYWluaW5nIDw9IDAgdGhlbgogICAgICAgICAgICAgICAgICAgIHRhYmxlLnJlbW92ZShxdWV1ZSwgaSk7CiAgICAgICAgICAgICAgICAgICAgZ290byBjb250aW51ZTsKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIGlzX3Zpc2libGUgPSB0cnVlOwogICAgICAgICAgICAgICAgOjpjb250aW51ZTo6CiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAoKICAgICAgICByZXR1cm4gaXNfdmlzaWJsZTsKICAgIGVuZAoKICAgIGZ1bmN0aW9uIG5vdGlmeTpvbl9wYWludF91aSgpCiAgICAgICAgbG9jYWwgeCwgeSA9IDgsIDU7CiAgICAgICAgbG9jYWwgZmxhZ3MgPSAiZCI7CgogICAgICAgIGZvciBpID0gMSwgI3F1ZXVlIGRvCiAgICAgICAgICAgIGxvY2FsIHYgPSBxdWV1ZVtpXTsKCiAgICAgICAgICAgIGxvY2FsIGNvbG91ciA9IHYuY29sb3VyOwogICAgICAgICAgICBsb2NhbCByLCBnLCBiLCBhID0gY29sb3VyWzFdLCBjb2xvdXJbMl0sIGNvbG91clszXSwgY29sb3VyWzRdOwoKICAgICAgICAgICAgbG9jYWwgdGV4dCA9IHYudGV4dDpnc3ViKCJcbiIsICIiKTsKICAgICAgICAgICAgbG9jYWwgbWVhc3VyZSA9IHZlY3RvcihyZW5kZXJlci5tZWFzdXJlX3RleHQoZmxhZ3MsIHRleHQpKTsKCiAgICAgICAgICAgIGxvY2FsIHRhbGwgPSBtZWFzdXJlLnkgKyAxOwoKICAgICAgICAgICAgaWYgdi5saWZlcmVtYWluaW5nIDwgLjUgdGhlbgogICAgICAgICAgICAgICAgbG9jYWwgZiA9IGZ1bmMuZmNsYW1wKHYubGlmZXJlbWFpbmluZywgMCwgLjUpIC8gLjU7CiAgICAgICAgICAgICAgICBhID0gYSAqIGY7CgogICAgICAgICAgICAgICAgaWYgaSA9PSAxIGFuZCBmIDwgLjIgdGhlbgogICAgICAgICAgICAgICAgICAgIHkgPSB5IC0gdGFsbCAqICgxIC0gZiAvIC4yKTsKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIGlmIHYuY29sb3JlZCB0aGVuCiAgICAgICAgICAgICAgICBzdXJmYWNlOmNvbG9yX3RleHQoNjMsIHgsIHksIHIsIGcsIGIsIGEsIHRleHQpOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBzdXJmYWNlOnRleHQoNjMsIHgsIHksIHIsIGcsIGIsIGEsIHRleHQpOwogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIHkgPSB5ICsgdGFsbDsKICAgICAgICBlbmQKICAgIGVuZAoKICAgIGZ1bmN0aW9uIG5vdGlmeTpvbl9vdXRwdXQoZSkKICAgICAgICBsb2NhbCB0ZXh0ID0gc3RyaW5nLmZvcm1hdCgiXGElMDJ4JTAyeCUwMnglMDJ4JXMiLCBlLnIsIGUuZywgZS5iLCBlLmEsIGUudGV4dCk7CiAgICAgICAgbG9jYWwgaSA9IHRleHQ6ZmluZCAiXDAiOwoKICAgICAgICBpZiBpIH49IG5pbCB0aGVuCiAgICAgICAgICAgIHRleHQgPSB0ZXh0OnN1YigxLCBpIC0gMSk7CiAgICAgICAgZW5kCgogICAgICAgIGlmIGN1cnJlbnQgfj0gbmlsIHRoZW4KICAgICAgICAgICAgY3VycmVudC50ZXh0ID0gY3VycmVudC50ZXh0IC4uIHRleHQ7CgogICAgICAgICAgICBpZiBpID09IG5pbCB0aGVuCiAgICAgICAgICAgICAgICBjdXJyZW50ID0gbmlsOwogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIHJldHVybiBjdXJyZW50OwogICAgICAgIGVuZAoKICAgICAgICBsb2NhbCB0aGlzID0gc2VsZjphZGRfdG9fcXVldWUoZS5yLCBlLmcsIGUuYiwgZS5hLCB0ZXh0KTsKICAgICAgICB0aGlzLmNvbG9yZWQgPSB0ZXh0OmZpbmQgIlxhIiB+PSBuaWw7CgogICAgICAgIGlmIGkgfj0gbmlsIHRoZW4KICAgICAgICAgICAgY3VycmVudCA9IHRoaXM7CiAgICAgICAgZW5kCgogICAgICAgIHJldHVybiB0aGlzOwogICAgZW5kCgogICAgZnVuY3Rpb24gbm90aWZ5Om9uX2NvbnNvbGVfaW5wdXQoZSkKICAgICAgICBpZiBlOmZpbmQoImNsZWFyIikgPT0gMSB0aGVuCiAgICAgICAgICAgIGZvciBpID0gMSwgI3F1ZXVlIGRvCiAgICAgICAgICAgICAgICBxdWV1ZVtpXSA9IG5pbDsKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKZW5kCgpkZXZpY2U6b25fdXBkYXRlKCkKCmNsaWVudC5zZXRfZXZlbnRfY2FsbGJhY2soInBhaW50X3VpIiwgZnVuY3Rpb24oKQogICAgaWYgbm90IHVpLmdldChtZW51LnZpc3VhbHNUYWIuZGV2UHJpbnQpIHRoZW4gcmV0dXJuIGVuZAogICAgZGV2aWNlOm9uX3VwZGF0ZSgpCiAgICBub3RpZnk6c2hvdWxkX2RyYXcoKQogICAgbm90aWZ5Om9uX3BhaW50X3VpKCkKZW5kKQoKY2xpZW50LnNldF9ldmVudF9jYWxsYmFjaygib3V0cHV0IiwgZnVuY3Rpb24oZSkKICAgIG5vdGlmeTpvbl9vdXRwdXQoZSkKZW5kKQoKY2xpZW50LnNldF9ldmVudF9jYWxsYmFjaygiY29uc29sZV9pbnB1dCIsIGZ1bmN0aW9uKGUpCiAgICBpZiBub3QgdWkuZ2V0KG1lbnUudmlzdWFsc1RhYi5kZXZQcmludCkgdGhlbiByZXR1cm4gZW5kCiAgICBub3RpZnk6b25fY29uc29sZV9pbnB1dChlKQplbmQpCgp1aS5zZXRfY2FsbGJhY2sobWVudS52aXN1YWxzVGFiLmRldlByaW50LCBmdW5jdGlvbigpIAogICAgbG9jYWwgY2FsbGJhY2sgPSB1aS5nZXQobWVudS52aXN1YWxzVGFiLmRldlByaW50KSBhbmQgY2xpZW50LnNldF9ldmVudF9jYWxsYmFjayBvciBjbGllbnQudW5zZXRfZXZlbnRfY2FsbGJhY2sKICAgIGNhbGxiYWNrKCJvdXRwdXQiLCBmdW5jdGlvbihlKSBub3RpZnk6b25fb3V0cHV0KGUpIGVuZCkKZW5kKQoKLS0gQHJlZ2lvbiBVSV9DQUxMQkFDS1Mgc3RhcnQKdWkudXBkYXRlKG1lbnUuY29uZmlnVGFiLmxpc3QsZ2V0Q29uZmlnTGlzdCgpKQppZiBkYXRhYmFzZS5yZWFkKGx1YS5kYXRhYmFzZS5jb25maWdzKSA9PSBuaWwgdGhlbgogICAgZGF0YWJhc2Uud3JpdGUobHVhLmRhdGFiYXNlLmNvbmZpZ3MsIHt9KQplbmQKdWkuc2V0KG1lbnUuY29uZmlnVGFiLm5hbWUsICNkYXRhYmFzZS5yZWFkKGx1YS5kYXRhYmFzZS5jb25maWdzKSA9PSAwIGFuZCAiIiBvciBkYXRhYmFzZS5yZWFkKGx1YS5kYXRhYmFzZS5jb25maWdzKVt1aS5nZXQobWVudS5jb25maWdUYWIubGlzdCkrMV0ubmFtZSkKdWkuc2V0X2NhbGxiYWNrKG1lbnUuY29uZmlnVGFiLmxpc3QsIGZ1bmN0aW9uKHZhbHVlKQogICAgbG9jYWwgcHJvdGVjdGVkID0gZnVuY3Rpb24oKQogICAgICAgIGlmIHZhbHVlID09IG5pbCB0aGVuIHJldHVybiBlbmQKICAgICAgICBsb2NhbCBuYW1lID0gIiIKICAgIAogICAgICAgIGxvY2FsIGNvbmZpZ3MgPSBnZXRDb25maWdMaXN0KCkKICAgICAgICBpZiBjb25maWdzID09IG5pbCB0aGVuIHJldHVybiBlbmQKICAgIAogICAgICAgIG5hbWUgPSBjb25maWdzW3VpLmdldCh2YWx1ZSkrMV0gb3IgIiIKICAgIAogICAgICAgIHVpLnNldChtZW51LmNvbmZpZ1RhYi5uYW1lLCBuYW1lKQogICAgZW5kCgogICAgaWYgcGNhbGwocHJvdGVjdGVkKSB0aGVuCgogICAgZW5kCmVuZCkKCnVpLnNldF9jYWxsYmFjayhtZW51LmNvbmZpZ1RhYi5sb2FkLCBmdW5jdGlvbigpCiAgICBsb2NhbCByLCBnLCBiID0gdWkuZ2V0KG1lbnUudmlzdWFsc1RhYi5sb2dzQ2xyKQogICAgbG9jYWwgbmFtZSA9IHVpLmdldChtZW51LmNvbmZpZ1RhYi5uYW1lKQogICAgaWYgbmFtZSA9PSAiIiB0aGVuIHJldHVybiBlbmQKCiAgICBsb2NhbCBwcm90ZWN0ZWQgPSBmdW5jdGlvbigpCiAgICAgICAgbG9hZENvbmZpZyhuYW1lKQogICAgZW5kCgogICAgaWYgcGNhbGwocHJvdGVjdGVkKSB0aGVuCiAgICAgICAgbmFtZSA9IG5hbWU6Z3N1YignKicsICcnKQogICAgICAgIG5vdGlmaWNhdGlvbnMubmV3KHN0cmluZy5mb3JtYXQoJ1N1Y2Nlc3NmdWxseSBsb2FkZWQgIiQlcyQiJywgbmFtZSksIHIsIGcsIGIpCiAgICBlbHNlCiAgICAgICAgbm90aWZpY2F0aW9ucy5uZXcoc3RyaW5nLmZvcm1hdCgnRmFpbGVkIHRvIGxvYWQgIiQlcyQiJywgbmFtZSksIDI1NSwgMTIwLCAxMjApCiAgICBlbmQKZW5kKQoKdWkuc2V0X2NhbGxiYWNrKG1lbnUuY29uZmlnVGFiLnNhdmUsIGZ1bmN0aW9uKCkKICAgIGxvY2FsIHIsIGcsIGIgPSB1aS5nZXQobWVudS52aXN1YWxzVGFiLmxvZ3NDbHIpCgogICAgbG9jYWwgbmFtZSA9IHVpLmdldChtZW51LmNvbmZpZ1RhYi5uYW1lKQogICAgaWYgbmFtZSA9PSAiIiB0aGVuIHJldHVybiBlbmQKCiAgICBmb3IgaSwgdiBpbiBwYWlycyhwcmVzZXRzKSBkbwogICAgICAgIGlmIHYubmFtZSA9PSBuYW1lOmdzdWIoJyonLCAnJykgdGhlbgogICAgICAgICAgICBub3RpZmljYXRpb25zLm5ldyhzdHJpbmcuZm9ybWF0KCdZb3UgY2FuYHQgc2F2ZSBidWlsdC1pbiBwcmVzZXQgIiQlcyQiJywgbmFtZTpnc3ViKCcqJywgJycpKSwgMjU1LCAxMjAsIDEyMCkKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZW5kCiAgICBlbmQKCiAgICBpZiBuYW1lOm1hdGNoKCJbXiV3XSIpIH49IG5pbCB0aGVuCiAgICAgICAgbm90aWZpY2F0aW9ucy5uZXcoc3RyaW5nLmZvcm1hdCgnRmFpbGVkIHRvIHNhdmUgIiQlcyQiIGR1ZSB0byBpbnZhbGlkIGNoYXJhY3RlcnMnLCBuYW1lKSwgMjU1LCAxMjAsIDEyMCkKICAgICAgICByZXR1cm4KICAgIGVuZAoKICAgIGxvY2FsIHByb3RlY3RlZCA9IGZ1bmN0aW9uKCkKICAgICAgICBzYXZlQ29uZmlnKG5hbWUpCiAgICAgICAgdWkudXBkYXRlKG1lbnUuY29uZmlnVGFiLmxpc3QsIGdldENvbmZpZ0xpc3QoKSkKICAgIGVuZAogICAgaWYgcGNhbGwocHJvdGVjdGVkKSB0aGVuCiAgICAgICAgbm90aWZpY2F0aW9ucy5uZXcoc3RyaW5nLmZvcm1hdCgnU3VjY2Vzc2Z1bGx5IHNhdmVkICIkJXMkIicsIG5hbWUpLCByLCBnLCBiKQogICAgZWxzZQogICAgICAgIG5vdGlmaWNhdGlvbnMubmV3KHN0cmluZy5mb3JtYXQoJ0ZhaWxlZCB0byBzYXZlICIkJXMkIicsIG5hbWUpLCAyNTUsIDEyMCwgMTIwKQogICAgZW5kCmVuZCkKCnVpLnNldF9jYWxsYmFjayhtZW51LmNvbmZpZ1RhYi5kZWxldGUsIGZ1bmN0aW9uKCkKICAgIGxvY2FsIG5hbWUgPSB1aS5nZXQobWVudS5jb25maWdUYWIubmFtZSkKICAgIGlmIG5hbWUgPT0gIiIgdGhlbiByZXR1cm4gZW5kCiAgICBsb2NhbCByLCBnLCBiID0gdWkuZ2V0KG1lbnUudmlzdWFsc1RhYi5sb2dzQ2xyKQogICAgaWYgZGVsZXRlQ29uZmlnKG5hbWUpID09IGZhbHNlIHRoZW4KICAgICAgICBub3RpZmljYXRpb25zLm5ldyhzdHJpbmcuZm9ybWF0KCdGYWlsZWQgdG8gZGVsZXRlICIkJXMkIicsIG5hbWUpLCAyNTUsIDEyMCwgMTIwKQogICAgICAgIHVpLnVwZGF0ZShtZW51LmNvbmZpZ1RhYi5saXN0LCBnZXRDb25maWdMaXN0KCkpCiAgICAgICAgcmV0dXJuCiAgICBlbmQKCiAgICBmb3IgaSwgdiBpbiBwYWlycyhwcmVzZXRzKSBkbwogICAgICAgIGlmIHYubmFtZSA9PSBuYW1lOmdzdWIoJyonLCAnJykgdGhlbgogICAgICAgICAgICBub3RpZmljYXRpb25zLm5ldyhzdHJpbmcuZm9ybWF0KCdZb3UgY2FuYHQgZGVsZXRlIGJ1aWx0LWluIHByZXNldCAiJCVzJCInLCBuYW1lOmdzdWIoJyonLCAnJykpLCAyNTUsIDEyMCwgMTIwKQogICAgICAgICAgICByZXR1cm4KICAgICAgICBlbmQKICAgIGVuZAoKICAgIGxvY2FsIHByb3RlY3RlZCA9IGZ1bmN0aW9uKCkKICAgICAgICBkZWxldGVDb25maWcobmFtZSkKICAgIGVuZAoKICAgIGlmIHBjYWxsKHByb3RlY3RlZCkgdGhlbgogICAgICAgIHVpLnVwZGF0ZShtZW51LmNvbmZpZ1RhYi5saXN0LCBnZXRDb25maWdMaXN0KCkpCiAgICAgICAgdWkuc2V0KG1lbnUuY29uZmlnVGFiLmxpc3QsICNwcmVzZXRzICsgI2RhdGFiYXNlLnJlYWQobHVhLmRhdGFiYXNlLmNvbmZpZ3MpIC0gI2RhdGFiYXNlLnJlYWQobHVhLmRhdGFiYXNlLmNvbmZpZ3MpKQogICAgICAgIHVpLnNldChtZW51LmNvbmZpZ1RhYi5uYW1lLCAjZGF0YWJhc2UucmVhZChsdWEuZGF0YWJhc2UuY29uZmlncykgPT0gMCBhbmQgIiIgb3IgZ2V0Q29uZmlnTGlzdCgpWyNwcmVzZXRzICsgI2RhdGFiYXNlLnJlYWQobHVhLmRhdGFiYXNlLmNvbmZpZ3MpIC0gI2RhdGFiYXNlLnJlYWQobHVhLmRhdGFiYXNlLmNvbmZpZ3MpKzFdKQogICAgICAgIG5vdGlmaWNhdGlvbnMubmV3KHN0cmluZy5mb3JtYXQoJ1N1Y2Nlc3NmdWxseSBkZWxldGVkICIkJXMkIicsIG5hbWUpLCByLCBnLCBiKQogICAgZW5kCmVuZCkKCnVpLnNldF9jYWxsYmFjayhtZW51LmNvbmZpZ1RhYi5pbXBvcnQsIGZ1bmN0aW9uKCkKICAgIGxvY2FsIHIsIGcsIGIgPSB1aS5nZXQobWVudS52aXN1YWxzVGFiLmxvZ3NDbHIpCgogICAgbG9jYWwgcHJvdGVjdGVkID0gZnVuY3Rpb24oKQogICAgICAgIGltcG9ydFNldHRpbmdzKCkKICAgIGVuZAoKICAgIGlmIHBjYWxsKHByb3RlY3RlZCkgdGhlbgogICAgICAgIG5vdGlmaWNhdGlvbnMubmV3KHN0cmluZy5mb3JtYXQoJ1N1Y2Nlc3NmdWxseSBpbXBvcnRlZCBzZXR0aW5ncycsIG5hbWUpLCByLCBnLCBiKQogICAgZWxzZQogICAgICAgIG5vdGlmaWNhdGlvbnMubmV3KHN0cmluZy5mb3JtYXQoJ0ZhaWxlZCB0byBpbXBvcnQgc2V0dGluZ3MnLCBuYW1lKSwgMjU1LCAxMjAsIDEyMCkKICAgIGVuZAplbmQpCgp1aS5zZXRfY2FsbGJhY2sobWVudS5jb25maWdUYWIuZXhwb3J0LCBmdW5jdGlvbigpCiAgICBsb2NhbCBuYW1lID0gdWkuZ2V0KG1lbnUuY29uZmlnVGFiLm5hbWUpCiAgICBpZiBuYW1lID09ICIiIHRoZW4gcmV0dXJuIGVuZAoKICAgIGxvY2FsIHByb3RlY3RlZCA9IGZ1bmN0aW9uKCkKICAgICAgICBleHBvcnRTZXR0aW5ncyhuYW1lKQogICAgZW5kCiAgICBsb2NhbCByLCBnLCBiID0gdWkuZ2V0KG1lbnUudmlzdWFsc1RhYi5sb2dzQ2xyKQoKICAgIGlmIHBjYWxsKHByb3RlY3RlZCkgdGhlbgogICAgICAgIG5vdGlmaWNhdGlvbnMubmV3KHN0cmluZy5mb3JtYXQoJ1N1Y2Nlc3NmdWxseSBleHBvcnRlZCBzZXR0aW5ncycsIG5hbWUpLCByLCBnLCBiKQogICAgZWxzZQogICAgICAgIG5vdGlmaWNhdGlvbnMubmV3KHN0cmluZy5mb3JtYXQoJ0ZhaWxlZCB0byBleHBvcnQgc2V0dGluZ3MnLCBuYW1lKSwgMjU1LCAxMjAsIDEyMCkKICAgIGVuZAplbmQpCgpsb2NhbCBsb2dpY2ExMzM3ID0gIjIiCgp1aS5zZXRfY2FsbGJhY2sobWVudS5idWlsZGVyVGFiLlByZXNldENvbWJvQm94LCBmdW5jdGlvbigpCiAgICBpZiB1aS5nZXQobWVudS5idWlsZGVyVGFiLlByZXNldENvbWJvQm94KSA9PSAiW2JldGFdIHNjYWxldmlsbGFpbiIgdGhlbgogICAgICAgIGxvY2FsIHIsIGcsIGIgPSB1aS5nZXQobWVudS52aXN1YWxzVGFiLmxvZ3NDbHIpCgogICAgICAgIGxvY2FsIHByb3RlY3RlZCA9IGZ1bmN0aW9uKCkKICAgICAgICAgICAgaW1wb3J0UHJlc2V0KCkKICAgICAgICBlbmQKCiAgICAgICAgaWYgcGNhbGwocHJvdGVjdGVkKSB0aGVuCiAgICAgICAgICAgIG5vdGlmaWNhdGlvbnMubmV3KHN0cmluZy5mb3JtYXQoJ1N1Y2Nlc3NmdWxseSBlbmFibGVkIFtiZXRhXSBzY2FsZXZpbGxhaW4nLCBuYW1lKSwgciwgZywgYikKICAgICAgICBlbHNlCiAgICAgICAgICAgIG5vdGlmaWNhdGlvbnMubmV3KHN0cmluZy5mb3JtYXQoJ0Vycm9yIHdpdGggcHJlc2V0cyBzY2FsZXZpbGxhaW4sIGJ1Z3JlcG9ydCB0aGlzIHBsZWFzZScsIG5hbWUpLCAyNTUsIDEyMCwgMTIwKQogICAgICAgIGVuZAogICAgZW5kCmVuZCkKCnVpLnNldF9jYWxsYmFjayhtZW51LmJ1aWxkZXJUYWIuYnV0dG9uUHJlc2V0cywgZnVuY3Rpb24oKQogICAgbG9jYWwgciwgZywgYiA9IHVpLmdldChtZW51LnZpc3VhbHNUYWIubG9nc0NscikKCiAgICBsb2NhbCBwcm90ZWN0ZWQgPSBmdW5jdGlvbigpCiAgICAgICAgdWkuc2V0KG1lbnUuYnVpbGRlclRhYi5Mb2dpY0NvbWJvQm94LCAiMiIpCiAgICBlbmQKCiAgICBpZiBwY2FsbChwcm90ZWN0ZWQpIHRoZW4KICAgICAgICBub3RpZmljYXRpb25zLm5ldyhzdHJpbmcuZm9ybWF0KCdTdWNjZXNzZnVsbHkgZW5hYmxlZCBwcmVzZXRzIG1vZGUnLCBuYW1lKSwgciwgZywgYikKICAgIGVsc2UKICAgICAgICBub3RpZmljYXRpb25zLm5ldyhzdHJpbmcuZm9ybWF0KCdGYWlsZWQgdG8gZW5hYmxlIHByZXNldHMgbW9kZScsIG5hbWUpLCAyNTUsIDEyMCwgMTIwKQogICAgZW5kCmVuZCkKCnVpLnNldF9jYWxsYmFjayhtZW51LmJ1aWxkZXJUYWIuYnV0dG9uQnVpbGRlciwgZnVuY3Rpb24oKQogICAgbG9jYWwgciwgZywgYiA9IHVpLmdldChtZW51LnZpc3VhbHNUYWIubG9nc0NscikKCiAgICBsb2NhbCBwcm90ZWN0ZWQgPSBmdW5jdGlvbigpCiAgICAgICAgdWkuc2V0KG1lbnUuYnVpbGRlclRhYi5Mb2dpY0NvbWJvQm94LCAiMSIpCiAgICAgICAgdWkuc2V0KG1lbnUuYnVpbGRlclRhYi5QcmVzZXRDb21ib0JveCwgIkRpc2FibGVkIikKICAgICAgICBpbXBvcnRQcmVzZXRDbGVhcigpCiAgICBlbmQKCiAgICBpZiBwY2FsbChwcm90ZWN0ZWQpIHRoZW4KICAgICAgICBub3RpZmljYXRpb25zLm5ldyhzdHJpbmcuZm9ybWF0KCdTdWNjZXNzZnVsbHkgZW5hYmxlZCBidWlsZGVyIG1vZGUnLCBuYW1lKSwgciwgZywgYikKICAgIGVsc2UKICAgICAgICBub3RpZmljYXRpb25zLm5ldyhzdHJpbmcuZm9ybWF0KCdGYWlsZWQgdG8gZW5hYmxlIGJ1aWxkZXIgbW9kZScsIG5hbWUpLCAyNTUsIDEyMCwgMTIwKQogICAgZW5kCmVuZCkKCi0tIEByZWdpb24gVUlfQ0FMTEJBQ0tTIGVuZAoKbG9jYWwgdWlmaXggPSB7CiAgICBuZXdsaW5lMTkgPSB1aS5uZXdfbGFiZWwoJ0FBJywgJ0FudGktYWltYm90IGFuZ2xlcycsICdcbicsICdzdHJpbmcnKSwKICAgIG5ld2xpbmUxNCA9IHVpLm5ld19sYWJlbCgnQUEnLCAnQW50aS1haW1ib3QgYW5nbGVzJywgJ1xuJywgJ3N0cmluZycpLAogICAgbmV3bGluZTE1ID0gdWkubmV3X2xhYmVsKCdBQScsICdBbnRpLWFpbWJvdCBhbmdsZXMnLCAnXG4nLCAnc3RyaW5nJyksCiAgICBuZXdsaW5lMTYgPSB1aS5uZXdfbGFiZWwoJ0FBJywgJ0FudGktYWltYm90IGFuZ2xlcycsICdcbicsICdzdHJpbmcnKSwKICAgIG5ld2xpbmUxNyA9IHVpLm5ld19sYWJlbCgnQUEnLCAnQW50aS1haW1ib3QgYW5nbGVzJywgJ1xuJywgJ3N0cmluZycpLAogICAgbmV3bGluZTE4ID0gdWkubmV3X2xhYmVsKCdBQScsICdBbnRpLWFpbWJvdCBhbmdsZXMnLCAnXG4nLCAnc3RyaW5nJyksCiAgICBuZXdsaW5lMTkzID0gdWkubmV3X2xhYmVsKCdBQScsICdBbnRpLWFpbWJvdCBhbmdsZXMnLCAnXG4nLCAnc3RyaW5nJyksCiAgICBuZXdsaW5lMTQzID0gdWkubmV3X2xhYmVsKCdBQScsICdBbnRpLWFpbWJvdCBhbmdsZXMnLCAnXG4nLCAnc3RyaW5nJyksCiAgICBuZXdsaW5lMTUzID0gdWkubmV3X2xhYmVsKCdBQScsICdBbnRpLWFpbWJvdCBhbmdsZXMnLCAnXG4nLCAnc3RyaW5nJyksCiAgICBuZXdsaW5lMTYzID0gdWkubmV3X2xhYmVsKCdBQScsICdBbnRpLWFpbWJvdCBhbmdsZXMnLCAnXG4nLCAnc3RyaW5nJyksCiAgICBuZXdsaW5lMTczID0gdWkubmV3X2xhYmVsKCdBQScsICdBbnRpLWFpbWJvdCBhbmdsZXMnLCAnXG4nLCAnc3RyaW5nJyksCiAgICBuZXdsaW5lMTgzID0gdWkubmV3X2xhYmVsKCdBQScsICdBbnRpLWFpbWJvdCBhbmdsZXMnLCAnXG4nLCAnc3RyaW5nJyksCiAgICBuZXdsaW5lMTczMiA9IHVpLm5ld19sYWJlbCgnQUEnLCAnQW50aS1haW1ib3QgYW5nbGVzJywgJ1xuJywgJ3N0cmluZycpLAogICAgbmV3bGluZTE4MzIgPSB1aS5uZXdfbGFiZWwoJ0FBJywgJ0FudGktYWltYm90IGFuZ2xlcycsICdcbicsICdzdHJpbmcnKSwKICAgIG5ld2xpbmUxNzMxID0gdWkubmV3X2xhYmVsKCdBQScsICdBbnRpLWFpbWJvdCBhbmdsZXMnLCAnXG4nLCAnc3RyaW5nJyksCiAgICBuZXdsaW5lMTgzMSA9IHVpLm5ld19sYWJlbCgnQUEnLCAnQW50aS1haW1ib3QgYW5nbGVzJywgJ1xuJywgJ3N0cmluZycpLAogICAgbmV3bGluZTE3MzUgPSB1aS5uZXdfbGFiZWwoJ0FBJywgJ0FudGktYWltYm90IGFuZ2xlcycsICdcbicsICdzdHJpbmcnKSwKICAgIG5ld2xpbmUxODM1ID0gdWkubmV3X2xhYmVsKCdBQScsICdBbnRpLWFpbWJvdCBhbmdsZXMnLCAnXG4nLCAnc3RyaW5nJyksCn0KCi0tIEByZWdpb24gVUlfUkVOREVSIHN0YXJ0CmNsaWVudC5zZXRfZXZlbnRfY2FsbGJhY2soInBhaW50X3VpIiwgZnVuY3Rpb24oKQogICAgdmFycy5hY3RpdmVTdGF0ZSA9IHZhcnMuc1RvSW50W3VpLmdldChtZW51LmJ1aWxkZXJUYWIuc3RhdGUpXQogICAgbG9jYWwgaXNFbmFibGVkID0gdWkuZ2V0KG1hc3RlclN3aXRjaCkKICAgIGxvY2FsIGlzR2VuZXJhbFRhYiA9IHVpLmdldCh0YWJQaWNrZXIxKSA9PSAiR2VuZXJhbCIKICAgIGxvY2FsIGlzU2V0dGluZ3NUYWIgPSB1aS5nZXQodGFiUGlja2VyMSkgPT0gIlNldHRpbmdzIgogICAgbG9jYWwgaXNCdWlsZGVyVGFiID0gdmFycy5jdXJyZW50VGFiID09IDIgYW5kIGlzU2V0dGluZ3NUYWIKICAgIGxvY2FsIGlzVmlzdWFsc1RhYiA9IHZhcnMuY3VycmVudFRhYiA9PSAzIGFuZCBpc1NldHRpbmdzVGFiCiAgICBsb2NhbCBpc0NGR1RhYiA9IHZhcnMuY3VycmVudFRhYiA9PSA0IGFuZCBpc1NldHRpbmdzVGFiCiAgICBsb2NhbCBpc3ByZXNldGRpc2FibGVkID0gdWkuZ2V0KG1lbnUuYnVpbGRlclRhYi5QcmVzZXRDb21ib0JveCkgPT0gIkRpc2FibGVkIgogICAgbG9jYWwgaXNMb2dpY0J1aWxkZXIgPSB1aS5nZXQobWVudS5idWlsZGVyVGFiLkxvZ2ljQ29tYm9Cb3gpID09ICIxIgogICAgbG9jYWwgaXNMb2dpY1ByZXNldHMgPSB1aS5nZXQobWVudS5idWlsZGVyVGFiLkxvZ2ljQ29tYm9Cb3gpID09ICIyIgogICAgdWkuc2V0X3Zpc2libGUodGFiUGlja2VyMSwgaXNFbmFibGVkKQogICAgdWkuc2V0X3Zpc2libGUobWVudS5HZW5lcmFsVGFiLnRleHQxLCBpc0VuYWJsZWQgYW5kIGlzR2VuZXJhbFRhYikKICAgIHVpLnNldF92aXNpYmxlKG1lbnUuR2VuZXJhbFRhYi50ZXh0MiwgaXNFbmFibGVkIGFuZCBpc0dlbmVyYWxUYWIpCiAgICB1aS5zZXRfdmlzaWJsZShtZW51LkdlbmVyYWxUYWIudGV4dDMsIGlzRW5hYmxlZCBhbmQgaXNHZW5lcmFsVGFiKQogICAgdWkuc2V0X3Zpc2libGUobWVudS5HZW5lcmFsVGFiLmRpc2NvcmQsIGlzRW5hYmxlZCBhbmQgaXNHZW5lcmFsVGFiKQogICAgdWkuc2V0X3Zpc2libGUobWVudS5HZW5lcmFsVGFiLm5ld2xpbmUxLCBpc0VuYWJsZWQgYW5kIGlzR2VuZXJhbFRhYikKICAgIHVpLnNldF92aXNpYmxlKG1lbnUuR2VuZXJhbFRhYi5uZXdsaW5lMiwgaXNFbmFibGVkIGFuZCBpc0dlbmVyYWxUYWIpCiAgICB1aS5zZXRfdmlzaWJsZShidWlsZGVyQnRuLCB2YXJzLmN1cnJlbnRUYWIgPT0gMSBhbmQgaXNFbmFibGVkIGFuZCBpc1NldHRpbmdzVGFiKQogICAgdWkuc2V0X3Zpc2libGUodmlzQnRuLCB2YXJzLmN1cnJlbnRUYWIgPT0gMSBhbmQgaXNFbmFibGVkIGFuZCBpc1NldHRpbmdzVGFiKQogICAgdWkuc2V0X3Zpc2libGUoY2ZnQnRuLCB2YXJzLmN1cnJlbnRUYWIgPT0gMSBhbmQgaXNFbmFibGVkIGFuZCBpc1NldHRpbmdzVGFiKQogICAgdWkuc2V0X3Zpc2libGUoYmFja0J0biwgdmFycy5jdXJyZW50VGFiIH49IDEgYW5kIGlzRW5hYmxlZCBhbmQgaXNTZXR0aW5nc1RhYikKCiAgICBmb3IgaSwgZmVhdHVyZSBpbiBwYWlycyhtZW51LmJ1aWxkZXJUYWIpIGRvCiAgICAgICAgaWYgdHlwZShmZWF0dXJlKSB+PSAidGFibGUiIHRoZW4KICAgICAgICAgICAgdWkuc2V0X3Zpc2libGUoZmVhdHVyZSwgaXNCdWlsZGVyVGFiIGFuZCBpc0VuYWJsZWQpCiAgICAgICAgZW5kCgllbmQgCgogICAgZm9yIGksIGZlYXR1cmUgaW4gcGFpcnMobWVudS5idWlsZGVyVGFiLm1hbnVhbFRhYikgZG8KICAgICAgICBpZiB0eXBlKGZlYXR1cmUpIH49ICJ0YWJsZSIgdGhlbgogICAgICAgICAgICB1aS5zZXRfdmlzaWJsZShmZWF0dXJlLCBpc0J1aWxkZXJUYWIgYW5kIGlzRW5hYmxlZCkKICAgICAgICBlbmQKCWVuZCAKICAgIAogICAgdWkuc2V0KGFhQnVpbGRlclsxXS5lbmFibGVTdGF0ZSwgdHJ1ZSkKICAgIGZvciBpID0gMSwgI3ZhcnMuYWFTdGF0ZXMgZG8KICAgICAgICBsb2NhbCBzdGF0ZUVuYWJsZWQgPSB1aS5nZXQoYWFCdWlsZGVyW2ldLmVuYWJsZVN0YXRlKQogICAgICAgIHVpLnNldF92aXNpYmxlKGFhQnVpbGRlcltpXS5lbmFibGVTdGF0ZSwgdmFycy5hY3RpdmVTdGF0ZSA9PSBpIGFuZCBpc0J1aWxkZXJUYWIgYW5kIGlzRW5hYmxlZCBhbmQgaXNwcmVzZXRkaXNhYmxlZCBhbmQgaXNMb2dpY0J1aWxkZXIpCiAgICAgICAgdWkuc2V0X3Zpc2libGUoYWFCdWlsZGVyW2ldLnBpdGNoLCB2YXJzLmFjdGl2ZVN0YXRlID09IGkgYW5kIGlzQnVpbGRlclRhYiBhbmQgc3RhdGVFbmFibGVkIGFuZCBpc0VuYWJsZWQgYW5kIGlzcHJlc2V0ZGlzYWJsZWQgYW5kIGlzTG9naWNCdWlsZGVyKQogICAgICAgIHVpLnNldF92aXNpYmxlKGFhQnVpbGRlcltpXS5waXRjaFNsaWRlciAsIHZhcnMuYWN0aXZlU3RhdGUgPT0gaSBhbmQgaXNCdWlsZGVyVGFiIGFuZCBzdGF0ZUVuYWJsZWQgYW5kIHVpLmdldChhYUJ1aWxkZXJbaV0ucGl0Y2gpID09ICJDdXN0b20iIGFuZCBpc0VuYWJsZWQgYW5kIGlzcHJlc2V0ZGlzYWJsZWQgYW5kIGlzTG9naWNCdWlsZGVyKQogICAgICAgIHVpLnNldF92aXNpYmxlKGFhQnVpbGRlcltpXS55YXdCYXNlLCB2YXJzLmFjdGl2ZVN0YXRlID09IGkgYW5kIGlzQnVpbGRlclRhYiBhbmQgc3RhdGVFbmFibGVkIGFuZCBpc0VuYWJsZWQgYW5kIGlzcHJlc2V0ZGlzYWJsZWQgYW5kIGlzTG9naWNCdWlsZGVyKQogICAgICAgIHVpLnNldF92aXNpYmxlKGFhQnVpbGRlcltpXS55YXcsIHZhcnMuYWN0aXZlU3RhdGUgPT0gaSBhbmQgaXNCdWlsZGVyVGFiIGFuZCBzdGF0ZUVuYWJsZWQgYW5kIGlzRW5hYmxlZCBhbmQgaXNwcmVzZXRkaXNhYmxlZCBhbmQgaXNMb2dpY0J1aWxkZXIpCiAgICAgICAgdWkuc2V0X3Zpc2libGUoYWFCdWlsZGVyW2ldLnlhd0NvbmRpdGlvbiwgdmFycy5hY3RpdmVTdGF0ZSA9PSBpIGFuZCB1aS5nZXQoYWFCdWlsZGVyW2ldLnlhdykgfj0gIk9mZiIgYW5kIGlzQnVpbGRlclRhYiBhbmQgc3RhdGVFbmFibGVkIGFuZCBpc0VuYWJsZWQgYW5kIGlzcHJlc2V0ZGlzYWJsZWQgYW5kIGlzTG9naWNCdWlsZGVyKQogICAgICAgIHVpLnNldF92aXNpYmxlKGFhQnVpbGRlcltpXS55YXdTdGF0aWMsIHZhcnMuYWN0aXZlU3RhdGUgPT0gaSBhbmQgdWkuZ2V0KGFhQnVpbGRlcltpXS55YXcpIH49ICJPZmYiIGFuZCB1aS5nZXQoYWFCdWlsZGVyW2ldLnlhd0NvbmRpdGlvbikgPT0gIlN0YXRpYyIgYW5kIGlzQnVpbGRlclRhYiBhbmQgc3RhdGVFbmFibGVkIGFuZCBpc0VuYWJsZWQgYW5kIGlzcHJlc2V0ZGlzYWJsZWQgYW5kIGlzTG9naWNCdWlsZGVyKQogICAgICAgIHVpLnNldF92aXNpYmxlKGFhQnVpbGRlcltpXS55YXdMZWZ0LCB2YXJzLmFjdGl2ZVN0YXRlID09IGkgYW5kIHVpLmdldChhYUJ1aWxkZXJbaV0ueWF3KSB+PSAiT2ZmIiBhbmQgdWkuZ2V0KGFhQnVpbGRlcltpXS55YXdDb25kaXRpb24pIH49ICJTdGF0aWMiIGFuZCBpc0J1aWxkZXJUYWIgYW5kIHN0YXRlRW5hYmxlZCBhbmQgaXNFbmFibGVkIGFuZCBpc3ByZXNldGRpc2FibGVkIGFuZCBpc0xvZ2ljQnVpbGRlcikKICAgICAgICB1aS5zZXRfdmlzaWJsZShhYUJ1aWxkZXJbaV0ueWF3UmlnaHQsIHZhcnMuYWN0aXZlU3RhdGUgPT0gaSBhbmQgdWkuZ2V0KGFhQnVpbGRlcltpXS55YXcpIH49ICJPZmYiIGFuZCB1aS5nZXQoYWFCdWlsZGVyW2ldLnlhd0NvbmRpdGlvbikgfj0gIlN0YXRpYyIgYW5kIGlzQnVpbGRlclRhYiBhbmQgc3RhdGVFbmFibGVkIGFuZCBpc0VuYWJsZWQgYW5kIGlzcHJlc2V0ZGlzYWJsZWQgYW5kIGlzTG9naWNCdWlsZGVyKQogICAgICAgIHVpLnNldF92aXNpYmxlKGFhQnVpbGRlcltpXS55YXdTcGVlZCwgdmFycy5hY3RpdmVTdGF0ZSA9PSBpIGFuZCB1aS5nZXQoYWFCdWlsZGVyW2ldLnlhdykgfj0gIk9mZiIgYW5kIHVpLmdldChhYUJ1aWxkZXJbaV0ueWF3Q29uZGl0aW9uKSA9PSAiU2xvdyIgYW5kIGlzQnVpbGRlclRhYiBhbmQgc3RhdGVFbmFibGVkIGFuZCBpc0VuYWJsZWQgYW5kIGlzcHJlc2V0ZGlzYWJsZWQgYW5kIGlzTG9naWNCdWlsZGVyKQogICAgICAgIHVpLnNldF92aXNpYmxlKGFhQnVpbGRlcltpXS55YXdKaXR0ZXIsIHZhcnMuYWN0aXZlU3RhdGUgPT0gaSBhbmQgdWkuZ2V0KGFhQnVpbGRlcltpXS55YXcpIH49ICJPZmYiIGFuZCBpc0J1aWxkZXJUYWIgYW5kIHN0YXRlRW5hYmxlZCBhbmQgaXNFbmFibGVkIGFuZCBpc3ByZXNldGRpc2FibGVkIGFuZCBpc0xvZ2ljQnVpbGRlcikKICAgICAgICB1aS5zZXRfdmlzaWJsZShhYUJ1aWxkZXJbaV0ueWF3Sml0dGVyQ29uZGl0aW9uLCB2YXJzLmFjdGl2ZVN0YXRlID09IGkgYW5kIHVpLmdldChhYUJ1aWxkZXJbaV0ueWF3Sml0dGVyKSB+PSAiT2ZmIiBhbmQgaXNCdWlsZGVyVGFiIGFuZCBzdGF0ZUVuYWJsZWQgYW5kIGlzRW5hYmxlZCBhbmQgaXNwcmVzZXRkaXNhYmxlZCBhbmQgaXNMb2dpY0J1aWxkZXIpCiAgICAgICAgdWkuc2V0X3Zpc2libGUoYWFCdWlsZGVyW2ldLnlhd0ppdHRlclN0YXRpYywgdmFycy5hY3RpdmVTdGF0ZSA9PSBpIGFuZCB1aS5nZXQoYWFCdWlsZGVyW2ldLnlhd0ppdHRlcikgfj0gIk9mZiIgYW5kIHVpLmdldChhYUJ1aWxkZXJbaV0ueWF3Sml0dGVyQ29uZGl0aW9uKSA9PSAiU3RhdGljIiBhbmQgaXNCdWlsZGVyVGFiIGFuZCBzdGF0ZUVuYWJsZWQgYW5kIGlzRW5hYmxlZCBhbmQgaXNwcmVzZXRkaXNhYmxlZCBhbmQgaXNMb2dpY0J1aWxkZXIpCiAgICAgICAgdWkuc2V0X3Zpc2libGUoYWFCdWlsZGVyW2ldLnlhd0ppdHRlckxlZnQsIHZhcnMuYWN0aXZlU3RhdGUgPT0gaSBhbmQgdWkuZ2V0KGFhQnVpbGRlcltpXS55YXdKaXR0ZXIpIH49ICJPZmYiIGFuZCB1aS5nZXQoYWFCdWlsZGVyW2ldLnlhd0ppdHRlckNvbmRpdGlvbikgPT0gIkwgJiBSIiBhbmQgaXNCdWlsZGVyVGFiIGFuZCBzdGF0ZUVuYWJsZWQgYW5kIGlzRW5hYmxlZCBhbmQgaXNwcmVzZXRkaXNhYmxlZCBhbmQgaXNMb2dpY0J1aWxkZXIpCiAgICAgICAgdWkuc2V0X3Zpc2libGUoYWFCdWlsZGVyW2ldLnlhd0ppdHRlclJpZ2h0LCB2YXJzLmFjdGl2ZVN0YXRlID09IGkgYW5kIHVpLmdldChhYUJ1aWxkZXJbaV0ueWF3Sml0dGVyKSB+PSAiT2ZmIiBhbmQgdWkuZ2V0KGFhQnVpbGRlcltpXS55YXdKaXR0ZXJDb25kaXRpb24pID09ICJMICYgUiIgYW5kIGlzQnVpbGRlclRhYiBhbmQgc3RhdGVFbmFibGVkIGFuZCBpc0VuYWJsZWQgYW5kIGlzcHJlc2V0ZGlzYWJsZWQgYW5kIGlzTG9naWNCdWlsZGVyKQogICAgICAgIHVpLnNldF92aXNpYmxlKGFhQnVpbGRlcltpXS55YXdKaXR0ZXJEaXNhYmxlcnMsIHZhcnMuYWN0aXZlU3RhdGUgPT0gaSBhbmQgdWkuZ2V0KGFhQnVpbGRlcltpXS55YXdKaXR0ZXIpIH49ICJPZmYiIGFuZCBpc0J1aWxkZXJUYWIgYW5kIHN0YXRlRW5hYmxlZCBhbmQgaXNFbmFibGVkIGFuZCBpc3ByZXNldGRpc2FibGVkIGFuZCBpc0xvZ2ljQnVpbGRlcikKICAgICAgICB1aS5zZXRfdmlzaWJsZShhYUJ1aWxkZXJbaV0uYm9keVlhdywgdmFycy5hY3RpdmVTdGF0ZSA9PSBpIGFuZCBpc0J1aWxkZXJUYWIgYW5kIHN0YXRlRW5hYmxlZCBhbmQgaXNFbmFibGVkIGFuZCBpc3ByZXNldGRpc2FibGVkIGFuZCBpc0xvZ2ljQnVpbGRlcikKICAgICAgICB1aS5zZXRfdmlzaWJsZShhYUJ1aWxkZXJbaV0uYm9keVlhd1NsaWRlciwgdmFycy5hY3RpdmVTdGF0ZSA9PSBpIGFuZCB1aS5nZXQoYWFCdWlsZGVyW2ldLmJvZHlZYXcpIH49ICJPZmYiIGFuZCBpc0J1aWxkZXJUYWIgYW5kIHN0YXRlRW5hYmxlZCBhbmQgaXNFbmFibGVkIGFuZCBpc3ByZXNldGRpc2FibGVkIGFuZCBpc0xvZ2ljQnVpbGRlcikKICAgICAgICB1aS5zZXRfdmlzaWJsZShhYUJ1aWxkZXJbaV0uZGVmZW5zaXZlT3B0LCB2YXJzLmFjdGl2ZVN0YXRlID09IGkgYW5kIGlzQnVpbGRlclRhYiBhbmQgc3RhdGVFbmFibGVkIGFuZCBpc0VuYWJsZWQgYW5kIGlzcHJlc2V0ZGlzYWJsZWQgYW5kIGlzTG9naWNCdWlsZGVyKQogICAgICAgIHVpLnNldF92aXNpYmxlKGFhQnVpbGRlcltpXS5kZWZlbnNpdmVZYXcsIHZhcnMuYWN0aXZlU3RhdGUgPT0gaSBhbmQgaXNCdWlsZGVyVGFiIGFuZCBzdGF0ZUVuYWJsZWQgYW5kIGlzRW5hYmxlZCBhbmQgaXNwcmVzZXRkaXNhYmxlZCBhbmQgaXNMb2dpY0J1aWxkZXIpCiAgICAgICAgdWkuc2V0X3Zpc2libGUoYWFCdWlsZGVyW2ldLmRlZmVuc2l2ZVlhd1NsaWRlciwgdmFycy5hY3RpdmVTdGF0ZSA9PSBpIGFuZCBpc0J1aWxkZXJUYWIgYW5kIHN0YXRlRW5hYmxlZCBhbmQgaXNFbmFibGVkIGFuZCB1aS5nZXQoYWFCdWlsZGVyW2ldLmRlZmVuc2l2ZVlhdykgPT0gIkN1c3RvbSIgYW5kIGlzcHJlc2V0ZGlzYWJsZWQgYW5kIGlzTG9naWNCdWlsZGVyKQogICAgICAgIHVpLnNldF92aXNpYmxlKGFhQnVpbGRlcltpXS5kZWZlbnNpdmVQaXRjaCwgdmFycy5hY3RpdmVTdGF0ZSA9PSBpIGFuZCBpc0J1aWxkZXJUYWIgYW5kIHN0YXRlRW5hYmxlZCBhbmQgaXNFbmFibGVkIGFuZCBpc3ByZXNldGRpc2FibGVkIGFuZCBpc0xvZ2ljQnVpbGRlcikKICAgICAgICB1aS5zZXRfdmlzaWJsZShhYUJ1aWxkZXJbaV0uZGVmZW5zaXZlUGl0Y2hTbGlkZXIsIHZhcnMuYWN0aXZlU3RhdGUgPT0gaSBhbmQgaXNCdWlsZGVyVGFiIGFuZCBzdGF0ZUVuYWJsZWQgYW5kIGlzRW5hYmxlZCBhbmQgdWkuZ2V0KGFhQnVpbGRlcltpXS5kZWZlbnNpdmVQaXRjaCkgPT0gIkN1c3RvbSIgYW5kIGlzcHJlc2V0ZGlzYWJsZWQgYW5kIGlzTG9naWNCdWlsZGVyKQogICAgZW5kCgogICAgLS0gYnVpbGRlclRhYgogICAgdWkuc2V0X3Zpc2libGUobWVudS5idWlsZGVyVGFiLnN0YXRlLCB1aS5nZXQobWVudS5idWlsZGVyVGFiLlByZXNldENvbWJvQm94KSA9PSAiRGlzYWJsZWQiIGFuZCBpc0J1aWxkZXJUYWIgYW5kIGlzRW5hYmxlZCBhbmQgaXNMb2dpY0J1aWxkZXIpCiAgICB1aS5zZXRfdmlzaWJsZShtZW51LmJ1aWxkZXJUYWIuYnV0dG9uQnVpbGRlciwgaXNCdWlsZGVyVGFiIGFuZCBpc0VuYWJsZWQgYW5kIGlzTG9naWNQcmVzZXRzKQogICAgdWkuc2V0X3Zpc2libGUobWVudS5idWlsZGVyVGFiLmJ1dHRvblByZXNldHMsIGlzQnVpbGRlclRhYiBhbmQgaXNFbmFibGVkIGFuZCBpc0xvZ2ljQnVpbGRlcikKICAgIHVpLnNldF92aXNpYmxlKG1lbnUuYnVpbGRlclRhYi5QcmVzZXRDb21ib0JveCwgaXNCdWlsZGVyVGFiIGFuZCBpc0VuYWJsZWQgYW5kIGlzTG9naWNQcmVzZXRzKQogICAgdWkuc2V0X3Zpc2libGUobWVudS5idWlsZGVyVGFiLkxvZ2ljQ29tYm9Cb3gsIGlzQnVpbGRlclRhYiBhbmQgaXNFbmFibGVkIGFuZCBsb2dpY2ExMzM3ID09ICIxIikKICAgIHVpLnNldF92aXNpYmxlKG1lbnUuYnVpbGRlclRhYi5mcmVlc3RhbmRIb3RrZXksIGlzQnVpbGRlclRhYiBhbmQgaXNFbmFibGVkIGFuZCBmdW5jLmluY2x1ZGVzKHVpLmdldChtZW51LmJ1aWxkZXJUYWIuVHdlYWtzTXVsdGlzZWxlY3QpLCAiRnJlZXN0YW5kIikpCiAgICB1aS5zZXRfdmlzaWJsZShtZW51LmJ1aWxkZXJUYWIuZnJlZXN0YW5kRGlzYWJsZXJzLCBpc0J1aWxkZXJUYWIgYW5kIGlzRW5hYmxlZCBhbmQgZnVuYy5pbmNsdWRlcyh1aS5nZXQobWVudS5idWlsZGVyVGFiLlR3ZWFrc011bHRpc2VsZWN0KSwgIkZyZWVzdGFuZCIpKQogICAgdWkuc2V0X3Zpc2libGUobWVudS5idWlsZGVyVGFiLmF2b2lkQmFja3N0YWIsIGlzQnVpbGRlclRhYiBhbmQgaXNFbmFibGVkIGFuZCBmdW5jLmluY2x1ZGVzKHVpLmdldChtZW51LmJ1aWxkZXJUYWIuVHdlYWtzTXVsdGlzZWxlY3QpLCAiQXZvaWQgQmFja3N0YWIiKSkKICAgIHVpLnNldF92aXNpYmxlKG1lbnUuYnVpbGRlclRhYi5lZGdlWWF3SG90a2V5LCBpc0J1aWxkZXJUYWIgYW5kIGlzRW5hYmxlZCBhbmQgZnVuYy5pbmNsdWRlcyh1aS5nZXQobWVudS5idWlsZGVyVGFiLlR3ZWFrc011bHRpc2VsZWN0KSwgIkVkZ2UgWWF3IikpCiAgICB1aS5zZXRfdmlzaWJsZShtZW51LmJ1aWxkZXJUYWIuc3RhdGljTWFudWFscywgaXNCdWlsZGVyVGFiIGFuZCBpc0VuYWJsZWQgYW5kIGZ1bmMuaW5jbHVkZXModWkuZ2V0KG1lbnUuYnVpbGRlclRhYi5Ud2Vha3NNdWx0aXNlbGVjdCksICJNYW51YWxzIikpCiAgICB1aS5zZXRfdmlzaWJsZShtZW51LmJ1aWxkZXJUYWIubWFudWFsVGFiLm1hbnVhbExlZnQsIGlzQnVpbGRlclRhYiBhbmQgaXNFbmFibGVkIGFuZCBmdW5jLmluY2x1ZGVzKHVpLmdldChtZW51LmJ1aWxkZXJUYWIuVHdlYWtzTXVsdGlzZWxlY3QpLCAiTWFudWFscyIpKQogICAgdWkuc2V0X3Zpc2libGUobWVudS5idWlsZGVyVGFiLm1hbnVhbFRhYi5tYW51YWxSaWdodCwgaXNCdWlsZGVyVGFiIGFuZCBpc0VuYWJsZWQgYW5kIGZ1bmMuaW5jbHVkZXModWkuZ2V0KG1lbnUuYnVpbGRlclRhYi5Ud2Vha3NNdWx0aXNlbGVjdCksICJNYW51YWxzIikpCiAgICB1aS5zZXRfdmlzaWJsZShtZW51LmJ1aWxkZXJUYWIubWFudWFsVGFiLm1hbnVhbEZvcndhcmQsIGlzQnVpbGRlclRhYiBhbmQgaXNFbmFibGVkIGFuZCBmdW5jLmluY2x1ZGVzKHVpLmdldChtZW51LmJ1aWxkZXJUYWIuVHdlYWtzTXVsdGlzZWxlY3QpLCAiTWFudWFscyIpKQogICAgdWkuc2V0X3Zpc2libGUobWVudS5idWlsZGVyVGFiLm1hbnVhbFRhYi5tYW51YWxSZXNldCwgaXNCdWlsZGVyVGFiIGFuZCBpc0VuYWJsZWQgYW5kIGZ1bmMuaW5jbHVkZXModWkuZ2V0KG1lbnUuYnVpbGRlclRhYi5Ud2Vha3NNdWx0aXNlbGVjdCksICJNYW51YWxzIikpCgogICAgZm9yIGksIGZlYXR1cmUgaW4gcGFpcnModWlmaXgpIGRvCiAgICAgICAgaWYgdHlwZShmZWF0dXJlKSB+PSAidGFibGUiIHRoZW4KICAgICAgICAgICAgdWkuc2V0X3Zpc2libGUoZmVhdHVyZSwgaXNCdWlsZGVyVGFiIGFuZCBpc0VuYWJsZWQpCiAgICAgICAgZW5kCgllbmQgCgoKICAgIGZvciBpLCBmZWF0dXJlIGluIHBhaXJzKG1lbnUudmlzdWFsc1RhYikgZG8KICAgICAgICBpZiB0eXBlKGZlYXR1cmUpIH49ICJ0YWJsZSIgdGhlbgogICAgICAgICAgICB1aS5zZXRfdmlzaWJsZShmZWF0dXJlLCBpc1Zpc3VhbHNUYWIgYW5kIGlzRW5hYmxlZCkKICAgICAgICBlbmQKCWVuZCAKICAgIHVpLnNldF92aXNpYmxlKG1lbnUudmlzdWFsc1RhYi5sb2dzLCBpc1Zpc3VhbHNUYWIgYW5kIGlzRW5hYmxlZCBhbmQgZnVuYy5pbmNsdWRlcyh1aS5nZXQobWVudS52aXN1YWxzVGFiLlZpc3VhbHNNdWx0aXNlbGVjdCksICJPbiBzY3JlZW4gbG9ncyIpKQogICAgdWkuc2V0X3Zpc2libGUobWVudS52aXN1YWxzVGFiLmxvZ09mZnNldCwgdWkuZ2V0KG1lbnUudmlzdWFsc1RhYi5sb2dzKSBhbmQgaXNWaXN1YWxzVGFiIGFuZCBpc0VuYWJsZWQgYW5kIGZ1bmMuaW5jbHVkZXModWkuZ2V0KG1lbnUudmlzdWFsc1RhYi5WaXN1YWxzTXVsdGlzZWxlY3QpLCAiT24gc2NyZWVuIGxvZ3MiKSkKICAgIHVpLnNldF92aXNpYmxlKG1lbnUudmlzdWFsc1RhYi5sb2dzQ2xyLCB1aS5nZXQobWVudS52aXN1YWxzVGFiLmxvZ3MpIGFuZCBpc1Zpc3VhbHNUYWIgYW5kIGlzRW5hYmxlZCBhbmQgZnVuYy5pbmNsdWRlcyh1aS5nZXQobWVudS52aXN1YWxzVGFiLlZpc3VhbHNNdWx0aXNlbGVjdCksICJPbiBzY3JlZW4gbG9ncyIpKQogICAgdWkuc2V0X3Zpc2libGUobWVudS52aXN1YWxzVGFiLmluZGljYXRvcnMsIGlzVmlzdWFsc1RhYiBhbmQgaXNFbmFibGVkIGFuZCBmdW5jLmluY2x1ZGVzKHVpLmdldChtZW51LnZpc3VhbHNUYWIuVmlzdWFsc011bHRpc2VsZWN0KSwgIkNyb3NzaGFpciBJbmRpY2F0b3JzIikpCiAgICB1aS5zZXRfdmlzaWJsZShtZW51LnZpc3VhbHNUYWIuaW5kaWNhdG9yc1N0eWxlLCB1aS5nZXQobWVudS52aXN1YWxzVGFiLmluZGljYXRvcnMpID09ICJTb2Z0IiBhbmQgaXNWaXN1YWxzVGFiIGFuZCBpc0VuYWJsZWQgYW5kIGZ1bmMuaW5jbHVkZXModWkuZ2V0KG1lbnUudmlzdWFsc1RhYi5WaXN1YWxzTXVsdGlzZWxlY3QpLCAiQ3Jvc3NoYWlyIEluZGljYXRvcnMiKSkKICAgIHVpLnNldF92aXNpYmxlKG1lbnUudmlzdWFsc1RhYi5pbmRpY2F0b3JzQ2xyLCBpc1Zpc3VhbHNUYWIgYW5kIGlzRW5hYmxlZCBhbmQgdWkuZ2V0KG1lbnUudmlzdWFsc1RhYi5pbmRpY2F0b3JzKSB+PSAiRGlzYWJsZWQiIGFuZCBmdW5jLmluY2x1ZGVzKHVpLmdldChtZW51LnZpc3VhbHNUYWIuVmlzdWFsc011bHRpc2VsZWN0KSwgIkNyb3NzaGFpciBJbmRpY2F0b3JzIikpCiAgICB1aS5zZXRfdmlzaWJsZShtZW51LnZpc3VhbHNUYWIuYXJyb3dJbmRpY2F0b3JTdHlsZSwgaXNWaXN1YWxzVGFiIGFuZCBpc0VuYWJsZWQgYW5kIGZ1bmMuaW5jbHVkZXModWkuZ2V0KG1lbnUudmlzdWFsc1RhYi5WaXN1YWxzTXVsdGlzZWxlY3QpLCAiQ3Jvc3NoYWlyIEFycm93cyIpKQogICAgdWkuc2V0X3Zpc2libGUobWVudS52aXN1YWxzVGFiLmFycm93Q2xyLCBpc1Zpc3VhbHNUYWIgYW5kIGlzRW5hYmxlZCBhbmQgZnVuYy5pbmNsdWRlcyh1aS5nZXQobWVudS52aXN1YWxzVGFiLlZpc3VhbHNNdWx0aXNlbGVjdCksICJDcm9zc2hhaXIgQXJyb3dzIikpCiAgICB1aS5zZXRfdmlzaWJsZShtZW51LnZpc3VhbHNUYWIud2F0ZXJtYXJrQ2xyLCB1aS5nZXQobWVudS52aXN1YWxzVGFiLndhdGVybWFyaykgPT0gIk9sZCIgYW5kIGlzVmlzdWFsc1RhYiBhbmQgaXNFbmFibGVkKQogICAgdWkuc2V0X3Zpc2libGUobWVudS52aXN1YWxzVGFiLndhdGVybWFya1Bvc2l0aW9uLCB1aS5nZXQobWVudS52aXN1YWxzVGFiLndhdGVybWFyaykgPT0gIkRlZmF1bHQiIGFuZCBpc1Zpc3VhbHNUYWIgYW5kIGlzRW5hYmxlZCkKICAgIHVpLnNldF92aXNpYmxlKG1lbnUuY29uZmlnVGFiLmV4cG9ydCwgaXNMb2dpY0J1aWxkZXIgYW5kIGlzQ0ZHVGFiIGFuZCBpc0VuYWJsZWQpCiAgICB1aS5zZXRfdmlzaWJsZShtZW51LmNvbmZpZ1RhYjIuV2FybmluZ0NvbmZpZywgaXNMb2dpY1ByZXNldHMgYW5kIGlzQ0ZHVGFiIGFuZCBpc0VuYWJsZWQpCiAgICB1aS5zZXRfdmlzaWJsZShtZW51LmNvbmZpZ1RhYjIuV2FybmluZ0NvbmZpZzIsIGlzTG9naWNQcmVzZXRzIGFuZCBpc0NGR1RhYiBhbmQgaXNFbmFibGVkKQogICAgdWkuc2V0X3Zpc2libGUobWVudS52aXN1YWxzVGFiLmZhc3RMYWRkZXIsIGlzVmlzdWFsc1RhYiBhbmQgaXNFbmFibGVkIGFuZCBmdW5jLmluY2x1ZGVzKHVpLmdldChtZW51LnZpc3VhbHNUYWIuTWlzY011bHRpc2VsZWN0KSwgIkZhc3QgbGFkZGVyIikpCiAgICB1aS5zZXRfdmlzaWJsZShtZW51LnZpc3VhbHNUYWIuYW5pbWF0aW9ucywgaXNWaXN1YWxzVGFiIGFuZCBpc0VuYWJsZWQgYW5kIGZ1bmMuaW5jbHVkZXModWkuZ2V0KG1lbnUudmlzdWFsc1RhYi5NaXNjTXVsdGlzZWxlY3QpLCAiQW5pbSBicmVha2VycyIpKQogICAgdWkuc2V0X3Zpc2libGUobWVudS52aXN1YWxzVGFiLmRldlByaW50LCBpc1Zpc3VhbHNUYWIgYW5kIGlzRW5hYmxlZCBhbmQgZnVuYy5pbmNsdWRlcyh1aS5nZXQobWVudS52aXN1YWxzVGFiLk1pc2NNdWx0aXNlbGVjdCksICJPbGQgY29uc29sZSBsb2dzIikpCiAgICB1aS5zZXRfdmlzaWJsZShtZW51LnZpc3VhbHNUYWIuaHVkLCBpc1Zpc3VhbHNUYWIgYW5kIGlzRW5hYmxlZCBhbmQgZnVuYy5pbmNsdWRlcyh1aS5nZXQobWVudS52aXN1YWxzVGFiLlZpc3VhbHNNdWx0aXNlbGVjdCksICJibHVoZ2FuZyBtZW51IikpCiAgICB1aS5zZXRfdmlzaWJsZShtZW51LnZpc3VhbHNUYWIuaHVkWCwgdWkuZ2V0KG1lbnUudmlzdWFsc1RhYi5odWQpIH49ICJEaXNhYmxlZCIgYW5kIGlzVmlzdWFsc1RhYiBhbmQgaXNFbmFibGVkIGFuZCBmdW5jLmluY2x1ZGVzKHVpLmdldChtZW51LnZpc3VhbHNUYWIuVmlzdWFsc011bHRpc2VsZWN0KSwgImJsdWhnYW5nIG1lbnUiKSkKICAgIHVpLnNldF92aXNpYmxlKG1lbnUudmlzdWFsc1RhYi5odWRZLCB1aS5nZXQobWVudS52aXN1YWxzVGFiLmh1ZCkgfj0gIkRpc2FibGVkIiBhbmQgaXNWaXN1YWxzVGFiIGFuZCBpc0VuYWJsZWQgYW5kIGZ1bmMuaW5jbHVkZXModWkuZ2V0KG1lbnUudmlzdWFsc1RhYi5WaXN1YWxzTXVsdGlzZWxlY3QpLCAiYmx1aGdhbmcgbWVudSIpKQogICAgdWkuc2V0X3Zpc2libGUobWVudS52aXN1YWxzVGFiLnRyYXNoVGFsaywgaXNWaXN1YWxzVGFiIGFuZCBpc0VuYWJsZWQgYW5kIGZ1bmMuaW5jbHVkZXModWkuZ2V0KG1lbnUudmlzdWFsc1RhYi5NaXNjTXVsdGlzZWxlY3QpLCAiVHJhc2h0YWxrIikpCiAgICB1aS5zZXRfdmlzaWJsZShtZW51LnZpc3VhbHNUYWIuVHJhc2hUYWxrTGFuZ3VhZ2UsIHVpLmdldChtZW51LnZpc3VhbHNUYWIudHJhc2hUYWxrKSBhbmQgaXNWaXN1YWxzVGFiIGFuZCBpc0VuYWJsZWQgYW5kIGZ1bmMuaW5jbHVkZXModWkuZ2V0KG1lbnUudmlzdWFsc1RhYi5NaXNjTXVsdGlzZWxlY3QpLCAiVHJhc2h0YWxrIikpCiAgICAKICAgIGZvciBpLCBmZWF0dXJlIGluIHBhaXJzKG1lbnUuY29uZmlnVGFiKSBkbwoJCXVpLnNldF92aXNpYmxlKGZlYXR1cmUsIGlzTG9naWNCdWlsZGVyIGFuZCBpc0NGR1RhYiBhbmQgaXNFbmFibGVkKQoJZW5kCgogICAgaWYgbm90IGlzRW5hYmxlZCBhbmQgbm90IHNhdmVkIHRoZW4KICAgICAgICBmdW5jLnJlc2V0QUFUYWIoKQogICAgICAgIHVpLnNldChyZWZzLmZzQm9keVlhdywgaXNFbmFibGVkKQogICAgICAgIHVpLnNldChyZWZzLmVuYWJsZWQsIGlzRW5hYmxlZCkKICAgICAgICBzYXZlZCA9IHRydWUKICAgIGVsc2VpZiBpc0VuYWJsZWQgYW5kIHNhdmVkIHRoZW4KICAgICAgICB1aS5zZXQocmVmcy5mc0JvZHlZYXcsIG5vdCBpc0VuYWJsZWQpCiAgICAgICAgdWkuc2V0KHJlZnMuZW5hYmxlZCwgaXNFbmFibGVkKQogICAgICAgIHNhdmVkID0gZmFsc2UKICAgIGVuZAogICAgZnVuYy5zZXRBQVRhYihub3QgaXNFbmFibGVkKQoKZW5kKQotLSBAcmVnaW9uIFVJX1JFTkRFUiBlbmQKCmNsaWVudC5zZXRfZXZlbnRfY2FsbGJhY2soInNodXRkb3duIiwgZnVuY3Rpb24oKQogICAgaWYgaHNWYWx1ZSB+PSBuaWwgdGhlbgogICAgICAgIHVpLnNldChyZWZzLmZha2VMYWdbMV0sIGhzVmFsdWUpCiAgICBlbmQKICAgIGlmIGNsYW5UYWcgfj0gbmlsIHRoZW4KICAgICAgICBjbGllbnQuc2V0X2NsYW5fdGFnKCIiKQogICAgZW5kCiAgICBpZiBkdFNhdmVkIH49IG5pbCB0aGVuCiAgICAgICAgdWkuc2V0KHJlZnMuZHRbM10sICJEZWZlbnNpdmUiKQogICAgZW5kCiAgICBmdW5jLnNldEFBVGFiKHRydWUpCmVuZCk="}