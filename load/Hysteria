{"status":200,"content":"CgoKCi0tIGh5c3RlcmlhIOKAoiBnYW1lc2Vuc2UKLS0tLS0gZW5RLiAyMDIzCgoKCi0tLS08ICBIZWFkZXIgID4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgppZiBub3QgTFBIX09CRlVTQ0FURUQgdGhlbgoJTFBIX05PX1ZJUlRVQUxJWkUgPSBmdW5jdGlvbiAoLi4uKSByZXR1cm4gLi4uIGVuZAplbmQKCkxQSF9OT19WSVJUVUFMSVpFKGZ1bmN0aW9uICgpCgoKbG9jYWwgYSA9IGZ1bmN0aW9uICguLi4pIHJldHVybiAuLi4gZW5kCgoKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KLS0gI3JlZ2lvbiA6OiBEZWZpbml0aW9ucwoKCi0tCi0tICNyZWdpb24gOiBEZWZpbml0aW9ucwoKbG9jYWwgaW5mb190ID0gb2JleF9mZXRjaCBhbmQgb2JleF9mZXRjaCgpIG9yIHsgdXNlcm5hbWUgPSAiZW5RIiwgYnVpbGQgPSAiRGVidWciLCBkaXNjb3JkID0gMCB9Cgpsb2NhbCBfVkVSU0lPTiA9ICIxLjYiCmxvY2FsIF9MT0NBTExJQiA9IGluZm9fdC51c2VybmFtZSA9PSAiZW5RIgoKLS0gI3JlZ2lvbiAtIGh5c3RlcmlhCgpsb2NhbCBfQlVJTEQsIF9MRVZFTCwgX0JMSVNTLCBfQkVUQSwgX0RFQlVHLCBfQVpBWkkgPSAic3RhYmxlIiwgMSwgZmFsc2UsIGZhbHNlLCBmYWxzZSwgZmFsc2UgZG8KCWxvY2FsIGJ1aWxkcyA9IHsKCQlbIlByaXZhdGUiXSA9IHsxLCAic3RhYmxlIn0sCgkJWyJVc2VyIl0gPSB7MiwgImJsaXNzIn0sCgkJWyJCZXRhIl0gPSB7MywgImJldGEifSwKCQlbIkRlYnVnIl0gPSB7NCwgImRlYnVnIn0sCgl9CgoJbG9jYWwgY3R4ID0gYnVpbGRzW2luZm9fdC5idWlsZF0gb3IgYnVpbGRzWyJVc2VyIl0KCV9CVUlMRCwgX0xFVkVMID0gY3R4WzJdLCBjdHhbMV0KCglpZiBfTEVWRUwgPj0gMiB0aGVuIF9CTElTUyA9IHRydWUgZW5kCglpZiBfTEVWRUwgPj0gMyB0aGVuIF9CRVRBID0gdHJ1ZSBlbmQKCWlmIF9MRVZFTCA+PSA0IHRoZW4gX0RFQlVHID0gdHJ1ZSBlbmQKCglkbwoJCWxvY2FsIGN1c3RvbXMgPSB7CgkJCVsic2lzYXIiXSA9IGZ1bmN0aW9uICgpIF9CVUlMRCA9ICJ0aGVvcyIgZW5kLAoJCQlbInJ1emgiXSA9IGZ1bmN0aW9uICgpIF9CVUlMRCA9ICJwcml2YXRlIiBlbmQsCgkJCVsicWluZ3NoYW5nIl0gPSBmdW5jdGlvbiAoKSBfTE9DQUxMSUIgPSB0cnVlIGVuZCwKCQkJWyJqdXN0aWNlIl0gPSBmdW5jdGlvbiAoKSBfQVpBWkksIF9CVUlMRCA9IHRydWUsICLQvNC10LfQvtC30L7QuCIgZW5kLAoJCQlbIjAwMDAiXSA9IGZ1bmN0aW9uICgpIF9BWkFaSSwgX0JVSUxEID0gdHJ1ZSwgItGB0LzRi9GB0Lsg0L/QtdC30LTQtdGC0YwiIGVuZCwKCQl9CgoJCWxvY2FsIG5hbWUgPSBzdHJpbmcubG93ZXIoaW5mb190LnVzZXJuYW1lKQoJCWxvY2FsIGN1c3RvbSA9IGN1c3RvbXNbbmFtZV0KCQlpZiBjdXN0b20gdGhlbiBjdXN0b20oKSBlbmQKCWVuZAplbmQKCmxvY2FsIGh5c3RlcmlhID0gewoJbmFtZSA9ICJoeXN0ZXJpYSIsCgl2ZXJzaW9uID0gX1ZFUlNJT04sIGJ1aWxkID0gX0JVSUxELCBsZXZlbCA9IF9MRVZFTCwKCXVzZXIgPSB7CgkJbmFtZSA9IGluZm9fdC51c2VybmFtZSwKCQlhdmF0YXIgPSBuaWwKCX0KfQoKLS0gI2VuZHJlZ2lvbgoKLS0gI3JlZ2lvbiAtIERlcGVuZGVuY2llcyBhbmQgbG9jYWxpemF0aW9uCgpsb2NhbCBkZWZlciwgZXJyb3IsIGdldGZlbnYsIHNldGZlbnYsIGdldG1ldGF0YWJsZSwgc2V0bWV0YXRhYmxlLAppcGFpcnMsIHBhaXJzLCBuZXh0LCBwcmludGYsIHJhd2VxdWFsLCByYXdzZXQsIHJhd2xlbiwgcmVhZGZpbGUsIHdyaXRlZmlsZSwgcmVxdWlyZSwgc2VsZWN0LAp0b251bWJlciwgdG9zdHJpbmcsIHRvdGlja3MsIHRvdGltZSwgdHlwZSwgdW5wYWNrLCBwY2FsbCwgeHBjYWxsID0KZGVmZXIsIGVycm9yLCBnZXRmZW52LCBzZXRmZW52LCBnZXRtZXRhdGFibGUsIHNldG1ldGF0YWJsZSwKaXBhaXJzLCBwYWlycywgbmV4dCwgcHJpbnRmLCByYXdlcXVhbCwgcmF3c2V0LCByYXdsZW4sIHJlYWRmaWxlLCB3cml0ZWZpbGUsIHJlcXVpcmUsIHNlbGVjdCwKdG9udW1iZXIsIHRvc3RyaW5nLCB0b3RpY2tzLCB0b3RpbWUsIHR5cGUsIHVucGFjaywgcGNhbGwsIHhwY2FsbAoKbG9jYWwgQyA9IGZ1bmN0aW9uICh0KSBsb2NhbCBjID0ge30gaWYgdHlwZSh0KSB+PSAidGFibGUiIHRoZW4gcmV0dXJuIHQgZW5kIGZvciBrLCB2IGluIG5leHQsIHQgZG8gY1trXSA9IHYgZW5kIHJldHVybiBjIGVuZAoKbG9jYWwgdGFibGUsIG1hdGgsIHN0cmluZyA9IEModGFibGUpLCBDKG1hdGgpLCBDKHN0cmluZykKbG9jYWwgdWksIGNsaWVudCwgZGF0YWJhc2UsIGVudGl0eSwgZmZpLCBnbG9iYWxzLCBwYW5vcmFtYSwgcmVuZGVyZXIKPSBDKHVpKSwgQyhjbGllbnQpLCBDKGRhdGFiYXNlKSwgQyhlbnRpdHkpLCBDKHJlcXVpcmUgImZmaSIpLCBDKGdsb2JhbHMpLCBDKHBhbm9yYW1hKSwgQyhyZW5kZXJlcikKCi0tCgpsb2NhbCByZXF1aXJlYiA9IGZ1bmN0aW9uIChuYW1lLCBsaW5rKQogICAgbG9jYWwgcywgbGliID0gcGNhbGwocmVxdWlyZSwgbmFtZSkKICAgIGlmIG5vdCBzIHRoZW4gZXJyb3IoICgiWW91IGFyZSBub3Qgc3Vic2NyaWJlZCB0byAlcy5cbkhlcmUgaXMgdGhlIGxpbmsgdG8gdGhpcyBsaWJyYXJ5OiBnYW1lc2Vuc2UucHViL2ZvcnVtcy92aWV3dG9waWMucGhwP2lkPSVzIik6Zm9ybWF0KG5hbWUsIGxpbmspLCAzICkgZW5kCiAgICByZXR1cm4gbGliCmVuZAoKbG9jYWwgcHVpID0gcmVxdWlyZSAiZ2FtZXNlbnNlL3B1aSIKbG9jYWwgaHR0cCA9IHJlcXVpcmUgImdhbWVzZW5zZS9odHRwIgpsb2NhbCBhZGF0YSA9IHJlcXVpcmUgImdhbWVzZW5zZS9hbnRpYWltX2Z1bmNzIgpsb2NhbCB2ZWN0b3IgPSByZXF1aXJlICJ2ZWN0b3IiCmxvY2FsIG1zZ3BhY2sgPSByZXF1aXJlICJnYW1lc2Vuc2UvbXNncGFjayIKbG9jYWwgd2VhcG9uZGF0YSA9IHJlcXVpcmUgImdhbWVzZW5zZS9jc2dvX3dlYXBvbnMiCgotLSAjZW5kcmVnaW9uCgotLSAjcmVnaW9uIC0gTWlzYwoKdGFibGUuY2xlYXIgPSByZXF1aXJlICJ0YWJsZS5jbGVhciIKdGFibGUuaWZpbmQgPSBmdW5jdGlvbiAodCwgaikgIGZvciBpID0gMSwgI3QgZG8gaWYgdFtpXSA9PSBqIHRoZW4gcmV0dXJuIGkgZW5kIGVuZCAgZW5kCnRhYmxlLmFwcGVuZCA9IGZ1bmN0aW9uICh0LCAuLi4pICBmb3IgaSwgdiBpbiBpcGFpcnN7Li4ufSBkbyB0YWJsZS5pbnNlcnQodCwgdikgZW5kICBlbmQKdGFibGUubWZpbmQgPSBmdW5jdGlvbiAodCwgaikgIGZvciBpID0gMSwgdGFibGUubWF4bih0KSBkbyBpZiB0W2ldID09IGogdGhlbiByZXR1cm4gaSBlbmQgZW5kICBlbmQKdGFibGUuZmluZCA9IGZ1bmN0aW9uICh0LCBqKSAgZm9yIGssIHYgaW4gcGFpcnModCkgZG8gaWYgdiA9PSBqIHRoZW4gcmV0dXJuIGsgZW5kIGVuZCByZXR1cm4gZmFsc2UgIGVuZAp0YWJsZS5maWx0ZXIgPSBmdW5jdGlvbiAodCkgIGxvY2FsIHJlcyA9IHt9IGZvciBpID0gMSwgdGFibGUubWF4bih0KSBkbyBpZiB0W2ldIH49IG5pbCB0aGVuIHJlc1sjcmVzKzFdID0gdFtpXSBlbmQgZW5kIHJldHVybiByZXMgIGVuZAp0YWJsZS5jb3B5ID0gZnVuY3Rpb24gKG8pIGlmIHR5cGUobykgfj0gInRhYmxlIiB0aGVuIHJldHVybiBvIGVuZCBsb2NhbCByZXMgPSB7fSBmb3IgaywgdiBpbiBwYWlycyhvKSBkbyByZXNbdGFibGUuY29weShrKV0gPSB0YWJsZS5jb3B5KHYpIGVuZCByZXR1cm4gcmVzIGVuZAp0YWJsZS5paGFzID0gZnVuY3Rpb24gKHQsIC4uLikgbG9jYWwgYXJnID0gey4uLn0gZm9yIGkgPSAxLCB0YWJsZS5tYXhuKHQpIGRvIGZvciBqID0gMSwgI2FyZyBkbyBpZiB0W2ldID09IGFyZ1tqXSB0aGVuIHJldHVybiB0cnVlIGVuZCBlbmQgZW5kIHJldHVybiBmYWxzZSBlbmQKdGFibGUuZGlzdHJpYnV0ZSA9IGZ1bmN0aW9uICh0LCByLCBrKSAgbG9jYWwgcmVzdWx0ID0ge30gZm9yIGksIHYgaW4gaXBhaXJzKHQpIGRvIGxvY2FsIG4gPSBrIGFuZCB2W2tdIG9yIGkgcmVzdWx0W25dID0gciA9PSBuaWwgYW5kIGkgb3IgdltyXSBlbmQgcmV0dXJuIHJlc3VsdCAgZW5kCnRhYmxlLnBsYWNlID0gZnVuY3Rpb24gKHQsIHBhdGgsIHBsYWNlKSAgbG9jYWwgcCA9IHQgZm9yIGksIHYgaW4gaXBhaXJzKHBhdGgpIGRvIGlmIHR5cGUocFt2XSkgPT0gInRhYmxlIiB0aGVuIHAgPSBwW3ZdIGVsc2UgcFt2XSA9IChpIDwgI3BhdGgpIGFuZCB7fSBvciBwbGFjZSAgcCA9IHBbdl0gIGVuZCBlbmQgcmV0dXJuIHQgIGVuZAoKbWF0aC5lID0gMi43MTgyOAptYXRoLmdyYXRpbyA9IDEuNjE4MDMzOTg4NwptYXRoLnJhbmRvbXNlZWQoIGNsaWVudC50aW1lc3RhbXAoKSAtIDE0MyApCm1hdGgucm91bmQgPSBmdW5jdGlvbiAodikgIHJldHVybiBtYXRoLmZsb29yKHYgKyAwLjUpICBlbmQKbWF0aC5yb3VuZGIgPSBmdW5jdGlvbiAodiwgZCkgIHJldHVybiBtYXRoLmZsb29yKHYgKyAwLjUpIC8gKGQgb3IgMCkgXiAxICBlbmQKbWF0aC5jbGFtcCA9IGZ1bmN0aW9uICh4LCBhLCBiKSBpZiBhID4geCB0aGVuIHJldHVybiBhIGVsc2VpZiBiIDwgeCB0aGVuIHJldHVybiBiIGVsc2UgcmV0dXJuIHggZW5kIGVuZAptYXRoLmxlcnAgPSBmdW5jdGlvbiAoYSwgYiwgdykgIHJldHVybiBhICsgKGIgLSBhKSAqIHcgIGVuZAptYXRoLm5vcm1hbGl6ZV95YXcgPSBmdW5jdGlvbiAoeWF3KSByZXR1cm4gKHlhdyArIDE4MCkgJSAtMzYwICsgMTgwIGVuZAptYXRoLm5vcm1hbGl6ZV9waXRjaCA9IGZ1bmN0aW9uIChwaXRjaCkgcmV0dXJuIG1hdGguY2xhbXAocGl0Y2gsIC04OSwgODkpIGVuZAptYXRoLmNsb3Nlc3RfcmF5X3BvaW50ID0gZnVuY3Rpb24gKHAsIHMsIGUpCglsb2NhbCB0LCBkID0gcCAtIHMsIGUgLSBzCglsb2NhbCBsID0gZDpsZW5ndGgoKQoJZCA9IGQgLyBsCglsb2NhbCByID0gZDpkb3QodCkKCWlmIHIgPCAwIHRoZW4gcmV0dXJuIHMgZWxzZWlmIHIgPiBsIHRoZW4gcmV0dXJuIGUgZW5kCglyZXR1cm4gcyArIGQgKiByCmVuZAoKc3RyaW5nLmluc2VydCA9IGZ1bmN0aW9uIChhLCBiLCBwb3MpIHJldHVybiBzdHJpbmcuc3ViKGEsIDEsIHBvcykgLi4gYiAuLiBzdHJpbmcuc3ViKGEsIHBvcyArIDEpIGVuZApzdHJpbmcubGltaXQgPSBmdW5jdGlvbiAocywgbCwgYykgbG9jYWwgciwgaSA9IHt9LCAxIGZvciB3IGluIHN0cmluZy5nbWF0Y2gocywgIi5bXDEyOC1cMTkxXSoiKSBkbyBpLCByW2ldID0gaSArIDEsIHcgaWYgaSA+IGwgdGhlbiBpZiBjIHRoZW4gcltpXSA9IGMgPT0gdHJ1ZSBhbmQgIi4uLiIgb3IgYyBlbmQgYnJlYWsgZW5kIGVuZCByZXR1cm4gdGFibGUuY29uY2F0KHIpIGVuZAoKCi0tCgpsb2NhbCBOSUxGTiA9IGZ1bmN0aW9uKCllbmQKbG9jYWwgdGVybmFyeSA9IGZ1bmN0aW9uIChjLCBhLCBiKSAgaWYgYyB0aGVuIHJldHVybiBhIGVsc2UgcmV0dXJuIGIgZW5kICBlbmQKCmxvY2FsIG15CgotLSAjZW5kcmVnaW9uCgotLSAjZW5kcmVnaW9uCi0tCgoKLS0KLS0gI3JlZ2lvbiA6IEhlbHBlcnMKCi0tICNyZWdpb24gLSBDYWxsYmFja3MKCmxvY2FsIGNhbGxiYWNrcyBkbwoJbG9jYWwgZXZlbnRfbXQgPSB7CgkJX19jYWxsID0gZnVuY3Rpb24gKHNlbGYsIGJvb2wsIGZuKQoJCQlsb2NhbCBhY3Rpb24gPSBib29sIGFuZCBjbGllbnQuc2V0X2V2ZW50X2NhbGxiYWNrIG9yIGNsaWVudC51bnNldF9ldmVudF9jYWxsYmFjawoJCQlhY3Rpb24oc2VsZlsxXSwgZm4pCgkJZW5kLAoJCXNldCA9IGZ1bmN0aW9uIChzZWxmLCBmbikKCQkJY2xpZW50LnNldF9ldmVudF9jYWxsYmFjayhzZWxmWzFdLCBmbikKCQllbmQsCgkJdW5zZXQgPSBmdW5jdGlvbiAoc2VsZiwgZm4pCgkJCWNsaWVudC51bnNldF9ldmVudF9jYWxsYmFjayhzZWxmWzFdLCBmbikKCQllbmQsCgkJZmlyZSA9IGZ1bmN0aW9uIChzZWxmLCAuLi4pCgkJCWNsaWVudC5maXJlX2V2ZW50KHNlbGZbMV0sIC4uLikKCQllbmQsCgl9CWV2ZW50X210Ll9faW5kZXggPSBldmVudF9tdAoKCWNhbGxiYWNrcyA9IHNldG1ldGF0YWJsZSh7fSwgewoJCV9faW5kZXggPSBmdW5jdGlvbiAoc2VsZiwga2V5KQoJCQlzZWxmW2tleV0gPSBzZXRtZXRhdGFibGUoe2tleX0sIGV2ZW50X210KQoJCQlyZXR1cm4gc2VsZltrZXldCgkJZW5kLAoJfSkKZW5kCgotLSAjZW5kcmVnaW9uCgotLSAjcmVnaW9uIC0gUmVuZGVyZXIKCmxvY2FsIERQSSwgX0RQSSA9IDEsIHt9CmxvY2FsIHN3LCBzaCA9IGNsaWVudC5zY3JlZW5fc2l6ZSgpCmxvY2FsIGFzdywgYXNoID0gc3csIHNoCmxvY2FsIHNjID0ge3ggPSBzdyAqIC41LCB5ID0gc2ggKiAuNX0KbG9jYWwgYXNjID0ge3ggPSBhc3cgKiAuNSwgeSA9IGFzaCAqIC41fQoKLS0jcmVnaW9uOiBjdXN0b20gY29sb3JzCgpsb2NhbCBjb2xvciBkbwoJbG9jYWwgaGVscGVycyA9IHsKCQlSR0J0b0hFWCA9IGEoZnVuY3Rpb24gKGNvbCwgc2hvcnQpCgkJCXJldHVybiBzdHJpbmcuZm9ybWF0KHNob3J0IGFuZCAiJTAyWCUwMlglMDJYIiBvciAiJTAyWCUwMlglMDJYJTAyWCIsIGNvbC5yLCBjb2wuZywgY29sLmIsIGNvbC5hKQoJCWVuZCksCgkJSEVYdG9SR0IgPSBhKGZ1bmN0aW9uIChoZXgpCgkJCWhleCA9IHN0cmluZy5nc3ViKGhleCwgIl4jIiwgIiIpCgkJCXJldHVybiB0b251bWJlcihzdHJpbmcuc3ViKGhleCwgMSwgMiksIDE2KSwgdG9udW1iZXIoc3RyaW5nLnN1YihoZXgsIDMsIDQpLCAxNiksIHRvbnVtYmVyKHN0cmluZy5zdWIoaGV4LCA1LCA2KSwgMTYpLCB0b251bWJlcihzdHJpbmcuc3ViKGhleCwgNywgOCksIDE2KSBvciAyNTUKCQllbmQpCgl9CgoJbG9jYWwgY3JlYXRlCgoJLS0KCWxvY2FsIG10ID0gewoJCV9fZXEgPSBhKGZ1bmN0aW9uIChhLCBiKQoJCQlyZXR1cm4gYS5yID09IGIuciBhbmQgYS5nID09IGIuZyBhbmQgYS5iID09IGIuYiBhbmQgYS5hID09IGIuYQoJCWVuZCksCgkJbGVycCA9IGEoZnVuY3Rpb24gKGYsIHQsIHcpCgkJCXJldHVybiBjcmVhdGUoZi5yICsgKHQuciAtIGYucikgKiB3LCBmLmcgKyAodC5nIC0gZi5nKSAqIHcsIGYuYiArICh0LmIgLSBmLmIpICogdywgZi5hICsgKHQuYSAtIGYuYSkgKiB3KQoJCWVuZCksCgkJdG9faGV4ID0gaGVscGVycy5SR0J0b0hFWCwKCQlhbHBoZW4gPSBhKGZ1bmN0aW9uIChzZWxmLCBhLCByKQoJCQlyZXR1cm4gY3JlYXRlKHNlbGYuciwgc2VsZi5nLCBzZWxmLmIsIHIgYW5kIGEgKiBzZWxmLmEgb3IgYSkKCQllbmQpLAoJfQltdC5fX2luZGV4ID0gbXQKCgljcmVhdGUgPSBmZmkubWV0YXR5cGUoZmZpLnR5cGVvZigic3RydWN0IHsgdWludDhfdCByOyB1aW50OF90IGc7IHVpbnQ4X3QgYjsgdWludDhfdCBhOyB9IiksIG10KQoKCS0tCgljb2xvciA9IHNldG1ldGF0YWJsZSh7CgkJcmdiID0gYShmdW5jdGlvbiAocixnLGIsYSkKCQkJciA9IG1hdGgubWluKHIgb3IgMjU1LCAyNTUpCgkJCXJldHVybiBjcmVhdGUociwgZyBhbmQgbWF0aC5taW4oZywgMjU1KSBvciByLCBiIGFuZCBtYXRoLm1pbihiLCAyNTUpIG9yIHIsIGEgYW5kIG1hdGgubWluKGEsIDI1NSkgb3IgMjU1KQoJCWVuZCksCgkJaGV4ID0gYShmdW5jdGlvbiAoaGV4KQoJCQlsb2NhbCByLGcsYixhID0gaGVscGVycy5IRVh0b1JHQihoZXgpCgkJCXJldHVybiBjcmVhdGUocixnLGIsYSkKCQllbmQpCgl9LCB7CgkJX19jYWxsID0gYShmdW5jdGlvbiAoc2VsZiwgciwgZywgYiwgYSkKCQkJcmV0dXJuIHR5cGUocikgPT0gInN0cmluZyIgYW5kIHNlbGYuaGV4KHIpIG9yIHNlbGYucmdiKHIsIGcsIGIsIGEpCgkJZW5kKSwKCX0pCmVuZAoKLS0jZW5kcmVnaW9uCgotLSNyZWdpb246IGN1c3RvbSByZW5kZXJlcgoKbG9jYWwgcmVuZGVyIGRvCglsb2NhbCBhbHBoYSA9IDEKCWxvY2FsIGFzdGFjayA9IHt9CgoJbG9jYWwgbWVhc3VyZW1lbnRzID0gc2V0bWV0YXRhYmxlKHt9LCB7IF9fbW9kZSA9ICJrdiIgfSkKCgktLSAjcmVnaW9uIC0gZHBpCgoJbG9jYWwgZHBpX2ZsYWcgPSAiIgoJbG9jYWwgZHBpX3JlZiA9IHVpLnJlZmVyZW5jZSgiTUlTQyIsICJTZXR0aW5ncyIsICJEUEkgc2NhbGUiKQoKCV9EUEkuc2NhbGFibGUgPSBmYWxzZQoJX0RQSS5jYWxsYmFjayA9IGZ1bmN0aW9uICgpCgkJbG9jYWwgb2xkID0gRFBJCgkJRFBJID0gX0RQSS5zY2FsYWJsZSBhbmQgdG9udW1iZXIodWkuZ2V0KGRwaV9yZWYpOnN1YigxLCAtMikpICogLjAxIG9yIDEKCgkJc3csIHNoID0gY2xpZW50LnNjcmVlbl9zaXplKCkKCQlzdywgc2ggPSBzdyAvIERQSSwgc2ggLyBEUEkKCQlzYy54LCBzYy55ID0gc3cgKiAuNSwgc2ggKiAuNQoJCWRwaV9mbGFnID0gRFBJIH49IDEgYW5kICJkIiBvciAiIgoKCQlpZiBvbGQgfj0gRFBJIHRoZW4KCQkJY2FsbGJhY2tzWyJoeXN0ZXJpYTo6cmVuZGVyX2RwaSJdOmZpcmUoRFBJKQoJCQlvbGQgPSBEUEkKCQllbmQKCWVuZAoKCV9EUEkuY2FsbGJhY2soKQoJdWkuc2V0X2NhbGxiYWNrKGRwaV9yZWYsIF9EUEkuY2FsbGJhY2spCgoJLS0gI2VuZHJlZ2lvbgoKCS0tICNyZWdpb24gLSBibHVyCgoJbG9jYWwgYmx1cnMgPSBzZXRtZXRhdGFibGUoe30sIHtfX21vZGUgPSAia3YifSkKCglkbwoJCWxvY2FsIGZ1bmN0aW9uIGNoZWNrX3NjcmVlbiAoKQoJCQlpZiBzdyA9PSAwIG9yIHNoID09IDAgdGhlbgoJCQkJX0RQSS5jYWxsYmFjaygpCgkJCQlhc3csIGFzaCA9IGNsaWVudC5zY3JlZW5fc2l6ZSgpCgkJCQlzdywgc2ggPSByZW5kZXIuc2NyZWVuX3NpemUoKQoJCQllbHNlCgkJCQljYWxsYmFja3MucGFpbnRfdWk6dW5zZXQoY2hlY2tfc2NyZWVuKQoJCQllbmQKCQllbmQKCQljYWxsYmFja3MucGFpbnRfdWk6c2V0KGNoZWNrX3NjcmVlbikKCWVuZAoKCWNhbGxiYWNrcy5wYWludDpzZXQoZnVuY3Rpb24gKCkKCQlmb3IgaSA9IDEsICNibHVycyBkbwoJCQlsb2NhbCB2ID0gYmx1cnNbaV0KCQkJaWYgdiB0aGVuIHJlbmRlcmVyLmJsdXIodlsxXSwgdlsyXSwgdlszXSwgdls0XSkgZW5kCgkJZW5kCgkJdGFibGUuY2xlYXIoYmx1cnMpCgllbmQpCgljYWxsYmFja3MucGFpbnRfdWk6c2V0KGZ1bmN0aW9uICgpCgkJdGFibGUuY2xlYXIoYmx1cnMpCgllbmQpCgoJLS0gI2VuZHJlZ2lvbgoKCWxvY2FsIEYsIEMsIFIgPSBtYXRoLmZsb29yLCBtYXRoLmNlaWwsIG1hdGgucm91bmQKCgktLQoJcmVuZGVyID0gc2V0bWV0YXRhYmxlKHsKCQljaGVhcCA9IGZhbHNlLAoKCQlwdXNoX2FscGhhID0gYShmdW5jdGlvbiAodikKCQkJbG9jYWwgbGVuID0gI2FzdGFjawoJCQlhc3RhY2tbbGVuKzFdID0gdgoJCQlhbHBoYSA9IGFscGhhICogYXN0YWNrW2xlbisxXSAqIChhc3RhY2tbbGVuXSBvciAxKQoJCQlpZiBsZW4gPiAyNTUgdGhlbiBlcnJvciAiYWxwaGEgc3RhY2sgZXhjZWVkZWQgMjU1IG9iamVjdHMsIHJlcG9ydCB0byBkZXZlbG9wZXJzIiBlbmQKCQllbmQpLAoJCXBvcF9hbHBoYSA9IGEoZnVuY3Rpb24gKCkKCQkJbG9jYWwgbGVuID0gI2FzdGFjawoJCQlhc3RhY2tbbGVuXSwgbGVuID0gbmlsLCBsZW4tMQoJCQlhbHBoYSA9IGxlbiA9PSAwIGFuZCAxIG9yIGFzdGFja1tsZW5dICogKGFzdGFja1tsZW4tMV0gb3IgMSkKCQllbmQpLAoJCWdldF9hbHBoYSA9IGEoZnVuY3Rpb24gKCkgIHJldHVybiBhbHBoYSAgZW5kKSwKCgkJYmx1ciA9IGEoZnVuY3Rpb24gKHgsIHksIHcsIGgsIGEsIHMpCgkJCWlmIG5vdCByZW5kZXIuY2hlYXAgYW5kIG15LnZhbGlkIGFuZCAoYSBvciAxKSAqIGFscGhhID4gLjI1IHRoZW4KCQkJCWJsdXJzWyNibHVycysxXSA9IHtGKHggKiBEUEkpLCBGKHkgKiBEUEkpLCBGKHcgKiBEUEkpLCBGKGggKiBEUEkpfQoJCQllbmQKCQllbmQpLAoJCWdyYWRpZW50ID0gYShmdW5jdGlvbiAoeCwgeSwgdywgaCwgYzEsIGMyLCBkaXIpCgkJCXJlbmRlcmVyLmdyYWRpZW50KEYoeCAqIERQSSksIEYoeSAqIERQSSksIEYodyAqIERQSSksIEYoaCAqIERQSSksIGMxLnIsIGMxLmcsIGMxLmIsIGMxLmEgKiBhbHBoYSwgYzIuciwgYzIuZywgYzIuYiwgYzIuYSAqIGFscGhhLCBkaXIgb3IgZmFsc2UpCgkJZW5kKSwKCgkJbGluZSA9IGEoZnVuY3Rpb24gKHhhLCB5YSwgeGIsIHliLCBjKQoJCQlyZW5kZXJlci5saW5lKEYoeGEgKiBEUEkpLCBGKHlhICogRFBJKSwgRih4YiAqIERQSSksIEYoeWIgKiBEUEkpLCBjLnIsIGMuZywgYy5iLCBjLmEgKiBhbHBoYSkKCQllbmQpLAoJCXJlY3RhbmdsZSA9IGEoZnVuY3Rpb24gKHgsIHksIHcsIGgsIGMsIG4pCgkJCXgsIHksIHcsIGgsIG4gPSBGKHggKiBEUEkpLCBGKHkgKiBEUEkpLCBGKHcgKiBEUEkpLCBGKGggKiBEUEkpLCBuIGFuZCBGKG4gKiBEUEkpIG9yIDAKCQkJbG9jYWwgciwgZywgYiwgYSA9IGMuciwgYy5nLCBjLmIsIGMuYSAqIGFscGhhCgoJCQlpZiBuID09IDAgdGhlbgoJCQkJcmVuZGVyZXIucmVjdGFuZ2xlKHgsIHksIHcsIGgsIHIsIGcsIGIsIGEpCgkJCWVsc2UKCQkJCXJlbmRlcmVyLmNpcmNsZSh4ICsgbiwgeSArIG4sIHIsIGcsIGIsIGEsIG4sIDE4MCwgMC4yNSkKCQkJCXJlbmRlcmVyLnJlY3RhbmdsZSh4ICsgbiwgeSwgdyAtIG4gLSBuLCBuLCByLCBnLCBiLCBhKQoJCQkJcmVuZGVyZXIuY2lyY2xlKHggKyB3IC0gbiwgeSArIG4sIHIsIGcsIGIsIGEsIG4sIDkwLCAwLjI1KQoJCQkJcmVuZGVyZXIucmVjdGFuZ2xlKHgsIHkgKyBuLCB3LCBoIC0gbiAtIG4sIHIsIGcsIGIsIGEpCgkJCQlyZW5kZXJlci5jaXJjbGUoeCArIG4sIHkgKyBoIC0gbiwgciwgZywgYiwgYSwgbiwgMjcwLCAwLjI1KQoJCQkJcmVuZGVyZXIucmVjdGFuZ2xlKHggKyBuLCB5ICsgaCAtIG4sIHcgLSBuIC0gbiwgbiwgciwgZywgYiwgYSkKCQkJCXJlbmRlcmVyLmNpcmNsZSh4ICsgdyAtIG4sIHkgKyBoIC0gbiwgciwgZywgYiwgYSwgbiwgMCwgMC4yNSkKCQkJZW5kCgkJZW5kKSwKCQlyZWN0X291dGxpbmUgPSBhKGZ1bmN0aW9uICh4LCB5LCB3LCBoLCBjLCBuLCB0KQoJCQl4LCB5LCB3LCBoLCBuLCB0ID0gRih4ICogRFBJKSwgRih5ICogRFBJKSwgRih3ICogRFBJKSwgRihoICogRFBJKSwgbiBhbmQgRihuICogRFBJKSBvciAwLCB0IGFuZCBGKHQgKiBEUEkpIG9yIDEKCQkJbG9jYWwgciwgZywgYiwgYSA9IGMuciwgYy5nLCBjLmIsIGMuYSAqIGFscGhhCgoJCQlpZiBuID09IDAgdGhlbgoJCQkJcmVuZGVyZXIucmVjdGFuZ2xlKHgsIHksIHcgLSB0LCB0LCByLCBnLCBiLCBhKQoJCQkJcmVuZGVyZXIucmVjdGFuZ2xlKHgsIHkgKyB0LCB0LCBoIC0gdCwgciwgZywgYiwgYSkKCQkJCXJlbmRlcmVyLnJlY3RhbmdsZSh4ICsgdyAtIHQsIHksIHQsIGggLSB0LCByLCBnLCBiLCBhKQoJCQkJcmVuZGVyZXIucmVjdGFuZ2xlKHggKyB0LCB5ICsgaCAtIHQsIHcgLSB0LCB0LCByLCBnLCBiLCBhKQoJCQllbHNlCgkJCQlyZW5kZXJlci5jaXJjbGVfb3V0bGluZSh4ICsgbiwgeSArIG4sIHIsIGcsIGIsIGEsIG4sIDE4MCwgMC4yNSwgdCkKCQkJCXJlbmRlcmVyLnJlY3RhbmdsZSh4ICsgbiwgeSwgdyAtIG4gLSBuLCB0LCByLCBnLCBiLCBhKQoJCQkJcmVuZGVyZXIuY2lyY2xlX291dGxpbmUoeCArIHcgLSBuLCB5ICsgbiwgciwgZywgYiwgYSwgbiwgMjcwLCAwLjI1LCB0KQoJCQkJcmVuZGVyZXIucmVjdGFuZ2xlKHgsIHkgKyBuLCB0LCBoIC0gbiAtIG4sIHIsIGcsIGIsIGEpCgkJCQlyZW5kZXJlci5jaXJjbGVfb3V0bGluZSh4ICsgbiwgeSArIGggLSBuLCByLCBnLCBiLCBhLCBuLCA5MCwgMC4yNSwgdCkKCQkJCXJlbmRlcmVyLnJlY3RhbmdsZSh4ICsgbiwgeSArIGggLSB0LCB3IC0gbiAtIG4sIHQsIHIsIGcsIGIsIGEpCgkJCQlyZW5kZXJlci5jaXJjbGVfb3V0bGluZSh4ICsgdyAtIG4sIHkgKyBoIC0gbiwgciwgZywgYiwgYSwgbiwgMCwgMC4yNSwgdCkKCQkJCXJlbmRlcmVyLnJlY3RhbmdsZSh4ICsgdyAtIHQsIHkgKyBuLCB0LCBoIC0gbiAtIG4sIHIsIGcsIGIsIGEpCgkJCWVuZAoJCWVuZCksCgkJdHJpYW5nbGUgPSBhKGZ1bmN0aW9uICh4MSwgeTEsIHgyLCB5MiwgeDMsIHkzLCBjKQoJCQl4MSwgeTEsIHgyLCB5MiwgeDMsIHkzID0geDEgKiBEUEksIHkxICogRFBJLCB4MiAqIERQSSwgeTIgKiBEUEksIHgzICogRFBJLCB5MyAqIERQSQoJCQlyZW5kZXJlci50cmlhbmdsZSh4MSwgeTEsIHgyLCB5MiwgeDMsIHkzLCBjLnIsIGMuZywgYy5iLCBjLmEgKiBhbHBoYSkKCQllbmQpLAoKCQljaXJjbGUgPSBhKGZ1bmN0aW9uICh4LCB5LCBjLCByYWRpdXMsIHN0YXJ0LCBwZXJjZW50YWdlKQoJCQlyZW5kZXJlci5jaXJjbGUoeCAqIERQSSwgeSAqIERQSSwgYy5yLCBjLmcsIGMuYiwgYy5hICogYWxwaGEsIHJhZGl1cyAqIERQSSwgc3RhcnQgb3IgMCwgcGVyY2VudGFnZSBvciAxKQoJCWVuZCksCgkJY2lyY2xlX291dGxpbmUgPSBhKGZ1bmN0aW9uICh4LCB5LCBjLCByYWRpdXMsIHN0YXJ0LCBwZXJjZW50YWdlLCB0aGlja25lc3MpCgkJCXJlbmRlcmVyLmNpcmNsZSh4ICogRFBJLCB5ICogRFBJLCBjLnIsIGMuZywgYy5iLCBjLmEgKiBhbHBoYSwgcmFkaXVzICogRFBJLCBzdGFydCBvciAwLCBwZXJjZW50YWdlIG9yIDEsIHRoaWNrbmVzcyAqIERQSSkKCQllbmQpLAoKCQlzY3JlZW5fc2l6ZSA9IGEoZnVuY3Rpb24gKHJhdykKCQkJbG9jYWwgdywgaCA9IGNsaWVudC5zY3JlZW5fc2l6ZSgpCgkJCWlmIHJhdyB0aGVuIHJldHVybiB3LCBoIGVsc2UgcmV0dXJuIHcgLyBEUEksIGggLyBEUEkgZW5kCgkJZW5kKSwKCgkJbG9hZF9yZ2JhID0gYShmdW5jdGlvbiAoYywgdywgaCkgcmV0dXJuIHJlbmRlcmVyLmxvYWRfcmdiYShjLCB3LCBoKSBlbmQpLAoJCWxvYWRfanBnID0gYShmdW5jdGlvbiAoYywgdywgaCkgcmV0dXJuIHJlbmRlcmVyLmxvYWRfanBnKGMsIHcsIGgpIGVuZCksCgkJbG9hZF9wbmcgPSBhKGZ1bmN0aW9uIChjLCB3LCBoKSByZXR1cm4gcmVuZGVyZXIubG9hZF9wbmcoYywgdywgaCkgZW5kKSwKCQlsb2FkX3N2ZyA9IGEoZnVuY3Rpb24gKGMsIHcsIGgpIHJldHVybiByZW5kZXJlci5sb2FkX3N2ZyhjLCB3LCBoKSBlbmQpLAoJCXRleHR1cmUgPSBhKGZ1bmN0aW9uIChpZCwgeCwgeSwgdywgaCwgYywgbW9kZSkKCQkJaWYgbm90IGlkIHRoZW4gcmV0dXJuIGVuZAoJCQlyZW5kZXJlci50ZXh0dXJlKGlkLCBGKHggKiBEUEkpLCBGKHkgKiBEUEkpLCBGKHcgKiBEUEkpLCBGKGggKiBEUEkpLCBjLnIsIGMuZywgYy5iLCBjLmEgKiBhbHBoYSwgbW9kZSBvciAiZiIpCgkJZW5kKSwKCgkJdGV4dCA9IGEoZnVuY3Rpb24gKHgsIHksIGMsIGZsYWdzLCB3aWR0aCwgLi4uKQoJCQlyZW5kZXJlci50ZXh0KHggKiBEUEksIHkgKiBEUEksIGMuciwgYy5nLCBjLmIsIGMuYSAqIGFscGhhLCAoZmxhZ3Mgb3IgIiIpIC4uIGRwaV9mbGFnLCB3aWR0aCBvciAwLCAuLi4pCgkJZW5kKSwKCQltZWFzdXJlX3RleHQgPSBhKGZ1bmN0aW9uIChmbGFncywgdGV4dCkKCQkJaWYgbm90IHRleHQgb3IgdGV4dCA9PSAiIiB0aGVuIHJldHVybiAwLCAwIGVuZAoJCQl0ZXh0ID0gdGV4dDpnc3ViKCJcYSV4JXgleCV4JXgleCV4JXgiLCAiIikKCgkJCWZsYWdzID0gKGZsYWdzIG9yICIiKQoKCQkJbG9jYWwga2V5ID0gc3RyaW5nLmZvcm1hdCgiPCVzPiVzIiwgZmxhZ3MsIHRleHQpCgkJCWlmIG5vdCBtZWFzdXJlbWVudHNba2V5XSBvciBtZWFzdXJlbWVudHNba2V5XVsxXSA9PSAwIHRoZW4KCQkJCW1lYXN1cmVtZW50c1trZXldID0geyByZW5kZXJlci5tZWFzdXJlX3RleHQoZmxhZ3MsIHRleHQpIH0KCQkJZW5kCgkJCXJldHVybiBtZWFzdXJlbWVudHNba2V5XVsxXSwgbWVhc3VyZW1lbnRzW2tleV1bMl0KCQkJLS0gcmV0dXJuIHJlbmRlcmVyLm1lYXN1cmVfdGV4dChmbGFncywgdGV4dCkKCQllbmQpLAoJfSwge19faW5kZXggPSByZW5kZXJlcn0pCmVuZAoKLS0jZW5kcmVnaW9uCgotLSNyZWdpb246IGFuaW1hCgpsb2NhbCBhbmltYSBkbwoJbG9jYWwgbXQsIGFuaW1hdG9ycyA9IHt9LCBzZXRtZXRhdGFibGUoe30sIHtfX21vZGUgPSAia3YifSkKCWxvY2FsIGZyYW1ldGltZSwgZ19zcGVlZCA9IGdsb2JhbHMuYWJzb2x1dGVmcmFtZXRpbWUoKSwgMQoKCS0tCgoKCWFuaW1hID0gewoJCXB1bHNlID0gMCwKCgkJZWFzaW5ncyA9IHsKCQkJcG93ID0gewoJCQkJZnVuY3Rpb24gKHgsIHApIHJldHVybiAxIC0gKCgxIC0geCkgXiAocCBvciAzKSkgZW5kLAoJCQkJZnVuY3Rpb24gKHgsIHApIHJldHVybiB4IF4gKHAgb3IgMykgZW5kLAoJCQkJZnVuY3Rpb24gKHgsIHApIHJldHVybiB4IDwgMC41IGFuZCA0ICogbWF0aC5wb3coeCwgcCBvciAzKSBvciAxIC0gbWF0aC5wb3coLTIgKiB4ICsgMiwgcCBvciAzKSAqIDAuNSBlbmQsCgkJCX0KCQl9LAoKCQlsZXJwID0gYShmdW5jdGlvbiAoYSwgYiwgcywgdCkKCQkJbG9jYWwgYyA9IGEgKyAoYiAtIGEpICogZnJhbWV0aW1lICogKHMgb3IgOCkgKiBnX3NwZWVkCgkJCXJldHVybiBtYXRoLmFicyhiIC0gYykgPCAodCBvciAuMDA1KSBhbmQgYiBvciBjCgkJZW5kKSwKCgkJY29uZGl0aW9uID0gYShmdW5jdGlvbiAoaWQsIGMsIHMsIGUpCgkJCWxvY2FsIGN0eCA9IGlkWzFdIGFuZCBpZCBvciBhbmltYXRvcnNbaWRdCgkJCWlmIG5vdCBjdHggdGhlbiBhbmltYXRvcnNbaWRdID0geyBjIGFuZCAxIG9yIDAsIGMgfTsgY3R4ID0gYW5pbWF0b3JzW2lkXSBlbmQKCgkJCXMgPSBzIG9yIDQKCQkJbG9jYWwgY3VyX3MgPSBzCgkJCWlmIHR5cGUocykgPT0gInRhYmxlIiB0aGVuIGN1cl9zID0gYyBhbmQgc1sxXSBvciBzWzJdIGVuZAoKCQkJY3R4WzFdID0gbWF0aC5jbGFtcChjdHhbMV0gKyAoIGZyYW1ldGltZSAqIG1hdGguYWJzKGN1cl9zKSAqIGdfc3BlZWQgKiAoYyBhbmQgMSBvciAtMSkgKSwgMCwgMSkKCgkJCXJldHVybiAoY3R4WzFdICUgMSA9PSAwIG9yIGN1cl9zIDwgMCkgYW5kIGN0eFsxXSBvcgoJCQlhbmltYS5lYXNpbmdzLnBvd1tlIGFuZCAoYyBhbmQgZVsxXVsxXSBvciBlWzJdWzFdKSBvciAoYyBhbmQgMSBvciAzKV0oY3R4WzFdLCBlIGFuZCAoYyBhbmQgZVsxXVsyXSBvciBlWzJdWzJdKSBvciAzKQoJCWVuZCkKCX0KCgktLQoKCW10ID0gewoJCV9fY2FsbCA9IGFuaW1hLmNvbmRpdGlvbgoJfQoKCS0tCgljYWxsYmFja3MucGFpbnRfdWk6c2V0KGZ1bmN0aW9uICgpCgkJYW5pbWEucHVsc2UgPSBtYXRoLmFicyhnbG9iYWxzLnJlYWx0aW1lKCkgKiAxICUgMiAtIDEpCgkJZnJhbWV0aW1lID0gZ2xvYmFscy5hYnNvbHV0ZWZyYW1ldGltZSgpCgllbmQpCmVuZAoKLS0jZW5kcmVnaW9uCgpsb2NhbCBjb2xvcnMgPSB7CgloZXgJCT0gIlxhNzRBNkE5RkYiLAoJYWNjZW50CT0gY29sb3IuaGV4KCI3NEE2QTkiKSwKCWJhY2sJPSBjb2xvci5yZ2IoMjMsIDI2LCAyOCksCglkYXJrCT0gY29sb3IucmdiKDUsIDYsIDgpLAoJd2hpdGUJPSBjb2xvci5yZ2IoMjU1KSwKCWJsYWNrCT0gY29sb3IucmdiKDApLAoJbnVsbAk9IGNvbG9yLnJnYigwLCAwLCAwLCAwKSwKCXRleHQJPSBjb2xvci5yZ2IoMjMwKSwKCXBhbmVsID0gewoJCWwxID0gY29sb3IucmdiKDUsIDYsIDgsIDk2KSwKCQlnMSA9IGNvbG9yLnJnYig1LCA2LCA4LCAxNDApLAoJCWwyID0gY29sb3IucmdiKDIzLCAyNiwgMjgsIDk2KSwKCQlnMiA9IGNvbG9yLnJnYigyMywgMjYsIDI4LCAxNDApLAoJfQp9CgotLSAjZW5kcmVnaW9uCgotLSAjcmVnaW9uIC0gVXRpbGl0ZXMKCi0tI3JlZ2lvbjogZmlsZXN5c3RlbQoKbG9jYWwgZmlsZXN5c3RlbSA9IHt9IGRvCglsb2NhbCBtLCBpID0gImZpbGVzeXN0ZW1fc3RkaW8uZGxsIiwgIlZGaWxlU3lzdGVtMDE3IgoJbG9jYWwgYWRkX3NlYXJjaF9wYXRoCQk9IHZ0YWJsZV9iaW5kKG0sIGksIDExLCAidm9pZCAoX190aGlzY2FsbCopKHZvaWQqLCBjb25zdCBjaGFyKiwgY29uc3QgY2hhciosIGludCkiKQoJbG9jYWwgcmVtb3ZlX3NlYXJjaF9wYXRoCT0gdnRhYmxlX2JpbmQobSwgaSwgMTIsICJib29sIChfX3RoaXNjYWxsKikodm9pZCosIGNvbnN0IGNoYXIqLCBjb25zdCBjaGFyKikiKQoKCWxvY2FsIGdldF9nYW1lX2RpcmVjdG9yeSA9IHZ0YWJsZV9iaW5kKCJlbmdpbmUuZGxsIiwgIlZFbmdpbmVDbGllbnQwMTQiLCAzNiwgImNvbnN0IGNoYXIqKF9fdGhpc2NhbGwqKSh2b2lkKikiKQoJZmlsZXN5c3RlbS5nYW1lX2RpcmVjdG9yeSA9IHN0cmluZy5zdWIoZmZpLnN0cmluZyhnZXRfZ2FtZV9kaXJlY3RvcnkoKSksIDEsIC01KQoKCWFkZF9zZWFyY2hfcGF0aChmaWxlc3lzdGVtLmdhbWVfZGlyZWN0b3J5LCAiUk9PVF9QQVRIIiwgMCkKCWRlZmVyKGZ1bmN0aW9uICgpIHJlbW92ZV9zZWFyY2hfcGF0aChmaWxlc3lzdGVtLmdhbWVfZGlyZWN0b3J5LCAiUk9PVF9QQVRIIikgZW5kKQoKCWZpbGVzeXN0ZW0uY3JlYXRlX2RpcmVjdG9yeQk9IHZ0YWJsZV9iaW5kKG0sIGksIDIyLCAidm9pZCAoX190aGlzY2FsbCopKHZvaWQqLCBjb25zdCBjaGFyKiwgY29uc3QgY2hhciopIikKZW5kCgpmaWxlc3lzdGVtLmNyZWF0ZV9kaXJlY3RvcnkoImh5c3RlcmlhIiwgIlJPT1RfUEFUSCIpCgotLSNlbmRyZWdpb24KCi0tI3JlZ2lvbjogYmFzZTY0ICh0byBiZSBpbXByb3ZlZCkKCmxvY2FsIGJhc2U2NCBkbwoJbG9jYWwgZXh0cmFjdCA9IGZ1bmN0aW9uKHYsIGZyb20sIHdpZHRoKQoJCXJldHVybiBiaXQuYmFuZChiaXQucnNoaWZ0KHYsIGZyb20pLCBiaXQubHNoaWZ0KDEsIHdpZHRoKSAtIDEpCgllbmQKCglsb2NhbCBmdW5jdGlvbiBtYWtlZW5jb2RlcihhbHBoYWJldCkKCQlsb2NhbCBlbmNvZGVyLCBkZWNvZGVyID0ge30sIHt9CgkJZm9yIGkgPSAxLCA2NSBkbwoJCQlsb2NhbCBjaGFyID0gc3RyaW5nLmJ5dGUoc3RyaW5nLnN1YihhbHBoYWJldCwgaSwgaSkpIG9yIDMyIC0tIG9yICcgJwoJCQlpZiBkZWNvZGVyW2NoYXJdIH49IG5pbCB0aGVuCgkJCQllcnJvcignaW52YWxpZCBhbHBoYWJldDogZHVwbGljYXRlIGNoYXJhY3RlciAnIC4uIGNoYXIsIDMpCgkJCWVuZAoJCQllbmNvZGVyW2kgLSAxXSA9IGNoYXIKCQkJZGVjb2RlcltjaGFyXSA9IGkgLSAxCgkJZW5kCgkJcmV0dXJuIGVuY29kZXIsIGRlY29kZXIKCWVuZAoKCWxvY2FsIGVuY29kZXJzLCBkZWNvZGVycyA9IHt9LCB7fQoKCWVuY29kZXJzWydiYXNlNjQnXSwgZGVjb2RlcnNbJ2Jhc2U2NCddID0gbWFrZWVuY29kZXIoJ0FCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky89JykKCWVuY29kZXJzWydiYXNlNjR1cmwnXSwgZGVjb2RlcnNbJ2Jhc2U2NHVybCddID0gbWFrZWVuY29kZXIoJ0FCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5LV8nKQoKCWxvY2FsIGFscGhhYmV0X210ID0gewoJCV9faW5kZXggPSBmdW5jdGlvbih0YmwsIGtleSkKCQkJaWYgdHlwZShrZXkpID09ICdzdHJpbmcnIGFuZCAja2V5ID09IDY0IG9yICNrZXkgPT0gNjUgdGhlbgoJCQkJZW5jb2RlcnNba2V5XSwgZGVjb2RlcnNba2V5XSA9IG1ha2VlbmNvZGVyKGtleSkKCQkJCXJldHVybiB0Ymxba2V5XQoJCQllbmQKCQllbmQKCX0KCglzZXRtZXRhdGFibGUoZW5jb2RlcnMsIGFscGhhYmV0X210KQoJc2V0bWV0YXRhYmxlKGRlY29kZXJzLCBhbHBoYWJldF9tdCkKCgliYXNlNjQgPSB7CgkJZW5jb2RlID0gZnVuY3Rpb24gKHN0ciwgZW5jb2RlcikKCQkJZW5jb2RlciA9IGVuY29kZXJzW2VuY29kZXIgb3IgJ2Jhc2U2NCddIG9yIGVycm9yKCdpbnZhbGlkIGFscGhhYmV0IHNwZWNpZmllZCcsIDIpCgoJCQlzdHIgPSB0b3N0cmluZyhzdHIpCgoJCQlsb2NhbCB0LCBrLCBuID0ge30sIDEsICNzdHIKCQkJbG9jYWwgbGFzdG4gPSBuICUgMwoJCQlsb2NhbCBjYWNoZSA9IHt9CgoJCQlmb3IgaSA9IDEsIG4tbGFzdG4sIDMgZG8KCQkJCWxvY2FsIGEsIGIsIGMgPSBzdHJpbmcuYnl0ZShzdHIsIGksIGkrMikKCQkJCWxvY2FsIHYgPSBhKjB4MTAwMDAgKyBiKjB4MTAwICsgYwoJCQkJbG9jYWwgcyA9IGNhY2hlW3ZdCgoJCQkJaWYgbm90IHMgdGhlbgoJCQkJCXMgPSBzdHJpbmcuY2hhcihlbmNvZGVyW2V4dHJhY3QodiwxOCw2KV0sIGVuY29kZXJbZXh0cmFjdCh2LDEyLDYpXSwgZW5jb2RlcltleHRyYWN0KHYsNiw2KV0sIGVuY29kZXJbZXh0cmFjdCh2LDAsNildKQoJCQkJCWNhY2hlW3ZdID0gcwoJCQkJZW5kCgoJCQkJdFtrXSA9IHMKCQkJCWsgPSBrICsgMQoJCQllbmQKCgkJCWlmIGxhc3RuID09IDIgdGhlbgoJCQkJbG9jYWwgYSwgYiA9IHN0cmluZy5ieXRlKHN0ciwgbi0xLCBuKQoJCQkJbG9jYWwgdiA9IGEqMHgxMDAwMCArIGIqMHgxMDAKCQkJCXRba10gPSBzdHJpbmcuY2hhcihlbmNvZGVyW2V4dHJhY3QodiwxOCw2KV0sIGVuY29kZXJbZXh0cmFjdCh2LDEyLDYpXSwgZW5jb2RlcltleHRyYWN0KHYsNiw2KV0sIGVuY29kZXJbNjRdKQoJCQllbHNlaWYgbGFzdG4gPT0gMSB0aGVuCgkJCQlsb2NhbCB2ID0gc3RyaW5nLmJ5dGUoc3RyLCBuKSoweDEwMDAwCgkJCQl0W2tdID0gc3RyaW5nLmNoYXIoZW5jb2RlcltleHRyYWN0KHYsMTgsNildLCBlbmNvZGVyW2V4dHJhY3QodiwxMiw2KV0sIGVuY29kZXJbNjRdLCBlbmNvZGVyWzY0XSkKCQkJZW5kCgoJCQlyZXR1cm4gdGFibGUuY29uY2F0KHQpCgkJZW5kLAoJCWRlY29kZSA9IGZ1bmN0aW9uIChiNjQsIGRlY29kZXIpCgkJCWRlY29kZXIgPSBkZWNvZGVyc1tkZWNvZGVyIG9yICdiYXNlNjQnXSBvciBlcnJvcignaW52YWxpZCBhbHBoYWJldCBzcGVjaWZpZWQnLCAyKQoKCQkJbG9jYWwgcGF0dGVybiA9ICdbXiV3JSslLyU9XScKCQkJaWYgZGVjb2RlciB0aGVuCgkJCQlsb2NhbCBzNjIsIHM2MwoJCQkJZm9yIGNoYXJjb2RlLCBiNjRjb2RlIGluIHBhaXJzKGRlY29kZXIpIGRvCgkJCQkJaWYgYjY0Y29kZSA9PSA2MiB0aGVuIHM2MiA9IGNoYXJjb2RlCgkJCQkJZWxzZWlmIGI2NGNvZGUgPT0gNjMgdGhlbiBzNjMgPSBjaGFyY29kZQoJCQkJCWVuZAoJCQkJZW5kCgkJCQlwYXR0ZXJuID0gc3RyaW5nLmZvcm1hdCgnW14lJXclJSVzJSUlcyUlPV0nLCBzdHJpbmcuY2hhcihzNjIpLCBzdHJpbmcuY2hhcihzNjMpKQoJCQllbmQKCgkJCWI2NCA9IHN0cmluZy5nc3ViKHRvc3RyaW5nKGI2NCksIHBhdHRlcm4sICcnKQoKCQkJbG9jYWwgY2FjaGUgPSB7fQoJCQlsb2NhbCB0LCBrID0ge30sIDEKCQkJbG9jYWwgbiA9ICNiNjQKCQkJbG9jYWwgcGFkZGluZyA9IHN0cmluZy5zdWIoYjY0LCAtMikgPT0gJz09JyBhbmQgMiBvciBzdHJpbmcuc3ViKGI2NCwgLTEpID09ICc9JyBhbmQgMSBvciAwCgoJCQlmb3IgaSA9IDEsIHBhZGRpbmcgPiAwIGFuZCBuLTQgb3IgbiwgNCBkbwoJCQkJbG9jYWwgYSwgYiwgYywgZCA9IHN0cmluZy5ieXRlKGI2NCwgaSwgaSszKQoKCQkJCWxvY2FsIHYwID0gYSoweDEwMDAwMDAgKyBiKjB4MTAwMDAgKyBjKjB4MTAwICsgZAoJCQkJbG9jYWwgcyA9IGNhY2hlW3YwXQoJCQkJaWYgbm90IHMgdGhlbgoJCQkJCWxvY2FsIHYgPSBkZWNvZGVyW2FdKjB4NDAwMDAgKyBkZWNvZGVyW2JdKjB4MTAwMCArIGRlY29kZXJbY10qMHg0MCArIGRlY29kZXJbZF0KCQkJCQlzID0gc3RyaW5nLmNoYXIoZXh0cmFjdCh2LDE2LDgpLCBleHRyYWN0KHYsOCw4KSwgZXh0cmFjdCh2LDAsOCkpCgkJCQkJY2FjaGVbdjBdID0gcwoJCQkJZW5kCgoJCQkJdFtrXSA9IHMKCQkJCWsgPSBrICsgMQoJCQllbmQKCgkJCWlmIHBhZGRpbmcgPT0gMSB0aGVuCgkJCQlsb2NhbCBhLCBiLCBjID0gc3RyaW5nLmJ5dGUoYjY0LCBuLTMsIG4tMSkKCQkJCWxvY2FsIHYgPSBkZWNvZGVyW2FdKjB4NDAwMDAgKyBkZWNvZGVyW2JdKjB4MTAwMCArIGRlY29kZXJbY10qMHg0MAoJCQkJdFtrXSA9IHN0cmluZy5jaGFyKGV4dHJhY3QodiwxNiw4KSwgZXh0cmFjdCh2LDgsOCkpCgkJCWVsc2VpZiBwYWRkaW5nID09IDIgdGhlbgoJCQkJbG9jYWwgYSwgYiA9IHN0cmluZy5ieXRlKGI2NCwgbi0zLCBuLTIpCgkJCQlsb2NhbCB2ID0gZGVjb2RlclthXSoweDQwMDAwICsgZGVjb2RlcltiXSoweDEwMDAKCQkJCXRba10gPSBzdHJpbmcuY2hhcihleHRyYWN0KHYsMTYsOCkpCgkJCWVuZAoJCQlyZXR1cm4gdGFibGUuY29uY2F0KHQpCgkJZW5kCgl9CmVuZAoKLS0jZW5kcmVnaW9uCgotLSNyZWdpb246IGNsaXBib2FyZAoKbG9jYWwgY2xpcGJvYXJkIGRvCglsb2NhbCBjaGFyX2FycmF5ID0gZmZpLnR5cGVvZiAiY2hhcls/XSIKCglsb2NhbCBuYXRpdmUgPSB7CgkJR2V0Q2xpcGJvYXJkVGV4dENvdW50ID0gdnRhYmxlX2JpbmQoInZndWkyLmRsbCIsICJWR1VJX1N5c3RlbTAxMCIsIDcsICJpbnQoX190aGlzY2FsbCopKHZvaWQqKSIpLAoJCVNldENsaXBib2FyZFRleHQgPSB2dGFibGVfYmluZCgidmd1aTIuZGxsIiwgIlZHVUlfU3lzdGVtMDEwIiwgOSwgInZvaWQoX190aGlzY2FsbCopKHZvaWQqLCBjb25zdCBjaGFyKiwgaW50KSIpLAoJCUdldENsaXBib2FyZFRleHQgPSB2dGFibGVfYmluZCgidmd1aTIuZGxsIiwgIlZHVUlfU3lzdGVtMDEwIiwgMTEsICJpbnQoX190aGlzY2FsbCopKHZvaWQqLCBpbnQsIGNvbnN0IGNoYXIqLCBpbnQpIikKCX0KCgljbGlwYm9hcmQgPSB7CgkJZ2V0ID0gZnVuY3Rpb24gKCkKCQkJbG9jYWwgbGVuZ3RoID0gbmF0aXZlLkdldENsaXBib2FyZFRleHRDb3VudCgpCgkJCWlmIGxlbmd0aCA9PSAwIHRoZW4gcmV0dXJuIGVuZAoKCQkJbG9jYWwgYXJyYXkgPSBjaGFyX2FycmF5KGxlbmd0aCkKCgkJCW5hdGl2ZS5HZXRDbGlwYm9hcmRUZXh0KDAsIGFycmF5LCBsZW5ndGgpCgkJCXJldHVybiBmZmkuc3RyaW5nKGFycmF5LCBsZW5ndGggLSAxKQoJCWVuZCwKCQlzZXQgPSBmdW5jdGlvbiAodGV4dCkKCQkJdGV4dCA9IHRvc3RyaW5nKHRleHQpCgkJCW5hdGl2ZS5TZXRDbGlwYm9hcmRUZXh0KHRleHQsICN0ZXh0KQoJCWVuZAoJfQplbmQKCi0tI2VuZHJlZ2lvbgoKLS0jcmVnaW9uOiBwcmludCAvIGRlYnVnCgpsb2NhbCBwcmludGMgZG8KCWxvY2FsIG5hdGl2ZV9wcmludCA9IHZ0YWJsZV9iaW5kKCJ2c3RkbGliLmRsbCIsICJWRW5naW5lQ3ZhcjAwNyIsIDI1LCAidm9pZChfX2NkZWNsKikodm9pZCosIGNvbnN0IHZvaWQqLCBjb25zdCBjaGFyKiwgLi4uKSIpCgoJcHJpbnRjID0gZnVuY3Rpb24gKC4uLikKCQlmb3IgaSwgdiBpbiBpcGFpcnN7Li4ufSBkbwoJCQlsb2NhbCByID0gIlxhRDlEOUQ5IiAuLiBzdHJpbmcuZ3N1Yih0b3N0cmluZyh2KSwgIltcclx2XSIsIHtbIlxyIl0gPSAiXGFEOUQ5RDkiLCBbIlx2Il0gPSAiXGEiLi4gKGNvbG9ycy5oZXg6c3ViKDEsIDcpKX0pCgkJCWZvciBjb2wsIHRleHQgaW4gcjpnbWF0Y2goIlxhKCV4JXgleCV4JXgleCkoW15cYV0qKSIpIGRvCgkJCQluYXRpdmVfcHJpbnQoY29sb3IuaGV4KGNvbCksIHRleHQpCgkJCWVuZAoJCWVuZAoJCW5hdGl2ZV9wcmludChjb2xvci5yZ2IoMjE3LCAyMTcsIDIxNyksICJcbiIpCgllbmQKZW5kCgpoeXN0ZXJpYS5wcmludCA9IGZ1bmN0aW9uICguLi4pCglwcmludGMoX0FaQVpJIGFuZCAiICBcdmF6YXplcmlhXHIgICIgb3IgIiAgXHZoeXN0ZXJpYVxyICAiLCAuLi4pCmVuZAoKLS0KCmxvY2FsIGRlYnVnID0gZnVuY3Rpb24gKC4uLikKCWlmIF9ERUJVRyB0aGVuIHByaW50YygiICBcdmh5c3RlcmlhXHIgICIsIC4uLikgZW5kCmVuZAoKLS0jZW5kcmVnaW9uCgotLSNyZWdpb246IG1pc2MKCmxvY2FsIHBhbm9yYW1hX2FwaSA9IHBhbm9yYW1hLm9wZW4oKQoKbG9jYWwgbmV0d29yayA9IHsKCW9wZW5fbGluayA9IHBhbm9yYW1hX2FwaS5TdGVhbU92ZXJsYXlBUEkuT3BlbkV4dGVybmFsQnJvd3NlclVSTCwKfQoKbG9jYWwgbW91c2UgPSB7IHggPSAwLCB5ID0gMCB9IGRvCglsb2NhbCB1bmxvY2tfY3Vyc29yID0gdnRhYmxlX2JpbmQoInZndWltYXRzdXJmYWNlLmRsbCIsICJWR1VJX1N1cmZhY2UwMzEiLCA2NiwgInZvaWQoX190aGlzY2FsbCopKHZvaWQqKSIpCglsb2NhbCBsb2NrX2N1cnNvciA9IHZ0YWJsZV9iaW5kKCJ2Z3VpbWF0c3VyZmFjZS5kbGwiLCAiVkdVSV9TdXJmYWNlMDMxIiwgNjcsICJ2b2lkKF9fdGhpc2NhbGwqKSh2b2lkKikiKQoKCW1vdXNlLmxvY2sgPSBmdW5jdGlvbiAoYm9vbCkKCQlpZiBib29sIHRoZW4gbG9ja19jdXJzb3IoKSBlbHNlIHVubG9ja19jdXJzb3IoKSBlbmQKCWVuZAoKCW1vdXNlLmluX2JvdW5kcyA9IGZ1bmN0aW9uICh4LCB5LCB3LCBoKQoJCXJldHVybiAobW91c2UueCA+PSB4IGFuZCBtb3VzZS55ID49IHkpIGFuZCAobW91c2UueCA8PSAoeCArIHcpIGFuZCBtb3VzZS55IDw9ICh5ICsgaCkpCgllbmQKCgltb3VzZS5wcmVzc2VkID0gZnVuY3Rpb24gKGtleSkKCQlyZXR1cm4gY2xpZW50LmtleV9zdGF0ZShrZXkgb3IgMSkKCWVuZAoKCWNhbGxiYWNrcy5wcmVfcmVuZGVyOnNldChmdW5jdGlvbiAoKQoJCW1vdXNlLngsIG1vdXNlLnkgPSB1aS5tb3VzZV9wb3NpdGlvbigpCgkJbW91c2UueCwgbW91c2UueSA9IG1vdXNlLnggLyBEUEksIG1vdXNlLnkgLyBEUEkKCWVuZCkKZW5kCgpjbGllbnQuZXh0cmFwb2xhdGUgPSBmdW5jdGlvbiAoeCwgeSwgeiwgdmVsb2NpdHksIHRpY2tzKQoJbG9jYWwgdGltZSA9IGdsb2JhbHMudGlja2ludGVydmFsKCkgKiB0aWNrcwoJcmV0dXJuIHggKyAodmVsb2NpdHkueCAqIHRpbWUpLCB5ICsgKHZlbG9jaXR5LnkgKiB0aW1lKSwgeiArICh2ZWxvY2l0eS56ICogdGltZSkKZW5kCgpkbwoJbG9jYWwgbmF0aXZlX2dldF9jbGllbnRfZW50aXR5ID0gdnRhYmxlX2JpbmQoImNsaWVudC5kbGwiLCAiVkNsaWVudEVudGl0eUxpc3QwMDMiLCAzLCAidm9pZCooX190aGlzY2FsbCopKHZvaWQqLCBpbnQpIikKCWxvY2FsIGFuaW1zdGF0ZV90ID0gZmZpLnR5cGVvZiAnc3RydWN0IHsgY2hhciBwYWQwWzB4MThdOyBmbG9hdCBhbmltX3VwZGF0ZV90aW1lcjsgY2hhciBwYWQxWzB4Q107IGZsb2F0IHN0YXJ0ZWRfbW92aW5nX3RpbWU7IGZsb2F0IGxhc3RfbW92ZV90aW1lOyBjaGFyIHBhZDJbMHgxMF07IGZsb2F0IGxhc3RfbGJ5X3RpbWU7IGNoYXIgcGFkM1sweDhdOyBmbG9hdCBydW5fYW1vdW50OyBjaGFyIHBhZDRbMHgxMF07IHZvaWQqIGVudGl0eTsgdm9pZCogYWN0aXZlX3dlYXBvbjsgdm9pZCogbGFzdF9hY3RpdmVfd2VhcG9uOyBmbG9hdCBsYXN0X2NsaWVudF9zaWRlX2FuaW1hdGlvbl91cGRhdGVfdGltZTsgaW50CSBsYXN0X2NsaWVudF9zaWRlX2FuaW1hdGlvbl91cGRhdGVfZnJhbWVjb3VudDsgZmxvYXQgZXllX3RpbWVyOyBmbG9hdCBleWVfYW5nbGVzX3k7IGZsb2F0IGV5ZV9hbmdsZXNfeDsgZmxvYXQgZ29hbF9mZWV0X3lhdzsgZmxvYXQgY3VycmVudF9mZWV0X3lhdzsgZmxvYXQgdG9yc29feWF3OyBmbG9hdCBsYXN0X21vdmVfeWF3OyBmbG9hdCBsZWFuX2Ftb3VudDsgY2hhciBwYWQ1WzB4NF07IGZsb2F0IGZlZXRfY3ljbGU7IGZsb2F0IGZlZXRfeWF3X3JhdGU7IGNoYXIgcGFkNlsweDRdOyBmbG9hdCBkdWNrX2Ftb3VudDsgZmxvYXQgbGFuZGluZ19kdWNrX2Ftb3VudDsgY2hhciBwYWQ3WzB4NF07IGZsb2F0IGN1cnJlbnRfb3JpZ2luWzNdOyBmbG9hdCBsYXN0X29yaWdpblszXTsgZmxvYXQgdmVsb2NpdHlfeDsgZmxvYXQgdmVsb2NpdHlfeTsgY2hhciBwYWQ4WzB4NF07IGZsb2F0IHVua25vd25fZmxvYXQxOyBjaGFyIHBhZDlbMHg4XTsgZmxvYXQgdW5rbm93bl9mbG9hdDI7IGZsb2F0IHVua25vd25fZmxvYXQzOyBmbG9hdCB1bmtub3duOyBmbG9hdCBtX3ZlbG9jaXR5OyBmbG9hdCBqdW1wX2ZhbGxfdmVsb2NpdHk7IGZsb2F0IGNsYW1wZWRfdmVsb2NpdHk7IGZsb2F0IGZlZXRfc3BlZWRfZm9yd2FyZHNfb3Jfc2lkZXdheXM7IGZsb2F0IGZlZXRfc3BlZWRfdW5rbm93bl9mb3J3YXJkc19vcl9zaWRld2F5czsgZmxvYXQgbGFzdF90aW1lX3N0YXJ0ZWRfbW92aW5nOyBmbG9hdCBsYXN0X3RpbWVfc3RvcHBlZF9tb3Zpbmc7IGJvb2wgb25fZ3JvdW5kOyBib29sIGhpdF9pbl9ncm91bmRfYW5pbWF0aW9uOyBjaGFyIHBhZDEwWzB4NF07IGZsb2F0IHRpbWVfc2luY2VfaW5fYWlyOyBmbG9hdCBsYXN0X29yaWdpbl96OyBmbG9hdCBoZWFkX2Zyb21fZ3JvdW5kX2Rpc3RhbmNlX3N0YW5kaW5nOyBmbG9hdCBzdG9wX3RvX2Z1bGxfcnVubmluZ19mcmFjdGlvbjsgY2hhciBwYWQxMVsweDRdOyBmbG9hdCBtYWdpY19mcmFjdGlvbjsgY2hhciBwYWQxMlsweDNDXTsgZmxvYXQgd29ybGRfZm9yY2U7IGNoYXIgcGFkMTNbMHgxQ0FdOyBmbG9hdCBtaW5feWF3OyBmbG9hdCBtYXhfeWF3OyB9ICoqJwoJbG9jYWwgYW5pbWxheWVyX3QgPSBmZmkudHlwZW9mICdzdHJ1Y3QgeyBjaGFyIHBhZF8weDAwMDBbMHgxOF07IHVpbnQzMl90IHNlcXVlbmNlOyBmbG9hdCBwcmV2X2N5Y2xlOyBmbG9hdCB3ZWlnaHQ7IGZsb2F0IHdlaWdodF9kZWx0YV9yYXRlOyBmbG9hdCBwbGF5YmFja19yYXRlOyBmbG9hdCBjeWNsZTt2b2lkICplbnRpdHk7Y2hhciBwYWRfMHgwMDM4WzB4NF07IH0gKionCgoJZW50aXR5LmdldF9wb2ludGVyID0gZnVuY3Rpb24gKGVudCkKCQlyZXR1cm4gbmF0aXZlX2dldF9jbGllbnRfZW50aXR5KGVudCkKCWVuZAoKCWVudGl0eS5nZXRfYW5pbXN0YXRlID0gZnVuY3Rpb24gKGVudCkKCQlsb2NhbCBwb2ludGVyID0gbmF0aXZlX2dldF9jbGllbnRfZW50aXR5KGVudCkKCQlpZiBwb2ludGVyIHRoZW4gcmV0dXJuIGZmaS5jYXN0KGFuaW1zdGF0ZV90LCBmZmkuY2FzdCgiY2hhcioiLCBmZmkuY2FzdCgidm9pZCoqKiIsIHBvaW50ZXIpKSArIDB4OTk2MClbMF0gZW5kCgllbmQKCgllbnRpdHkuZ2V0X2FuaW1sYXllciA9IGZ1bmN0aW9uIChlbnQsIGxheWVyKQoJCWxvY2FsIHBvaW50ZXIgPSBuYXRpdmVfZ2V0X2NsaWVudF9lbnRpdHkoZW50KQoJCWlmIHBvaW50ZXIgdGhlbiByZXR1cm4gZmZpLmNhc3QoYW5pbWxheWVyX3QsIGZmaS5jYXN0KCdjaGFyKicsIGZmaS5jYXN0KCJ2b2lkKioqIiwgcG9pbnRlcikpICsgMHgzOTE0KVswXVtsYXllciBvciAwXSBlbmQKCWVuZAoKCWVudGl0eS5nZXRfc2ltdGltZSA9IGZ1bmN0aW9uIChlbnQpCgkJbG9jYWwgcG9pbnRlciA9IG5hdGl2ZV9nZXRfY2xpZW50X2VudGl0eShlbnQpCgkJaWYgcG9pbnRlciB0aGVuIHJldHVybiBlbnRpdHkuZ2V0X3Byb3AoZW50LCAibV9mbFNpbXVsYXRpb25UaW1lIiksIGZmaS5jYXN0KCJmbG9hdCoiLCBmZmkuY2FzdCgidWludHB0cl90IiwgcG9pbnRlcikgKyAweDI2QylbMF0gZWxzZSByZXR1cm4gMCBlbmQKCWVuZAoKCWVudGl0eS5nZXRfbWF4X2Rlc3luYyA9IGZ1bmN0aW9uIChhbmltc3RhdGUpCgkJbG9jYWwgc3BlZWRmYWN0b3IgPSBtYXRoLmNsYW1wKGFuaW1zdGF0ZS5mZWV0X3NwZWVkX2ZvcndhcmRzX29yX3NpZGV3YXlzLCAwLCAxKQoJCWxvY2FsIGF2Z19zcGVlZGZhY3RvciA9IChhbmltc3RhdGUuc3RvcF90b19mdWxsX3J1bm5pbmdfZnJhY3Rpb24gKiAtMC4zIC0gMC4yKSAqIHNwZWVkZmFjdG9yICsgMQoKCQlsb2NhbCBkdWNrX2Ftb3VudCA9IGFuaW1zdGF0ZS5kdWNrX2Ftb3VudAoJCWlmIGR1Y2tfYW1vdW50ID4gMCB0aGVuCgkJCWxvY2FsIGR1Y2tfc3BlZWQgPSBkdWNrX2Ftb3VudCAqIHNwZWVkZmFjdG9yCgoJCQlhdmdfc3BlZWRmYWN0b3IgPSBhdmdfc3BlZWRmYWN0b3IgKyAoZHVja19zcGVlZCAqICgwLjUgLSBhdmdfc3BlZWRmYWN0b3IpKQoJCWVuZAoKCQlyZXR1cm4gbWF0aC5jbGFtcChhdmdfc3BlZWRmYWN0b3IsIC41LCAxKQoJZW5kCmVuZAoKLS0jZW5kcmVnaW9uCgotLSAjZW5kcmVnaW9uCgotLSAjZW5kcmVnaW9uCi0tCgotLQotLSAjcmVnaW9uIDogRmVhdHVyZXMgaW50cm9kdWN0aW9uCgpsb2NhbCBhbnRpYWltID0gewoJc3RhdGVzID0gewoJCXsiZGVmYXVsdCIsICJEZWZhdWx0IiwgIkQifSwKCQl7InN0YW5kIiwgIlN0YW5kaW5nIiwgIlMifSwKCQl7InJ1biIsICJSdW5uaW5nIiwgIlIifSwKCQl7IndhbGsiLCAiV2Fsa2luZyIsICJXIn0sCgkJeyJhaXIiLCAiSW4tYWlyIiwgIkEifSwKCQl7ImFpcmR1Y2siLCAiQWlyLWNyb3VjaGluZyIsICJBQyJ9LAoJCXsiY3JvdWNoIiwgIkNyb3VjaGluZyIsICJDIn0sCgkJeyJzbmVhayIsICJTbmVha2luZyIsICIzIn0sCgl9LAoJcHJlc2V0cyA9IHsKCQktLSBbMV0gPSBhbnRpYnJ1dGUKCQljdXN0b20gPSB7CgkJCVsxXSA9IHt9LAoJCX0sCgl9Cn0KCmxvY2FsIHJhZ2UsIG1pc2MsIHZpc3VhbHMgPSB7fSwge30sIHt9CmxvY2FsIHZhcnMsIHJlZnMsIHRleHR1cmVzID0ge30sIHt9LCB7fQoKLS0gI2VuZHJlZ2lvbgotLQoKLS0KLS0gI3JlZ2lvbiA6IE1pc2NlbGxhbmVvdXMKCi0tICNyZWdpb24gLSBkYXRhYmFzZQoKbG9jYWwgZGIgPSB7CglrZXkgPSAiaHlzdGVyaWEiLAoJdmVyc2lvbiA9IDIsCn0gZG8KCWxvY2FsIGRhdGEgPSBkYXRhYmFzZS5yZWFkKGRiLmtleSkKCglpZiBub3QgZGF0YSB0aGVuCgkJZGF0YSA9IHsKCQkJdmVyc2lvbiA9IGRiLnZlcnNpb24sCgkJCWNvbmZpZ3MgPSB7fSwKCQkJc3RhdHMgPSB7CgkJCQlraWxsZWQgPSAwLCBldmFkZWQgPSAwLCBwbGF5dGltZSA9IDAsIGxvYWRlZCA9IDEKCQkJfSwKCQl9CgoJCWRhdGFiYXNlLndyaXRlKGRiLmtleSwgZGF0YSkKCWVuZAoKCWlmIGRhdGEudmVyc2lvbiB+PSBkYi52ZXJzaW9uIHRoZW4KCQlkYXRhLnN0YXRzLmNhbmRpZXMgPSBuaWwKCQlkYXRhLnZlcnNpb24gPSBkYi52ZXJzaW9uCgllbmQKCglpZiBub3QgZGF0YS5zdGF0cy5raWxsZWQgdGhlbiBkYXRhLnN0YXRzLmtpbGxlZCA9IDAgZW5kCglpZiBub3QgZGF0YS5zdGF0cy5ldmFkZWQgdGhlbiBkYXRhLnN0YXRzLmV2YWRlZCA9IDAgZW5kCglpZiBub3QgZGF0YS5zdGF0cy5wbGF5dGltZSB0aGVuIGRhdGEuc3RhdHMucGxheXRpbWUgPSAwIGVuZAoJaWYgbm90IGRhdGEuc3RhdHMubG9hZGVkIHRoZW4gZGF0YS5zdGF0cy5sb2FkZWQgPSAxIGVuZAoKCWRhdGEuc3RhdHMubG9hZGVkID0gZGF0YS5zdGF0cy5sb2FkZWQgKyAxCgoJLS0KCWRvCgkJbG9jYWwgZnVuY3Rpb24gYXV0b21lbW8gKCkKCQkJZGVidWcoImF1dG9zYXZlIikKCQkJY2xpZW50LmZpcmVfZXZlbnQoImh5c3RlcmlhOjpkYXRhYmFzZV93cml0ZSIpCgkJCWRhdGFiYXNlLndyaXRlKGRiLmtleSwgZGF0YSkKCQkJY2xpZW50LmRlbGF5X2NhbGwoMzAwLCBhdXRvbWVtbykKCQllbmQgY2xpZW50LmRlbGF5X2NhbGwoMzAwLCBhdXRvbWVtbykKCWVuZAoKCWRlZmVyKGZ1bmN0aW9uICgpCgkJZGF0YWJhc2Uud3JpdGUoZGIua2V5LCBkYXRhKQoJCWRhdGFiYXNlLmZsdXNoKCkKCWVuZCkKCgktLQoJc2V0bWV0YXRhYmxlKGRiLCB7CgkJX19pbmRleCA9IGRhdGEsCgkJX19jYWxsID0gZnVuY3Rpb24gKHNlbGYsIGZsdXNoKQoJCQlkYXRhYmFzZS53cml0ZShkYi5rZXksIGRhdGEpCgkJCWlmIGZsdXNoID09IHRydWUgdGhlbiBkYXRhYmFzZS5mbHVzaCgpIGVuZAoJCWVuZAogCX0pCmVuZAoKLS0gI2VuZHJlZ2lvbgoKLS0gI3JlZ2lvbiAtIGVudW1zCgpsb2NhbCBlbnVtcyA9IHsKCWhpdGdyb3VwcyA9IHsnZ2VuZXJpYycsICdoZWFkJywgJ2NoZXN0JywgJ3N0b21hY2gnLCAnbGVmdCBhcm0nLCAncmlnaHQgYXJtJywgJ2xlZnQgbGVnJywgJ3JpZ2h0IGxlZycsICduZWNrJywgJz8nLCAnZ2Vhcid9LAoJc3RhdGVzID0gdGFibGUuZGlzdHJpYnV0ZShhbnRpYWltLnN0YXRlcywgbmlsLCAxKSwKCWJ1aWxkID0gewoJCVsic3RhYmxlIl0gPSB7IiIsICIifSwKCQlbImJldGEiXSA9IHsizrIiLCAiIn0sCgkJWyJkZWJ1ZyJdID0geyLimaoiLCAiIn0sCgl9LAoJYXNwZWN0X3JhdGlvcyA9IHsKCQl7MTI1LCAiNTo0In0sCgkJezEzMywgIjQ6MyJ9LAoJCXsxNTAsICIzOjIifSwKCQl7MTYwLCAiMTY6MTAifSwKCQl7MTc4LCAiMTY6OSJ9LAoJCXsyMDAsICIyOjEifSwKCX0sCn0KCmxvY2FsIGN2YXJzID0gc2V0bWV0YXRhYmxlKHt9LCB7CglfX2luZGV4ID0gZnVuY3Rpb24gKHNlbGYsIGspCgkJbG9jYWwgdiA9IGN2YXJba10KCQlyYXdzZXQoc2VsZiwgaywgdikKCQlyZXR1cm4gdgoJZW5kCn0pCgotLSAjZW5kcmVnaW9uCgotLSAjcmVnaW9uIC0gbWUKCmxvY2FsIHBsYXllcnMgPSB7fQoKbXkgPSB7CgllbnRpdHkgPSBlbnRpdHkuZ2V0X2xvY2FsX3BsYXllcigpLAoJb3JpZ2luID0gdmVjdG9yKCksCgl2YWxpZCA9IGZhbHNlLAoJdGhyZWF0ID0gY2xpZW50LmN1cnJlbnRfdGhyZWF0KCksCgl2ZWxvY2l0eSA9IDAsCglleHBsb2l0ID0gewoJCWFjdGl2ZSA9IG5pbCwKCQlkZWZlbnNpdmUgPSBmYWxzZSwKCQlsYWdwZWVrID0gZmFsc2UsCgkJc2hpZnRlZCA9IGZhbHNlLAoJCXJlYWR5ID0gZmFsc2UsCgkJZGlmZiA9IDAsCgl9LAoJc2lkZSA9IDAsCn0gZG8KCWxvY2FsIGdldF9zdGF0ZSA9IGEoZnVuY3Rpb24gKGNtZCkKCQlpZiBteS5vbl9ncm91bmQgdGhlbgoJCQlpZiBteS5jcm91Y2hpbmcgdGhlbiByZXR1cm4gZW51bXMuc3RhdGVzLmNyb3VjaCBlbmQKCQkJaWYgbXkudmVsb2NpdHkgPiA1IHRoZW4gcmV0dXJuIG15LndhbGtpbmcgYW5kIGVudW1zLnN0YXRlcy53YWxrIG9yIGVudW1zLnN0YXRlcy5ydW4KCQkJZWxzZSByZXR1cm4gZW51bXMuc3RhdGVzLnN0YW5kIGVuZAoJCWVsc2UKCQkJLS0gcmV0dXJuIG15LmNyb3VjaGluZyBhbmQgZW51bXMuc3RhdGVzLmFpcmNyb3VjaCBvciBlbnVtcy5zdGF0ZXMuYWlyCgkJCXJldHVybiBlbnVtcy5zdGF0ZXMuYWlyCgkJZW5kCgllbmQpCgoJbG9jYWwgdGlja2Jhc2VfbWF4ID0gMAoJbG9jYWwgbGFzdF9jb21tYW5kbnVtYmVyCgoJY2FsbGJhY2tzLnByZWRpY3RfY29tbWFuZDpzZXQoZnVuY3Rpb24gKGNtZCkKCQlpZiBub3QgbXkudmFsaWQgb3IgbGFzdF9jb21tYW5kbnVtYmVyIH49IGNtZC5jb21tYW5kX251bWJlciB0aGVuIHJldHVybiBlbmQKCgkJbG9jYWwgdGlja2Jhc2UgPSBlbnRpdHkuZ2V0X3Byb3AobXkuZW50aXR5LCAibV9uVGlja0Jhc2UiKSBvciAwCgoJCWlmIHRpY2tiYXNlX21heCB+PSBuaWwgdGhlbgogICAgICAgICAgICBteS5leHBsb2l0LmRpZmYgPSB0aWNrYmFzZSAtIHRpY2tiYXNlX21heAoJCQlteS5leHBsb2l0LmRlZmVuc2l2ZSA9IG15LmV4cGxvaXQuZGlmZiA8IC0zCgoJCQlpZiBtYXRoLmFicyh0aWNrYmFzZSAtIHRpY2tiYXNlX21heCkgPiA2NCB0aGVuIHRpY2tiYXNlX21heCA9IDAgZW5kCiAgICAgICAgZW5kCgoJCXRpY2tiYXNlX21heCA9IG1hdGgubWF4KHRpY2tiYXNlLCB0aWNrYmFzZV9tYXggb3IgMCkKCWVuZCkKCgljYWxsYmFja3MuZmluaXNoX2NvbW1hbmQ6c2V0KGZ1bmN0aW9uIChjbWQpCgkJaWYgbXkudmFsaWQgdGhlbgoJCQlsYXN0X2NvbW1hbmRudW1iZXIgPSBjbWQuY29tbWFuZF9udW1iZXIKCQllbmQKCWVuZCkKCgljYWxsYmFja3MucnVuX2NvbW1hbmQ6c2V0KGZ1bmN0aW9uIChjbWQpCgkJbXkuZW50aXR5ID0gZW50aXR5LmdldF9sb2NhbF9wbGF5ZXIoKQoJCW15LnZhbGlkID0gKG15LmVudGl0eSBhbmQgZW50aXR5LmlzX2FsaXZlKG15LmVudGl0eSkpIGFuZCB0cnVlIG9yIGZhbHNlCgoJCW15LnRocmVhdCA9IG15LnZhbGlkIGFuZCBjbGllbnQuY3VycmVudF90aHJlYXQoKSBvciBuaWwKCQlteS53ZWFwb24gPSBteS52YWxpZCBhbmQgZW50aXR5LmdldF9wbGF5ZXJfd2VhcG9uKG15LmVudGl0eSkgb3IgbmlsCgoJCW15LmluX2dhbWUgPSBnbG9iYWxzLm1hcG5hbWUoKSB+PSBuaWwKCQlwbGF5ZXJzID0gZW50aXR5LmdldF9wbGF5ZXJzKCkKCgkJaWYgbXkudmFsaWQgdGhlbgoJCQlsb2NhbCB2ZWxvY2l0eSA9IHZlY3RvcihlbnRpdHkuZ2V0X3Byb3AobXkuZW50aXR5LCAibV92ZWNWZWxvY2l0eSIpKQoJCQlteS52ZWxvY2l0eSA9IHZlbG9jaXR5Omxlbmd0aDJkKCkKCgkJCW15Lm9yaWdpbiA9IHZlY3RvcihlbnRpdHkuZ2V0X3Byb3AobXkuZW50aXR5LCAibV92ZWNPcmlnaW4iKSkKCQllbmQKCWVuZCkKCgljYWxsYmFja3MucHJlX3JlbmRlcjpzZXQoZnVuY3Rpb24gKCkKCQlteS52YWxpZCA9IG15LnZhbGlkIGFuZCBnbG9iYWxzLm1hcG5hbWUoKSB+PSBuaWwKCWVuZCkKCglsb2NhbCBjb3VudGVyID0gMAoKCWNhbGxiYWNrcy5uZXRfdXBkYXRlX2VuZDpzZXQoZnVuY3Rpb24gKCkKCQlteS5lbnRpdHkgPSBlbnRpdHkuZ2V0X2xvY2FsX3BsYXllcigpCgkJbXkudmFsaWQgPSAobXkuZW50aXR5IGFuZCBlbnRpdHkuaXNfYWxpdmUobXkuZW50aXR5KSkgYW5kIHRydWUgb3IgZmFsc2UKCQlteS5nYW1lX3J1bGVzID0gZW50aXR5LmdldF9nYW1lX3J1bGVzKCkKCgkJaWYgbXkudmFsaWQgdGhlbgoJCQlsb2NhbCBzdF9jdXIsIHN0X29sZCA9IGVudGl0eS5nZXRfc2ltdGltZShteS5lbnRpdHkpCgoJCQlteS5leHBsb2l0LmxhZ3BlZWsgPSBzdF9jdXIgPCBzdF9vbGQKCgkJCS0tIGNvdW50ZXIgPSBpc190YiBhbmQgY291bnRlciArIDEgb3IgMAoJCQktLSBkZWJ1Zyhpc19zdCBhbmQgIisiIG9yICItIiwgIiBTVCAvIFRCICIsIGlzX3RiIGFuZCAiKyIgb3IgIi0iKQoJCQktLSBkZWJ1Zyhjb3VudGVyLCAiOiAiLCBpc19zdCBhbmQgIlNUICIgb3IgIiIsIGlzX3RiIGFuZCAiVEIgIiBvciAiIikKCQllbmQKCWVuZCkKCgljYWxsYmFja3Muc2V0dXBfY29tbWFuZDpzZXQoZnVuY3Rpb24gKGNtZCkKCQlteS5lbnRpdHkgPSBlbnRpdHkuZ2V0X2xvY2FsX3BsYXllcigpCgkJbXkudmFsaWQgPSAobXkuZW50aXR5IGFuZCBlbnRpdHkuaXNfYWxpdmUobXkuZW50aXR5KSkgYW5kIHRydWUgb3IgZmFsc2UKCgkJbXkudGhyZWF0ID0gbXkudmFsaWQgYW5kIGNsaWVudC5jdXJyZW50X3RocmVhdCgpIG9yIG5pbAoJCW15LndlYXBvbiA9IG15LnZhbGlkIGFuZCBlbnRpdHkuZ2V0X3BsYXllcl93ZWFwb24obXkuZW50aXR5KSBvciBuaWwKCgkJcGxheWVycyA9IGVudGl0eS5nZXRfcGxheWVycygpCgoJCWlmIG15LnZhbGlkIHRoZW4KCQkJbXkuZXhwbG9pdC5hY3RpdmUgPQoJCQkocmVmcy5yYWdlLmFpbWJvdC5kb3VibGVfdGFwWzFdLnZhbHVlIGFuZCByZWZzLnJhZ2UuYWltYm90LmRvdWJsZV90YXBbMV0uaG90a2V5OmdldCgpKSBhbmQgMCBvcgoJCQkocmVmcy5hYS5vdGhlci5vbnNob3QudmFsdWUgYW5kIHJlZnMuYWEub3RoZXIub25zaG90LmhvdGtleTpnZXQoKSkgYW5kIDEgb3IgbmlsCgkJCWlmIHJlZnMucmFnZS5vdGhlci5kdWNrOmdldCgpIHRoZW4gbXkuZXhwbG9pdC5hY3RpdmUgPSBuaWwgZW5kCgoJCQlteS5leHBsb2l0LnNoaWZ0ZWQgPSBteS5leHBsb2l0LmRpZmYgPD0gMCBvciBhZGF0YS5nZXRfZG91YmxlX3RhcCgpCgoKCQkJbG9jYWwgZmxhZ3MgPSBlbnRpdHkuZ2V0X3Byb3AobXkuZW50aXR5LCAibV9mRmxhZ3MiKQoKCQkJbXkudXNpbmcsIG15LmluX3Njb3JlID0gY21kLmluX3VzZSA9PSAxLCBjbWQuaW5fc2NvcmUgPT0gMQoJCQlteS5qdW1waW5nID0gbm90IG15Lm9uX2dyb3VuZCBvciAoY21kLmluX2p1bXAgPT0gMSkKCQkJbXkud2Fsa2luZyA9IG15LnZlbG9jaXR5ID4gNSBhbmQgKGNtZC5pbl9zcGVlZCA9PSAxKQoJCQlteS5vbl9ncm91bmQgPSBiaXQuYmFuZChmbGFncywgYml0LmxzaGlmdCgxLCAwKSkgPT0gMQoJCQlteS5jcm91Y2hpbmcgPSBjbWQuaW5fZHVjayA9PSAxCgoJCQlteS5zaWRlID0gKGNtZC5pbl9tb3ZlcmlnaHQgPT0gMSkgYW5kIC0xIG9yIChjbWQuaW5fbW92ZWxlZnQgPT0gMSkgYW5kIDEgb3IgMAoJCQlteS5zdGF0ZSA9IGdldF9zdGF0ZShjbWQpCgkJZW5kCgllbmQpCmVuZAoKLS0gI2VuZHJlZ2lvbgoKLS0gI2VuZHJlZ2lvbgotLQoKCi0tICNlbmRyZWdpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi0tCgoKCgotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQotLSAjcmVnaW9uIDo6IE1lbnUKCgotLQotLSAjcmVnaW9uIDogR1MgUmVmZXJlbmNlcwoKcmVmcyA9IHsKCXJhZ2UgPSB7CgkJYWltYm90ID0gewoJCQlmb3JjZV9iYWltID0gcHVpLnJlZmVyZW5jZSgiUkFHRSIsICJBaW1ib3QiLCAiRm9yY2UgYm9keSBhaW0iKSwKCQkJZm9yY2Vfc3AgPSBwdWkucmVmZXJlbmNlKCJSQUdFIiwgIkFpbWJvdCIsICJGb3JjZSBzYWZlIHBvaW50IiksCgkJCWhpdF9jaGFuY2UgPSBwdWkucmVmZXJlbmNlKCJSQUdFIiwgIkFpbWJvdCIsICJNaW5pbXVtIGhpdCBjaGFuY2UiKSwKCQkJZGFtYWdlID0gcHVpLnJlZmVyZW5jZSgiUkFHRSIsICJBaW1ib3QiLCAiTWluaW11bSBkYW1hZ2UiKSwKCQkJZGFtYWdlX292ciA9IHsgcHVpLnJlZmVyZW5jZSgiUkFHRSIsICJBaW1ib3QiLCAiTWluaW11bSBkYW1hZ2Ugb3ZlcnJpZGUiKSB9LAoJCQlkb3VibGVfdGFwID0geyBwdWkucmVmZXJlbmNlKCJSQUdFIiwgIkFpbWJvdCIsICJEb3VibGUgdGFwIikgfSwKCQkJZHRfZmwgPSB7IHB1aS5yZWZlcmVuY2UoIlJBR0UiLCAiQWltYm90IiwgIkRvdWJsZSB0YXAgZmFrZSBsYWcgbGltaXQiKSB9LAoJCX0sCgkJb3RoZXIgPSB7CgkJCXBlZWsgPSBwdWkucmVmZXJlbmNlKCJSQUdFIiwgIk90aGVyIiwgIlF1aWNrIHBlZWsgYXNzaXN0IiksCgkJCWR1Y2sgPSBwdWkucmVmZXJlbmNlKCJSQUdFIiwgIk90aGVyIiwgIkR1Y2sgcGVlayBhc3Npc3QiKSwKCQkJbG9nX21pc3NlcyA9IHB1aS5yZWZlcmVuY2UoIlJBR0UiLCAiT3RoZXIiLCAiTG9nIG1pc3NlcyBkdWUgdG8gc3ByZWFkIiksCgkJfQoJfSwKCWFhID0gewoJCWFuZ2xlcyA9IHsKCQkJZW5hYmxlID0gcHVpLnJlZmVyZW5jZSgiQUEiLCAiQW50aS1BaW1ib3QgYW5nbGVzIiwgIkVuYWJsZWQiKSwKCQkJcGl0Y2ggPSB7IHB1aS5yZWZlcmVuY2UoIkFBIiwgIkFudGktQWltYm90IGFuZ2xlcyIsICJQaXRjaCIpIH0sCgkJCXlhdyA9IHsgcHVpLnJlZmVyZW5jZSgiQUEiLCAiQW50aS1BaW1ib3QgYW5nbGVzIiwgIllhdyIpIH0sCgkJCWJhc2UgPSBwdWkucmVmZXJlbmNlKCJBQSIsICJBbnRpLUFpbWJvdCBhbmdsZXMiLCAiWWF3IGJhc2UiKSwKCQkJaml0dGVyID0geyBwdWkucmVmZXJlbmNlKCJBQSIsICJBbnRpLUFpbWJvdCBhbmdsZXMiLCAiWWF3IGppdHRlciIpIH0sCgkJCWJvZHkgPSB7IHB1aS5yZWZlcmVuY2UoIkFBIiwgIkFudGktQWltYm90IGFuZ2xlcyIsICJCb2R5IHlhdyIpIH0sCgkJCWVkZ2UgPSBwdWkucmVmZXJlbmNlKCJBQSIsICJBbnRpLUFpbWJvdCBhbmdsZXMiLCAiRWRnZSB5YXciKSwKCQkJZnNfYm9keSA9IHB1aS5yZWZlcmVuY2UoIkFBIiwgIkFudGktQWltYm90IGFuZ2xlcyIsICJGcmVlc3RhbmRpbmcgYm9keSB5YXciKSwKCQkJZnJlZXN0YW5kID0gcHVpLnJlZmVyZW5jZSgiQUEiLCAiQW50aS1BaW1ib3QgYW5nbGVzIiwgIkZyZWVzdGFuZGluZyIpLAoJCQlyb2xsID0gcHVpLnJlZmVyZW5jZSgiQUEiLCAiQW50aS1BaW1ib3QgYW5nbGVzIiwgIlJvbGwiKSwKCQl9LAoJCWZha2VsYWcgPSB7CgkJCWVuYWJsZSA9IHB1aS5yZWZlcmVuY2UoIkFBIiwgIkZha2UgbGFnIiwgIkVuYWJsZWQiKSwKCQkJYW1vdW50ID0gcHVpLnJlZmVyZW5jZSgiQUEiLCAiRmFrZSBsYWciLCAiQW1vdW50IiksCgkJCXZhcmlhbmNlID0gcHVpLnJlZmVyZW5jZSgiQUEiLCAiRmFrZSBsYWciLCAiVmFyaWFuY2UiKSwKCQkJbGltaXQgPSBwdWkucmVmZXJlbmNlKCJBQSIsICJGYWtlIGxhZyIsICJMaW1pdCIpLAoJCX0sCgkJb3RoZXIgPSB7CgkJCXNsb3dtbyA9IHB1aS5yZWZlcmVuY2UoIkFBIiwgIk90aGVyIiwgIlNsb3cgbW90aW9uIiksCgkJCWxlZ3MgPSBwdWkucmVmZXJlbmNlKCJBQSIsICJPdGhlciIsICJMZWcgbW92ZW1lbnQiKSwKCQkJb25zaG90ID0gcHVpLnJlZmVyZW5jZSgiQUEiLCAiT3RoZXIiLCAiT24gc2hvdCBhbnRpLWFpbSIpLAoJCQlmcCA9IHB1aS5yZWZlcmVuY2UoIkFBIiwgIk90aGVyIiwgIkZha2UgcGVlayIpLAoJCX0KCX0sCgltaXNjID0gewoJCWNsYW50YWcgPSBwdWkucmVmZXJlbmNlKCJNSVNDIiwgIk1pc2NlbGxhbmVvdXMiLCAiQ2xhbiB0YWcgc3BhbW1lciIpLAoJCWxvZ19kYW1hZ2UgPSBwdWkucmVmZXJlbmNlKCJNSVNDIiwgIk1pc2NlbGxhbmVvdXMiLCAiTG9nIGRhbWFnZSBkZWFsdCIpLAoJCXBpbmdfc3Bpa2UgPSBwdWkucmVmZXJlbmNlKCJNSVNDIiwgIk1pc2NlbGxhbmVvdXMiLCAiUGluZyBzcGlrZSIpLAoJCXNldHRpbmdzID0gewoJCQlkcGkgPSBwdWkucmVmZXJlbmNlKCJNSVNDIiwgIlNldHRpbmdzIiwgIkRQSSBzY2FsZSIpLAoJCQlhY2NlbnQgPSBwdWkucmVmZXJlbmNlKCJNSVNDIiwgIlNldHRpbmdzIiwgIk1lbnUgY29sb3IiKSwKCQkJbWF4c2hpZnQgPSBwdWkucmVmZXJlbmNlKCJNSVNDIiwgIlNldHRpbmdzIiwgInN2X21heHVzcmNtZHByb2Nlc3N0aWNrczIiKQoJCX0KCX0KfQoKZGVmZXIoZnVuY3Rpb24gKCkKCXB1aS50cmF2ZXJzZShyZWZzLCBmdW5jdGlvbiAocmVmKQoJCXJlZjpvdmVycmlkZSgpCgkJcmVmOnNldF9lbmFibGVkKHRydWUpCgkJaWYgcmVmLmhvdGtleSB0aGVuIHJlZi5ob3RrZXk6c2V0X2VuYWJsZWQodHJ1ZSkgZW5kCgllbmQpCglyZWZzLm1pc2Muc2V0dGluZ3MubWF4c2hpZnQ6c2V0X3Zpc2libGUoZmFsc2UpCmVuZCkKCi0tICNlbmRyZWdpb24KLS0KCi0tCi0tICNyZWdpb24gOiBTY3JpcHQgbWVudQoKLS0gI3JlZ2lvbiAtIEJhc2UKCnB1aS5tYWNyb3Muc2lsZW50ID0gIlxhQ0RDRENENDAiCnB1aS5tYWNyb3MucCA9ICJcYUNEQ0RDRDQw4oCiXHIgICIKcHVpLm1hY3Jvcy5oeXN0ZXJpYSA9IGNvbG9ycy5oZXgKcHVpLm1hY3Jvcy5oeXN0ZXJpYWIgPSBzdHJpbmcuc3ViKGNvbG9ycy5oZXgsIDIsIDcpCgotLSBwdWkuYWNjZW50ID0gIjc0QTZBOUZGIgoKbG9jYWwgbWVudSwgZ3JvdXBzID0gewoJeCA9IDAsIHkgPSAwLCB3ID0gMCwgaCA9IDAsCglzZXRfdmlzaWJsZSA9IGZ1bmN0aW9uIChib29sLCBhYSkKCQlwdWkudHJhdmVyc2UocmVmcy5hYSwgZnVuY3Rpb24gKHIsIHBhdGgpCgkJCWlmIGFhIGFuZCBoeXN0ZXJpYS5idWlsZCA9PSAic3RhYmxlIiBhbmQgdmFycy5hbnRpYWltLmdsb2JhbC52YWx1ZSBhbmQgcGF0aFsxXSA9PSAiYW5nbGVzIiB0aGVuCgkJCQlyOnNldF92aXNpYmxlKGZhbHNlKQoJCQllbHNlCgkJCQlyOnNldF92aXNpYmxlKGJvb2wgPT0gbmlsIGFuZCB0cnVlIG9yIGJvb2wpCgkJCWVuZAoJCWVuZCkKCWVuZCwKCXRhYnMgPSB7CgkJeyJnZW5lcmFsIiwgIkhvbWUifSwKCQl7InNldHRpbmdzIiwgIlNldHRpbmdzIn0sCgkJeyJhbnRpYWltIiwgIkFudGktYWltIn0sCgl9LAoJaGVhZGVyID0gZnVuY3Rpb24gKGdyb3VwLCB0ZXh0KQoJCWxvY2FsIHIgPSB7fQoJCWlmIHRleHQgdGhlbiByWyNyKzFdID0gZ3JvdXA6bGFiZWwoIlx24oCiXHIgICIuLiB0ZXh0KSBlbmQKCQlyWyNyKzFdID0gZ3JvdXA6bGFiZWwoIlxhMzczNzM3RkbigL7igL7igL7igL7igL7igL7igL7igL7igL7igL7igL7igL7igL7igL7igL7igL7igL7igL7igL7igL7igL7igL7igL7igL7igL7igL4iKQoJCXJldHVybiByCgllbmQsCglmZWF0dXJlID0gZnVuY3Rpb24gKG1haW4sIHNldHRpbmdzKQoJCW1haW4gPSBtYWluLl9fdHlwZSA9PSAicHVpOjplbGVtZW50IiBhbmQge21haW59IG9yIG1haW4KCQlsb2NhbCBmZWF0dXJlLCBnX2RlcGVuZCA9IHNldHRpbmdzKG1haW5bMV0pCgoJCWZvciBrLCB2IGluIHBhaXJzKGZlYXR1cmUpIGRvCgkJCXY6ZGVwZW5kKHttYWluWzFdLCBnX2RlcGVuZH0pCgkJZW5kCgkJZmVhdHVyZVttYWluLmtleSBvciAib24iXSA9IG1haW5bMV0KCgkJcmV0dXJuIGZlYXR1cmUKCWVuZCwKCXNwYWNlID0gZnVuY3Rpb24gKGdyb3VwKSByZXR1cm4gZ3JvdXA6bGFiZWwgIlxuIiBlbmQsCglsb2NrID0gZnVuY3Rpb24gKGlkLCBpdGVtLCB0bywgbWluKQoJCWlmIF9MRVZFTCA8IChtaW4gb3IgMikgdGhlbgoJCQlsb2NhbCBjYiA9IGZ1bmN0aW9uICh0aGlzKSBjbGllbnQuZGVsYXlfY2FsbCguMSwgZnVuY3Rpb24oKSB0aGlzOnNldCh0byBvciBmYWxzZSkgZW5kKSBlbmQKCQkJaXRlbTpzZXRfY2FsbGJhY2soY2IsIHRydWUpCgkJCWl0ZW06c2V0X2VuYWJsZWQoZmFsc2UpCgkJZW5kCgoJCXJldHVybiBpdGVtCgllbmQKfSwgewoJYW5nbGVzID0gcHVpLmdyb3VwKCJBQSIsICJBbnRpLWFpbWJvdCBhbmdsZXMiKSwKCWZha2VsYWcgPSBwdWkuZ3JvdXAoIkFBIiwgIkZha2UgbGFnIiksCglvdGhlciA9IHB1aS5ncm91cCgiQUEiLCAiT3RoZXIiKSwKfQoKZG8gLS0gYXV0by1oaWRlCglyZWZzLmFhLmFuZ2xlcy55YXdbMl06ZGVwZW5kKHtyZWZzLmFhLmFuZ2xlcy55YXdbMV0sIDF9KQoJcmVmcy5hYS5hbmdsZXMucGl0Y2hbMl06ZGVwZW5kKHtyZWZzLmFhLmFuZ2xlcy5waXRjaFsxXSwgMX0pCglyZWZzLmFhLmFuZ2xlcy5qaXR0ZXJbMV06ZGVwZW5kKHtyZWZzLmFhLmFuZ2xlcy55YXdbMV0sIDF9KQoJcmVmcy5hYS5hbmdsZXMuaml0dGVyWzJdOmRlcGVuZCh7cmVmcy5hYS5hbmdsZXMuaml0dGVyWzFdLCAxfSkKCXJlZnMuYWEuYW5nbGVzLmJvZHlbMl06ZGVwZW5kKHtyZWZzLmFhLmFuZ2xlcy5ib2R5WzFdLCAxfSkKCXJlZnMuYWEuYW5nbGVzLmZzX2JvZHk6ZGVwZW5kKHtyZWZzLmFhLmFuZ2xlcy5ib2R5WzFdLCAxfSkKZW5kCgpjYWxsYmFja3MucGFpbnRfdWk6c2V0KGZ1bmN0aW9uICgpCgltZW51LngsIG1lbnUueSA9IHVpLm1lbnVfcG9zaXRpb24oKQoJbWVudS53LCBtZW51LmggPSB1aS5tZW51X3NpemUoKQplbmQpCgotLSAjZW5kcmVnaW9uCgotLSAjcmVnaW9uIC0gVW5zYXZhYmxlCgptZW51Lm1haW4gPSB7CgltZW51LnNwYWNlKGdyb3Vwcy5mYWtlbGFnKSwKCWdsb2JhbCA9IGdyb3Vwcy5mYWtlbGFnOmNoZWNrYm94KF9BWkFaSSBhbmQgIlxmPHNpbGVudD4tLS0tLS0tLS0tLSAgXHbQsNC30LDQt9C4XHLQsNC30LDQt9CwICBcZjxzaWxlbnQ+LS0tLS0tLS0tLS0iIG9yICJcZjxzaWxlbnQ+LS0tLS0tLS0tLS0tLSAgXHZoeXN0XHJlcmlhICBcZjxzaWxlbnQ+LS0tLS0tLS0tLS0tLSIpLAoJYmFyID0gZ3JvdXBzLmZha2VsYWc6bGFiZWwoIlxmPHNpbGVudD7igL7igL7igL7igL7igL7igL7igL7igL7igL7igL7igL7igL7igL7igL7igL7igL7igL7igL7igL7igL7igL7igL7igL7igL7igL7igL4iKSwKCXRhYiA9IGdyb3Vwcy5mYWtlbGFnOmNvbWJvYm94KCJcbiIsIHRhYmxlLmRpc3RyaWJ1dGUobWVudS50YWJzLCAyKSksCgktLSBtZW51LnNwYWNlKGdyb3Vwcy5mYWtlbGFnKSwKfQoKbWVudS5taXNjID0gewoJb3ZlcnJpZGRlbiA9IGdyb3Vwcy5hbmdsZXM6bGFiZWwoIk92ZXJyaWRkZW4gYnkgXHZoeXN0ZXJpYSIpCn0KCm1lbnUuaW5mbyA9IHsKCXVzZXIgPSBncm91cHMuZmFrZWxhZzpsYWJlbCgiIFxmPHNpbGVudD5Vc2VyICAgXHYiLi4gaHlzdGVyaWEudXNlci5uYW1lKSwKCXZlcnNpb24gPSBncm91cHMuZmFrZWxhZzpsYWJlbCggKGh5c3RlcmlhLmJ1aWxkID09ICJzdGFibGUiIGFuZCAiIFxmPHNpbGVudD5WZXJzaW9uICAgXHYlcyIgb3IgIiBcZjxzaWxlbnQ+VmVyc2lvbiAgIFx2JXMg4oCiICVzIik6Zm9ybWF0KGh5c3RlcmlhLnZlcnNpb24sIGh5c3RlcmlhLmJ1aWxkKSApLAoJbWVudS5oZWFkZXIoZ3JvdXBzLmZha2VsYWcpCn0KCm1lbnUuZ2VuZXJhbCA9IHsKCWNvbmZpZyA9IHsKCQltZW51LmhlYWRlcihncm91cHMub3RoZXIsICJOZXcgY29uZmlnIiksCgkJbmFtZSA9IGdyb3Vwcy5vdGhlcjp0ZXh0Ym94KCJOYW1lIiksCgkJY3JlYXRlID0gZ3JvdXBzLm90aGVyOmJ1dHRvbigiQ3JlYXRlIiwgTklMRk4pLAoJCWltcG9ydCA9IGdyb3Vwcy5vdGhlcjpidXR0b24oIkltcG9ydCIsIE5JTEZOKSwKCgkJbWVudS5oZWFkZXIoZ3JvdXBzLmFuZ2xlcywgIllvdXIgY29uZmlncyIpLAoJCWxpc3QgPSBncm91cHMuYW5nbGVzOmxpc3Rib3goIkNvbmZpZ3MiLCB7IkRlZmF1bHQifSksCgkJc2VsZWN0ZWQgPSBncm91cHMuYW5nbGVzOmxhYmVsKCJTZWxlY3RlZDogXHZEZWZhdWx0IiksCgkJbGlzdF9yZXBvcnQgPSBncm91cHMuYW5nbGVzOmxhYmVsKCJSRVBPUlQiKSwKCQlsb2FkID0gZ3JvdXBzLmFuZ2xlczpidXR0b24oIlxmPGh5c3RlcmlhPkxvYWQiLCBOSUxGTiksCgkJbG9hZGFhID0gZ3JvdXBzLmFuZ2xlczpidXR0b24oIkxvYWQgQUEgb25seSIsIE5JTEZOKSwKCQlzYXZlID0gZ3JvdXBzLmFuZ2xlczpidXR0b24oIlNhdmUiLCBOSUxGTiksCgkJZXhwb3J0ID0gZ3JvdXBzLmFuZ2xlczpidXR0b24oIkV4cG9ydCIsIE5JTEZOKSwKCQlkZWxldGUgPSBncm91cHMuYW5nbGVzOmJ1dHRvbigiXGFEOTUxNDhGRkRlbGV0ZSIsIE5JTEZOKSwKCQlkZWxldGViID0gZ3JvdXBzLmFuZ2xlczpidXR0b24oIlxhRDk1MTQ4NDBEZWxldGUiLCBOSUxGTiksCgl9LAoJdmVyaWZ5ID0gewoJCW1lbnUuc3BhY2UoZ3JvdXBzLm90aGVyKSwKCQltZW51LmhlYWRlcihncm91cHMub3RoZXIsICJEaXNjb3JkIiksCgkJZ3JvdXBzLm90aGVyOmJ1dHRvbigiSm9pbiB1cyIsIGZ1bmN0aW9uICgpIG5ldHdvcmsub3Blbl9saW5rKCJodHRwczovL2Rpc2NvcmQuZ2cvZUM4MlNtY0Y5RSIpIGVuZCksCgkJYXV0aCA9IGdyb3Vwcy5vdGhlcjpidXR0b24oIkNvcHkgYXV0aGNvZGUiLCBOSUxGTiksCgl9LAp9CgptZW51LnN0YXRzID0gewoJbWVudS5oZWFkZXIoZ3JvdXBzLm90aGVyLCAiU3RhdGlzdGljcyIpLAoJbG9hZGVkID0gZ3JvdXBzLm90aGVyOmxhYmVsKCJcZjxzaWxlbnQ+VGltZXMgbG9hZGVkXHRcdiIgLi4gZGIuc3RhdHMubG9hZGVkKSwKCXBsYXl0aW1lID0gZ3JvdXBzLm90aGVyOmxhYmVsKCJcZjxzaWxlbnQ+SG91cnMgcGxheWVkXHRcdiIgLi4gbWF0aC5mbG9vcihkYi5zdGF0cy5wbGF5dGltZSksICI6IiwgbWF0aC5mbG9vcihkYi5zdGF0cy5wbGF5dGltZSAlIDEgKiA2MCkpLAoJa2lsbGVkID0gZ3JvdXBzLm90aGVyOmxhYmVsKCJcZjxzaWxlbnQ+RW5lbWllcyBlbGltaW5hdGVkXHRcdiIgLi4gZGIuc3RhdHMua2lsbGVkKSwKCWV2YWRlZCA9IGdyb3Vwcy5vdGhlcjpsYWJlbCgiXGY8c2lsZW50PkV2YWRlZCBzaG90c1x0XHYiIC4uIGRiLnN0YXRzLmV2YWRlZCksCgljYW5kaWVzID0gZ3JvdXBzLm90aGVyOmxhYmVsKCJcZjxzaWxlbnQ+Q2FuZGllcyBnYXRoZXJlZFx0XHYiIC4uIChkYXRhYmFzZS5yZWFkKCJoeXN0ZXJpYTo6Y2FuZGllcyIpIG9yIDApKSwKfQoKbWVudS5jYW5keXNob3AgPSB7fQoKLS0gI2VuZHJlZ2lvbgoKLS0gI3JlZ2lvbiAtIFZhcnMKCnZhcnMucmFnZSA9IHsKCW1lbnUuaGVhZGVyKGdyb3Vwcy5hbmdsZXMsICJSYWdlYm90IiksCgl0ZWxlcG9ydCA9IG1lbnUuZmVhdHVyZSh7Z3JvdXBzLmFuZ2xlczpjaGVja2JveCgiQXV0byB0ZWxlcG9ydCIsIDB4MDApfSwgZnVuY3Rpb24gKHBhcmVudCkKCQlyZXR1cm4gewoJCQlsYW5kID0gZ3JvdXBzLmFuZ2xlczpjaGVja2JveCgiXGY8cD5FbnN1cmUgbGFuZGluZyIpLAoJCQlwaXN0b2wgPSBncm91cHMuYW5nbGVzOmNoZWNrYm94KCJcZjxwPkFsbG93IHBpc3RvbHMiKSwKCQl9LCB0cnVlCgllbmQpLAoJZXhzd2l0Y2ggPSBtZW51LmZlYXR1cmUoe2dyb3Vwcy5hbmdsZXM6Y2hlY2tib3goIkF1dG8gZXhwbG9pdCBzd2l0Y2giKX0sIGZ1bmN0aW9uIChwYXJlbnQpCgkJcmV0dXJuIHsKCQkJYWxsb3cgPSBncm91cHMuYW5nbGVzOm11bHRpc2VsZWN0KCJcZjxwPkFkZGl0aW9uYWwgd2VhcG9ucyIsIHsiUGlzdG9scyIsICJEZXNlcnQgRWFnbGUifSksCgkJfSwgdHJ1ZQoJZW5kKSwKCXJlc29sdmVyID0gZ3JvdXBzLmFuZ2xlczpjaGVja2JveCgiSml0dGVyIHJlc29sdmVyIiksCgltZW51LnNwYWNlKGdyb3Vwcy5hbmdsZXMpCn0KCnZhcnMudmlzdWFscyA9IHsKCW1lbnUuaGVhZGVyKGdyb3Vwcy5hbmdsZXMsICJWaXN1YWxzIiksCglncm91cHMuYW5nbGVzOmxhYmVsKCJBY2NlbnQgY29sb3IiKSwKCWFjY2VudCA9IGdyb3Vwcy5hbmdsZXM6Y29sb3JfcGlja2VyKCJBY2NlbnQgY29sb3IiLCBjb2xvcnMuYWNjZW50LnIsIGNvbG9ycy5hY2NlbnQuZywgY29sb3JzLmFjY2VudC5iLCAyNTUpLAoJY3Jvc3NoYWlyID0gbWVudS5mZWF0dXJlKGdyb3Vwcy5hbmdsZXM6Y2hlY2tib3goIkNyb3NzaGFpciBpbmRpY2F0b3JzIiksIGZ1bmN0aW9uIChwYXJlbnQpCgkJcmV0dXJuIHsKCQkJc3R5bGUgPSBncm91cHMuYW5nbGVzOmNvbWJvYm94KCJcbmNoX3N0eWxlIiwgeyJDbGFzc2ljIiwgIk1pbmkifSksCgkJCWxvZ28gPSBncm91cHMuYW5nbGVzOmNoZWNrYm94KCJcZjxwPkJ1dHRlcmZseSIpLAoJCX0sIHRydWUKCWVuZCksCglkYW1hZ2UgPSBncm91cHMuYW5nbGVzOmNoZWNrYm94KCJEYW1hZ2UgaW5kaWNhdG9yIiksCglhcnJvd3MgPSBncm91cHMuYW5nbGVzOmNoZWNrYm94KCJBbnRpLWFpbSBhcnJvd3MiKSwKCXdhdGVyID0gbWVudS5mZWF0dXJlKGdyb3Vwcy5hbmdsZXM6Y2hlY2tib3goIldhdGVybWFyayIpLCBmdW5jdGlvbiAoKQoJCXJldHVybiB7CgkJCW5hbWUgPSBncm91cHMuYW5nbGVzOnRleHRib3goIlxmPHA+Q3VzdG9tIG5hbWUiKSwKCQkJaGlkZSA9IGdyb3Vwcy5hbmdsZXM6Y2hlY2tib3goIlxmPHA+SGlkZSBsb2dvIiksCgkJfSwgdHJ1ZQoJZW5kKSwKCWtleWxpc3QgPSBncm91cHMuYW5nbGVzOmNoZWNrYm94KCJLZXlsaXN0IiksCglzcGVjbGlzdCA9IGdyb3Vwcy5hbmdsZXM6Y2hlY2tib3goIlNwZWNsaXN0IiksCgltYXJrZXIgPSBncm91cHMuYW5nbGVzOmNoZWNrYm94KCJIaXRtYXJrZXIiKSwKCXNsb3dkb3duID0gZ3JvdXBzLmFuZ2xlczpjaGVja2JveCgiU2xvd2Rvd24gd2FybmluZyIpLAoJY2hlYXAgPSBncm91cHMuYW5nbGVzOmNoZWNrYm94KCJQZXJmb3JtYW5jZSBtb2RlIiksCglkcGkgPSBncm91cHMuYW5nbGVzOmNoZWNrYm94KCJEUEkgc2NhbGluZyIpLAoJbWVudS5zcGFjZShncm91cHMuYW5nbGVzKSwKfQoKdmFycy5taXNjID0gewoJbWVudS5oZWFkZXIoZ3JvdXBzLmFuZ2xlcywgIk1pc2NlbGxhbmVvdXMiKSwKCWFzcGVjdCA9IG1lbnUuZmVhdHVyZShncm91cHMuYW5nbGVzOmNoZWNrYm94KCJBc3BlY3QgcmF0aW8iKSwgZnVuY3Rpb24gKCkKCQlyZXR1cm4gewoJCQlyYXRpbyA9IGdyb3Vwcy5hbmdsZXM6c2xpZGVyKCJcbmFyYXRpbyIsIDgwLCAyMDAsIDEzMywgdHJ1ZSwgbmlsLCAuMDEsIHRhYmxlLmRpc3RyaWJ1dGUoZW51bXMuYXNwZWN0X3JhdGlvcywgMiwgMSkpCgkJfSwgdHJ1ZQoJZW5kKSwKCWxhZGRlciA9IGdyb3Vwcy5hbmdsZXM6Y2hlY2tib3goIkZhc3QgbGFkZGVyIiksCgljbGFudGFnID0gZ3JvdXBzLmFuZ2xlczpjaGVja2JveCgiQ2xhbnRhZyIpLAoJZmlsdGVyID0gZ3JvdXBzLmFuZ2xlczpjaGVja2JveCgiQ29uc29sZSBmaWx0ZXIiKSwKCWxvZ3MgPSBtZW51LmZlYXR1cmUoZ3JvdXBzLmFuZ2xlczpjaGVja2JveCgiRXZlbnRsb2dnZXIiKSwgZnVuY3Rpb24gKHBhcmVudCkKCQlyZXR1cm4gewoJCQlldmVudHMgPSBncm91cHMuYW5nbGVzOm11bHRpc2VsZWN0KCJcZjxwPkV2ZW50cyIsIHsiUmFnZWJvdCBzaG90cyIsICJIYXJtaW5nIGVuZW1pZXMiLCAiR2V0dGluZyBoYXJtZWQiLCAiQW50aS1haW0gaW5mbyJ9KSwKCQkJb3V0cHV0ID0gZ3JvdXBzLmFuZ2xlczptdWx0aXNlbGVjdCgiXGY8cD5PdXRwdXQiLCB7IkNvbnNvbGUiLCAiU2NyZWVuIn0pLAoJCX0sIHRydWUKCWVuZCksCglicmVha2VyID0gbWVudS5mZWF0dXJlKGdyb3Vwcy5hbmdsZXM6Y2hlY2tib3goIkFuaW1hdGlvbiBicmVha2VyIiksIGZ1bmN0aW9uIChwYXJlbnQpCgkJcmV0dXJuIHsKCQkJcGl0Y2ggPSBncm91cHMuYW5nbGVzOmNoZWNrYm94KCJcZjxwPlBpdGNoIDAgb24gbGFuZCIpLAoJCQlzbGlhID0gZ3JvdXBzLmFuZ2xlczpjaGVja2JveCgiXGY8cD5TdGF0aWMgbGVncyBpbiBhaXIiKSwKCQkJbGVncyA9IGdyb3Vwcy5hbmdsZXM6Y29tYm9ib3goIlxmPHA+TGVncyIsIHsiTm9uZSIsICJTdGF0aWMiLCAiSml0dGVyIiwgIk5vIHN0ZXAgYmFjayJ9KSwKCQl9LCB0cnVlCgllbmQpCn0KCnZhcnMuZHJhZyA9IHt9CgoKLS0gI2VuZHJlZ2lvbgoKLS0gI3JlZ2lvbiAtIEFudGktYWltCgp2YXJzLmFudGlhaW0gPSB7CglnbG9iYWwgPSBncm91cHMuZmFrZWxhZzpjaGVja2JveCgiRW5hYmxlIiksCgl0YWIgPSBncm91cHMuZmFrZWxhZzpjb21ib2JveCgiXG4iLCB7IkdlbmVyYWwiLCAiQnVpbGRlciJ9LCBuaWwsIGZhbHNlKSwKCglnZW5lcmFsID0gewoJCW1lbnUuaGVhZGVyKGdyb3Vwcy5hbmdsZXMsICJHZW5lcmFsIiksCgkJaW52ZXJ0ZXIgPSBncm91cHMuYW5nbGVzOmhvdGtleSgiSW52ZXJ0ZXIiLCBmYWxzZSksCgkJeWF3ID0gZ3JvdXBzLmFuZ2xlczpjb21ib2JveCgiWWF3IGJhc2UiLCB7IkF0IHRhcmdldHMiLCAiTG9jYWwgdmlldyJ9KSwKCQloZWFkID0gZ3JvdXBzLmFuZ2xlczptdWx0aXNlbGVjdCgiU2FmZSBoZWFkIiwgeyJBaXIgbWVsZWUiLCAiSGVpZ2h0IGRpZmZlcmVuY2UifSksCgkJbWFudWFsID0gbWVudS5mZWF0dXJlKGdyb3Vwcy5hbmdsZXM6Y2hlY2tib3goIk1hbnVhbCB5YXciKSwgZnVuY3Rpb24gKCkKCQkJcmV0dXJuIHsKCQkJCXN0ID0gZ3JvdXBzLmFuZ2xlczpjaGVja2JveCgiXGY8cD5TdGF0aWMgbWFudWFsIHlhdyIpLAoJCQkJbGVmdCA9IGdyb3Vwcy5hbmdsZXM6aG90a2V5KCJcZjxwPkxlZnQiLCBmYWxzZSwgMCksCgkJCQlyaWdodCA9IGdyb3Vwcy5hbmdsZXM6aG90a2V5KCJcZjxwPlJpZ2h0IiwgZmFsc2UsIDApLAoJCQkJcmVzZXQgPSBncm91cHMuYW5nbGVzOmhvdGtleSgiXGY8cD5SZXNldCIsIGZhbHNlLCAwKSwKCQkJCWVkZ2UgPSBncm91cHMuYW5nbGVzOmhvdGtleSgiXGY8cD5FZGdlIHlhdyIsIGZhbHNlLCAwKSwKCQkJCWZzID0gZ3JvdXBzLmFuZ2xlczpob3RrZXkoIlxmPHA+RnJlZXN0YW5kaW5nIiwgZmFsc2UsIDApLAoJCQl9LCB0cnVlCgkJZW5kKSwKCQlzdGFiID0gZ3JvdXBzLmFuZ2xlczpjaGVja2JveCgiQW50aS1iYWNrc3RhYiIpLAoJCXVzZSA9IGdyb3Vwcy5hbmdsZXM6Y2hlY2tib3goIk9uIHVzZSBBQSIpLAoJCXdhcm11cCA9IGdyb3Vwcy5hbmdsZXM6Y2hlY2tib3goIldhcm11cCBBQSIpLAoJCW1lbnUuc3BhY2UoZ3JvdXBzLmFuZ2xlcykKCX0sCglleHBsb2l0cyA9IHsKCQltZW51LmhlYWRlcihncm91cHMuYW5nbGVzLCAiRXhwbG9pdHMiKSwKCQl2dWxubGMgPSBncm91cHMuYW5nbGVzOm11bHRpc2VsZWN0KCJcYUI2QjY2NUZGTEMgYnJlYWtlciIsIHsiQ2FuJ3Qgc2hvb3QiLCAiSnVtcGluZyIsICJDcm91Y2hpbmcifSksCgkJc25hcCA9IG1lbnUuZmVhdHVyZShncm91cHMuYW5nbGVzOmNoZWNrYm94KCJcYUI2QjY2NUZGRGVmZW5zaXZlIHNuYXAiLCAweDAwKSwgZnVuY3Rpb24gKCkKCQkJcmV0dXJuIHsKCQkJCWxwID0gZ3JvdXBzLmFuZ2xlczpjaGVja2JveCgiXGY8cD5QaW5nLXNhZmUiKSwKCQkJCW9zID0gZ3JvdXBzLmFuZ2xlczpjaGVja2JveCgiXGY8cD5BbGxvdyB3aXRoIE9uIHNob3QgQUEiKSwKCQkJCWdyb3Vwcy5hbmdsZXM6bGFiZWwoIlxmPHA+U2VlIFx2QnVpbGRlclxyIGZvciBtb3JlIHNldHRpbmdzLiIpCgkJCX0sIHRydWUKCQllbmQpLAoJCW1lbnUuc3BhY2UoZ3JvdXBzLmFuZ2xlcykKCX0sCglsYWcgPSB7CgkJbWVudS5oZWFkZXIoZ3JvdXBzLm90aGVyLCAiTGFnIHNldHRpbmdzIiksCgkJZmFrZWxhZyA9IG1lbnUuZmVhdHVyZShncm91cHMub3RoZXI6Y2hlY2tib3goIkZha2UgbGFnIiksIGZ1bmN0aW9uICgpCgkJCXJldHVybiB7CgkJCQltb2RlID0gZ3JvdXBzLm90aGVyOmNvbWJvYm94KCJcbmZsbW9kZSIsIHsiRHluYW1pYyIsICJNYXhpbXVtIiwgIkZsdWN0dWF0ZSJ9KSwKCQkJCWxpbWl0ID0gZ3JvdXBzLm90aGVyOnNsaWRlcigiXGY8cD5MaW1pdCIsIDEsIDE1LCAxNCwgdHJ1ZSwgInQiKQoJCQl9LCB0cnVlCgkJZW5kKSwKCX0sCgoJYnVpbGRlciA9IHsKCQlzdGF0ZSA9IGdyb3Vwcy5hbmdsZXM6Y29tYm9ib3goIlx24oCiXHIgIFN0YXRlICBcYTM3MzczN0ZGLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSIsIHRhYmxlLmRpc3RyaWJ1dGUoYW50aWFpbS5zdGF0ZXMsIDIpLCBuaWwsIGZhbHNlKSwKCQktLSBtZW51LmhlYWRlcihncm91cHMub3RoZXIsICJBY3Rpb25zIHdpdGggdGhpcyBzdGF0ZSIpLAoJCS0tIGltcG9ydCA9IGdyb3Vwcy5vdGhlcjpidXR0b24oIkltcG9ydCIsIGZ1bmN0aW9uICgpIGVuZCksCgkJLS0gZXhwb3J0ID0gZ3JvdXBzLm90aGVyOmJ1dHRvbigiRXhwb3J0IiwgZnVuY3Rpb24gKCkgZW5kKSwKCX0sCglzdGF0ZXMgPSB7fSwKCXZlbnR1cmUgPSB7CgkJbG9uZyA9IHsKCQkJbWVudS5oZWFkZXIoZ3JvdXBzLm90aGVyLCAiTG9uZy10ZXJtIiksCgkJCWdhc2xpZ2h0ID0gZ3JvdXBzLm90aGVyOmNoZWNrYm94KCJHYXNsaWdodGluZyIpCgkJfSwKCQlzaG9ydCA9IHsKCQkJbWVudS5oZWFkZXIoZ3JvdXBzLmFuZ2xlcywgIkluLXRpbWUiKSwKCQl9Cgl9Cn0KCmRvIC0tIHN0YXRlcwoJbG9jYWwgbmV3ID0gZnVuY3Rpb24gKHBhdGgsIHJlZikKCQlyZWY6c2V0X2NhbGxiYWNrKGZ1bmN0aW9uIChzZWxmKSB0YWJsZS5wbGFjZShhbnRpYWltLnByZXNldHMuY3VzdG9tLCBwYXRoLCBzZWxmLnZhbHVlKSBlbmQsIHRydWUpCgkJcmV0dXJuIHJlZgoJZW5kCgoJbG9jYWwgdG9vbHRpcHMgPSB7CgkJZGVsYXkgPSB7IFsxXSA9ICJPZmYiLCBbMTVdID0gIlJTIiwgWzE2XSA9ICJSTCIsIFsxN10gPSAiQUIiIH0KCX0KCglmb3IgaSwgdiBpbiBpcGFpcnMoYW50aWFpbS5zdGF0ZXMpIGRvCgkJbG9jYWwgaWQsIG5hbWUsIHNob3J0ID0gdlsxXSwgdlsyXSwgdlszXQoKCQl2YXJzLmFudGlhaW0uc3RhdGVzW2lkXSwgcHVpLm1hY3Jvcy5fcCA9IHt9LCAiXG4iLi5zaG9ydAoJCWxvY2FsIGN0eCA9IHZhcnMuYW50aWFpbS5zdGF0ZXNbaWRdCgkJLS0KCgkJaWYgaWQgfj0gImRlZmF1bHQiIHRoZW4KCQkJY3R4Lm92ZXJyaWRlID0gbmV3KHtpZCwgIm92ZXJyaWRlIn0sIGdyb3Vwcy5hbmdsZXM6Y2hlY2tib3goIk92ZXJyaWRlIFx2Ii4uIG5hbWU6bG93ZXIoKSkpCgkJZW5kCgoJCWN0eFsjY3R4KzFdID0gbWVudS5zcGFjZShncm91cHMuYW5nbGVzKQoJCWN0eFsjY3R4KzFdID0gbWVudS5oZWFkZXIoZ3JvdXBzLmFuZ2xlcywgIllhdyIpCgoJCS0tCgkJY3R4Lnlfb2ZmCT0gbmV3KHtpZCwgInlhdyIsICJvZmZzZXQifSwgZ3JvdXBzLmFuZ2xlczpzbGlkZXIoIk9mZnNldFxmPF9wPiIsIC02MCwgNjAsIDAsIHRydWUsICLCsCIpKQoKCQljdHhbI2N0eCsxXSA9IG1lbnUuc3BhY2UoZ3JvdXBzLmFuZ2xlcykKCQljdHgubW9kCQk9IG5ldyh7aWQsICJtb2QiLCAidHlwZSJ9LCBncm91cHMuYW5nbGVzOmNvbWJvYm94KCJNb2RpZmllclxmPF9wPiIsIHsiTm9uZSIsICJKaXR0ZXIiLCAiWC13YXkiLCAiUm90YXRlIiwgIlJhbmRvbSIsIF9BWkFaSSBhbmQgItC/0LXRgNC00LXQu9GM0YLQsCIgb3IgbmlsfSkpCgkJY3R4LndfbQkJPSBuZXcoe2lkLCAid2F5cyIsICJtYW51YWwifSwgZ3JvdXBzLmFuZ2xlczpjaGVja2JveCgiXGY8cD5NYW51YWwgd2F5c1xmPF9wPiIpKQoJCWN0eC5tX3IJCT0gbmV3KHtpZCwgIm1vZCIsICJyYW5nZSJ9LCBncm91cHMuYW5nbGVzOmNoZWNrYm94KCJcZjxwPlJhbmdlXGY8X3A+IikpCgkJY3R4Lm1fYQkJPSBuZXcoe2lkLCAibW9kIiwgImFkZCJ9LCBncm91cHMuYW5nbGVzOmNoZWNrYm94KCJcZjxwPkFkZCB5YXdcZjxfcD4iKSkKCgkJLS0KCQljdHgud19udW0JPSBuZXcoe2lkLCAid2F5cyIsICJ0b3RhbCJ9LCBncm91cHMuYW5nbGVzOnNsaWRlcigiXG53bnVtIi4uIGlkLCAzLCA3LCAzLCB0cnVlLCAiLXciKSkKCQljdHgud19sYWJlbCA9IGdyb3Vwcy5hbmdsZXM6bGFiZWwoIkVhY2ggd2F5XGY8X3A+IikgY3R4LndfbGFiZWw6ZGVwZW5kKHtjdHgubW9kLCAiWC13YXkifSwgY3R4LndfbSkKCQljdHgud19udW06c2V0X2NhbGxiYWNrKGZ1bmN0aW9uICh0aGlzKSBjdHgud19sYWJlbDpzZXQoIkVhY2ggd2F5IFxhQ0RDRENENjAiIC4uIHRoaXMudmFsdWUpIGVuZCwgdHJ1ZSkKCgkJY3R4LndheXMgPSB7fSBmb3IgdyA9IDEsIDcgZG8KCQkJY3R4LndheXNbd10gPSBuZXcoe2lkLCAid2F5Iiwgd30sIGdyb3Vwcy5hbmdsZXM6c2xpZGVyKCJcbiIuLncuLmlkLCAtNjAsIDYwLCAwLCB0cnVlLCAiwrAiLCAxLCB7WzBdID0gIlIifSkpCgkJCWN0eC53YXlzW3ddOmRlcGVuZCh7Y3R4Lm1vZCwgIlgtd2F5In0sIGN0eC53X20sIHtjdHgud19udW0sIHcsIDd9KQoJCWVuZAoKCQktLQoJCWN0eC5tX2QJCT0gbmV3KHtpZCwgIm1vZCIsICJkZWdyZWUifSwgZ3JvdXBzLmFuZ2xlczpzbGlkZXIoIkRlZ3JlZVxmPF9wPiIsIC02MCwgNjAsIDAsIHRydWUsICLCsCIpKQoJCWN0eC5tX21pbgk9IG5ldyh7aWQsICJtb2QiLCAibWluIn0sIGdyb3Vwcy5hbmdsZXM6c2xpZGVyKCJSYW5nZSBcYUNEQ0RDRDYwbWluL21heFxmPF9wPiIsIC02MCwgNjAsIDAsIHRydWUsICLCsCIpKQoJCWN0eC5tX21heAk9IG5ldyh7aWQsICJtb2QiLCAibWF4In0sIGdyb3Vwcy5hbmdsZXM6c2xpZGVyKCJcbm1vZG1heFxmPF9wPiIsIC02MCwgNjAsIDAsIHRydWUsICLCsCIpKQoJCWN0eC5tX2FsCT0gbmV3KHtpZCwgIm1vZCIsICJsZWZ0In0sIGdyb3Vwcy5hbmdsZXM6c2xpZGVyKCJBZGQgXGFDRENEQ0Q2MGxlZnQvcmlnaHRcZjxfcD4iLCAtNjAsIDYwLCAwLCB0cnVlLCAiwrAiKSkKCQljdHgubV9hcgk9IG5ldyh7aWQsICJtb2QiLCAicmlnaHQifSwgZ3JvdXBzLmFuZ2xlczpzbGlkZXIoIlxuYXJcZjxfcD4iLCAtNjAsIDYwLCAwLCB0cnVlLCAiwrAiKSkKCgoJCS0tCgkJY3R4WyNjdHgrMV0JPSBtZW51LnNwYWNlKGdyb3Vwcy5hbmdsZXMpCgkJY3R4WyNjdHgrMV0JPSBtZW51LmhlYWRlcihncm91cHMuYW5nbGVzLCAiRGVzeW5jIikKCQljdHguZF9vbgk9IG5ldyh7aWQsICJib2R5IiwgIm9uIn0sIGdyb3Vwcy5hbmdsZXM6Y2hlY2tib3goIkJvZHkgeWF3XGY8X3A+IikpCgkJY3R4LmRfc3cJPSBuZXcoe2lkLCAiYm9keSIsICJqaXR0ZXIifSwgZ3JvdXBzLmFuZ2xlczpjaGVja2JveCgiXGY8cD5KaXR0ZXJcZjxfcD4iKSkKCQljdHguZF9ydwk9IG5ldyh7aWQsICJib2R5IiwgInJlbGF0aXZlIn0sIGdyb3Vwcy5hbmdsZXM6Y2hlY2tib3goIlxmPHA+UmVsYXRpdmUgWC13YXlcZjxfcD4iKSkKCQljdHguZF9tb2RlCT0gbmV3KHtpZCwgImJvZHkiLCAibW9kZSJ9LCBncm91cHMuYW5nbGVzOmNvbWJvYm94KCJCb2R5IHlhdyBtb2RlXGY8X3A+IiwgeyJBdXRvIiwgIkRlZmF1bHQiLCAiU2lkZS1iYXNlZCJ9KSkKCQljdHguZF9kCQk9IG5ldyh7aWQsICJib2R5IiwgImRlZ3JlZSJ9LCBncm91cHMuYW5nbGVzOnNsaWRlcigiXG5mZGVnXGY8X3A+IiwgLTE4MCwgMTgwLCAwLCB0cnVlLCAiwrAiKSkKCQljdHguZF9sCQk9IG5ldyh7aWQsICJib2R5IiwgImxlZnQifSwgZ3JvdXBzLmFuZ2xlczpzbGlkZXIoIlJhbmdlIFxhQ0RDRENENjBsZWZ0L3JpZ2h0XG5ib2R5bFxmPF9wPiIsIC0xODAsIDE4MCwgMCwgdHJ1ZSwgIsKwIikpCgkJY3R4LmRfcgkJPSBuZXcoe2lkLCAiYm9keSIsICJyaWdodCJ9LCBncm91cHMuYW5nbGVzOnNsaWRlcigiXG5ib2R5clxmPF9wPiIsIC0xODAsIDE4MCwgMCwgdHJ1ZSwgIsKwIikpCgkJLS0gY3R4LmRfZGJhc2UJPSBncm91cHMuYW5nbGVzOnNsaWRlcigiRm9vdCBiYXNlXGY8X3A+IiwgLTE4MCwgMTgwLCAwLCB0cnVlLCAiwrAiKQoJCS0tIGN0eC5kX2Rwb3cJPSBncm91cHMuYW5nbGVzOnNsaWRlcigiT3ZlcmRyaXZlXGY8X3A+IiwgMCwgNTAsIDAsIHRydWUsICLPiSIsIDAuMSkKCgkJLS0KCQljdHhbI2N0eCsxXQk9IG1lbnUuaGVhZGVyKGdyb3Vwcy5vdGhlciwgIkFkdmFuY2VkIikKCQljdHgucl9pcgk9IG5ldyh7aWQsICJhZHYiLCAiaXJyZWcifSwgZ3JvdXBzLm90aGVyOnNsaWRlcigiSXJyZWd1bGFyaXR5XGY8X3A+IiwgMCwgMTAwLCAwLCB0cnVlLCAiJSIpKQoJCWN0eC5yX2R0CT0gbmV3KHtpZCwgImFkdiIsICJkZWxheSJ9LCBncm91cHMub3RoZXI6c2xpZGVyKCJEZWxheSB0aWNrXGY8X3A+IiwgMSwgMTcsIDAsIHRydWUsICJ0IiwgMSwgdG9vbHRpcHMuZGVsYXkpKQoJCWN0eC5kcwkJPSBuZXcoe2lkLCAic25hcCIsICJvbiJ9LCBncm91cHMub3RoZXI6Y29tYm9ib3goIkRlZmVuc2l2ZSBzbmFwXGY8X3A+IiwgaWQgPT0gImRlZmF1bHQiIGFuZCB7Ik9mZiIsICJDdXN0b20ifSBvciB7IkRlZmF1bHQiLCAiT2ZmIiwgIkN1c3RvbSJ9KSkKCQljdHguZHNwIAk9IG5ldyh7aWQsICJzbmFwIiwgInBpdGNoIn0sIGdyb3Vwcy5vdGhlcjpjb21ib2JveCgiXGY8cD5QaXRjaFxmPF9wPiIsIHsiTm9uZSIsICJTd2l0Y2giLCAiUmFuZG9tIiwgIlNwaW4ifSkpCgkJY3R4LmRzcDEJPSBuZXcoe2lkLCAic25hcCIsICJwaXRjaF9taW4ifSwgZ3JvdXBzLm90aGVyOnNsaWRlcigiXGY8X3A+cG1pbiIsIC04OSwgODksIC00NSwgdHJ1ZSwgIsKwIikpCgkJY3R4LmRzcDIJPSBuZXcoe2lkLCAic25hcCIsICJwaXRjaF9tYXgifSwgZ3JvdXBzLm90aGVyOnNsaWRlcigiXGY8X3A+cG1heCIsIC04OSwgODksIC00NSwgdHJ1ZSwgIsKwIikpCgkJY3R4LmRzeQkJPSBuZXcoe2lkLCAic25hcCIsICJ5YXcifSwgZ3JvdXBzLm90aGVyOmNvbWJvYm94KCJcZjxwPllhd1xmPF9wPiIsIHsiTm9uZSIsICJTd2l0Y2giLCAiUmFuZG9tIiwgIlNwaW4iLCBfQVpBWkkgYW5kICLQsNC30LDQt9C+0LkiIG9yIG5pbH0pKQoJCWN0eC5kc3kxCT0gbmV3KHtpZCwgInNuYXAiLCAieWF3X21pbiJ9LCBncm91cHMub3RoZXI6c2xpZGVyKCJcZjxfcD55bWluIiwgMCwgMzYwLCAxODAsIHRydWUsICLCsCIpKQoJCS0tIGN0eC5kc3kyCT0gbmV3KHtpZCwgInNuYXAiLCAieWF3X21heCJ9LCBncm91cHMub3RoZXI6c2xpZGVyKCJcZjxfcD55bWF4IiwgLTE4MCwgMTgwLCA5MCwgdHJ1ZSwgIsKwIikpCgoJCS0tCgkJZG8KCQkJY3R4LmRfc3c6ZGVwZW5kKGN0eC5kX29uKQoJCQljdHguZF9tb2RlOmRlcGVuZChjdHguZF9vbikKCQkJY3R4LmRfZDpkZXBlbmQoY3R4LmRfb24sIHtjdHguZF9tb2RlLCAiRGVmYXVsdCJ9KQoJCQljdHguZF9sOmRlcGVuZChjdHguZF9vbiwge2N0eC5kX21vZGUsICJTaWRlLWJhc2VkIn0pCgkJCWN0eC5kX3I6ZGVwZW5kKGN0eC5kX29uLCB7Y3R4LmRfbW9kZSwgIlNpZGUtYmFzZWQifSkKCQkJLS0gY3R4LmRfZGJhc2U6ZGVwZW5kKGN0eC5kX29uLCB7Y3R4LmRfbW9kZSwgIkR5bmFtaWMifSkKCQkJLS0gY3R4LmRfZHBvdzpkZXBlbmQoY3R4LmRfb24sIHtjdHguZF9tb2RlLCAiRHluYW1pYyJ9KQoJCQljdHguZF9ydzpkZXBlbmQoY3R4LmRfb24sIHtjdHgubW9kLCAiWC13YXkifSkKCQllbmQKCQlkbwoJCQlsb2NhbCB3YXlzX2NoZWNrID0gZnVuY3Rpb24gKCkgcmV0dXJuIG5vdCAoY3R4Lm1vZC52YWx1ZSA9PSAiWC13YXkiIGFuZCBjdHgud19tLnZhbHVlKSBlbmQKCgkJCWN0eC53X206ZGVwZW5kKHtjdHgubW9kLCAiWC13YXkifSkKCQkJY3R4Lm1fcjpkZXBlbmQoe2N0eC5tb2QsICJOb25lIiwgdHJ1ZX0sIHtjdHgud19tLCB3YXlzX2NoZWNrfSkKCQkJY3R4Lm1fYTpkZXBlbmQoe2N0eC5tb2QsICJOb25lIiwgdHJ1ZX0pCgoJCQljdHgubV9kOmRlcGVuZCh7Y3R4Lm1fciwgZmFsc2V9LCB7Y3R4Lm1vZCwgIk5vbmUiLCB0cnVlfSwge2N0eC53X20sIHdheXNfY2hlY2t9KQoJCQljdHgubV9taW46ZGVwZW5kKHtjdHgubV9yLCB0cnVlfSwge2N0eC5tb2QsICJOb25lIiwgdHJ1ZX0sIHtjdHgud19tLCB3YXlzX2NoZWNrfSkKCQkJY3R4Lm1fbWF4OmRlcGVuZCh7Y3R4Lm1fciwgdHJ1ZX0sIHtjdHgubW9kLCAiTm9uZSIsIHRydWV9LCB7Y3R4LndfbSwgd2F5c19jaGVja30pCgkJCWN0eC5tX2FsOmRlcGVuZCh7Y3R4Lm1fYSwgdHJ1ZX0sIHtjdHgubW9kLCAiTm9uZSIsIHRydWV9KQoJCQljdHgubV9hcjpkZXBlbmQoe2N0eC5tX2EsIHRydWV9LCB7Y3R4Lm1vZCwgIk5vbmUiLCB0cnVlfSkKCgkJCWN0eC53X251bTpkZXBlbmQoe2N0eC5tb2QsICJYLXdheSJ9KQoJCWVuZAoJCWRvCgkJCWN0eC5kczpkZXBlbmQoe3ZhcnMuYW50aWFpbS5leHBsb2l0cy5zbmFwLm9uLCB0cnVlfSkKCQkJY3R4LmRzcDpkZXBlbmQoe3ZhcnMuYW50aWFpbS5leHBsb2l0cy5zbmFwLm9uLCB0cnVlfSwge2N0eC5kcywgIkN1c3RvbSJ9KQoJCQljdHguZHN5OmRlcGVuZCh7dmFycy5hbnRpYWltLmV4cGxvaXRzLnNuYXAub24sIHRydWV9LCB7Y3R4LmRzLCAiQ3VzdG9tIn0pCgkJCWN0eC5kc3AxOmRlcGVuZCh7dmFycy5hbnRpYWltLmV4cGxvaXRzLnNuYXAub24sIHRydWV9LCB7Y3R4LmRzLCAiQ3VzdG9tIn0sIHtjdHguZHNwLCAiTm9uZSIsIHRydWV9KQoJCQljdHguZHNwMjpkZXBlbmQoe3ZhcnMuYW50aWFpbS5leHBsb2l0cy5zbmFwLm9uLCB0cnVlfSwge2N0eC5kcywgIkN1c3RvbSJ9LCB7Y3R4LmRzcCwgIk5vbmUiLCB0cnVlfSkKCQkJY3R4LmRzeTE6ZGVwZW5kKHt2YXJzLmFudGlhaW0uZXhwbG9pdHMuc25hcC5vbiwgdHJ1ZX0sIHtjdHguZHMsICJDdXN0b20ifSwge2N0eC5kc3ksICJOb25lIiwgdHJ1ZX0pCgkJCS0tIGN0eC5kc3kyOmRlcGVuZCh7dmFycy5hbnRpYWltLmV4cGxvaXRzLnNuYXAub24sIHRydWV9LCB7Y3R4LmRzLCAiQ3VzdG9tIn0sIHtjdHguZHN5LCAiTm9uZSIsIHRydWV9KQoJCWVuZAoKCQktLQoJCXB1aS50cmF2ZXJzZShjdHgsIGZ1bmN0aW9uIChyZWYsIHBhdGgpCgkJCXJlZjpkZXBlbmQoe3ZhcnMuYW50aWFpbS5idWlsZGVyLnN0YXRlLCBuYW1lfSwgcGF0aFsjcGF0aF0gfj0gIm92ZXJyaWRlIiBhbmQgY3R4Lm92ZXJyaWRlIG9yIG5pbCkKCQllbmQpCgllbmQKCglwdWkubWFjcm9zLl9wID0gbmlsCgoJLS0gdmFycy5hbnRpYWltLmJ1aWxkZXIuc3RhdGU6c2V0X2NhbGxiYWNrKGZ1bmN0aW9uICh0aGlzKQoJLS0gCXZhcnMuYW50aWFpbS5idWlsZGVyWzFdWzFdOnNldChwdWkuZm9ybWF0ICJcduKAolxyICBBY3Rpb25zIHdpdGggXHYiIC4uIHRoaXMudmFsdWUpCgktLSBlbmQsIHRydWUpCmVuZAoKZG8gLS0gYnJ1dGUKCmVuZAoKLS0gI2VuZHJlZ2lvbgoKLS0gI3JlZ2lvbiAtIEhhbmRsZQoKaWYgbm90IF9CTElTUyB0aGVuCgltZW51LmxvY2soImpyIiwgdmFycy5yYWdlLnJlc29sdmVyKQoJbWVudS5sb2NrKCJlcyIsIHZhcnMucmFnZS5leHN3aXRjaC5vbiwgbmlsLCAzKQoJbWVudS5sb2NrKCJrbCIsIHZhcnMudmlzdWFscy5rZXlsaXN0KQoJbWVudS5sb2NrKCJzbCIsIHZhcnMudmlzdWFscy5zcGVjbGlzdCkKCW1lbnUubG9jaygiaG0iLCB2YXJzLnZpc3VhbHMubWFya2VyKQoJbWVudS5sb2NrKCJhYiIsIHZhcnMubWlzYy5icmVha2VyLm9uKQoJbWVudS5sb2NrKCJmbCIsIHZhcnMubWlzYy5sYWRkZXIpCgltZW51LmxvY2soInNoIiwgdmFycy5hbnRpYWltLmdlbmVyYWwuaGVhZCwge30pCmVuZAoKZG8KCWRlZmVyKG1lbnUuc2V0X3Zpc2libGUpCgoJdmFycy52aXN1YWxzLmRwaTpzZXRfY2FsbGJhY2soZnVuY3Rpb24gKHRoaXMpCgkJX0RQSS5zY2FsYWJsZSA9IHRoaXMudmFsdWUKCQlfRFBJLmNhbGxiYWNrKCkKCWVuZCwgdHJ1ZSkKCgltZW51Lm1haW4uZ2xvYmFsOnNldF9jYWxsYmFjayhmdW5jdGlvbiAodGhpcykgbWVudS5zZXRfdmlzaWJsZShub3QgdGhpcy52YWx1ZSwgdHJ1ZSkgZW5kLCB0cnVlKQoJbWVudS5tYWluWzFdOmRlcGVuZCh7bWVudS5tYWluLmdsb2JhbCwgZmFsc2V9KQoJbWVudS5tYWluLnRhYjpkZXBlbmQobWVudS5tYWluLmdsb2JhbCkKCW1lbnUubWFpbi5iYXI6ZGVwZW5kKG1lbnUubWFpbi5nbG9iYWwpCgoJLS0KCgltZW51Lm1pc2Mub3ZlcnJpZGRlbjpkZXBlbmQoe21lbnUubWFpbi5nbG9iYWwsIGZhbHNlfSwgdmFycy5hbnRpYWltLmdsb2JhbCkKCXB1aS50cmF2ZXJzZShtZW51LmluZm8sIGZ1bmN0aW9uIChyZWYsIHBhdGgpCgkJcmVmOmRlcGVuZChtZW51Lm1haW4uZ2xvYmFsKQoJZW5kKQoJcHVpLnRyYXZlcnNlKG1lbnUuZ2VuZXJhbCwgZnVuY3Rpb24gKHJlZiwgcGF0aCkKCQlyZWY6ZGVwZW5kKG1lbnUubWFpbi5nbG9iYWwsIHttZW51Lm1haW4udGFiLCAiSG9tZSJ9KQoJZW5kKQoJcHVpLnRyYXZlcnNlKG1lbnUuc3RhdHMsIGZ1bmN0aW9uIChyZWYsIHBhdGgpCgkJcmVmOmRlcGVuZChtZW51Lm1haW4uZ2xvYmFsLCB7bWVudS5tYWluLnRhYiwgIlNldHRpbmdzIn0pCgllbmQpCglwdWkudHJhdmVyc2Uoe3ZhcnMucmFnZSwgdmFycy52aXN1YWxzLCB2YXJzLm1pc2N9LCBmdW5jdGlvbiAocmVmLCBwYXRoKQoJCXJlZjpkZXBlbmQobWVudS5tYWluLmdsb2JhbCwge21lbnUubWFpbi50YWIsICJTZXR0aW5ncyJ9KQoJZW5kKQoJcHVpLnRyYXZlcnNlKHZhcnMuYW50aWFpbSwgZnVuY3Rpb24gKHJlZiwgcGF0aCkKCQlyZWY6ZGVwZW5kKG1lbnUubWFpbi5nbG9iYWwsIHttZW51Lm1haW4udGFiLCAiQW50aS1haW0ifSwgKHBhdGhbI3BhdGhdIH49ICJnbG9iYWwiKSBhbmQgdmFycy5hbnRpYWltLmdsb2JhbCBvciBuaWwpCgoJCWlmIHBhdGhbMV0gPT0gImdsb2JhbCIgb3IgcGF0aFsxXSA9PSAidGFiIiB0aGVuIHJldHVybiBlbmQKCgkJaWYgcGF0aFsxXSA9PSAiYnVpbGRlciIgb3IgcGF0aFsxXSA9PSAic3RhdGVzIiB0aGVuCgkJCXJlZjpkZXBlbmQoe3ZhcnMuYW50aWFpbS50YWIsICJCdWlsZGVyIn0pCgkJZWxzZWlmIHBhdGhbMV0gPT0gInZlbnR1cmUiIHRoZW4KCQkJcmVmOmRlcGVuZCh7dmFycy5hbnRpYWltLnRhYiwgIkFudGktYnJ1dGVmb3JjZSJ9KQoJCWVsc2UKCQkJcmVmOmRlcGVuZCh7dmFycy5hbnRpYWltLnRhYiwgIkdlbmVyYWwifSkKCQllbmQKCWVuZCkKCgktLQoKCWxvY2FsIGdyYXksIGFjY2VudCA9IGNvbG9yLnJnYig2OSksIGNvbG9yLmhleChwdWkuYWNjZW50KQoJY2FsbGJhY2tzLnBhaW50X3VpOnNldChmdW5jdGlvbiAoKQoJCWlmIG5vdCB1aS5pc19tZW51X29wZW4oKSB0aGVuIHJldHVybiBlbmQKCgkJbG9jYWwgcHVsc2UgPSBtYXRoLmFicyhnbG9iYWxzLnJlYWx0aW1lKCkgKiAwLjUgJSAyIC0gMSkKCQlsb2NhbCBjb2wgPSBncmF5OmxlcnAoYWNjZW50LCBhbmltYS5lYXNpbmdzLnBvd1sxXShwdWxzZSwgNCkpCgoJCW1lbnUubWFpbi5iYXI6c2V0KCJcYSIuLiBjb2w6dG9faGV4KCkgLi4gIuKAvuKAvuKAvuKAvuKAvuKAvuKAvuKAvuKAvuKAvuKAvuKAvuKAvuKAvuKAvuKAvuKAvuKAvuKAvuKAvuKAvuKAvuKAvuKAvuKAvuKAviIpCgllbmQpCgljbGllbnQuc2V0X2V2ZW50X2NhbGxiYWNrKCJwdWk6OmFjY2VudF9jb2xvciIsIGZ1bmN0aW9uIChuZXcpCgkJYWNjZW50ID0gY29sb3IucmdiKG5ld1sxXSwgbmV3WzJdLCBuZXdbM10sIDI1NSkKCWVuZCkKCgl2YXJzLnZpc3VhbHMuYWNjZW50OnNldF9jYWxsYmFjayhmdW5jdGlvbiAodGhpcykKCQlsb2NhbCByLCBnLCBiID0gdW5wYWNrKHRoaXMudmFsdWUpCgkJY29sb3JzLmFjY2VudCA9IGNvbG9yLnJnYihyLCBnLCBiLCAyNTUpCgkJY29sb3JzLmhleCA9ICJcYSIuLiBjb2xvcnMuYWNjZW50OnRvX2hleCgpCgkJY29sb3JzLmhleHMgPSBzdHJpbmcuc3ViKGNvbG9ycy5oZXgsIDEsIC0zKQoJZW5kLCB0cnVlKQoKCXZhcnMudmlzdWFscy5jaGVhcDpzZXRfY2FsbGJhY2soZnVuY3Rpb24gKHRoaXMpCgkJcmVuZGVyLmNoZWFwID0gdGhpcy52YWx1ZQoJZW5kLCB0cnVlKQplbmQKCi0tICNlbmRyZWdpb24KCi0tICNlbmRyZWdpb24KLS0KCi0tCi0tICNyZWdpb24gOiBDb25maWcgc3lzdGVtCgpsb2NhbCBjb25maWdzID0gewoJc3lzdGVtID0gbmlsLAoJZGVmYXVsdCA9ICJoeXN0ZXJpYTo6R1M6OktHUmxabUYxYkhRcFcyVnVVVjE3aGFSa2NtRm5pS2h6Y0dWamJHbHpkSUtoZWMwVGlLRjR6UXRrcG1GeWNtOTNjNEtoZWMwVFlxRjR6UktZcVdOeWIzTnphR0ZwY29LaGVjMFVsS0Y0elJNTHFITnNiM2RrYjNkdWdxRjV6UWxMb1hqTkVrejExM1puYTJWNWJHbHpkSUtoZWMwVGlLRjR6UXRrcG1SaGJXRm5aWUtoZWMwVHJhRjR6Uk9jcVhkaGRHVnliV0Z5YTRPaGVjeTVvWGpOSnAyaFlRS2tiRzluYzRLaGVjMGF6YUY0elJCNnAzWnBjM1ZoYkhPTG8yUndhY0tsWTJobFlYRENwbTFoY210bGNzT29jM0JsWTJ4cGMzVENwbUZ5Y205M2M4S25hMlY1YkdsemRNS29jMnh2ZDJSdmQyN0RwbVJoYldGblpjT21ZV05qWlc1MHFTTTNORUUyUVRsR1JxVjNZWFJsY29Pa2FHbGtaY0trYm1GdFphQ2liMjdEcVdOeWIzTnphR0ZwY29Pa2JHOW5iOE9sYzNSNWJHV25RMnhoYzNOcFk2SnZic09rYldselk0YW1abWxzZEdWeXc2WnNZV1JrWlhMRHAyTnNZVzUwWVdmQ3AySnlaV0ZyWlhLRXBITnNhV0hEcFhCcGRHTm93cUp2YnNLa2JHVm5jNlJPYjI1bHBtRnpjR1ZqZElLbGNtRjBhV3oxNDNaTWhhSnZic09rYkc5bmM0T21aWFpsYm5SemxhMVNZV2RsWW05MElITm9iM1J6cjBoaGNtMXBibWNnWlc1bGJXbGxjNjVIWlhSMGFXNW5JR2hoY20xbFpLMUJiblJwTFdGcGJTQnBibVp2b1g2bWIzVjBjSFYwazZkRGIyNXpiMnhscGxOamNtVmxicUZ6MTEzWm9tOXV3NmRoYm5ScFlXbHRocWQyWlc1MGRYSmxnYVJzYjI1bmdhaG5ZWE5zYVdkb2RNS21aMnh2WW1Gc3c2TnNZV2VCcDJaaGEyVnNZV2VEcFd4cGJXbDBENlJ0YjJSbHAwUjVibUZ0YVdPaWIyN0RwMmRsYm1WeVlXeUhwSE4wWVdMRHBHaGxZV1NSb1g2amRYTmx3Nlp0WVc1MVlXeUhwWEpwWjJoMGt3SUFvWDZrYkdWbWRKTUNBS0Z6MTEzWnBHVmtaMldUQWdDaGZxSnpkTUtpWm5PVEFnQ2hmcUp2YnNPbGNtVnpaWFNUQWdDaGZxaHBiblpsY25SbGNwTUJBS0Z6MTEzWm8zbGhkNnBCZENCMFlYSm5aWFJ6cG5kaGNtMTFjTUtvWlhod2JHOXBkSE9DcG5aMWJHNXNZNVNyUTJGdUozUWdjMmh2YjNTblNuVnRjR2x1WjZsRGNtOTFZMmhwYm1laGZxUnpibUZ3aEtKdmM4T2liSEREb205dXc2UnZibDlva3dBQW9YNm1jM1JoZEdWemlLUjNZV3hyM2dBY28yUmZaQUNsYlY5dGFXN2xwRzFmWVhJQXBHMWZZV3dBcEhKZlpIUUZvMjF2WktaS2FYUjBaWEtrY2w5cGNncWpiVjlod3FWdFgyMWhlQ09qWkhONXBFNXZibVdvYjNabGNuSnBaR1hEb21SenAwUmxabUYxYkhTa1pGOXlkOEtrWkY5emQ4T2taRjl2YnNPalpITndwRTV2Ym1Xa1pITndNdERUbzJSZmNnQ2paRjlzQUtOdFgyUUFwWGRmYm5WdEE2VjVYMjltWmdDbVpGOXRiMlJscEVGMWRHejExM1pqYlY5eXc2UmtjM0F4ME5Pa2QyRjVjNWNBQUFBQUFBQUFwR1J6ZVRITXRLTjNYMjNDcDJGcGNtUjFZMnZlQUJ5alpGOWtBS1Z0WDIxcGJ1cWtiVjloY2dDa2JWOWhiQUNrY2w5a2RBT2piVzlrcGtwcGRIUmxjcVJ5WDJseUJxTnRYMkhDcFcxZmJXRjRKS05rYzNtbVUzZHBkR05vcUc5MlpYSnlhV1JsdzZKa2M2WkRkWE4wYjIya1pGOXlkOEtrWkY5emQ4T2taRjl2YnNPalpITndwbE4zYVhSamFLUmtjM0F5QUtOa1gzSUFvMlJmYkFDamJWOWtBS1YzWDI1MWJRT2xlVjl2Wm1ZRHBtUmZiVzlrWmFSQmRYUnZvMjFmY3NPa1pITndNZENucEhkaGVYT1hBQUFBQUFBQUFLUmtjM2t4elBDamQxOXR3cU5oYVhMZUFCeWpaRjlrQUtWdFgyMXBiZ0NrYlY5aGNnQ2tiVjloYkFDa2NsOWtkQkdqYlc5a3BrcHBkSFJsY3FSeVgybHlBS050WDJIQ3BXMWZiV0Y0QUtOa2MzbW1VM2RwZEdOb3FHOTJaWEp5YVdSbHc2SmtjNlpEZFhOMGIyMmtaRjl5ZDhLa1pGOXpkOE9rWkY5dmJzT2paSE53cGxOM2FYUmphS1JrYzNBeUFLTmtYM0lBbzJSZmJBQ2piVjlrSEtWM1gyNTFiUU9sZVY5dlptWURwbVJmYlc5a1phUkJkWFJ2bzIxZmNzS2taSE53TVFDa2QyRjVjNWNBQUFBQUFBQUFwR1J6ZVRITXRLTjNYMjNDcFhOdVpXRnIzZ0FjbzJSZlpBQ2xiVjl0YVc3cnBHMWZZWElBcEcxZllXd0FwSEpmWkhRUm8yMXZaS1pLYVhSMFpYS2tjbDlwY2dhamJWOWh3cVZ0WDIxaGVDU2paSE41cEU1dmJtV29iM1psY25KcFpHWERvbVJ6cDBSbFptRjFiSFNrWkY5eWQ4S2taRjl6ZDhPa1pGOXZic09qWkhOd3BFNXZibVdrWkhOd010RFRvMlJmY2dDalpGOXNBS050WDJRQXBYZGZiblZ0QTZWNVgyOW1aZ0NtWkY5dGIyUmxwRUYxZEd6MTEzWmpiVjl5dzZSa2MzQXgwTk9rZDJGNWM1Y0FBQUFBQUFBQXBHUnplVEhNdEtOM1gyM0NwWE4wWVc1azNnQWNvMlJmWkFpbGJWOXRhVzRBcEcxZllYSUFwRzFmWVd3QXBISmZaSFFCbzIxdlpLWkthWFIwWlhLa2NsOXBjZ0NqYlY5aHdxVnRYMjFoZUFDalpITjVwRTV2Ym1Xb2IzWmxjbkpwWkdYRG9tUnpwMFJsWm1GMWJIU2taRjl5ZDhLa1pGOXpkOEtrWkY5dmJzT2paSE53cEU1dmJtV2taSE53TXREVG8yUmZjZ0NqWkY5c0FLTnRYMlFncFhkZmJuVnRBNlY1WDI5bVpnQ21aRjl0YjJSbHBFRjFkR3oxMTNaamJWOXl3cVJrYzNBeDBOT2tkMkY1YzVjQUFBQUFBQUFBcEdSemVUSE10S04zWDIzQ3BtTnliM1ZqYU40QUhLTmtYMlFBcFcxZmJXbHVBS1J0WDJGeUFLUnRYMkZzQUtSeVgyUjBFYU50YjJTbVNtbDBkR1Z5cEhKZmFYSUFvMjFmWWNLbGJWOXRZWGdBbzJSemVhUk9iMjVscUc5MlpYSnlhV1JsdzZKa2M2ZEVaV1poZFd4MHBHUmZjbmZDcEdSZmMzZkRwR1JmYjI3RG8yUnpjS1JPYjI1bHBHUnpjRExRMDZOa1gzSUFvMlJmYkFDamJWOWtIcVYzWDI1MWJRT2xlVjl2Wm1ZQ3BtUmZiVzlrWmFSQmRYUnZvMjFmY3NLa1pITndNZERUcEhkaGVYT1hBQUFBQUFBQUFLUmtjM2t4ekxTamQxOXR3cU55ZFc3ZUFCeWpaRjlrQUtWdFgyMXBidUtrYlY5aGNnQ2tiVjloYkFDa2NsOWtkQU9qYlc5a3BrcHBkSFJsY3FSeVgybHlBS050WDJIQ3BXMWZiV0Y0STZOa2MzbWtUbTl1WmFodmRtVnljbWxrWmNPaVpIT25SR1ZtWVhWc2RLUmtYM0ozd3FSa1gzTjN3NlJrWDI5dXc2TmtjM0NrVG05dVphUmtjM0F5ME5PalpGOXlBS05rWDJ3QW8yMWZaQUNsZDE5dWRXMERwWGxmYjJabUFLWmtYMjF2WkdXa1FYVjBiNk50WDNMRHBHUnpjREhRMDZSM1lYbHpsd0FBQUFBQUFBQ2taSE41TWN5MG8zZGZiY0tuWkdWbVlYVnNkTjRBRzZOa1gyUUFwVzFmYldsdTQ2UnRYMkZ5QUtSdFgyRnNBS1J5WDJSMEFhTnRYMkhDcEhKZmFYSUFwVzFmYldGNEhhUmtYM04zdzZSa1gyOXV3NkprYzZaRGRYTjBiMjJrWkY5eWQ4S2taSE41TWN5MG8yUnplYVpUZDJsMFkyaWpaRjlzQUtOa2MzQ21VM2RwZEdOb3BHUnpjRExRcDZOa1gzSUFvMjFmWkIybGQxOXVkVzBEcFhsZmIyWm1BS1prWDIxdlpHV2tRWFYwYjZOdFgzTENwR1J6Y0RIUXA2UjNZWGx6bHdBQUFBQUFBQUNqYlc5a3BrcHBkSFJsY3FOM1gyM0NwSEpoWjJXRHFIUmxiR1Z3YjNKMGhLUnZibDlva3dFQW9YNm1jR2x6ZEc5c3dxSnZic0trYkdGdVpNS29aWGh6ZDJsMFkyaUNwV0ZzYkc5M2thRnoxMTNab205dXdxaHlaWE52YkhabGNzSjkiLAoJYmFkZ2UgPSBwdWkuZm9ybWF0KCJcduKAolxyICIpLAoJc2VsZWN0ZWQgPSAwLCBuYW1lID0gIiIsCglsb2FkZWQgPSBuaWwsCglsaXN0ID0ge30KfSBkbwoJbG9jYWwgY29udGV4dCA9IG1lbnUuZ2VuZXJhbC5jb25maWcKCgljb250ZXh0LnNhdmU6ZGVwZW5kKHRydWUsIHtjb250ZXh0Lmxpc3QsIDAsIHRydWV9KQoJY29udGV4dC5leHBvcnQ6ZGVwZW5kKHRydWUsIHtjb250ZXh0Lmxpc3QsIDAsIHRydWV9KQoJY29udGV4dC5kZWxldGU6ZGVwZW5kKHtjb250ZXh0Lmxpc3QsIDAsIHRydWV9KQoJY29udGV4dC5kZWxldGViOmRlcGVuZCh7Y29udGV4dC5saXN0LCAwfSkKCWNvbnRleHQuZGVsZXRlYjpkZXBlbmQodHJ1ZSwge2NvbnRleHQubGlzdCwgMCwgdHJ1ZX0pCgoJLS0jcmVnaW9uOiBhY3Rpb25zCgoJbG9jYWwgYWN0aW9ucyA9IHt9CgoJYWN0aW9ucy5ldmFsID0gZnVuY3Rpb24gKHJhdywgbm9wYXJzZSkKCQlpZiBub3QgcmF3IHRoZW4gcmV0dXJuICJcZkNvbmZpZyBub3QgZm91bmQuIiBlbmQKCgkJbG9jYWwgY2hlYXQsIGNvbnRlbnRzLCBwYWQgPSBzdHJpbmcubWF0Y2gocmF3LCAiXmh5c3RlcmlhOjooJWErKTo6KFsldyUrJS9dKykoXyopIikKCQlpZiBjaGVhdCB+PSAiR1MiIHRoZW4gcmV0dXJuICJcZk5vdCBmb3IgZ2FtZXNlbnNlIiBlbmQKCgkJcGFkID0gcGFkIGFuZCBzdHJpbmcucmVwKCI9IiwgI3BhZCkgb3IgIiIKCQljb250ZW50cyA9IHN0cmluZy5nc3ViKGNvbnRlbnRzLCAieiVkJWQlZFoiLCB7IFsiejExM1oiXSA9ICIrIiwgWyJ6MTQzWiJdID0gIi8iLCB9KQoJCWNvbnRlbnRzID0gYmFzZTY0LmRlY29kZShjb250ZW50cy4ucGFkKQoKCQlsb2NhbCBuYW1lLCBhdXRob3IsIHNldHRpbmdzID0gc3RyaW5nLm1hdGNoKGNvbnRlbnRzLCAiXiUoKC4qKSUpJVsoLiopJV0leyguKyklfSIpCgkJcmV0dXJuIG5hbWUsIGF1dGhvciwgKG5vcGFyc2Ugfj0gdHJ1ZSBhbmQgc2V0dGluZ3Mgfj0gbmlsKSBhbmQgbXNncGFjay51bnBhY2soc2V0dGluZ3MpIG9yIHt9CgllbmQKCglhY3Rpb25zLnNhdmUgPSBmdW5jdGlvbiAobmFtZSwgbmV3KQoJCWlmIG5hbWUgPT0gIkRlZmF1bHQiIHRoZW4gcmV0dXJuICJcZkNhbid0IG92ZXJ3cml0ZSBEZWZhdWx0IiBlbmQKCQluYW1lID0gdG9zdHJpbmcobmFtZSkKCgkJbG9jYWwgb19uYW1lLCBvX2F1dGhvciBpZiBuZXcgPT0gdHJ1ZSB0aGVuCgkJCW9fbmFtZSwgb19hdXRob3IgPSBhY3Rpb25zLmV2YWwoZGIuY29uZmlnc1tuYW1lXSwgdHJ1ZSkKCQllbmQKCgkJbG9jYWwgY2ZnID0gLS1bWyBuZXcgYW5kIHt9IG9yIF1dIGNvbmZpZ3Muc3lzdGVtOnNhdmUoKQoJCWxvY2FsIGNvbnRlbnRzID0gc3RyaW5nLmZvcm1hdCgiKCVzKVslc117JXN9IiwgbmFtZSwgb19hdXRob3Igb3IgaHlzdGVyaWEudXNlci5uYW1lLCBtc2dwYWNrLnBhY2soY2ZnKSkKCQlsb2NhbCBlbmNvZGVkID0gc3RyaW5nLmdzdWIoYmFzZTY0LmVuY29kZShjb250ZW50cyksICJbJSslLyU9XSIsIHsgWyIrIl0gPSAiejExM1oiLCBbIi8iXSA9ICJ6MTQzWiIsIFsiPSJdID0gIl8iIH0pCgoJCWxvY2FsIHJlYWR5ID0gKCJoeXN0ZXJpYTo6R1M6OiVzIik6Zm9ybWF0KGVuY29kZWQpCgkJZGIuY29uZmlnc1tuYW1lXSA9IHJlYWR5CgoJCXJldHVybiAiXGEiLi4gbmFtZSAuLiIgc2F2ZWQiCgllbmQKCglhY3Rpb25zLmNyZWF0ZSA9IGZ1bmN0aW9uIChuYW1lKQoJCWlmIG5hbWUgPT0gIiIgdGhlbiAgcmV0dXJuICJcZkVudGVyIHRoZSBuYW1lIgoJCWVsc2VpZiBuYW1lID09ICJEZWZhdWx0IiB0aGVuICByZXR1cm4gIlxmQ2FuJ3Qgb3ZlcndyaXRlIERlZmF1bHQiCgkJZWxzZWlmICNuYW1lID4gMjQgdGhlbiAgcmV0dXJuICJcZlRoaXMgbmFtZSBpcyB0b28gbG9uZyIKCQllbHNlaWYgZGIuY29uZmlnc1tuYW1lXSB0aGVuICByZXR1cm4gIlxmIiAuLiBuYW1lIC4uICIgaXMgaW4gdGhlIGxpc3QiICBlbmQKCgkJcmV0dXJuIGFjdGlvbnMuc2F2ZShuYW1lLCB0cnVlKQoJZW5kCgoJYWN0aW9ucy5kZWxldGUgPSBmdW5jdGlvbiAobmFtZSkKCQlkYi5jb25maWdzW25hbWVdID0gbmlsCgllbmQKCglhY3Rpb25zLmV4cG9ydCA9IGZ1bmN0aW9uIChuYW1lKQoJCWlmIG5vdCBuYW1lIG9yIG5hbWUgPT0gIiIgdGhlbiByZXR1cm4gIlxmTm90IHNlbGVjdGVkIiBlbmQKCgkJY2xpcGJvYXJkLnNldChkYi5jb25maWdzW25hbWVdKQoJCXJldHVybiAiXGFDb3BpZWQgdG8gY2xpcGJvYXJkLiIKCWVuZAoKCWFjdGlvbnMuaW1wb3J0ID0gZnVuY3Rpb24gKCkKCQlsb2NhbCBjb3BpZWQgPSBjbGlwYm9hcmQuZ2V0KCkKCQlpZiBub3QgY29waWVkIHRoZW4gcmV0dXJuICJcZkVtcHR5IGNsaXBib2FyZCIgZW5kCgoJCWxvY2FsIG5hbWUsIGF1dGhvciwgc2V0dGluZ3MgPSBhY3Rpb25zLmV2YWwoY29waWVkLCB0cnVlKQoJCWlmIG5vdCBhdXRob3IgdGhlbiByZXR1cm4gbmFtZSBlbmQKCgoJCWxvY2FsIGNmZyA9IGNvcGllZDptYXRjaCgiXmh5c3RlcmlhOjolYSs6OlsldyUrJS9dK18qIikKCQlpZiBuYW1lID09ICJEZWZhdWx0IiB0aGVuIHJldHVybiAiXGZDYW4ndCBpbXBvcnQgZGVmYXVsdCBjb25maWciIGVuZAoJCWRiLmNvbmZpZ3NbbmFtZV0gPSBjZmcKCQlyZXR1cm4gIlxhIi4uIG5hbWUgLi4iIGJ5ICIuLiBhdXRob3IgLi4iIGFkZGVkIgoJZW5kCgoJYWN0aW9ucy5sb2FkID0gZnVuY3Rpb24gKG5hbWUsIC4uLikKCQlpZiBub3QgbmFtZSBvciBuYW1lID09ICIiIHRoZW4gcmV0dXJuICJFUlI6IGNhbid0IGxvYWQ6IG5vdCBzZWxlY3RlZCIgZW5kCgkJbG9jYWwgY2ZnID0gbmFtZSA9PSAiRGVmYXVsdCIgYW5kIGNvbmZpZ3MuZGVmYXVsdCBvciBkYi5jb25maWdzW25hbWVdCgoJCWxvY2FsIGNuYW1lLCBjYXV0aG9yLCBzZXR0aW5ncyA9IGFjdGlvbnMuZXZhbChjZmcpCgkJaWYgbm90IGNhdXRob3IgdGhlbiByZXR1cm4gY25hbWUgZW5kCgoJCWlmICh7Li4ufSlbMV0gPT0gImFudGlhaW0iIHRoZW4KCQkJc2V0dGluZ3MuYW50aWFpbS5nZW5lcmFsLm1hbnVhbCA9IG5pbAoJCWVuZAoKCQljb25maWdzLnN5c3RlbTpsb2FkKHNldHRpbmdzLCAuLi4pCgkJaWYgLi4uIHRoZW4gcmV0dXJuIGVuZAoJCWNvbmZpZ3MubG9hZGVkID0gbmFtZQoJZW5kCgoJLS0jZW5kcmVnaW9uCgoJbG9jYWwgcmVwb3J0IGRvCgkJY29udGV4dC5saXN0X3JlcG9ydDpkZXBlbmQoe2NvbnRleHQubGlzdF9yZXBvcnQsIDB9KQoKCQlsb2NhbCByZXBvcnRlbmQsIGFjdGl2ZSA9IDAsIGZhbHNlCgkJbG9jYWwgZnVuY3Rpb24gd2FpdCAoKQoJCQlpZiByZXBvcnRlbmQgPCBnbG9iYWxzLnJlYWx0aW1lKCkgdGhlbgoJCQkJY29udGV4dC5saXN0X3JlcG9ydDpzZXRfdmlzaWJsZShmYWxzZSkKCQkJCWNvbnRleHQuc2VsZWN0ZWQ6c2V0X3Zpc2libGUodHJ1ZSkKCgkJCQljYWxsYmFja3MucGFpbnRfdWk6dW5zZXQod2FpdCkKCQkJCWFjdGl2ZSA9IGZhbHNlCgkJCWVuZAoJCWVuZAoKCQlyZXBvcnQgPSBmdW5jdGlvbiAoY29kZSkKCQkJaWYgbm90IGNvZGUgdGhlbiByZXR1cm4gZW5kCgkJCXJlcG9ydGVuZCA9IGdsb2JhbHMucmVhbHRpbWUoKSArIDEKCgkJCWxvY2FsIHRleHQgPSBjb2RlOmdzdWIoIltcZlxhXSIsIHsKCQkJCVsiXGYiXSA9ICJcYUZGNDA0MEZGIiwKCQkJCVsiXGEiXSA9ICJcYUI2REU0N0ZGIiwKCQkJfSkKCQkJY29udGV4dC5saXN0X3JlcG9ydDpzZXQodGV4dCkKCQkJaWYgbm90IGFjdGl2ZSB0aGVuCgkJCQljb250ZXh0Lmxpc3RfcmVwb3J0OnNldF92aXNpYmxlKHRydWUpCgkJCQljb250ZXh0LnNlbGVjdGVkOnNldF92aXNpYmxlKGZhbHNlKQoKCQkJCWNhbGxiYWNrcy5wYWludF91aTpzZXQod2FpdCkKCQkJCWFjdGl2ZSA9IHRydWUKCQkJZW5kCgkJZW5kCgllbmQKCglsb2NhbCB1cGRhdGUgPSBmdW5jdGlvbiAobm9fcmV2YWwpCgkJaWYgbm9fcmV2YWwgfj0gdHJ1ZSB0aGVuCgkJCWNvbmZpZ3MubGlzdCA9IHt9CgkJCWZvciBrIGluIG5leHQsIGRiLmNvbmZpZ3MgZG8gY29uZmlncy5saXN0WyNjb25maWdzLmxpc3QrMV0gPSBrIGVuZAoKCQkJdGFibGUuc29ydChjb25maWdzLmxpc3QpCgkJCXRhYmxlLmluc2VydChjb25maWdzLmxpc3QsIDEsICJEZWZhdWx0IikKCgkJCWxvY2FsIGxvYWRlZCA9IHRhYmxlLmlmaW5kKGNvbmZpZ3MubGlzdCwgY29uZmlncy5sb2FkZWQpCgkJCWlmIGxvYWRlZCB0aGVuICBjb25maWdzLmxpc3RbbG9hZGVkXSA9IGNvbmZpZ3MuYmFkZ2UgLi4gY29uZmlncy5saXN0W2xvYWRlZF0KCQkJZWxzZSAgY29uZmlncy5sb2FkZWQgPSAwICBlbmQKCgkJCWNvbnRleHQubGlzdDp1cGRhdGUoY29uZmlncy5saXN0KQoJCWVuZAoKCQljb25maWdzLnNlbGVjdGVkID0gY29udGV4dC5saXN0LnZhbHVlICsgMQoJCWNvbmZpZ3MubmFtZSA9IGNvbmZpZ3MubGlzdFtjb25maWdzLnNlbGVjdGVkXTpnc3ViKCJeXGEleCV4JXgleCV4JXgleCV44oCiXGEleCV4JXgleCV4JXgleCV4ICIsICIiKQoKCQljb250ZXh0LnNlbGVjdGVkOnNldCggcHVpLmZvcm1hdCgiU2VsZWN0ZWQ6IFx2IikgLi4gY29uZmlncy5uYW1lKQoJCWNvbnRleHQubGlzdDpzZXQoY29uZmlncy5zZWxlY3RlZCAtIDEpCgllbmQKCglsb2NhbCBhY3QgPSBmdW5jdGlvbiAoYWN0aW9uLCAuLi4pCgkJbG9jYWwgc3VjY2VzcywgcmVzdWx0LCBjb2RlLCBvYmogPSBwY2FsbChhY3Rpb25zW2FjdGlvbl0sIC4uLikKCgkJZGVidWcoYWN0aW9uLCAiOiAiLCBzdWNjZXNzLCAiLCAiLCByZXN1bHQsICIsICIsIGNvZGUsICIsICIsIG9iaikKCQlyZXBvcnQoY29kZSBvciByZXN1bHQpCgkJdXBkYXRlKCkKCWVuZAoJdXBkYXRlKCkKCgljb250ZXh0Lmxpc3Q6c2V0X2NhbGxiYWNrKGZ1bmN0aW9uICgpICB1cGRhdGUodHJ1ZSkgIGVuZCkKCWNvbnRleHQuY3JlYXRlOnNldF9jYWxsYmFjayhmdW5jdGlvbiAoKSAgYWN0KCJjcmVhdGUiLCBjb250ZXh0Lm5hbWU6Z2V0KCkpICBlbmQpCgljb250ZXh0LmltcG9ydDpzZXRfY2FsbGJhY2soZnVuY3Rpb24gKCkgIGFjdCgiaW1wb3J0IiwgY29udGV4dC5uYW1lOmdldCgpKSAgZW5kKQoJY29udGV4dC5sb2FkOnNldF9jYWxsYmFjayhmdW5jdGlvbiAoKSAgYWN0KCJsb2FkIiwgY29uZmlncy5uYW1lKSAgZW5kKQoJY29udGV4dC5sb2FkYWE6c2V0X2NhbGxiYWNrKGZ1bmN0aW9uICgpICBhY3QoImxvYWQiLCBjb25maWdzLm5hbWUsICJhbnRpYWltIikgIGVuZCkKCWNvbnRleHQuc2F2ZTpzZXRfY2FsbGJhY2soZnVuY3Rpb24gKCkgIGFjdCgic2F2ZSIsIGNvbmZpZ3MubmFtZSkgIGVuZCkKCWNvbnRleHQuZGVsZXRlOnNldF9jYWxsYmFjayhmdW5jdGlvbiAoKSAgYWN0KCJkZWxldGUiLCBjb25maWdzLm5hbWUpICBlbmQpCgljb250ZXh0LmV4cG9ydDpzZXRfY2FsbGJhY2soZnVuY3Rpb24gKCkgIGFjdCgiZXhwb3J0IiwgY29uZmlncy5uYW1lKSAgZW5kKQplbmQKCi0tICNlbmRyZWdpb24KLS0KCgotLSAjZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQotLQoKCgoKCgoKCi0tLS08ICBGZWF0dXJlcyAgPi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQotLSAjcmVnaW9uIDo6IEFudGktYWltCgoKLS0KLS0gI3JlZ2lvbiA6IERlZmluaXRpb25zCgphbnRpYWltLm15ID0gewoJc3dpdGNoID0gZmFsc2UsIHNpZGUgPSAwLAoJc3RhdGUgPSAiZGVmYXVsdCIsCn0KCmFudGlhaW0ucmVmcyA9IHsKCXBpdGNoID0gcmVmcy5hYS5hbmdsZXMucGl0Y2hbMl0sCgliYXNlID0gcmVmcy5hYS5hbmdsZXMuYmFzZSwKCW9mZnNldCA9IHJlZnMuYWEuYW5nbGVzLnlhd1syXSwKCWJvZHkgPSByZWZzLmFhLmFuZ2xlcy5ib2R5WzJdLAoJcGl0Y2hfbW9kZSA9IHJlZnMuYWEuYW5nbGVzLnBpdGNoWzFdLAoJeWF3ID0gcmVmcy5hYS5hbmdsZXMueWF3WzFdLAoJaml0dGVyID0gcmVmcy5hYS5hbmdsZXMuaml0dGVyWzFdLAoJaml0dGVyX2RlZyA9IHJlZnMuYWEuYW5nbGVzLmppdHRlclsyXSwKCWJvZHlfeWF3ID0gcmVmcy5hYS5hbmdsZXMuYm9keVsxXSwKfQoKYW50aWFpbS5kYXRhLCBhbnRpYWltLmxhdGVzdCA9IHsKCXdheSA9IDEsIGxpZmV0aW1lID0gMCwgdXNpbmcgPSBmYWxzZSwKCW1hbnVhbCA9IG5pbCwKfSwge30KCi0tICNlbmRyZWdpb24KLS0KCi0tCi0tICNyZWdpb24gOiBTeXN0ZW0KCi0tICNyZWdpb24gLSBGZWF0dXJlcwoKYW50aWFpbS5mZWF0dXJlcyA9IHsKCW1hbnVhbCA9IHsKCQljdXJyZW50ID0gbmlsLAoJCWJ1dHRvbnMgPSB7CgkJCXsgImxlZnQiLCB5YXcgPSAtOTAsIGl0ZW0gPSB2YXJzLmFudGlhaW0uZ2VuZXJhbC5tYW51YWwubGVmdCB9LAoJCQl7ICJyaWdodCIsIHlhdyA9IDkwLCBpdGVtID0gdmFycy5hbnRpYWltLmdlbmVyYWwubWFudWFsLnJpZ2h0IH0sCgkJCXsgInJlc2V0IiwgeWF3ID0gbmlsLCBpdGVtID0gdmFycy5hbnRpYWltLmdlbmVyYWwubWFudWFsLnJlc2V0IH0sCgkJCS0tIHsgImVkZ2UiLCB5YXcgPSAwLCBpdGVtID0gdmFycy5hbnRpYWltLmdlbmVyYWwubWFudWFsLmVkZ2UgfSwKCQkJLS0geyAiZnMiLCB5YXcgPSAwLCBpdGVtID0gdmFycy5hbnRpYWltLmdlbmVyYWwubWFudWFsLmZzIH0sCgkJfSwKCQl3b3JrID0gZnVuY3Rpb24gKHNlbGYpCgkJCWlmIG5vdCB2YXJzLmFudGlhaW0uZ2VuZXJhbC5tYW51YWwub24udmFsdWUgdGhlbiByZXR1cm4gZW5kCgoJCQlmb3IgaSwgdiBpbiBpcGFpcnMoc2VsZi5idXR0b25zKSBkbwoJCQkJbG9jYWwgYWN0aXZlLCBtb2RlID0gdi5pdGVtOmdldCgpCgoJCQkJaWYgdi5hY3RpdmUgPT0gbmlsIHRoZW4gdi5hY3RpdmUgPSBhY3RpdmUgZW5kCgkJCQlpZiB2LmFjdGl2ZSA9PSBhY3RpdmUgdGhlbiBnb3RvIGRvbmUgZW5kCgoJCQkJdi5hY3RpdmUgPSBhY3RpdmUKCgkJCQlpZiB2LnlhdyA9PSBuaWwgdGhlbiBzZWxmLmN1cnJlbnQgPSBuaWwgZW5kCgoJCQkJaWYgbW9kZSA9PSAxIHRoZW4gc2VsZi5jdXJyZW50ID0gYWN0aXZlIGFuZCBpIG9yIG5pbCBnb3RvIGRvbmUKCQkJCWVsc2VpZiBtb2RlID09IDIgdGhlbiBzZWxmLmN1cnJlbnQgPSBzZWxmLmN1cnJlbnQgfj0gaSBhbmQgaSBvciBuaWwgZ290byBkb25lIGVuZAoKCQkJCTo6ZG9uZTo6CgkJCWVuZAoKCQkJbG9jYWwgcmVzdWx0ID0gc2VsZi5jdXJyZW50IH49IG5pbCBhbmQgc2VsZi5idXR0b25zW3NlbGYuY3VycmVudF0ueWF3IG9yIG5pbAoJCQlhbnRpYWltLmRhdGEubWFudWFsID0gcmVzdWx0CgoJCQlsb2NhbCBpc19mcywgaXNfZWRnZSA9IHZhcnMuYW50aWFpbS5nZW5lcmFsLm1hbnVhbC5mczpnZXQoKSwgdmFycy5hbnRpYWltLmdlbmVyYWwubWFudWFsLmVkZ2U6Z2V0KCkKCgkJCXJlZnMuYWEuYW5nbGVzLmVkZ2U6b3ZlcnJpZGUoaXNfZWRnZSkKCQkJcmVmcy5hYS5hbmdsZXMuZnJlZXN0YW5kOm92ZXJyaWRlKGlzX2ZzIGFuZCBub3QgaXNfZWRnZSBhbmQgbm90IHJlc3VsdCkKCgkJCXJldHVybiB0eXBlKHJlc3VsdCkgPT0gIm51bWJlciIgYW5kIHJlc3VsdCBvciBuaWwKCQllbmQKCX0sCglzdGFiID0gewoJCXdvcmsgPSBmdW5jdGlvbiAoc2VsZikKCQkJYW50aWFpbS5kYXRhLmJhY2tzdGFiID0gZmFsc2UKCQkJaWYgdmFycy5hbnRpYWltLmdlbmVyYWwuc3RhYi52YWx1ZSBhbmQgbXkudGhyZWF0IGFuZCBteS5lbnRpdHkgdGhlbgoJCQkJbG9jYWwgdGhyZWF0X2hpdGJveCA9IGVudGl0eS5oaXRib3hfcG9zaXRpb24obXkudGhyZWF0LCAzKQoJCQkJaWYgbm90IHRocmVhdF9oaXRib3ggdGhlbiByZXR1cm4gZW5kCgoJCQkJbG9jYWwgZGlzdGFuY2UgPSBteS5vcmlnaW46ZGlzdCggdmVjdG9yKGVudGl0eS5nZXRfcHJvcChteS50aHJlYXQsICJtX3ZlY09yaWdpbiIpKSApCgkJCQlsb2NhbCB3ZWFwb25fdCA9IHdlYXBvbmRhdGEoZW50aXR5LmdldF9wbGF5ZXJfd2VhcG9uKG15LnRocmVhdCkpCgoJCQkJaWYgZGlzdGFuY2UgPCAyNTYgYW5kICh3ZWFwb25fdCBhbmQgd2VhcG9uX3QudHlwZSA9PSAia25pZmUiKSB0aGVuIGFudGlhaW0uZGF0YS5iYWNrc3RhYiA9IHRydWUgcmV0dXJuIHsxODAsIC04OX0gZW5kCgkJCWVuZAoJCWVuZAoJfSwKCW9uX3VzZSA9IHsKCQlkZWZ1c2UgPSBmYWxzZSwKCQlvdmVycmlkZGVuID0gZmFsc2UsCgkJbmV4dCA9IDAsCgkJd29yayA9IGZ1bmN0aW9uIChzZWxmLCBjbWQpCgkJCWlmIG5vdCB2YXJzLmFudGlhaW0uZ2VuZXJhbC51c2UudmFsdWUgb3Igbm90IG15LndlYXBvbiB0aGVuIHJldHVybiBlbmQKCQkJbG9jYWwgdXNpbmcgPSBjbWQuaW5fdXNlID09IDEKCgkJCWxvY2FsIGluX2JvbWJ6b25lLCBpc19jdCA9IGVudGl0eS5nZXRfcHJvcChteS5lbnRpdHksICJtX2JJbkJvbWJab25lIikgPT0gMSwgZW50aXR5LmdldF9wcm9wKG15LmVudGl0eSwgIm1faVRlYW1OdW0iKSA9PSAzCgoJCQlpZiBpbl9ib21iem9uZSBvciBpc19jdCB0aGVuCgkJCQlsb2NhbCBib21icyA9IGVudGl0eS5nZXRfYWxsKCJDUGxhbnRlZEM0IikKCQkJCWlmICNib21icyA+IDAgdGhlbgoJCQkJCWxvY2FsIGM0ID0gYm9tYnNbI2JvbWJzXQoKCQkJCQlsb2NhbCBjNF9vcmlnaW4gPSB2ZWN0b3IoZW50aXR5LmdldF9wcm9wKGM0LCAibV92ZWNPcmlnaW4iKSkKCQkJCQlsb2NhbCBkaXN0ID0gbXkub3JpZ2luOmRpc3QoYzRfb3JpZ2luKQoKCQkJCQlpZiBkaXN0IDwgNjEgdGhlbiBzZWxmLmRlZnVzZSA9IHRydWUgZW5kCgkJCQllbmQKCQkJZW5kCgoJCQlpZiBlbnRpdHkuZ2V0X3Byb3AobXkuZW50aXR5LCAibV9iSXNEZWZ1c2luZyIpID09IDEgb3IgZW50aXR5LmdldF9wcm9wKG15LmVudGl0eSwgIm1fYklzR3JhYmJpbmdIb3N0YWdlIikgPT0gMSB0aGVuCgkJCQlzZWxmLmRlZnVzZSA9IHRydWUKCQkJZW5kCgkJCWxvY2FsIGJsb2NrID0gc2VsZi5kZWZ1c2Ugb3IgKGVudGl0eS5nZXRfcHJvcChteS53ZWFwb24sICJtX2lJdGVtRGVmaW5pdGlvbkluZGV4IikgPT0gNDkgYW5kIGluX2JvbWJ6b25lKQoKCQkJaWYgdXNpbmcgdGhlbgoJCQkJaWYgbm90IHNlbGYub3ZlcnJpZGRlbiB0aGVuCgkJCQkJc2VsZi5uZXh0LCBzZWxmLm92ZXJyaWRkZW4gPSBnbG9iYWxzLnRpY2tjb3VudCgpICsgMSwgdHJ1ZQoJCQkJZW5kCgoJCQkJaWYgZ2xvYmFscy50aWNrY291bnQoKSA+PSBzZWxmLm5leHQgYW5kIG5vdCBibG9jayB0aGVuCgkJCQkJY21kLmluX3VzZSA9IDAKCQkJCWVuZAoJCQllbHNlCgkJCQlzZWxmLm92ZXJyaWRkZW4sIHNlbGYuZGVmdXNlID0gZmFsc2UsIGZhbHNlCgkJCWVuZAoKCQkJbG9jYWwgY2FtX3kgPSBjbGllbnQuY2FtZXJhX2FuZ2xlcygpCgkJCXJldHVybiAobm90IGJsb2NrIGFuZCB1c2luZykgYW5kIHsxODAsIGNhbV95fSBvciBuaWwKCQllbmQKCX0sCglzbmFwID0gewoJCWRlY2hva2UgPSBmYWxzZSwKCQljaGVjayA9IGZ1bmN0aW9uIChjbWQsIHNldHRpbmdzLCBwcm9wcykKCQkJaWYgcHJvcHMgYW5kIHByb3BzLm9uID09ICJEZWZhdWx0IiB0aGVuCgkJCQlwcm9wcyA9IGFudGlhaW0uZGF0YS5zY2VuZXJ5LmRlZmF1bHQuc25hcAoJCQllbmQKCgkJCWlmIG5vdCAoc2V0dGluZ3Mub24udmFsdWUgYW5kIHNldHRpbmdzLm9uLmhvdGtleTpnZXQoKSkgb3IgcHJvcHMub24gPT0gIk9mZiIgb3IgYW50aWFpbS5kYXRhLnVzZWFhIG9yIGFudGlhaW0uZGF0YS5iYWNrc3RhYiBvciBhZGF0YS5nZXRfZG91YmxlX3RhcCgpIHRoZW4gcmV0dXJuIGZhbHNlIGVuZAoJCQlpZiBub3QgbXkuZXhwbG9pdC5hY3RpdmUgb3Igbm90IChteS5leHBsb2l0LmRlZmVuc2l2ZSBvciBteS5leHBsb2l0LmxhZ3BlZWspIG9yIChteS5leHBsb2l0LmFjdGl2ZSA9PSAxIGFuZCBub3Qgc2V0dGluZ3Mub3MudmFsdWUpIHRoZW4gcmV0dXJuIGZhbHNlIGVuZAoKCgkJCWlmIHNldHRpbmdzLmxwLnZhbHVlIGFuZCBteS50aHJlYXQgdGhlbgoJCQkJbG9jYWwgcmVzb3VyY2UgPSBlbnRpdHkuZ2V0X3BsYXllcl9yZXNvdXJjZShteS50aHJlYXQpCgkJCQlpZiBub3QgcmVzb3VyY2UgdGhlbiByZXR1cm4gZmFsc2UgZW5kCgoJCQkJbG9jYWwgcGluZyA9IGVudGl0eS5nZXRfcHJvcChyZXNvdXJjZSwgIm1faVBpbmciLCBteS50aHJlYXQpCgkJCQlpZiBub3QgcGluZyBvciAocGluZyA8IDE1IG9yIHBpbmcgPiA5MCkgdGhlbiByZXR1cm4gZmFsc2UgZW5kCgkJCWVuZAoKCQkJcmV0dXJuIHRydWUsIHByb3BzCgkJZW5kLAoJCXlhdyA9IHsKCQkJWyJOb25lIl0gPSBmdW5jdGlvbiAoKSByZXR1cm4gMCwgdHJ1ZSBlbmQsCgkJCVsiU3dpdGNoIl0gPSBmdW5jdGlvbiAocHJvcHMpCgkJCQlyZXR1cm4gLjUgKiAoYW50aWFpbS5teS5zd2l0Y2ggYW5kIHByb3BzLnlhd19taW4gb3IgLXByb3BzLnlhd19taW4pCgkJCWVuZCwKCQkJWyJTdGF0aWMiXSA9IGZ1bmN0aW9uIChwcm9wcykKCQkJCXJldHVybiBwcm9wcy55YXdfbWluCgkJCWVuZCwKCQkJWyJSYW5kb20iXSA9IGZ1bmN0aW9uIChwcm9wcykKCQkJCXJldHVybiAuNSAqIG1hdGgucmFuZG9tKC1wcm9wcy55YXdfbWluLCBwcm9wcy55YXdfbWluKQoJCQllbmQsCgkJCVsiU3BpbiJdID0gZnVuY3Rpb24gKHByb3BzKQoJCQkJcmV0dXJuIC41ICogbWF0aC5sZXJwKC1wcm9wcy55YXdfbWluLCBwcm9wcy55YXdfbWluLCBnbG9iYWxzLmN1cnRpbWUoKSAqIDMgJSAyIC0gMSkKCQkJZW5kLAoJCQlbItCw0LfQsNC30L7QuSJdID0gZnVuY3Rpb24gKHByb3BzKQoJCQkJcmV0dXJuIC41ICogbWF0aC5sZXJwKC1wcm9wcy55YXdfbWluLCBwcm9wcy55YXdfbWluLCBtYXRoLnNpbihnbG9iYWxzLmN1cnRpbWUoKSAqIDMgJSAxKSkKCQkJZW5kLAoJCX0sCgkJcGl0Y2ggPSB7CgkJCVsiTm9uZSJdID0gZnVuY3Rpb24gKCkgcmV0dXJuIDg5IGVuZCwKCQkJWyJTd2l0Y2giXSA9IGZ1bmN0aW9uIChwcm9wcykKCQkJCXJldHVybiBhbnRpYWltLmRhdGEubGlmZXRpbWUgJSAyID09IDAgYW5kIHByb3BzLnBpdGNoX21heCBvciBwcm9wcy5waXRjaF9taW4KCQkJZW5kLAoJCQlbIlJhbmRvbSJdID0gZnVuY3Rpb24gKHByb3BzKQoJCQkJcmV0dXJuIG1hdGgucmFuZG9tKHByb3BzLnBpdGNoX21pbiwgcHJvcHMucGl0Y2hfbWF4KQoJCQllbmQsCgkJCVsiU3BpbiJdID0gZnVuY3Rpb24gKHByb3BzKQoJCQkJcmV0dXJuIG1hdGgubGVycChwcm9wcy5waXRjaF9taW4sIHByb3BzLnBpdGNoX21heCwgZ2xvYmFscy5jdXJ0aW1lKCkgKiA2ICUgMiAtIDEpCgkJCWVuZCwKCQl9LAoJCXdvcmsgPSBmdW5jdGlvbiAoc2VsZiwgY21kLCBjdHgpCgkJCWxvY2FsIHNldHRpbmdzLCBwcm9wcyA9IHZhcnMuYW50aWFpbS5leHBsb2l0cy5zbmFwIG9yIHt9LCBuaWwKCQkJYW50aWFpbS5sYXRlc3Quc25hcHBpbmcsIHByb3BzID0gc2VsZi5jaGVjayhjbWQsIHNldHRpbmdzLCBhbnRpYWltLmRhdGEucHJlc2V0LnNuYXApCgoJCQlpZiBub3QgYW50aWFpbS5sYXRlc3Quc25hcHBpbmcgdGhlbiByZXR1cm4gZW5kCgoJCQktLQoJCQlsb2NhbCB5YXcsIGRtZiA9IHNlbGYueWF3W3Byb3BzLnlhd10ocHJvcHMpCgkJCWxvY2FsIHBpdGNoID0gc2VsZi5waXRjaFtwcm9wcy5waXRjaF0ocHJvcHMpCgoJCQlhbnRpYWltLmxhdGVzdC5mb3JjZV9zZW5kID0gdHJ1ZQoJCQljdHgub2Zmc2V0ID0gbWF0aC5ub3JtYWxpemVfeWF3KHlhdyArIChkbWYgYW5kIGN0eC5vZmZzZXQgb3IgMCkpCgkJCWN0eC5waXRjaCA9IG1hdGgubm9ybWFsaXplX3BpdGNoKHBpdGNoKQoJCQlpZiBub3QgZG1mIHRoZW4KCQkJCS0tIGN0eC5ib2R5ID0gMAoJCQllbmQKCQkJLS0gY21kLnlhdyA9IG1hdGgubm9ybWFsaXplX3lhdyh5YXcgKyAoZG1mIGFuZCBjdHgub2Zmc2V0IG9yIDApKQoJCQktLSBjbWQucGl0Y2ggPSBtYXRoLm5vcm1hbGl6ZV9waXRjaChwaXRjaCkKCQllbmQKCX0sCglyZXN0cmljdCA9IHsKCQl2ZW50dXJlZCA9IDEsCgkJbW9kZXMgPSB7CgkJCVsxNV0gPSBmdW5jdGlvbiAoKQoJCQkJcmV0dXJuIGFudGlhaW0uZGF0YS5saWZldGltZSAlIGNsaWVudC5yYW5kb21faW50KDEsIDQpID09IDAKCQkJZW5kLAoJCQlbMTZdID0gZnVuY3Rpb24gKCkKCQkJCXJldHVybiBhbnRpYWltLmRhdGEubGlmZXRpbWUgJSBjbGllbnQucmFuZG9tX2ludCgyLCA2KSA9PSAwCgkJCWVuZCwKCQkJWzE3XSA9IGZ1bmN0aW9uICgpCgkJCQlyZXR1cm4gYW50aWFpbS5kYXRhLmxpZmV0aW1lICUgYW50aWFpbS5mZWF0dXJlcy5yZXN0cmljdC52ZW50dXJlZCA9PSAwCgkJCWVuZCwKCQl9LAoJCXdvcmsgPSBhKGZ1bmN0aW9uIChzZWxmLCBjbWQsIHNjZW5lKQoJCQlpZiBzY2VuZS5hZHYuZGVsYXkgPT0gMSBvciBub3QgbXkuZXhwbG9pdC5hY3RpdmUgdGhlbiByZXR1cm4gdHJ1ZSBlbmQKCgkJCWlmIHNlbGYubW9kZXNbc2NlbmUuYWR2LmRlbGF5XSB0aGVuCgkJCQlyZXR1cm4gc2VsZi5tb2Rlc1tzY2VuZS5hZHYuZGVsYXldKCkKCQkJZWxzZQoJCQkJcmV0dXJuIGFudGlhaW0uZGF0YS5saWZldGltZSAlIHNjZW5lLmFkdi5kZWxheSA9PSAwCgkJCWVuZAoJCWVuZCkKCX0sCglmYWtlbGFnID0gewoJCW92ZXJyaWRkZW4gPSBmYWxzZSwKCQl3b3JrID0gYShmdW5jdGlvbiAoc2VsZiwgY21kKQoJCQlsb2NhbCByY3R4LCBoY3R4ID0gcmVmcy5hYS5mYWtlbGFnLCB2YXJzLmFudGlhaW0ubGFnLmZha2VsYWcKCgkJCWlmIGFudGlhaW0uZmVhdHVyZXMuc25hcC5kZWNob2tlIHRoZW4KCQkJCXNlbGYub3ZlcnJpZGRlbiA9IHRydWUKCQkJCXJjdHguZW5hYmxlOm92ZXJyaWRlKGZhbHNlKQoJCQkJY21kLm5vX2Nob2tlID0gdHJ1ZQoJCQkJYW50aWFpbS5sYXRlc3QuZm9yY2Vfc2VuZCA9IHRydWUKCQkJCWFudGlhaW0uZmVhdHVyZXMuc25hcC5kZWNob2tlID0gZmFsc2UKCQkJCWRlYnVnICJkZWNob2tlIgoJCQlyZXR1cm4gZW5kCgoJCQlpZiBoY3R4Lm9uLnZhbHVlIHRoZW4gc2VsZi5vdmVycmlkZGVuID0gdHJ1ZSBlbmQKCgkJCWlmIG5vdCBzZWxmLm92ZXJyaWRkZW4gdGhlbiByZXR1cm4gZW5kCgoJCQlpZiBoY3R4Lm9uLnZhbHVlIHRoZW4KCQkJCXJjdHguZW5hYmxlOm92ZXJyaWRlKHRydWUpCgkJCQlyY3R4LmFtb3VudDpvdmVycmlkZShoY3R4Lm1vZGUudmFsdWUpCgkJCQlyY3R4LmxpbWl0Om92ZXJyaWRlKGhjdHgubGltaXQudmFsdWUpCgkJCWVsc2UKCQkJCXJjdHguZW5hYmxlOm92ZXJyaWRlKCkKCQkJCXJjdHguYW1vdW50Om92ZXJyaWRlKCkKCQkJCXJjdHgubGltaXQ6b3ZlcnJpZGUoKQoJCQkJc2VsZi5vdmVycmlkZGVuID0gZmFsc2UKCQkJZW5kCgkJZW5kKQoJfSwKCWhlYWQgPSB7CgkJd29yayA9IGEoZnVuY3Rpb24gKHNlbGYsIGN0eCkKCQkJaWYgYW50aWFpbS5kYXRhLm1hbnVhbCBvciBhbnRpYWltLmRhdGEudXNlYWEgb3Igbm90IG15LnRocmVhdCBvciBlbnRpdHkuaXNfZG9ybWFudChteS50aHJlYXQpIHRoZW4gcmV0dXJuIGVuZAoKCQkJLS0KCQkJbG9jYWwgd2VhcG9uX3QgPSB3ZWFwb25kYXRhKG15LndlYXBvbikKCQkJbG9jYWwgdGhyZWF0X29yaWdpbiA9IHZlY3RvcihlbnRpdHkuZ2V0X29yaWdpbihteS50aHJlYXQpKQoJCQlsb2NhbCBkaXN0YW5jZSA9IG15Lm9yaWdpbjpkaXN0KHRocmVhdF9vcmlnaW4pCgkJCWxvY2FsIGhlaWdodF9kaWZmID0gbXkub3JpZ2luLnogLSB0aHJlYXRfb3JpZ2luLnoKCgkJCWxvY2FsIGV4LCBleSwgZXogPSBjbGllbnQuZXllX3Bvc2l0aW9uKCkKCQkJbG9jYWwgdHJhY2VfZnIsIHRyYWNlX2VudCA9IGNsaWVudC50cmFjZV9saW5lKG15LmVudGl0eSwgZXgsIGV5LCBleiwgdGhyZWF0X29yaWdpbi54LCB0aHJlYXRfb3JpZ2luLnksIHRocmVhdF9vcmlnaW4ueiArIDU2KQoJCQlsb2NhbCBpc192aXNpYmxlID0gdHJhY2VfZW50ID09IG15LnRocmVhdAoJCQlsb2NhbCBpc19tZWxlZSA9IHdlYXBvbl90IGFuZCB3ZWFwb25fdC53ZWFwb25fdHlwZV9pbnQgPT0gMAoKCQkJLS0KCQkJbG9jYWwgdHJpZ2dlcnMgPSB2YXJzLmFudGlhaW0uZ2VuZXJhbC5oZWFkCgkJCWlmICh0cmlnZ2VyczpnZXQgIkFpciBtZWxlZSIgYW5kIG15Lmp1bXBpbmcgYW5kIGlzX21lbGVlIGFuZCBoZWlnaHRfZGlmZiA+IC0zMikKCQkJb3IgKHRyaWdnZXJzOmdldCAiSGVpZ2h0IGRpZmZlcmVuY2UiIGFuZCBoZWlnaHRfZGlmZiA+IDY0IGFuZCAoaXNfdmlzaWJsZSBvciBkaXN0YW5jZSA8IDEwMjQpKSB0aGVuCgkJCQljdHgub2Zmc2V0LCBjdHguYm9keSwgY3R4LnBpdGNoID0gMjAsIDEsIDg5CgkJCWVuZAoJCWVuZCkKCX0sCgl2dWxubGMgPSB7CgkJY2hlY2sgPSBhKGZ1bmN0aW9uIChzZWxmLCBjbWQpCgkJCWlmIG5vdCBteS5leHBsb2l0LmFjdGl2ZSB0aGVuIHJldHVybiBlbmQKCgkJCWxvY2FsIHNldHRpbmdzID0gdmFycy5hbnRpYWltLmV4cGxvaXRzLnZ1bG5sYwoJCQlpZiBub3QgKCNzZXR0aW5ncy52YWx1ZSA+IDAgYW5kIG15LndlYXBvbiB+PSBuaWwpIHRoZW4gcmV0dXJuIGZhbHNlIGVuZAoKCQkJaWYgc2V0dGluZ3M6Z2V0KCJDYW4ndCBzaG9vdCIpIHRoZW4KCQkJCWxvY2FsIG5leHRfYXR0YWNrID0gZW50aXR5LmdldF9wcm9wKG15LmVudGl0eSwgIm1fZmxOZXh0QXR0YWNrIikgb3IgMAoJCQkJbG9jYWwgbmV4dF9zaG90ID0gZW50aXR5LmdldF9wcm9wKG15LndlYXBvbiwgIm1fZmxOZXh0UHJpbWFyeUF0dGFjayIpIG9yIDAKCQkJCWxvY2FsIHNpbXRpbWUgPSBlbnRpdHkuZ2V0X3Byb3AobXkuZW50aXR5LCAibV9mbFNpbXVsYXRpb25UaW1lIikKCgkJCQlsb2NhbCBhdHRhY2tfZGlmZiwgc2hvdF9kaWZmID0gdG90aWNrcyhuZXh0X2F0dGFjayAtIHNpbXRpbWUgLSAxKSwgdG90aWNrcyhuZXh0X3Nob3QgLSBzaW10aW1lIC0gMSkKCgkJCQlsb2NhbCB3ZWFwb25fdCA9IHdlYXBvbmRhdGEobXkud2VhcG9uKQoJCQkJbG9jYWwgY29uZGl0aW9uID0gKHdlYXBvbl90IGFuZCB3ZWFwb25fdC53ZWFwb25fdHlwZV9pbnQgfj0gOSkgYW5kIChjbWQucXVpY2tfc3RvcCBvciBhdHRhY2tfZGlmZiA+IDAgb3Igc2hvdF9kaWZmID4gMCkKCgkJCQlpZiBjb25kaXRpb24gdGhlbiByZXR1cm4gdHJ1ZSBlbmQKCQkJZW5kCgoJCQlsb2NhbCBzdGF0ZV9wZXJtID0KCQkJKG15Lmp1bXBpbmcgYW5kIHNldHRpbmdzOmdldCgiSnVtcGluZyIpKSBvcgoJCQkoKG15LmNyb3VjaGluZyBhbmQgbXkub25fZ3JvdW5kKSBhbmQgc2V0dGluZ3M6Z2V0KCJDcm91Y2hpbmciKSkKCQkJLS0gKG15LndhbGtpbmcgYW5kIHNldHRpbmdzOmdldCgiV2Fsa2luZyIpKQoKCQkJaWYgbm90IHN0YXRlX3Blcm0gdGhlbiByZXR1cm4gZmFsc2UgZW5kCgoJCQlyZXR1cm4gdHJ1ZQoJCWVuZCksCgkJd29yayA9IGEoZnVuY3Rpb24gKHNlbGYsIGNtZCkKCQkJaWYgc2VsZjpjaGVjayhjbWQpIHRoZW4KCQkJCWNtZC5mb3JjZV9kZWZlbnNpdmUgPSB0cnVlCgkJCWVuZAoJCWVuZCkKCX0sCglydWJiZXIgPSB7CgkJd29yayA9IGZ1bmN0aW9uICgpCgoJCWVuZAoJfQp9CgotLSAjZW5kcmVnaW9uCgotLSAjcmVnaW9uIC0gVmVudHVyZQoKYW50aWFpbS52ZW50dXJlID0gewoJbGF0ZXN0ID0gMCwgZGFtYWdlZCA9IDAsCgl0cmlnZ2VyID0gZnVuY3Rpb24gKGV2ZW50KQoJCWlmIG5vdCBteS52YWxpZCBvciBhbnRpYWltLnZlbnR1cmUubGF0ZXN0ID09IGdsb2JhbHMudGlja2NvdW50KCkgdGhlbiByZXR1cm4gZW5kCgoJCWxvY2FsIGF0dGFja2VyID0gY2xpZW50LnVzZXJpZF90b19lbnRpbmRleChldmVudC51c2VyaWQpCgkJaWYgbm90IGF0dGFja2VyIG9yIG5vdCBlbnRpdHkuaXNfZW5lbXkoYXR0YWNrZXIpIG9yIGVudGl0eS5pc19kb3JtYW50KGF0dGFja2VyKSB0aGVuIHJldHVybiBlbmQKCgkJLS0KCQlsb2NhbCBpbXBhY3QgPSB2ZWN0b3IoZXZlbnQueCwgZXZlbnQueSwgZXZlbnQueikKCQlsb2NhbCBlbmVteV92aWV3ID0gdmVjdG9yKGVudGl0eS5nZXRfb3JpZ2luKGF0dGFja2VyKSkKCQllbmVteV92aWV3LnogPSBlbmVteV92aWV3LnogKyA2NAoKCQlsb2NhbCBkaXN0cyA9IHt9CgkJZm9yIGkgPSAxLCAjcGxheWVycyBkbwoJCQlsb2NhbCB2ID0gcGxheWVyc1tpXQoKCQkJaWYgbm90IGVudGl0eS5pc19lbmVteSh2KSB0aGVuCgkJCQlsb2NhbCBoZWFkID0gdmVjdG9yKGVudGl0eS5oaXRib3hfcG9zaXRpb24odiwgMCkpCgkJCQlsb2NhbCBwb2ludCA9IG1hdGguY2xvc2VzdF9yYXlfcG9pbnQoaGVhZCwgZW5lbXlfdmlldywgaW1wYWN0KQoJCQkJZGlzdHNbI2Rpc3RzKzFdID0gaGVhZDpkaXN0KHBvaW50KQoJCQkJaWYgdiA9PSBteS5lbnRpdHkgdGhlbiBkaXN0cy5taW5lID0gZGlzdHNbI2Rpc3RzXSBlbmQKCQkJZW5kCgkJZW5kCgoJCWxvY2FsIGNsb3Nlc3QgPSBtYXRoLm1pbiggdW5wYWNrKGRpc3RzKSApCgoJCS0tCgkJaWYgKGRpc3RzLm1pbmUgYW5kIGNsb3Nlc3QpIGFuZCBkaXN0cy5taW5lIDwgNDAgb3IgKGNsb3Nlc3QgPT0gZGlzdHMubWluZSBhbmQgZGlzdHMubWluZSA8IDEyOCkgdGhlbgoJCQljbGllbnQuZGVsYXlfY2FsbCh0b3RpbWUoMSksIGZ1bmN0aW9uICgpCgkJCQljbGllbnQuZmlyZV9ldmVudCgiaHlzdGVyaWE6OmVuZW15X3Nob3QiLCB7CgkJCQkJZGFtYWdlZCA9IGFudGlhaW0udmVudHVyZS5sYXRlc3QgPT0gYW50aWFpbS52ZW50dXJlLmRhbWFnZWQsCgkJCQkJZGlzdCA9IGRpc3RzLm1pbmUsCgkJCQkJYXR0YWNrZXIgPSBhdHRhY2tlciwKCQkJCQl1c2VyaWQgPSBldmVudC51c2VyaWQKCQkJCX0pCgkJCWVuZCkKCgkJCWFudGlhaW0udmVudHVyZS5sYXRlc3QgPSBnbG9iYWxzLnRpY2tjb3VudCgpCgkJCWFudGlhaW0uZmVhdHVyZXMucmVzdHJpY3QudmVudHVyZWQgPSBtYXRoLnJhbmRvbSgxLCA0KQoJCWVuZAoJZW5kLAoJcnVuID0gZnVuY3Rpb24gKHNlbGYpCgkJY2FsbGJhY2tzLmJ1bGxldF9pbXBhY3Q6c2V0KHNlbGYudHJpZ2dlcikKCQljYWxsYmFja3MucGxheWVyX2h1cnQ6c2V0KGZ1bmN0aW9uIChldmVudCkKCQkJaWYgY2xpZW50LnVzZXJpZF90b19lbnRpbmRleChldmVudC51c2VyaWQpID09IG15LmVudGl0eSB0aGVuIHNlbGYuZGFtYWdlZCA9IGdsb2JhbHMudGlja2NvdW50KCkgZW5kCgkJZW5kKQoJZW5kCn0KCmFudGlhaW0udmVudHVyZTpydW4oKQoKLS0gI2VuZHJlZ2lvbgoKLS0gI3JlZ2lvbiAtIEJ1aWxkZXIKCmFudGlhaW0uYnVpbGRlciA9IHsKCXlhdyA9IGZ1bmN0aW9uIChzZWxmLCBjbWQsIHNjZW5lKQoJCWxvY2FsIHVzZSA9IGFudGlhaW0uZGF0YS51c2VhYQkJCQkJaWYgdXNlIHRoZW4gcmV0dXJuIHVzZVsxXSwgdXNlWzJdLCAiTG9jYWwgdmlldyIsIHt9IGVuZAoJCWxvY2FsIHN0YWIgPSBhbnRpYWltLmZlYXR1cmVzLnN0YWI6d29yaygpCQlpZiBzdGFiIHRoZW4gcmV0dXJuIHN0YWJbMV0sIHN0YWJbMl0sIG5pbCwge30gZW5kCgkJbG9jYWwgbWFudWFsID0gYW50aWFpbS5mZWF0dXJlcy5tYW51YWw6d29yaygpCWlmIG1hbnVhbCB0aGVuIHJldHVybiBtYW51YWwsIG5pbCwgIkxvY2FsIHZpZXciLCB7cyA9IHRydWV9IGVuZAoKCQlyZXR1cm4gc2NlbmUueWF3Lm9mZnNldCwgODksIG5pbCwge30KCWVuZCwKCW1vZGlmaWVyID0gZnVuY3Rpb24gKHNlbGYsIHNjZW5lKQoJCWlmIGFudGlhaW0uZGF0YS5zdGF0aWMgdGhlbiByZXR1cm4gMCBlbmQKCQlsb2NhbCBzaWRlLCB2YWx1ZSA9IDEsIDAKCgkJLS0KCQlsb2NhbCBtb2RpZmllciwgZGVncmVlLCByYW5nZSwgZWFjaHdheSA9IHNjZW5lLm1vZC50eXBlLCBzY2VuZS5tb2QuZGVncmVlLCBzY2VuZS5tb2QucmFuZ2UsIHNjZW5lLndheXMubWFudWFsCgkJbG9jYWwgcmFuZG9tID0gY2xpZW50LnJhbmRvbV9pbnQoLXNjZW5lLmFkdi5pcnJlZyAqIDAuNSwgc2NlbmUuYWR2LmlycmVnICogMC41KQoKCQlsb2NhbCBtaW4sIG1heCA9IChyYW5nZSBhbmQgc2NlbmUubW9kLm1pbiBvciAtZGVncmVlKSwgKHJhbmdlIGFuZCBzY2VuZS5tb2QubWF4IG9yIGRlZ3JlZSkKCQlsb2NhbCBhZGRpdGlvbiA9IHNjZW5lLm1vZC5hZGQgYW5kICgoYW50aWFpbS5teS5zaWRlID09IDEgYW5kIHNjZW5lLm1vZC5yaWdodCkgb3IgKGFudGlhaW0ubXkuc2lkZSA9PSAtMSBhbmQgc2NlbmUubW9kLmxlZnQpKSBvciAwCgoJCS0tCgkJaWYgCSAgIG1vZGlmaWVyID09ICJKaXR0ZXIiIHRoZW4JdmFsdWUgPSAoYW50aWFpbS5teS5zd2l0Y2ggYW5kIG1pbiBvciBtYXgpICogc2lkZQoJCWVsc2VpZiBtb2RpZmllciA9PSAiUmFuZG9tIiB0aGVuCXZhbHVlID0gbWF0aC5yYW5kb20obWluLCBtYXgpCgkJZWxzZWlmIG1vZGlmaWVyID09ICJSb3RhdGUiIHRoZW4JdmFsdWUgPSBtYXRoLmxlcnAobWF4LCBtaW4sIChnbG9iYWxzLnRpY2tjb3VudCgpICogc2lkZSkgJSA1IC8gNSkKCQllbHNlaWYgbW9kaWZpZXIgPT0gItC/0LXRgNC00LXQu9GM0YLQsCIgdGhlbgoJCQl2YWx1ZSA9IG1hdGgubGVycChtYXgsIG1pbiwgbWF0aC5zaW4oZ2xvYmFscy5jdXJ0aW1lKCkgKiA1ICUgMSkpCgkJZWxzZWlmIG1vZGlmaWVyID09ICJYLXdheSIgdGhlbgoJCQktLSBpZiBhbnRpYWltLm15LnNpZGUgfj0gMCBhbmQgbm90IHNjZW5lLm1vZC53cyBhbmQgc2NlbmUuYm9keS5qaXR0ZXIgYW5kIChhbnRpYWltLmRhdGEud2F5ICUgMiA9PSAwKSB+PSAoYW50aWFpbS5teS5zaWRlID09IDEpIHRoZW4KCQkJLS0gCWFudGlhaW0uZGF0YS53YXkgPSBhbnRpYWltLmRhdGEud2F5IC0gMQoJCQktLSBlbmQKCgkJCWFudGlhaW0uZGF0YS53YXkgPSBhbnRpYWltLmRhdGEud2F5IDwgKHNjZW5lLndheXMudG90YWwgLSAxKSBhbmQgKGFudGlhaW0uZGF0YS53YXkgKyAxKSBvciAwCgoJCQlpZiBlYWNod2F5IHRoZW4KCQkJCXZhbHVlID0gc2NlbmUud2F5W2FudGlhaW0uZGF0YS53YXkrMV0KCQkJZWxzZQoJCQkJbG9jYWwgc3RlcCA9IChhbnRpYWltLmRhdGEud2F5KSAvIChzY2VuZS53YXlzLnRvdGFsIC0gMSkKCQkJCXZhbHVlID0gbWF0aC5sZXJwKG1pbiwgbWF4LCBzdGVwKQoJCQllbmQKCQllbmQKCgoJCS0tCgkJcmV0dXJuIHZhbHVlICsgYWRkaXRpb24gKyByYW5kb20KCWVuZCwKCWJvZHkgPSBmdW5jdGlvbiAoc2VsZiwgc2NlbmUsIG1vZGlmaWVyKQoJCWlmIG5vdCBzY2VuZS5ib2R5Lm9uIHRoZW4gcmV0dXJuIGVuZAoJCWlmIHZhcnMuYW50aWFpbS5nZW5lcmFsLndhcm11cC52YWx1ZSBhbmQgZW50aXR5LmdldF9wcm9wKG15LmdhbWVfcnVsZXMsICJtX2JXYXJtdXBQZXJpb2QiKSA9PSAxIHRoZW4gcmV0dXJuIGVuZAoKCQlsb2NhbCBzaWRlLCBsZWZ0LCByaWdodCA9IDAsIDAsIDAKCQlsb2NhbCBzaG91bGRfcmVsYXRlID0gc2NlbmUubW9kLnR5cGUgPT0gIlgtd2F5IiBhbmQgc2NlbmUuYm9keS5yZWxhdGl2ZQoJCS0tIGxvY2FsIGRlc3luYyA9IG1hdGgubm9ybWFsaXplX3lhdyhhZGF0YS5nZXRfYWJzX3lhdygpIC0gYWRhdGEuZ2V0X2JvZHlfeWF3KDEpKQoKCQlpZiBzY2VuZS5ib2R5Lm1vZGUgPT0gIkRlZmF1bHQiIHRoZW4KCQkJbGVmdCwgcmlnaHQgPSBzY2VuZS5ib2R5LmRlZ3JlZSwgc2NlbmUuYm9keS5kZWdyZWUKCQllbHNlaWYgc2NlbmUuYm9keS5tb2RlID09ICJTaWRlLWJhc2VkIiB0aGVuCgkJCWxlZnQsIHJpZ2h0ID0gc2NlbmUuYm9keS5sZWZ0LCBzY2VuZS5ib2R5LnJpZ2h0CgkJZWxzZWlmIHNjZW5lLmJvZHkubW9kZSA9PSAiQXV0byIgdGhlbgoJCQlpZiBzaG91bGRfcmVsYXRlIHRoZW4KCQkJCWxlZnQsIHJpZ2h0ID0gMCwgMAoJCQkJZ290byBwcm9jZXNzZWQKCQkJZW5kCgkJCWxvY2FsIG92ZXJsYXAgPSBhZGF0YS5nZXRfb3ZlcmxhcCh0cnVlKQoKCQkJbG9jYWwgY3VyLCBvbGQgPSBlbnRpdHkuZ2V0X3NpbXRpbWUobXkuZW50aXR5KQoJCQlsb2NhbCBmbCA9IChjdXIgYW5kIG9sZCkgYW5kIHRvdGlja3MoY3VyIC0gb2xkKSAtIDEgb3IgMQoKCQkJbG9jYWwgbWF4ID0gb3ZlcmxhcCAqIChmbCA8IDIgYW5kIDMwIG9yIDYwKQoKCQkJbGVmdCwgcmlnaHQgPSBtb2RpZmllciAqIG1hdGguZ3JhdGlvIC0gbWF4LCBtb2RpZmllciAqIG1hdGguZ3JhdGlvICsgbWF4CgkJZW5kCgoJCTo6cHJvY2Vzc2VkOjoKCgkJLS0KCQlpZiBzaG91bGRfcmVsYXRlIHRoZW4KCQkJc2lkZSA9IG1hdGguY2xhbXAobW9kaWZpZXIsIC0xLCAxKQoJCWVsc2UKCQkJc2lkZSA9IHRlcm5hcnkoc2NlbmUuYm9keS5qaXR0ZXIsIGFudGlhaW0ubXkuc3dpdGNoLCB2YXJzLmFudGlhaW0uZ2VuZXJhbC5pbnZlcnRlcjpnZXQoKSkgYW5kIDEgb3IgLTEKCQllbmQKCgkJaWYgYW50aWFpbS5kYXRhLnN0YXRpYyB0aGVuIHNpZGUgPSAxIGVuZAoKCQktLQoJCWxvY2FsIHJlc3VsdCA9IChzaWRlID09IDAgYW5kIDApIG9yIChzaWRlID4gMCBhbmQgbGVmdCkgb3IgKHNpZGUgPCAwIGFuZCByaWdodCkKCQlhbnRpYWltLm15LnNpZGUgPSAocmVzdWx0ID09IDAgYW5kIChhbnRpYWltLm15LnN3aXRjaCBhbmQgMSBvciAtMSkpIG9yIChyZXN1bHQgPiAwIGFuZCAxKSBvciAocmVzdWx0IDwgMCBhbmQgLTEpCgoJCXJldHVybiByZXN1bHQKCWVuZCwKCXdvcmsgPSBmdW5jdGlvbiAoc2VsZiwgY21kLCBzY2VuZSwgY3R4KQoJCWxvY2FsIHlhdywgcGl0Y2gsIGJhc2UsIGZsYWdzID0gc2VsZjp5YXcoY21kLCBzY2VuZSkKCQlhbnRpYWltLmRhdGEuc3RhdGljID0gZmxhZ3MucyBhbmQgdmFycy5hbnRpYWltLmdlbmVyYWwubWFudWFsLnN0LnZhbHVlCgkJbG9jYWwgbW9kaWZpZXIgPSBzZWxmOm1vZGlmaWVyKHNjZW5lKQoJCWxvY2FsIGJvZHkgPSBzZWxmOmJvZHkoc2NlbmUsIG1vZGlmaWVyKQoKCQktLQoJCWN0eC5waXRjaF9tb2RlID0gIkN1c3RvbSIKCQljdHgucGl0Y2ggPSBwaXRjaCBvciA4OQoKCQljdHguYmFzZSA9IGJhc2Ugb3IgY3R4LmJhc2UKCQljdHgub2Zmc2V0ID0gbWF0aC5ub3JtYWxpemVfeWF3KHlhdyArIG1vZGlmaWVyKQoKCQljdHguYm9keV95YXcgPSBib2R5IGFuZCAiU3RhdGljIiBvciAiT2ZmIgoJCWlmIGJvZHkgdGhlbgoJCQljdHguYm9keSA9IG1hdGguY2xhbXAoYm9keSwgLTE4MCwgMTgwKQoJCWVuZAoJZW5kCn0KCi0tICNlbmRyZWdpb24KCi0tICNlbmRyZWdpb24KLS0KCi0tCi0tICNyZWdpb24gOiBTZXR1cAoKLS0gI3JlZ2lvbiAtIE1haW4KCmFudGlhaW0uYXJyYW5nZSA9IGEoZnVuY3Rpb24gKCkKCWxvY2FsIHN0YXRlID0gbXkuc3RhdGUKCWxvY2FsIHByZXNldAoKCWxvY2FsIGlzX2N1c3RvbSA9IHRydWUKCglpZiBpc19jdXN0b20gdGhlbgoJCXByZXNldCA9IGFudGlhaW0ucHJlc2V0cy5jdXN0b20KCWVuZAoKCXN0YXRlID0gcHJlc2V0WyBhbnRpYWltLnN0YXRlc1sgc3RhdGUgXVsxXSBdLm92ZXJyaWRlIGFuZCBzdGF0ZSBvciBlbnVtcy5zdGF0ZXMuZGVmYXVsdAoKCWlmIChteS5jcm91Y2hpbmcgYW5kIG15Lm9uX2dyb3VuZCBhbmQgbXkudmVsb2NpdHkgPiA1KSBhbmQgcHJlc2V0LnNuZWFrLm92ZXJyaWRlIHRoZW4KCQlzdGF0ZSA9IGVudW1zLnN0YXRlcy5zbmVhawoJZWxzZWlmIChteS5qdW1waW5nIGFuZCBteS5jcm91Y2hpbmcpIGFuZCBwcmVzZXQuYWlyZHVjay5vdmVycmlkZSB0aGVuCgkJc3RhdGUgPSBlbnVtcy5zdGF0ZXMuYWlyZHVjawoJZW5kCgoKCWFudGlhaW0ubXkuc3RhdGUgPSBhbnRpYWltLnN0YXRlc1sgc3RhdGUgXVsxXQoJYW50aWFpbS5kYXRhLnNjZW5lcnkgPSBwcmVzZXQKCWFudGlhaW0uZGF0YS5wcmVzZXQgPSBwcmVzZXRbYW50aWFpbS5teS5zdGF0ZV0KCglpZiBpc19jdXN0b20gYW5kIG5vdCBwdWkubWVudV9vcGVuIHRoZW4KCQlsb2NhbCBzZWxlY3RlZCA9IHZhcnMuYW50aWFpbS5idWlsZGVyLnN0YXRlLnZhbHVlCgkJbG9jYWwgY3VycmVudCA9IGFudGlhaW0uc3RhdGVzW3N0YXRlXVsyXQoJCWlmIHNlbGVjdGVkIH49IGN1cnJlbnQgdGhlbgoJCQktLSB2YXJzLmFudGlhaW0uYnVpbGRlci5zdGF0ZTpzZXQoY3VycmVudCkKCQllbmQKCWVuZAoKCWxvY2FsIGN0eCA9IHsKCQlwaXRjaCA9IC04OSwKCQliYXNlID0gdmFycy5hbnRpYWltLmdlbmVyYWwueWF3LnZhbHVlLAoJCXBpdGNoX21vZGUgPSBuaWwsCgkJeWF3ID0gIjE4MCIsCgkJb2Zmc2V0ID0gbmlsLAoJCWppdHRlciA9ICJPZmYiLAoJCWppdHRlcl9kZWcgPSBuaWwsCgkJYm9keV95YXcgPSBuaWwsCgkJYm9keSA9IG5pbCwKCX0KCglyZXR1cm4gYW50aWFpbS5kYXRhLnByZXNldCwgY3R4CmVuZCkKCmFudGlhaW0uZGlzcGF0Y2ggPSBhKGZ1bmN0aW9uIChkYXRhKQoJZm9yIGssIHYgaW4gbmV4dCwgYW50aWFpbS5yZWZzIGRvCgkJdjpvdmVycmlkZShkYXRhW2tdKQoJZW5kCmVuZCkKCmFudGlhaW0ubWFuYWdlID0gYShmdW5jdGlvbiAoY21kKQoJdGFibGUuY2xlYXIoYW50aWFpbS5sYXRlc3QpCglsb2NhbCBzY2VuZSwgY3R4ID0gYW50aWFpbS5hcnJhbmdlKCkKCgktLQoJYW50aWFpbS5idWlsZGVyOndvcmsoY21kLCBzY2VuZSwgY3R4KQoKCS0tCglhbnRpYWltLmRhdGEudXNlYWEgPSBhbnRpYWltLmZlYXR1cmVzLm9uX3VzZTp3b3JrKGNtZCkKCWFudGlhaW0uZmVhdHVyZXMudnVsbmxjOndvcmsoY21kKQoJYW50aWFpbS5mZWF0dXJlcy5mYWtlbGFnOndvcmsoY21kKQoJaWYgbm90IChhbnRpYWltLmRhdGEubWFudWFsIG9yIGFudGlhaW0uZGF0YS51c2VhYSkgdGhlbgoJCWFudGlhaW0uZmVhdHVyZXMuc25hcDp3b3JrKGNtZCwgY3R4KQoJCWFudGlhaW0uZmVhdHVyZXMuaGVhZDp3b3JrKGN0eCkKCWVuZAoKCS0tCglpZiBjbWQuY2hva2VkY29tbWFuZHMgPT0gMCBvciBhbnRpYWltLmxhdGVzdC5mb3JjZV9zZW5kIHRoZW4KCQlhbnRpYWltLmRpc3BhdGNoKGN0eCkKCQlpZiBjbWQuY2hva2VkY29tbWFuZHMgPT0gMCB0aGVuCgkJCWFudGlhaW0uZGF0YS5saWZldGltZSA9IGFudGlhaW0uZGF0YS5saWZldGltZSArIDEKCQkJaWYgYW50aWFpbS5mZWF0dXJlcy5yZXN0cmljdDp3b3JrKGNtZCwgc2NlbmUpIHRoZW4KCQkJCWFudGlhaW0ubXkuc3dpdGNoID0gbm90IGFudGlhaW0ubXkuc3dpdGNoCgkJCWVuZAoJCWVuZAoJZW5kCgoJLS0KCWFudGlhaW0uZGF0YS5kZWZlbnNpdmUgPSBjbWQuZm9yY2VfZGVmZW5zaXZlCmVuZCkKCi0tICNlbmRyZWdpb24KCi0tICNyZWdpb24gLSBGaW5pc2gKCmFudGlhaW0ucnVuID0gYShmdW5jdGlvbiAoKQoJbG9jYWwgZGVjaG9rZSA9IGZ1bmN0aW9uICgpCgkJbG9jYWwgZmQsIGR0LCBvcyA9IHJlZnMucmFnZS5vdGhlci5kdWNrOmdldCgpLCByZWZzLnJhZ2UuYWltYm90LmRvdWJsZV90YXBbMV0udmFsdWUgYW5kIHJlZnMucmFnZS5haW1ib3QuZG91YmxlX3RhcFsxXS5ob3RrZXk6Z2V0KCksIHJlZnMuYWEub3RoZXIub25zaG90LnZhbHVlIGFuZCByZWZzLmFhLm90aGVyLm9uc2hvdC5ob3RrZXk6Z2V0KCkKCQlpZiBhbnRpYWltLmxhdGVzdC5zbmFwcGluZyBhbmQgKGZkIG9yIG5vdCAoZHQgb3Igb3MpKSBhbmQgbm90IGFudGlhaW0uZmVhdHVyZXMuc25hcC5kZWNob2tlIHRoZW4KCQkJYW50aWFpbS5mZWF0dXJlcy5zbmFwLmRlY2hva2UgPSB0cnVlCgkJCXJlZnMuYWEuZmFrZWxhZy5lbmFibGU6b3ZlcnJpZGUoZmFsc2UpCgkJZW5kCgllbmQKCgl2YXJzLmFudGlhaW0uZ2xvYmFsOnNldF9jYWxsYmFjayhmdW5jdGlvbiAodGhpcykKCQljYWxsYmFja3Muc2V0dXBfY29tbWFuZCh0aGlzLnZhbHVlLCBhbnRpYWltLm1hbmFnZSkKCQljYWxsYmFja3MucHJlX3JlbmRlcih0aGlzLnZhbHVlLCBkZWNob2tlKQoKCQlyZWZzLmFhLmFuZ2xlcy5lbmFibGU6b3ZlcnJpZGUodGhpcy52YWx1ZSBvciBuaWwpCgkJcmVmcy5hYS5hbmdsZXMuZnJlZXN0YW5kOm92ZXJyaWRlKHRlcm5hcnkodGhpcy52YWx1ZSwgZmFsc2UsIG5pbCkpCgkJcmVmcy5hYS5hbmdsZXMuZnNfYm9keTpvdmVycmlkZSh0ZXJuYXJ5KHRoaXMudmFsdWUsIGZhbHNlLCBuaWwpKQoJCXJlZnMuYWEuYW5nbGVzLmZyZWVzdGFuZC5ob3RrZXk6b3ZlcnJpZGUodGhpcy52YWx1ZSBhbmQgeyJBbHdheXMgb24iLCAwfSBvciBuaWwpCgoJCWlmIG5vdCB0aGlzLnZhbHVlIHRoZW4KCQkJYW50aWFpbS5yZXZlcnQoKQoJCWVuZAoJZW5kLCB0cnVlKQoKCWRlZmVyKGFudGlhaW0ucmV2ZXJ0KQplbmQpCgphbnRpYWltLnJldmVydCA9IGZ1bmN0aW9uICgpCglmb3IgaywgdiBpbiBwYWlycyhhbnRpYWltLnJlZnMpIGRvIHY6b3ZlcnJpZGUoKSBlbmQKCWFudGlhaW0uZGF0YS5tYW51YWwgPSBuaWwKCXJlZnMuYWEuYW5nbGVzLmVuYWJsZTpvdmVycmlkZSgpCglyZWZzLmFhLmFuZ2xlcy5mcmVlc3RhbmQ6b3ZlcnJpZGUoKQoJcmVmcy5hYS5hbmdsZXMuZnJlZXN0YW5kLmhvdGtleTpvdmVycmlkZSgpCmVuZAoKZG8KCXZhcnMuYW50aWFpbS5nZW5lcmFsLm1hbnVhbC5vbjpzZXRfY2FsbGJhY2soZnVuY3Rpb24gKHRoaXMpCgkJaWYgbm90IHRoaXMudmFsdWUgdGhlbgoJCQlhbnRpYWltLmRhdGEubWFudWFsID0gbmlsCgkJCXJlZnMuYWEuYW5nbGVzLmVkZ2U6b3ZlcnJpZGUoKQoJCQlyZWZzLmFhLmFuZ2xlcy5mcmVlc3RhbmQ6b3ZlcnJpZGUoKQoJCWVuZAoJZW5kKQplbmQKCi0tICNlbmRyZWdpb24KCmFudGlhaW0ucnVuKCkKCi0tICNlbmRyZWdpb24KLS0KCgotLSAjZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQotLQoKCgotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQotLSAjcmVnaW9uIDo6IEZlYXR1cmVzCgoKLS0KLS0gI3JlZ2lvbiA6IE1pc2MKCi0tICNyZWdpb24gLSBGZWF0dXJlcwoKbWlzYy5jbGFudGFnID0gewoJZW5hYmxlZCA9IGZhbHNlLAoJbGFzdCA9IDAsCglsaXN0ID0gewoJCSJf4qCA4qCAIOKggCDioIAiLAoJCSI4X+KggOKggOKggCDioIAgIiwKCQkiaDRf4qCAIOKggCDioIAgIiwKCQkiaHkyXyDioIDioIDioIAiLAoJCSJoeXM3XyDioIDioIAgIiwKCQkiaHlzdDNf4qCA4qCAIiwKCQkiaHlzdGU5X+KggCAiLAoJCSJoeXN0ZXIxX+KggCIsCgkJImh5c3Rlcmk0XyAiLAoKCQkiaHlzdGVyaWHioIAiLAoJCSJoeXN0ZXJpYV8gIiwKCQkiaHlzdGVyaWHioIAiLAoJCSJoeXN0ZXJpYV8gIiwKCQkiaHlzdGVyaWHioIAiLAoJCSJoeXN0ZXJpYV8gIiwKCQkiaHlzdGVyaWHioIAiLAoJCSJoeXN0ZXJpYV8gIiwKCQkiaHlzdGVyaWHioIAiLAoJCSJoeXN0ZXJpYV8gIiwKCQkiaHlzdGVyaWHioIAiLAoKCQki4qCAXzRzdGVyaWEgIiwKCQki4qCA4qCAXzJ0ZXJpYSIsCgkJIuKggOKggCBfN2VyaWEiLAoJCSLioIDioIDioIBfM3JpYSIsCgkJIuKggOKggCDioIAgXzlpYSIsCgkJIuKggOKggOKggOKggF8xYSIsCgkJIuKggCDioIAg4qCAIF80IiwKCQki4qCAIOKggCDioIAg4qCAICIsCgl9LAoJd29yayA9IGEoZnVuY3Rpb24gKCkKCQlpZiBtaXNjLmNsYW50YWcuZW5hYmxlZCBhbmQgbm90IHZhcnMubWlzYy5jbGFudGFnLnZhbHVlIHRoZW4KCQkJbWlzYy5jbGFudGFnLmVuYWJsZWQgPSBmYWxzZQoJCQljYWxsYmFja3MubmV0X3VwZGF0ZV9lbmQ6dW5zZXQobWlzYy5jbGFudGFnLndvcmspCgkJCWNsaWVudC5zZXRfY2xhbl90YWcoKQoJCWVuZAoKCQlsb2NhbCB0aW1lID0gbWF0aC5mbG9vciggZ2xvYmFscy5jdXJ0aW1lKCkgKiA0ICsgMC41ICkKCQlsb2NhbCBpID0gdGltZSAlICNtaXNjLmNsYW50YWcubGlzdCArIDEKCgkJaWYgaSA9PSBtaXNjLmNsYW50YWcubGFzdCB0aGVuIHJldHVybiBlbmQKCQltaXNjLmNsYW50YWcubGFzdCA9IGkKCgkJY2xpZW50LnNldF9jbGFuX3RhZyhtaXNjLmNsYW50YWcubGlzdFtpXSkKCWVuZCksCglydW4gPSBhKGZ1bmN0aW9uIChzZWxmKQoJCXZhcnMubWlzYy5jbGFudGFnOnNldF9jYWxsYmFjayhmdW5jdGlvbiAodGhpcykKCQkJcmVmcy5taXNjLmNsYW50YWc6c2V0X2VuYWJsZWQobm90IHRoaXMudmFsdWUpCgoJCQlpZiB0aGlzLnZhbHVlIHRoZW4KCQkJCXNlbGYuZW5hYmxlZCA9IHRydWUKCQkJCWNhbGxiYWNrcy5uZXRfdXBkYXRlX2VuZDpzZXQoc2VsZi53b3JrKQoJCQkJcmVmcy5taXNjLmNsYW50YWc6b3ZlcnJpZGUoZmFsc2UpCgkJCWVsc2UKCQkJCXJlZnMubWlzYy5jbGFudGFnOm92ZXJyaWRlKCkKCQkJCWNsaWVudC5zZXRfY2xhbl90YWcoKQoJCQllbmQKCQllbmQsIHRydWUpCgkJZGVmZXIoZnVuY3Rpb24gKCkKCQkJcmVmcy5taXNjLmNsYW50YWc6c2V0X2VuYWJsZWQodHJ1ZSkKCQkJcmVmcy5taXNjLmNsYW50YWc6b3ZlcnJpZGUoKQoJCQljbGllbnQuc2V0X2NsYW5fdGFnKCkKCQllbmQpCgllbmQpCn0KCm1pc2MubGFkZGVyID0gewoJd29yayA9IGEoZnVuY3Rpb24gKGNtZCkKCQlpZiBlbnRpdHkuZ2V0X3Byb3AobXkuZW50aXR5LCAibV9Nb3ZlVHlwZSIpIH49IDkgb3IgY21kLmZvcndhcmRtb3ZlID09IDAgdGhlbiByZXR1cm4gZW5kCgoJCWxvY2FsIGNhbWVyYV9waXRjaCwgY2FtZXJhX3lhdyA9IGNsaWVudC5jYW1lcmFfYW5nbGVzKCkKCQlsb2NhbCBkZXNjZW5kaW5nID0gY21kLmZvcndhcmRtb3ZlIDwgMCBvciBjYW1lcmFfcGl0Y2ggPiA0NQoKCQljbWQuaW5fbW92ZWxlZnQsIGNtZC5pbl9tb3ZlcmlnaHQgPSBkZXNjZW5kaW5nIGFuZCAxIG9yIDAsIG5vdCBkZXNjZW5kaW5nIGFuZCAxIG9yIDAKCQljbWQuaW5fZm9yd2FyZCwgY21kLmluX2JhY2sgPSBkZXNjZW5kaW5nIGFuZCAxIG9yIDAsIG5vdCBkZXNjZW5kaW5nIGFuZCAxIG9yIDAKCgkJY21kLnBpdGNoLCBjbWQueWF3ID0gODksIG1hdGgubm9ybWFsaXplX3lhdyhjbWQueWF3ICsgOTApCgllbmQpLAoJcnVuID0gYShmdW5jdGlvbiAoc2VsZikKCQl2YXJzLm1pc2MubGFkZGVyOnNldF9jYWxsYmFjayhmdW5jdGlvbiAodGhpcykKCQkJY2FsbGJhY2tzLnNldHVwX2NvbW1hbmQodGhpcy52YWx1ZSwgc2VsZi53b3JrKQoJCWVuZCwgdHJ1ZSkKCWVuZCkKfQoKbWlzYy5tYXJrZXIgPSB7CglkdXJhdGlvbiA9IDIsCglsaXN0ID0ge30sCgoJbWFya2VyID0gYShmdW5jdGlvbiAoc2hvdCwgcHJvZ3Jlc3MsIGFzY2VuZCkKCQlsb2NhbCB4LCB5ID0gcmVuZGVyZXIud29ybGRfdG9fc2NyZWVuKHNob3QueCwgc2hvdC55LCBzaG90LnopCgkJaWYgeCBhbmQgeSB0aGVuCgkJCXgsIHkgPSB4IC8gRFBJLCB5IC8gRFBJCgoJCQlpZiBhc2NlbmQgdGhlbgoJCQkJbG9jYWwgcGhhbnRvbSA9IDMyICogcHJvZ3Jlc3MKCQkJCXJlbmRlci5jaXJjbGUoeCwgeSwgY29sb3JzLmFjY2VudDphbHBoZW4oMSAtIHByb2dyZXNzLCB0cnVlKSwgcGhhbnRvbSkKCQkJZW5kCgkJCXJlbmRlci50ZXh0dXJlKHRleHR1cmVzLm1pbmlfYmZseSwgeCAtIDUsIHkgLSA1LCA5LCA5LCBjb2xvcnMuYWNjZW50KQoJCWVuZAoJZW5kKSwKCXdvcmsgPSBhKGZ1bmN0aW9uICgpCgkJbG9jYWwgc2VsZiA9IG1pc2MubWFya2VyCgkJZm9yIGksIHYgaW4gaXBhaXJzKHNlbGYubGlzdCkgZG8KCQkJbG9jYWwgYXNjZW5kID0gdi50aW1lID4gZ2xvYmFscy5yZWFsdGltZSgpCgkJCWxvY2FsIHByb2dyZXNzID0gYW5pbWEuY29uZGl0aW9uKHYucHJvZ3Jlc3MsIGFzY2VuZCwgezMsIC00fSwgeyB7MSwgNH0sIHszLCA0fSB9KQoKCQkJcmVuZGVyLnB1c2hfYWxwaGEocHJvZ3Jlc3MpCgkJCXNlbGYubWFya2VyKHYsIHByb2dyZXNzLCBhc2NlbmQpCgkJCXJlbmRlci5wb3BfYWxwaGEoKQoKCQkJaWYgbm90IGFzY2VuZCBhbmQgcHJvZ3Jlc3MgPT0gMCB0aGVuCgkJCQl0YWJsZS5yZW1vdmUoc2VsZi5saXN0LCBpKQoJCQllbmQKCQllbmQKCWVuZCksCglhcHBlbmQgPSB7CgkJdGVtcCA9IHt9LAoJCWEoZnVuY3Rpb24gKHNob3QpCgkJCWxvY2FsIHNlbGYgPSBtaXNjLm1hcmtlcgoJCQlzZWxmLmFwcGVuZC50ZW1wW3Nob3QuaWRdID0gewoJCQkJeCA9IHNob3QueCwgeSA9IHNob3QueSwgeiA9IHNob3QuegoJCQl9CgkJZW5kKSwKCQlhKGZ1bmN0aW9uIChzaG90KQoJCQlsb2NhbCBzZWxmID0gbWlzYy5tYXJrZXIKCQkJbG9jYWwgdGVtcCA9IHNlbGYuYXBwZW5kLnRlbXBbc2hvdC5pZF0KCgkJCXRhYmxlLmluc2VydChzZWxmLmxpc3QsIDEsIHsKCQkJCXggPSB0ZW1wLngsIHkgPSB0ZW1wLnksIHogPSB0ZW1wLnosCgkJCQl0aW1lID0gZ2xvYmFscy5yZWFsdGltZSgpICsgc2VsZi5kdXJhdGlvbiwKCQkJCXByb2dyZXNzID0gezB9LAoJCQl9KQoKCQkJc2VsZi5hcHBlbmQudGVtcFtzaG90LmlkXSA9IG5pbAoJCWVuZCksCgkJYShmdW5jdGlvbiAoc2hvdCkKCQkJbWlzYy5tYXJrZXIuYXBwZW5kLnRlbXBbc2hvdC5pZF0gPSBuaWwKCQllbmQpLAoJfSwKCXJ1biA9IGEoZnVuY3Rpb24gKHNlbGYpCgkJbG9jYWwgY3R4ID0gdmFycy52aXN1YWxzLm1hcmtlcgoJCWN0eDpzZXRfZXZlbnQoImFpbV9maXJlIiwgc2VsZi5hcHBlbmRbMV0pCgkJY3R4OnNldF9ldmVudCgiYWltX2hpdCIsIHNlbGYuYXBwZW5kWzJdKQoJCWN0eDpzZXRfZXZlbnQoImFpbV9taXNzIiwgc2VsZi5hcHBlbmRbM10pCgkJY3R4OnNldF9ldmVudCgicGFpbnQiLCBzZWxmLndvcmspCgllbmQpCn0KCm1pc2MuYnJlYWtlciA9IHsKCXdvcmsgPSBhKGZ1bmN0aW9uICgpCgkJaWYgbm90IG15LnZhbGlkIHRoZW4gcmV0dXJuIGVuZAoJCWxvY2FsIGFuaW1zdGF0ZSA9IGVudGl0eS5nZXRfYW5pbXN0YXRlKG15LmVudGl0eSkKCQlpZiBub3QgYW5pbXN0YXRlIHRoZW4gcmV0dXJuIGVuZAoKCgkJbG9jYWwgY3R4ID0gdmFycy5taXNjLmJyZWFrZXIKCgkJaWYgY3R4LnBpdGNoLnZhbHVlIGFuZCAobm90IG15Lmp1bXBpbmcgYW5kIGFuaW1zdGF0ZS5oaXRfaW5fZ3JvdW5kX2FuaW1hdGlvbikgdGhlbgoJCQllbnRpdHkuc2V0X3Byb3AobXkuZW50aXR5LCAibV9mbFBvc2VQYXJhbWV0ZXIiLCAuNSwgMTIpCgkJZW5kCgoJCWlmIGN0eC5zbGlhLnZhbHVlIGFuZCBteS5qdW1waW5nIHRoZW4KCQkJZW50aXR5LnNldF9wcm9wKG15LmVudGl0eSwgIm1fZmxQb3NlUGFyYW1ldGVyIiwgMSwgNikKCQllbmQKCgkJaWYgY3R4LmxlZ3MudmFsdWUgPT0gIlN0YXRpYyIgdGhlbgoJCQlyZWZzLmFhLm90aGVyLmxlZ3M6b3ZlcnJpZGUoIkFsd2F5cyBzbGlkZSIpCgkJCWVudGl0eS5zZXRfcHJvcChteS5lbnRpdHksICJtX2ZsUG9zZVBhcmFtZXRlciIsIDAsIDApCgkJZWxzZWlmIGN0eC5sZWdzLnZhbHVlID09ICJKaXR0ZXIiIHRoZW4KCQkJcmVmcy5hYS5vdGhlci5sZWdzOm92ZXJyaWRlKCJBbHdheXMgc2xpZGUiKQoJCQlpZiBnbG9iYWxzLnRpY2tjb3VudCgpICUgNCA+IDEgdGhlbgoJCQkJZW50aXR5LnNldF9wcm9wKG15LmVudGl0eSwgIm1fZmxQb3NlUGFyYW1ldGVyIiwgMCwgMCkKCQkJZW5kCgkJZWxzZWlmIGN0eC5sZWdzLnZhbHVlID09ICJObyBzdGVwIGJhY2siIHRoZW4KCQkJcmVmcy5hYS5vdGhlci5sZWdzOm92ZXJyaWRlKCJOZXZlciBzbGlkZSIpCgkJCWVudGl0eS5zZXRfcHJvcChteS5lbnRpdHksICJtX2ZsUG9zZVBhcmFtZXRlciIsIDAuNSwgNykKCQllbHNlIHJlZnMuYWEub3RoZXIubGVnczpvdmVycmlkZSgpIGVuZAoJZW5kKSwKCXJ1biA9IGEoZnVuY3Rpb24gKHNlbGYpCgkJdmFycy5taXNjLmJyZWFrZXIub246c2V0X2NhbGxiYWNrKGZ1bmN0aW9uICh0aGlzKQoJCQljYWxsYmFja3MucHJlX3JlbmRlcih0aGlzLnZhbHVlLCBzZWxmLndvcmspCgkJCWlmIG5vdCB0aGlzLnZhbHVlIHRoZW4gcmVmcy5hYS5vdGhlci5sZWdzOm92ZXJyaWRlKCkgZW5kCgkJZW5kLCB0cnVlKQoJZW5kKQp9CgptaXNjLmFzcGVjdCA9IHsKCWFjdGl2ZSA9IGZhbHNlLAoJdmFsdWUgPSBzdyAvIHNoLAoJaW5pdCA9IHN3IC8gc2gsCglhY3RpdmF0ZSA9IGZ1bmN0aW9uICgpCgkJbWlzYy5hc3BlY3QuYWN0aXZlID0gdHJ1ZQoJZW5kLAoJd29yayA9IGZ1bmN0aW9uICgpCgkJbG9jYWwgc2VsZiwgY3R4ID0gbWlzYy5hc3BlY3QsIHZhcnMubWlzYy5hc3BlY3QKCQlpZiBub3Qgc2VsZi5hY3RpdmUgdGhlbiByZXR1cm4gZW5kCgoJCWlmIGN0eC5vbi52YWx1ZSB0aGVuCgkJCWxvY2FsIHRhcmdldCA9IGN0eC5yYXRpby52YWx1ZSAqIC4wMQoJCQlzZWxmLnZhbHVlID0gYW5pbWEubGVycChzZWxmLnZhbHVlLCB0YXJnZXQsIDgsIC4wMDEpCgkJCXNlbGYuYWN0aXZlID0gdGFyZ2V0IH49IHNlbGYudmFsdWUKCQkJY3Zhci5yX2FzcGVjdHJhdGlvOnNldF9mbG9hdChzZWxmLnZhbHVlKQoJCWVsc2UKCQkJc2VsZi52YWx1ZSA9IGFuaW1hLmxlcnAoc2VsZi52YWx1ZSwgc2VsZi5pbml0KQoJCQljdmFyLnJfYXNwZWN0cmF0aW86c2V0X2Zsb2F0KHNlbGYudmFsdWUpCgoJCQlpZiBzZWxmLnZhbHVlID09IHNlbGYuaW5pdCB0aGVuCgkJCQljYWxsYmFja3MucGFpbnRfdWk6dW5zZXQoc2VsZi53b3JrKQoJCQkJY3Zhci5yX2FzcGVjdHJhdGlvOnNldF9mbG9hdCgwKQoJCQkJc2VsZi5hY3RpdmUgPSBmYWxzZQoJCQllbmQKCQllbmQKCWVuZCwKCXJ1biA9IGZ1bmN0aW9uIChzZWxmKQoJCWxvY2FsIGN0eCA9IHZhcnMubWlzYy5hc3BlY3QKCgkJY3R4Lm9uOnNldF9jYWxsYmFjayhmdW5jdGlvbiAodGhpcykKCQkJc2VsZi5hY3RpdmUgPSB0cnVlCgkJCWlmIHRoaXMudmFsdWUgdGhlbiBjYWxsYmFja3MucGFpbnRfdWk6c2V0KHNlbGYud29yaykgZW5kCgkJZW5kLCB0cnVlKQoJCWN0eC5yYXRpbzpzZXRfY2FsbGJhY2soc2VsZi5hY3RpdmF0ZSwgdHJ1ZSkKCgkJZGVmZXIoZnVuY3Rpb24gKCkgY3Zhci5yX2FzcGVjdHJhdGlvOnNldF9mbG9hdCgwKSBlbmQpCgllbmQKfQoKbWlzYy5maWx0ZXIgPSB7CgljYWxsYmFjayA9IGZ1bmN0aW9uICh0aGlzKQoJCWN2YXIuY29uX2ZpbHRlcl9lbmFibGU6c2V0X2ludCh0aGlzLnZhbHVlIGFuZCAxIG9yIDApCgkJY3Zhci5jb25fZmlsdGVyX3RleHQ6c2V0X3N0cmluZyh0aGlzLnZhbHVlIGFuZCAiaHlzdGVyaWEiIG9yICIiKQoJZW5kLAoJcnVuID0gZnVuY3Rpb24gKHNlbGYpCgkJdmFycy5taXNjLmZpbHRlcjpzZXRfY2FsbGJhY2soc2VsZi5jYWxsYmFjaywgdHJ1ZSkKCWVuZAp9Cgpmb3IgaywgdiBpbiBwYWlycyhtaXNjKSBkbyB2OnJ1bigpIGVuZAoKLS0gI2VuZHJlZ2lvbgoKLS0gI3JlZ2lvbiAtIExvZ2dlcgoKbG9jYWwgbG9nZ2VyID0gewoJZGF0YSA9IHsKCQlmZWFyID0gMCwKCX0sCglsaXN0ID0ge30sCglzdGFjayA9IHt9LAoJZ2VuZXJpY193ZWFwb25zID0geyJrbmlmZSIsICJjNCIsICJkZWNveSIsICJmbGFzaGJhbmciLCAiaGVncmVuYWRlIiwgImluY2dyZW5hZGUiLCAibW9sb3RvdiIsICJpbmZlcm5vIiwgInNtb2tlZ3JlbmFkZSJ9LAoJY29sb3JzID0gewoJCVsiZmVhciJdCQk9IHsiXGEwMDAwMDAiLCAiXGEwMDAwMDBceDAxIiwgIlx4MDEiLCBjb2xvci5oZXgoIjAwMDAwMCIpfSwKCQlbIm1pc21hdGNoIl0JPSB7IlxhRDU5QTREIiwgIlxhRDU5QTREXHgwMSIsICJceDA3IiwgY29sb3IuaGV4KCJENTlBNEQiKX0sCgkJWyJoaXQiXQkJCT0geyJcYUEzRDM1MCIsICJcYUEzRDM1MFx4MDEiLCAiXHgwNiIsIGNvbG9yLmhleCgiQTNEMzUwIil9LAoJCVsibWlzcyJdCQk9IHsiXGFBNjdDQ0YiLCAiXGFBNjdDQ0ZceDAxIiwgIlx4MDMiLCBjb2xvci5oZXgoIkE2N0NDRiIpfSwKCQlbImhhcm0iXQkJPSB7IlxhZDM1MDUwIiwgIlxhZDM1MDUwXHgwMSIsICJceDA3IiwgY29sb3IuaGV4KCJkMzUwNTAiKX0sCgkJWyJicnV0ZSJdCQk9IHsiXGFCRkJGQkYiLCAiXGFCRkJGQkZceDAxIiwgIlx4MDEiLCBjb2xvci5oZXgoIkJGQkZCRiIpfSwKCQlbImV2YWRlZCJdCQk9IHsiXGFCMEM2RkYiLCAiXGFCMEM2RkZceDAxIiwgIlx4MDEiLCBjb2xvci5oZXgoIkFCMEM2RiIpfSwKCX0sCn0KCi0tI3JlZ2lvbjogZXZlbnRzCgpsb2dnZXIuZXZlbnRzID0gewoJZmVhciA9IGZ1bmN0aW9uIChjaGFuY2UsIGRlbGF5KQoJCWlmIG1hdGgucmFuZG9tKCkgPCBjaGFuY2UgYW5kIGdsb2JhbHMucmVhbHRpbWUoKSAtIGxvZ2dlci5kYXRhLmZlYXIgPiAyNDAgdGhlbgoJCQljbGllbnQuZGVsYXlfY2FsbChkZWxheSBvciA3LCBmdW5jdGlvbiAoKQoJCQkJbG9nZ2VyLmludmVudCgiZmVhciIsIHsKCQkJCQl7IllvdSBhcmUgIiwgeyJhZnJhaWQifX0sCgkJCQl9KQoJCQllbmQpCgkJCWxvZ2dlci5kYXRhLmZlYXIgPSBnbG9iYWxzLnJlYWx0aW1lKCkKCQllbmQKCWVuZCwKCWV2YWRlID0gZnVuY3Rpb24gKGV2ZW50KQoJCWlmIGV2ZW50LmRhbWFnZWQgb3Igbm90IHZhcnMubWlzYy5sb2dzLmV2ZW50czpnZXQoIkFudGktYWltIGluZm8iKSB0aGVuIHJldHVybiBlbmQKCgkJbG9nZ2VyLmludmVudCgiZXZhZGVkIiwgewoJCQl7IkV2YWRlZCAiLCB7ZW50aXR5LmdldF9wbGF5ZXJfbmFtZShldmVudC5hdHRhY2tlcil9LCAiJ3Mgc2hvdCJ9CgkJfSwgewoJCQl7ImQ6ICIsIHttYXRoLnJvdW5kKGV2ZW50LmRpc3QpfX0KCQl9KQoJZW5kLAoKCS0tCglyZWNlaXZlID0gZnVuY3Rpb24gKGV2ZW50LCB0YXJnZXQsIGF0dGFja2VyKQoJCWxvY2FsIHNlbGZfaGFybSwgaXNfZmF0YWwgPSB0YXJnZXQgPT0gYXR0YWNrZXIgb3IgYXR0YWNrZXIgPT0gMCwgZXZlbnQuaGVhbHRoID09IDAKCQlsb2NhbCB3ZWFwb24sIGRhbWFnZSwgaGl0Ym94ID0gZXZlbnQud2VhcG9uLCBldmVudC5kbWdfaGVhbHRoLCBlbnVtcy5oaXRncm91cHNbKGV2ZW50LmhpdGdyb3VwIG9yIDApICsgMV0gb3IgImdlbmVyaWMiCgkJbG9jYWwgcmVzdWx0ID0gaXNfZmF0YWwgYW5kICJLaWxsZWQgYnkiIG9yICJIYXJtZWQgYnkiCgoJCWF0dGFja2VyID0gYXR0YWNrZXIgfj0gMCBhbmQgZW50aXR5LmdldF9wbGF5ZXJfbmFtZShhdHRhY2tlcikgb3IgIndvcmxkIgoKCQlsb2NhbCBtYWluID0gewoJCQlzZWxmX2hhcm0gYW5kIHt7IllvdSJ9LCBpc19mYXRhbCBhbmQgIiBraWxsZWQgIiBvciAiIGhhcm1lZCAifSBvciB7cmVzdWx0LCAiICJ9LAoJCQl7dHJ1ZSwgc2VsZl9oYXJtIGFuZCB7InlvdXJzZWxmIn0gb3Ige2F0dGFja2VyfX0sCgkJCXtmYWxzZSwgc2VsZl9oYXJtIGFuZCB7InlvdXJzZWxmIn0gb3Ige2F0dGFja2VyfX0sCgoJCQkobm90IHNlbGZfaGFybSBhbmQgaGl0Ym94IH49ICJnZW5lcmljIikgYW5kIHsiIGluICIsIHtoaXRib3h9fSBvciBuaWwsCgkJCS0tICN3ZWFwb24gPiAwIGFuZCB7IiB3aXRoICIsIHt3ZWFwb259fSBvciBuaWwsCgkJCW5vdCBpc19mYXRhbCBhbmQgeyIgZm9yICIsIHtkYW1hZ2UsICIgaHAifX0gb3IgbmlsCgkJfQoKCQlsb2dnZXIuaW52ZW50KCJoYXJtIiwgbWFpbikKCQlpZiBub3QgaXNfZmF0YWwgdGhlbgoJCQlsb2dnZXIuZXZlbnRzLmZlYXIoMC4wMywgOSkKCQllbmQKCWVuZCwKCWhhcm0gPSBmdW5jdGlvbiAoZXZlbnQsIHRhcmdldCwgYXR0YWNrZXIpCgkJaWYgbm90IHRhYmxlLmlmaW5kKGxvZ2dlci5nZW5lcmljX3dlYXBvbnMsIGV2ZW50LndlYXBvbikgYW5kIGV2ZW50LndlYXBvbiB+PSAia25pZmUiIHRoZW4gcmV0dXJuIGVuZAoJCWxvY2FsIGlzX2ZhdGFsID0gZXZlbnQuaGVhbHRoID09IDAKCgkJbG9jYWwgd2VhcG9uID0gImEgIi4uIGV2ZW50LndlYXBvbgoJCWlmIGV2ZW50LndlYXBvbiA9PSAiaGVncmVuYWRlIiB0aGVuICB3ZWFwb24gPSAiYW4gSEUgZ3JlbmFkZSIgIGVuZAoKCQlsb2NhbCBuYW1lID0gZW50aXR5LmdldF9wbGF5ZXJfbmFtZSh0YXJnZXQpCgoJCWxvY2FsIHJlc3VsdCA9IGlzX2ZhdGFsIGFuZCAiS2lsbGVkIiBvciAiSGFybWVkIgoJCWlmIGlzX2ZhdGFsIGFuZCBldmVudC53ZWFwb24gPT0gImhlZ3JlbmFkZSIgdGhlbiAgcmVzdWx0ID0gIkV4cGxvZGVkIgoJCWVsc2VpZiBpc19mYXRhbCBhbmQgZXZlbnQud2VhcG9uID09ICJrbmlmZSIgdGhlbiAgcmVzdWx0ID0gIlN0YWJiZWQiCgkJZWxzZWlmIGV2ZW50LndlYXBvbiA9PSAiaW5mZXJubyIgdGhlbiAgcmVzdWx0ID0gIkJ1cm50IiAgZW5kCgoJCWxvY2FsIG1haW4gPSB7CgkJCXtyZXN1bHQsICIgIn0sCgkJCXt0cnVlLCB7bmFtZX19LAoJCQl7ZmFsc2UsIHtuYW1lfX0sCgkJCW5vdCBpc19mYXRhbCBhbmQgeyIgZm9yICIsIHtldmVudC5kbWdfaGVhbHRoLCAiIGhwIn19IG9yIG5pbCwKCQkJaXNfZmF0YWwgYW5kIHJlc3VsdCA9PSAiQnVybnQiIGFuZCB7IiB0byAiLCB7ImRlYXRoIn19IG9yIG5pbCwKCQkJKHJlc3VsdCA9PSAiS2lsbGVkIiBvciByZXN1bHQgPT0gIkhhcm1lZCIpIGFuZCB7dHJ1ZSwgIiB3aXRoICIsIHt3ZWFwb259fSBvciBuaWwKCQl9CgoJCWxvZ2dlci5pbnZlbnQoImhpdCIsIG1haW4pCgllbmQsCglkYW1hZ2UgPSBmdW5jdGlvbiAoZXZlbnQpCgkJbG9jYWwgdGFyZ2V0LCBhdHRhY2tlciA9IGNsaWVudC51c2VyaWRfdG9fZW50aW5kZXgoZXZlbnQudXNlcmlkKSwgZXZlbnQuYXR0YWNrZXIgfj0gMCBhbmQgY2xpZW50LnVzZXJpZF90b19lbnRpbmRleChldmVudC5hdHRhY2tlcikgb3IgMAoKCQlpZiB0YXJnZXQgPT0gbXkuZW50aXR5IGFuZCB2YXJzLm1pc2MubG9ncy5ldmVudHM6Z2V0KCJHZXR0aW5nIGhhcm1lZCIpIHRoZW4KCQkJbG9nZ2VyLmV2ZW50cy5yZWNlaXZlKGV2ZW50LCB0YXJnZXQsIGF0dGFja2VyKQoJCWVsc2VpZiBhdHRhY2tlciA9PSBteS5lbnRpdHkgYW5kIHRhcmdldCB+PSBteS5lbnRpdHkgYW5kIHZhcnMubWlzYy5sb2dzLmV2ZW50czpnZXQoIkhhcm1pbmcgZW5lbWllcyIpIHRoZW4KCQkJbG9nZ2VyLmV2ZW50cy5oYXJtKGV2ZW50LCB0YXJnZXQsIGF0dGFja2VyKQoJCWVuZAoJZW5kLAoKCS0tCgltaXNzID0gZnVuY3Rpb24gKHNob3QpCgkJaWYgbm90IHZhcnMubWlzYy5sb2dzLmV2ZW50czpnZXQoIlJhZ2Vib3Qgc2hvdHMiKSB0aGVuIHJldHVybiBlbmQKCQlsb2NhbCBwcmUgPSBsb2dnZXIuc3RhY2tbc2hvdC5pZF0gb3Ige30KCQktLQoKCQlsb2NhbCByZXN1bHQgPSAiTWlzc2VkIgoJCWxvY2FsIHRhcmdldCA9IGVudGl0eS5nZXRfcGxheWVyX25hbWUoc2hvdC50YXJnZXQpCgoJCWxvY2FsIHJlYXNvbiA9IHNob3QucmVhc29uCgkJaWYgcmVhc29uID09ICJwcmVkaWN0aW9uIGVycm9yIiBhbmQgcHJlLmRpZmZlcmVuY2UgYW5kIHByZS5kaWZmZXJlbmNlID4gMiB0aGVuCgkJCXJlYXNvbiA9ICJ1bnByZWRpY3RlZCBvY2Nhc2lvbiIKCQllbmQKCgkJbG9jYWwgaGl0Z3JvdXAgPSBlbnVtcy5oaXRncm91cHNbc2hvdC5oaXRncm91cCArIDFdCgoJCS0tCgkJbG9jYWwgbWFpbiwgYWRkID0gewoJCQl7cmVzdWx0LCAiICJ9LAoJCQl7dHJ1ZSwge3RhcmdldH19LAoJCQl7ZmFsc2UsIHt0YXJnZXR9fSwKCQkJaGl0Z3JvdXAgYW5kIHsiJ3MgIiwge2hpdGdyb3VwfX0sCgkJCXJlYXNvbiB+PSAiPyIgYW5kIHsiIGR1ZSB0byAiLCB7cmVhc29ufX0gb3IgbmlsCgkJfSwgewoJCQlwcmUuZGFtYWdlIGFuZCB7ImRtZzogIiwge3ByZS5kYW1hZ2V9fSwKCQkJeyJoYzogIiwge21hdGgucm91bmQoc2hvdC5oaXRfY2hhbmNlKSwgIiUlIn0sIChyZWZzLnJhZ2UuYWltYm90LmhpdF9jaGFuY2UudmFsdWUgLSBzaG90LmhpdF9jaGFuY2UgPiAzKSBhbmQgIuKunyIgb3IgIiJ9IG9yIG5pbCwKCQkJcHJlLmRpZmZlcmVuY2UgYW5kIHByZS5kaWZmZXJlbmNlIH49IDAgYW5kIHsizpQ6ICIsIHtwcmUuZGlmZmVyZW5jZSwgInQifSwgcHJlLmRpZmZlcmVuY2UgPCAwIGFuZCAi4q6fIiBvciAiIn0gb3IgbmlsLAoJCQlwcmUudGVsZXBvcnQgYW5kIHsgeyJMQyJ9IH0gb3IgbmlsLAoJCQkocHJlLmludGVycG9sYXRlZCBvciBwcmUuZXh0cmFwb2xhdGVkKSBhbmQgeyB7cHJlLmludGVycG9sYXRlZCBhbmQgIklOIiBvciAiIiwgcHJlLmV4dHJhcG9sYXRlZCBhbmQgIkVQIiBvciAiIn0gfSBvciBuaWwsCgkJfQoKCQlsb2dnZXIuaW52ZW50KCJtaXNzIiwgbWFpbiwgYWRkKQoJCWxvZ2dlci5zdGFja1tzaG90LmlkXSA9IG5pbAoJZW5kLAoJaGl0ID0gZnVuY3Rpb24gKHNob3QpCgkJaWYgbm90IHZhcnMubWlzYy5sb2dzLmV2ZW50czpnZXQoIlJhZ2Vib3Qgc2hvdHMiKSB0aGVuIHJldHVybiBlbmQKCQlsb2NhbCBwcmUgPSBsb2dnZXIuc3RhY2tbc2hvdC5pZF0gb3Ige30KCQktLQoKCQlsb2NhbCByZXN1bHQgPSAiSGl0IgoJCWlmIG5vdCBlbnRpdHkuaXNfYWxpdmUoc2hvdC50YXJnZXQpIHRoZW4KCQkJcmVzdWx0ID0gIktpbGxlZCIKCQllbmQKCgkJbG9jYWwgdGFyZ2V0ID0gZW50aXR5LmdldF9wbGF5ZXJfbmFtZShzaG90LnRhcmdldCkKCQlsb2NhbCBoaXRncm91cCwgZXhwX2hpdGdyb3VwID0gZW51bXMuaGl0Z3JvdXBzW3Nob3QuaGl0Z3JvdXAgKyAxXSwgZW51bXMuaGl0Z3JvdXBzWyhwcmUuaGl0Z3JvdXAgb3IgMCkgKyAxXQoKCQlsb2NhbCBkbWdfbWlzbWF0Y2gsIGhnX21pc21hdGNoID0gcmVzdWx0ID09ICJIaXQiIGFuZCBzaG90LmhpdGdyb3VwIH49IHByZS5oaXRncm91cCwgcmVzdWx0ID09ICJIaXQiIGFuZCAocHJlLmRhbWFnZSBvciAwKSAtIChzaG90LmRhbWFnZSBvciAwKSA+IDEwCgkJLS0gZG1nX21pc21hdGNoLCBoZ19taXNtYXRjaCA9IHRydWUsIHRydWUKCgkJbG9jYWwgZXhwZWN0ZWQgaWYgZG1nX21pc21hdGNoIGFuZCBoZ19taXNtYXRjaCBhbmQgZXhwX2hpdGdyb3VwIHRoZW4KCQkJZXhwZWN0ZWQgPSB7ZXhwX2hpdGdyb3VwLCAiLSIsIHByZS5kYW1hZ2V9CgkJZWxzZWlmIGRtZ19taXNtYXRjaCB0aGVuIGV4cGVjdGVkID0ge3ByZS5kYW1hZ2UsICIgaHAifSBlbmQKCgkJLS0KCQlsb2NhbCBtYWluLCBhZGQgPSB7CgkJCXtyZXN1bHQsICIgIiwge3RhcmdldH19LAoJCQkoaGl0Z3JvdXAgYW5kIGhpdGdyb3VwIH49ICJnZW5lcmljIikgYW5kIHsgcmVzdWx0ID09ICJIaXQiIGFuZCAiJ3MgIiBvciAiIGluICIsIHtoaXRncm91cH0sIGhnX21pc21hdGNoIGFuZCAiXGFENTlBNEQhXHIiIG9yICIiIH0gb3IgbmlsLAoJCQlyZXN1bHQgPT0gIkhpdCIgYW5kIHsiIGZvciAiLCB7c2hvdC5kYW1hZ2UsICIgaHAifSwgZG1nX21pc21hdGNoIGFuZCAiXGFENTlBNEQhXHIiIG9yICIiIH0gb3IgbmlsCgkJfSwgewoJCQlleHBlY3RlZCBhbmQgeyJleHA6ICIsIGV4cGVjdGVkfSwKCQkJcHJlLmRpZmZlcmVuY2Ugfj0gMCBhbmQgeyLOlDogIiwge3ByZS5kaWZmZXJlbmNlLCAidCJ9fSBvciBuaWwsCgkJCShyZWZzLnJhZ2UuYWltYm90LmhpdF9jaGFuY2UudmFsdWUgLSBzaG90LmhpdF9jaGFuY2UgPiA1KSBhbmQgeyJoYzogIiwge21hdGguZmxvb3Ioc2hvdC5oaXRfY2hhbmNlKSwgIiUlIn0sICLirp8ifSBvciBuaWwsCgkJfQoKCQktLQoJCWxvZ2dlci5pbnZlbnQoImhpdCIsIG1haW4sIGFkZCkKCQlsb2dnZXIuc3RhY2tbc2hvdC5pZF0gPSBuaWwKCWVuZCwKCWFpbSA9IGZ1bmN0aW9uIChzaG90KQoJCWlmIG5vdCB2YXJzLm1pc2MubG9ncy5ldmVudHM6Z2V0KCJSYWdlYm90IHNob3RzIikgdGhlbiByZXR1cm4gZW5kCgoJCXNob3QuZGlmZmVyZW5jZSA9IGdsb2JhbHMudGlja2NvdW50KCkgLSBzaG90LnRpY2sKCQlsb2dnZXIuc3RhY2tbc2hvdC5pZF0gPSBzaG90CgllbmQsCn0KCi0tI2VuZHJlZ2lvbgoKLS0jcmVnaW9uOiBtYWluCgpsb2dnZXIuaW52ZW50ID0gZnVuY3Rpb24gKGV2ZW50LCBtYWluLCBhZGQpCglsb2NhbCBsb2cgPSB7IGNvbnNvbGUgPSB7fSwgc2NyZWVuID0ge30sIGNoYXQgPSB7fSB9CgoJaWYgZXZlbnQgdGhlbgoJCWxvY2FsIGxjLCBscyA9IDAsIDAKCQlsb2NhbCBjb2wgPSBsb2dnZXIuY29sb3JzW2V2ZW50XQoJCWxvZy5jb25zb2xlW2xjKzFdLCBsb2cuY29uc29sZVtsYysyXSA9IGNvbCBhbmQgY29sWzFdIG9yICIiLCAi4oCiXHIgIgoJCWxvZy5zY3JlZW5bbHMrMV0sIGxvZy5zY3JlZW5bbHMrMl0gPSBjb2wgYW5kIGNvbFsyXSBvciAiIiwgIuKAolxhRTZFNkU2XHgwMiAiCgllbmQKCglmb3IgaSA9IDEsIHRhYmxlLm1heG4obWFpbikgZG8KCQlsb2NhbCBpdGVtID0gbWFpbltpXQoJCWlmIG5vdCBpdGVtIHRoZW4gZ290byBjb250aW51ZSBlbmQKCgkJaWYgdHlwZShpdGVtKSA9PSAidGFibGUiIHRoZW4KCQkJbG9jYWwgZXhjbHVkZSA9IChtYWluW2ldWzFdID09IHRydWUgYW5kIDEpIG9yIChtYWluW2ldWzFdID09IGZhbHNlIGFuZCAyKSBvciAwOwoJCQlmb3IgaiwgdiBpbiBpcGFpcnMoaXRlbSkgZG8KCQkJCWxvY2FsIGtpbmQgPSB0eXBlKHYpCgoJCQkJaWYgbm90ICgga2luZCA9PSAiYm9vbGVhbiIgYW5kIGogPT0gMSApIHRoZW4KCQkJCQlpZiBleGNsdWRlIH49IDIgdGhlbgoJCQkJCQlpZiBraW5kID09ICJ0YWJsZSIgdGhlbgoJCQkJCQkJdGFibGUubW92ZSh2LCAxLCAjdiwgI2xvZy5jb25zb2xlICsgMSwgbG9nLmNvbnNvbGUpCgkJCQkJCQl0YWJsZS5tb3ZlKHYsIDEsICN2LCAjbG9nLmNoYXQgKyAxLCBsb2cuY2hhdCkKCQkJCQkJZWxzZQoJCQkJCQkJbG9jYWwgbGMsIGxoID0gI2xvZy5jb25zb2xlLCAjbG9nLmNoYXQKCQkJCQkJCWxvZy5jb25zb2xlW2xjKzFdLCBsb2cuY29uc29sZVtsYysyXSwgbG9nLmNvbnNvbGVbbGMrM10gPSAiXGE5MDkwOTAiLCBraW5kID09ICJzdHJpbmciIGFuZCB2IG9yIHRvc3RyaW5nKHYpLCAiXHIiCgkJCQkJCQlsb2cuY2hhdFtsaCsxXSwgbG9nLmNoYXRbbGgrMl0sIGxvZy5jaGF0W2xoKzNdID0gIlx4MDgiLCBraW5kID09ICJzdHJpbmciIGFuZCBzdHJpbmcuZ3N1Yih2LCAiXGEleCV4JXgleCV4JXgiLCAiIikgb3IgdG9zdHJpbmcodiksICJceDAxIgoJCQkJCQllbmQKCQkJCQllbmQKCQkJCQlpZiBleGNsdWRlIH49IDEgdGhlbgoJCQkJCQlpZiBraW5kID09ICJ0YWJsZSIgdGhlbgoJCQkJCQkJbG9jYWwgbHMgPSAjbG9nLnNjcmVlbgoJCQkJCQkJZm9yIGlpID0gMSwgI3YsIDMgZG8KCQkJCQkJCQlsb2cuc2NyZWVuW2xzK2lpXSwgbG9nLnNjcmVlbltscytpaSsxXSwgbG9nLnNjcmVlbltscytpaSsyXSA9ICJcYUU2RTZFNlx4MDEiLCB2W2lpXSwgIlxhRTZFNkU2XHgwMiIKCQkJCQkJCWVuZAoJCQkJCQllbHNlCgkJCQkJCQlsb2NhbCBscyA9ICNsb2cuc2NyZWVuCgkJCQkJCQlsb2cuc2NyZWVuW2xzKzFdLCBsb2cuc2NyZWVuW2xzKzJdID0ga2luZCA9PSAic3RyaW5nIiBhbmQgc3RyaW5nLmdzdWIodiwgIlxhJXgleCV4JXgleCV4IiwgZnVuY3Rpb24gKHJhdykKCQkJCQkJCQlyZXR1cm4gcmF3IC4uICJceDAxIgoJCQkJCQkJZW5kKSBvciB0b3N0cmluZyh2KSwgIlxhRTZFNkU2XHgwMiIKCQkJCQkJZW5kCgkJCQkJZW5kCgkJCQllbmQKCQkJZW5kCgkJZWxzZQoJCQlsb2NhbCBsYyA9ICNsb2cuY29uc29sZQoJCQlsb2cuY29uc29sZVtsYysxXSwgbG9nLmNvbnNvbGVbbGMrMl0sIGxvZy5jb25zb2xlW2xjKzNdID0gIlxhODA4MDgwIiwgdG9zdHJpbmcoaXRlbSksICJcciIKCgkJCWxvZy5zY3JlZW5bI2xvZy5zY3JlZW4rMV0gPSB0eXBlKGl0ZW0pID09ICJzdHJpbmciIGFuZCBzdHJpbmcuZ3N1YihpdGVtLCAiXGEleCV4JXgleCV4JXgiLCBmdW5jdGlvbiAocmF3KQoJCQkJcmV0dXJuIHJhdyAuLiAiXHgwMiIKCQkJZW5kKSBvciB0b3N0cmluZyhpdGVtKQoJCWVuZAoKCQk6OmNvbnRpbnVlOjoKCWVuZAoKCWFkZCA9IHR5cGUoYWRkKSA9PSAidGFibGUiIGFuZCB0YWJsZS5maWx0ZXIoYWRkKSBvciBuaWwKCWlmIGFkZCBhbmQgI2FkZCA+IDAgdGhlbgoJCWxvZy5jb25zb2xlWyNsb2cuY29uc29sZSsxXSA9ICIgIFx2flxyICAiCgoJCWZvciBpID0gMSwgI2FkZCBkbwoJCQlpZiB0eXBlKGFkZFtpXSkgPT0gInRhYmxlIiB0aGVuCgkJCQlmb3IgXywgdiBpbiBpcGFpcnMoYWRkW2ldKSBkbwoJCQkJCWxvY2FsIGtpbmQgPSB0eXBlKHYpCgkJCQkJaWYga2luZCA9PSAidGFibGUiIHRoZW4KCQkJCQkJbG9nLmNvbnNvbGVbI2xvZy5jb25zb2xlKzFdID0gIlxhQUFBQUFBIgoJCQkJCQl0YWJsZS5tb3ZlKHYsIDEsICN2LCAjbG9nLmNvbnNvbGUgKyAxLCBsb2cuY29uc29sZSkKCQkJCQllbHNlCgkJCQkJCWxvY2FsIGwgPSAjbG9nLmNvbnNvbGUKCQkJCQkJbG9nLmNvbnNvbGVbbCsxXSwgbG9nLmNvbnNvbGVbbCsyXSA9ICJcYTcwNzA3MCIsIGtpbmQgPT0gInN0cmluZyIgYW5kIHYgb3IgdG9zdHJpbmcodikKCQkJCQllbmQKCQkJCQlsb2cuY29uc29sZVsjbG9nLmNvbnNvbGUrMV0gPSAiXHIiCgkJCQllbmQKCQkJZWxzZQoJCQkJbG9jYWwgbGMgPSAjbG9nLmNvbnNvbGUKCQkJCWxvZy5jb25zb2xlW2xjKzFdLCBsb2cuY29uc29sZVtsYysyXSwgbG9nLmNvbnNvbGVbbGMrM10gPSAiXGE3MDcwNzAiLCB0b3N0cmluZyhtYWluW2ldKSwgIlxyIgoJCQllbmQKCQkJaWYgaSA8ICNhZGQgdGhlbiAgbG9nLmNvbnNvbGVbI2xvZy5jb25zb2xlKzFdID0gIlxhNzA3MDcwLCBcciIgIGVuZAoJCWVuZAoJZW5kCgoJbG9nZ2VyLnB1c2goZXZlbnQsIHRhYmxlLmNvbmNhdChsb2cuY29uc29sZSksIHRhYmxlLmNvbmNhdChsb2cuc2NyZWVuKSwgdGFibGUuY29uY2F0KGxvZy5jaGF0KSkKZW5kCgpsb2dnZXIucHVzaCA9IGZ1bmN0aW9uIChldmVudCwgY29uc29sZSwgc2NyZWVuLCBjaGF0KQoJaWYgY29uc29sZSBhbmQgdmFycy5taXNjLmxvZ3Mub3V0cHV0OmdldCgiQ29uc29sZSIpIHRoZW4KCQloeXN0ZXJpYS5wcmludChjb25zb2xlKQoJZW5kCglpZiBzY3JlZW4gYW5kIHZhcnMubWlzYy5sb2dzLm91dHB1dDpnZXQoIlNjcmVlbiIpIHRoZW4KCQl0YWJsZS5pbnNlcnQobG9nZ2VyLmxpc3QsIDEsIHsKCQkJZXZlbnQgPSBldmVudCwgdGV4dCA9IHNjcmVlbiwKCQkJdGltZSA9IGdsb2JhbHMucmVhbHRpbWUoKSwgcHJvZ3Jlc3MgPSB7MH0sCgkJfSkKCWVuZAplbmQKCmxvZ2dlci5jbGVhcl9zdGFjayA9IGZ1bmN0aW9uICgpIGxvZ2dlci5zdGFjayA9IHt9IGVuZAoKbG9nZ2VyLnJ1biA9IGZ1bmN0aW9uIChzZWxmKQoJdmFycy5taXNjLmxvZ3Mub246c2V0X2NhbGxiYWNrKGZ1bmN0aW9uICh0aGlzKQoJCWNhbGxiYWNrcy5haW1fZmlyZSh0aGlzLnZhbHVlLCBzZWxmLmV2ZW50cy5haW0pCgkJY2FsbGJhY2tzLmFpbV9oaXQodGhpcy52YWx1ZSwgc2VsZi5ldmVudHMuaGl0KQoJCWNhbGxiYWNrcy5haW1fbWlzcyh0aGlzLnZhbHVlLCBzZWxmLmV2ZW50cy5taXNzKQoJCWNhbGxiYWNrcy5wbGF5ZXJfaHVydCh0aGlzLnZhbHVlLCBzZWxmLmV2ZW50cy5kYW1hZ2UpCgkJY2FsbGJhY2tzLm1lX3NwYXduZWQodGhpcy52YWx1ZSwgc2VsZi5jbGVhcl9zdGFjaykKCQljYWxsYmFja3NbImh5c3RlcmlhOjplbmVteV9zaG90Il0odGhpcy52YWx1ZSwgc2VsZi5ldmVudHMuZXZhZGUpCgoJCWxvY2FsIHN3aXRjaCA9IHRlcm5hcnkodGhpcy52YWx1ZSwgZmFsc2UsIG5pbCkKCQlyZWZzLnJhZ2Uub3RoZXIubG9nX21pc3NlczpvdmVycmlkZShzd2l0Y2gpCgkJcmVmcy5taXNjLmxvZ19kYW1hZ2U6b3ZlcnJpZGUoc3dpdGNoKQoJZW5kLCB0cnVlKQoKCXJlZnMucmFnZS5vdGhlci5sb2dfbWlzc2VzOmRlcGVuZCh0cnVlLCB7dmFycy5taXNjLmxvZ3Mub24sIGZhbHNlfSkKCXJlZnMubWlzYy5sb2dfZGFtYWdlOmRlcGVuZCh0cnVlLCB7dmFycy5taXNjLmxvZ3Mub24sIGZhbHNlfSkKZW5kCgotLQoKbG9nZ2VyOnJ1bigpCgotLSNlbmRyZWdpb24KCi0tICNlbmRyZWdpb24KCi0tICNyZWdpb24gLSBTdGF0aXN0aWNzCgpsb2NhbCBjYW5kaWVzID0gZGF0YWJhc2UucmVhZCgiaHlzdGVyaWE6OmNhbmRpZXMiKSBvciAwCgpkbwoJY2FsbGJhY2tzLnBsYXllcl9kZWF0aDpzZXQoZnVuY3Rpb24gKGV2ZW50KQoJCWxvY2FsIHRhcmdldCA9IGNsaWVudC51c2VyaWRfdG9fZW50aW5kZXgoZXZlbnQudXNlcmlkKQoJCWxvY2FsIGF0dGFja2VyID0gY2xpZW50LnVzZXJpZF90b19lbnRpbmRleChldmVudC5hdHRhY2tlcikKCQlpZiBlbnRpdHkuZ2V0X3Byb3AoZW50aXR5LmdldF9wbGF5ZXJfcmVzb3VyY2UoKSwgIm1faVBpbmciLCB0YXJnZXQpID09IDAgYW5kIG5vdCBfREVCVUcgdGhlbiByZXR1cm4gZW5kCgoJCWlmIHRhcmdldCA9PSBteS5lbnRpdHkgdGhlbgoJCQlyZXR1cm4KCQllbmQKCQlpZiB0YXJnZXQgfj0gbXkuZW50aXR5IGFuZCBhdHRhY2tlciA9PSBteS5lbnRpdHkgdGhlbgoJCQlkYi5zdGF0cy5raWxsZWQgPSBkYi5zdGF0cy5raWxsZWQgKyAxCgkJCW1lbnUuc3RhdHMua2lsbGVkOnNldCgiXGY8c2lsZW50PkVuZW1pZXMgZWxpbWluYXRlZFx0XHYiIC4uIGRiLnN0YXRzLmtpbGxlZCkKCQllbmQKCWVuZCkKCgljYWxsYmFja3NbImh5c3RlcmlhOjplbmVteV9zaG90Il06c2V0KGZ1bmN0aW9uIChldmVudCkKCQlpZiBlbnRpdHkuZ2V0X3Byb3AoZW50aXR5LmdldF9wbGF5ZXJfcmVzb3VyY2UoKSwgIm1faVBpbmciLCBldmVudC5hdHRhY2tlcikgPT0gMCB0aGVuIHJldHVybiBlbmQKCgkJaWYgZXZlbnQuZGFtYWdlZCB0aGVuIHJldHVybiBlbmQKCQlkYi5zdGF0cy5ldmFkZWQgPSBkYi5zdGF0cy5ldmFkZWQgKyAxCgkJbWVudS5zdGF0cy5ldmFkZWQ6c2V0KCJcZjxzaWxlbnQ+RXZhZGVkIHNob3RzXHRcdiIgLi4gZGIuc3RhdHMuZXZhZGVkKQoJZW5kKQoKCWxvY2FsIHRpbWUgPSBzdHJpbmcuZm9ybWF0KCIlZDolMDJkIiwgbWF0aC5mbG9vcihkYi5zdGF0cy5wbGF5dGltZSksIG1hdGguZmxvb3IoZGIuc3RhdHMucGxheXRpbWUgJSAxICogNjApKQoJbWVudS5zdGF0cy5wbGF5dGltZTpzZXQoIlxmPHNpbGVudD5Ib3VycyBwbGF5ZWRcdFx2IiAuLiB0aW1lKQoJY2FsbGJhY2tzWyJoeXN0ZXJpYTo6ZGF0YWJhc2Vfd3JpdGUiXTpzZXQoZnVuY3Rpb24gKGV2ZW50KQoJCWRiLnN0YXRzLnBsYXl0aW1lID0gZGIuc3RhdHMucGxheXRpbWUgKyAwLjA4CgkJdGltZSA9IHN0cmluZy5mb3JtYXQoIiVkOiUwMmQiLCBtYXRoLmZsb29yKGRiLnN0YXRzLnBsYXl0aW1lKSwgbWF0aC5mbG9vcihkYi5zdGF0cy5wbGF5dGltZSAlIDEgKiA2MCkpCgkJbWVudS5zdGF0cy5wbGF5dGltZTpzZXQoIlxmPHNpbGVudD5Ib3VycyBwbGF5ZWRcdFx2IiAuLiB0aW1lKQoJZW5kKQplbmQKCi0tICNlbmRyZWdpb24KCi0tICNyZWdpb24gLSBEaXNjb3JkCgpkbwoJbG9jYWwgdXNlciwgY2hlYXQgPSBoeXN0ZXJpYS51c2VyLm5hbWUsIF9CTElTUyBhbmQgImdhbWVzZW5zZS1ibGlzcyIgb3IgImdhbWVzZW5zZSIKCglsb2NhbCBoYXNoID0gZnVuY3Rpb24gKHN0cikKCQlsb2NhbCBoZXggPSB7fQoJCWxvY2FsIGJ5dGVzID0geyBzdHJpbmcuYnl0ZShzdHIsIDEsICNzdHIpIH0KCgkJZm9yIGksIHYgaW4gaXBhaXJzKGJ5dGVzKSBkbwoJCQloZXhbaV0gPSBzdHJpbmcuZm9ybWF0KCIleCIsIHYpCgkJZW5kCgoJCWxvY2FsIGhhc2hlZCA9IHN0cmluZy5nc3ViKHRhYmxlLmNvbmNhdChoZXgpLCAiWzY0XSIsIHsKCQkJWyI2Il0gPSAiYTciLCBbIjQiXSA9ICI5ciIsCgkJfSkKCgkJd2hpbGUgMTYgPiAjaGFzaGVkIGRvIGhhc2hlZCA9IGhhc2hlZCAuLiBoYXNoZWQgZW5kCgoJCXJldHVybiBzdHJpbmcuc3ViKGhhc2hlZCwgMSwgMTYpCgllbmQKCgl1aS5zZXRfY2FsbGJhY2sobWVudS5nZW5lcmFsLnZlcmlmeS5hdXRoLnJlZiwgZnVuY3Rpb24gKCkKCQltZW51LmdlbmVyYWwudmVyaWZ5LmF1dGg6c2V0X2VuYWJsZWQoZmFsc2UpCgoJCWxvY2FsIHNpZ25hdHVyZSA9IGhhc2godXNlciAuLiBjaGVhdCkKCQlodHRwLmdldCgiaHR0cHM6Ly9iYWNrZW5kLmh5c3RlcmlhLm9uZS9rZXlnZW4iLCB7CgkJCWhlYWRlcnMgPSB7CgkJCQlbImhzdC11bmFtZSJdID0gdXNlciwKCQkJCVsiaHN0LWNoZWF0Il0gPSBjaGVhdCwKCQkJCVsiVXNlckFnZW50Il0gPSAibHRjcF9kZWJ1ZyIgLi4gIi4uIiAuLiAifCIgLi4gIi4uIiAuLiBzaWduYXR1cmUsCgkJCX0KCQl9LCBmdW5jdGlvbiAocywgcmVzcG9uc2UpCgkJCWlmIG5vdCBzIHRoZW4gaHlzdGVyaWEucHJpbnQoIlNvbWV0aGluZyB3ZW50IHdyb25nLiBUcnkgYWdhaW4gbGF0ZXIuIikgcmV0dXJuIGVuZAoKCQkJbG9jYWwgcywgciA9IHBjYWxsKGpzb24ucGFyc2UsIHJlc3BvbnNlLmJvZHkpCgkJCWlmIG5vdCBzIHRoZW4gaHlzdGVyaWEucHJpbnQoIlNvbWV0aGluZyB3ZW50IHdyb25nLiBUcnkgYWdhaW4gbGF0ZXIuIikgcmV0dXJuIGVuZAoKCQkJaWYgci5pc19jb25uZWN0ZWQgPT0gInllcyIgdGhlbgoJCQkJY2xpcGJvYXJkLnNldCgiWW91IGhhdmUgYWxyZWFkeSBsaW5rZWQgeW91ciBkaXNjb3JkIikKCQkJCWh5c3RlcmlhLnByaW50KCJZb3UgaGF2ZSBhbHJlYWR5IGxpbmtlZCB5b3VyIGRpc2NvcmQiKQoJCQllbHNlCgkJCQljbGlwYm9hcmQuc2V0KHIuc3RhdHVzKQoJCQllbmQKCQllbmQpCgllbmQpCmVuZAoKLS0gI2VuZHJlZ2lvbgoKLS0gI2VuZHJlZ2lvbgotLQoKLS0KLS0gI3JlZ2lvbiA6IFJhZ2UKCnJhZ2UudGVsZXBvcnQgPSB7CglhY3RpdmUgPSBmYWxzZSwKCWxhdGVzdCA9IDAsCgl3b3JrID0gYShmdW5jdGlvbiAoY21kLCBjdHgpCgkJcmFnZS50ZWxlcG9ydC5hY3RpdmUgPSB2YXJzLnJhZ2UudGVsZXBvcnQub24uaG90a2V5OmdldCgpCgkJaWYgbm90IHJhZ2UudGVsZXBvcnQuYWN0aXZlIHRoZW4gcmV0dXJuIGVuZAoKCQlsb2NhbCBzaG91bGQgPSBmYWxzZQoJCWxvY2FsIHNlbGYsIHNldHRpbmdzID0gcmFnZS50ZWxlcG9ydCwgdmFycy5yYWdlLnRlbGVwb3J0CgoJCWxvY2FsIGNoYXJnZSA9IHJlZnMubWlzYy5zZXR0aW5ncy5tYXhzaGlmdC52YWx1ZSAtIHJlZnMucmFnZS5haW1ib3QuZHRfZmxbMV0udmFsdWUgKyAxCgoJCXNlbGYuYWN0aXZlID0gc2VsZi5hY3RpdmUgYW5kIG5vdCAoY2hhcmdlIDwgOCBvciBzZWxmLmxhdGVzdCA9PSBjbWQuY29tbWFuZF9udW1iZXIgb3IgbXkudmVsb2NpdHkgPCAxMDAgb3Igbm90IG15Lmp1bXBpbmcpCgkJaWYgbm90IHNlbGYuYWN0aXZlIHRoZW4gcmV0dXJuIGVuZAoKCQktLQoJCWxvY2FsIHdlYXBvbl9pZHggPSBlbnRpdHkuZ2V0X3BsYXllcl93ZWFwb24obXkuZW50aXR5KQoJCWlmIG5vdCB3ZWFwb25faWR4IHRoZW4gcmV0dXJuIGVuZAoKCQlsb2NhbCB3ZWFwb25fdCA9IHdlYXBvbmRhdGEod2VhcG9uX2lkeCkKCQlsb2NhbCB3ZWFwb25fdHlwZSA9IHdlYXBvbl90LndlYXBvbl90eXBlX2ludAoKCQlzZWxmLmFjdGl2ZSA9IHNlbGYuYWN0aXZlIGFuZCBub3QgKHdlYXBvbl90LmlzX2Z1bGxfYXV0byBvciAod2VhcG9uX3R5cGUgPT0gOSBvciB3ZWFwb25fdHlwZSA9PSAwKSBvciAobm90IHNldHRpbmdzLnBpc3RvbC52YWx1ZSBhbmQgd2VhcG9uX3R5cGUgPT0gMSkpCgkJaWYgbm90IHNlbGYuYWN0aXZlIHRoZW4gcmV0dXJuIGVuZAoKCQlsb2NhbCBtaW5fZGFtYWdlID0gKHJlZnMucmFnZS5haW1ib3QuZGFtYWdlX292clsxXS52YWx1ZSBhbmQgcmVmcy5yYWdlLmFpbWJvdC5kYW1hZ2Vfb3ZyWzFdOmdldF9ob3RrZXkoKSkgYW5kIHJlZnMucmFnZS5haW1ib3QuZGFtYWdlX292clsyXS52YWx1ZSBvciByZWZzLnJhZ2UuYWltYm90LmRhbWFnZS52YWx1ZQoKCQktLQoJCWxvY2FsIHZlbG9jaXR5ID0gdmVjdG9yKCBlbnRpdHkuZ2V0X3Byb3AobXkuZW50aXR5LCAibV92ZWNWZWxvY2l0eSIpICkKCgkJbG9jYWwgb3JpZ2luID0gdmVjdG9yKGVudGl0eS5nZXRfcHJvcChteS5lbnRpdHksICJtX3ZlY09yaWdpbiIpKQoJCWxvY2FsIGV5ZSA9IHZlY3RvcihjbGllbnQuZXllX3Bvc2l0aW9uKCkpCgkJbG9jYWwgcGV5ZSA9IHZlY3RvcihjbGllbnQuZXh0cmFwb2xhdGUoZXllLngsIGV5ZS55LCBleWUueiwgdmVsb2NpdHksIGNoYXJnZSkpCgoJCWxvY2FsIGxmcmFjdGlvbiA9IGNsaWVudC50cmFjZV9saW5lKG15LmVudGl0eSwgZXllLngsIGV5ZS55LCBleWUueiwgcGV5ZS54LCBwZXllLnksIHBleWUueikKCQlwZXllLnggPSBtYXRoLmxlcnAoZXllLngsIHBleWUueCwgbGZyYWN0aW9uKQoJCXBleWUueSA9IG1hdGgubGVycChleWUueSwgcGV5ZS55LCBsZnJhY3Rpb24pCgkJcGV5ZS56ID0gbWF0aC5sZXJwKGV5ZS56LCBwZXllLnosIGxmcmFjdGlvbikKCgkJLS0KCQlsb2NhbCB0YXJnZXQgPSBjbGllbnQuY3VycmVudF90aHJlYXQoKQoKCQlmb3IgaSwgZW5lbXkgaW4gaXBhaXJzKHBsYXllcnMpIGRvCgkJCWlmIG5vdCBlbmVteSBvciBub3QgZW50aXR5LmlzX2VuZW15KGVuZW15KSBvciBub3QgZW50aXR5LmlzX2FsaXZlKGVuZW15KSB0aGVuIGdvdG8gbmV4dCBlbmQKCgkJCWxvY2FsIGRpc3RhbmNlID0gb3JpZ2luOmRpc3QodmVjdG9yKGVudGl0eS5nZXRfcHJvcChlbmVteSwgIm1fdmVjT3JpZ2luIikpKQoKCQkJaWYgZGlzdGFuY2UgPCA0MDAgb3IgZW5lbXkgPT0gdGFyZ2V0IHRoZW4KCQkJCWxvY2FsIGhlYWQgPSB2ZWN0b3IoZW50aXR5LmhpdGJveF9wb3NpdGlvbihlbmVteSwgMCkpCgoJCQkJaWYgY2xpZW50LnZpc2libGUoaGVhZC54LCBoZWFkLnksIGhlYWQueikgdGhlbiBzaG91bGQgPSB0cnVlIGJyZWFrIGVuZAoKCQkJCWxvY2FsIHByZWRpY3RlZCA9IHsgY2xpZW50LnRyYWNlX2J1bGxldChteS5lbnRpdHksIHBleWUueCwgcGV5ZS55LCBwZXllLnosIGhlYWQueCwgaGVhZC55LCBoZWFkLnopIH0KCQkJCWxvY2FsIGRhbWFnZSA9IHByZWRpY3RlZFsyXSBvciAwCgoJCQkJbG9jYWwgcmVxdWlyZWQgPSBtYXRoLm1pbihtaW5fZGFtYWdlLCBlbnRpdHkuZ2V0X3Byb3AoZW5lbXksICJtX2lIZWFsdGgiKSkKCQkJCWlmIHByZWRpY3RlZFsxXSBhbmQgZGFtYWdlID4gcmVxdWlyZWQgdGhlbgoJCQkJCXNob3VsZCA9IHRydWUgYnJlYWsKCQkJCWVuZAoJCQllbmQKCgkJCTo6bmV4dDo6CgkJZW5kCgoJCWlmIHNob3VsZCB0aGVuCgkJCWlmIHNldHRpbmdzLmxhbmQudmFsdWUgdGhlbgoJCQkJbG9jYWwgcmVjb3ZlcnkgPSBteS5jcm91Y2hpbmcgYW5kIHdlYXBvbl90LnJlY292ZXJ5X3RpbWVfY3JvdWNoIG9yIHdlYXBvbl90LnJlY292ZXJ5X3RpbWVfc3RhbmQKCgkJCQlsb2NhbCBwX29yaWdpbiA9IHZlY3RvciggY2xpZW50LmV4dHJhcG9sYXRlKG9yaWdpbi54LCBvcmlnaW4ueSwgb3JpZ2luLnosIHZlbG9jaXR5LCBjaGFyZ2UpICkKCQkJCXBfb3JpZ2luLnogPSBwX29yaWdpbi56IC0gcmVjb3ZlcnkKCgkJCQlsb2NhbCBmcmFjdGlvbiA9IGNsaWVudC50cmFjZV9saW5lKG15LmVudGl0eSwgb3JpZ2luLngsIG9yaWdpbi55LCBvcmlnaW4ueiwgcF9vcmlnaW4ueCwgcF9vcmlnaW4ueSwgcF9vcmlnaW4ueikKCgkJCQlsb2NhbCBsYW5kaW5nID0gZnJhY3Rpb24gPCAxCgkJCQlpZiBub3QgbGFuZGluZyB0aGVuIHJldHVybiBlbmQKCQkJZW5kCgoJCQlzZWxmLmxhdGVzdCA9IGNtZC5jb21tYW5kX251bWJlcgoJCQljbWQuZGlzY2hhcmdlX3BlbmRpbmcgPSB0cnVlCgkJZW5kCgllbmQpLAoJcnVuID0gYShmdW5jdGlvbiAoc2VsZikKCQl2YXJzLnJhZ2UudGVsZXBvcnQub246c2V0X2NhbGxiYWNrKGZ1bmN0aW9uICh0aGlzKQoJCQljYWxsYmFja3Muc2V0dXBfY29tbWFuZCh0aGlzLnZhbHVlLCBzZWxmLndvcmspCgkJZW5kLCB0cnVlKQoJZW5kKQp9CgpyYWdlLnJlc29sdmVyID0gewoJcmVjb3JkcyA9IHt9LAoJd29yayA9IGEoZnVuY3Rpb24gKCkKCQlsb2NhbCBzZWxmID0gcmFnZS5yZXNvbHZlcgoJCWNsaWVudC51cGRhdGVfcGxheWVyX2xpc3QoKQoKCQlmb3IgaSA9IDEsICNwbGF5ZXJzIGRvCgkJCWxvY2FsIHYgPSBwbGF5ZXJzW2ldCgkJCWlmIGVudGl0eS5pc19lbmVteSh2KSB0aGVuCgkJCQlsb2NhbCBzdF9jdXIsIHN0X3ByZSA9IGVudGl0eS5nZXRfc2ltdGltZSh2KQoJCQkJc3RfY3VyLCBzdF9wcmUgPSB0b3RpY2tzKHN0X2N1ciksIHRvdGlja3Moc3RfcHJlKQoKCQkJCWlmIG5vdCBzZWxmLnJlY29yZHNbdl0gdGhlbiBzZWxmLnJlY29yZHNbdl0gPSBzZXRtZXRhdGFibGUoe30sIHtfX21vZGUgPSAia3YifSkgZW5kCgkJCQlsb2NhbCBzbG90ID0gc2VsZi5yZWNvcmRzW3ZdCgoJCQkJc2xvdFtzdF9jdXJdID0gewoJCQkJCXBvc2UgPSBlbnRpdHkuZ2V0X3Byb3AodiwgIm1fZmxQb3NlUGFyYW1ldGVyIiwgMTEpICogMTIwIC0gNjAsCgkJCQkJZXllID0gc2VsZWN0KDIsIGVudGl0eS5nZXRfcHJvcCh2LCAibV9hbmdFeWVBbmdsZXMiKSkKCQkJCX0KCgkJCQktLQoJCQkJbG9jYWwgdmFsdWUKCQkJCWxvY2FsIGFsbG93ID0gKHNsb3Rbc3RfcHJlXSBhbmQgc2xvdFtzdF9jdXJdKSB+PSBuaWwKCgkJCQlpZiBhbGxvdyB0aGVuCgkJCQkJbG9jYWwgYW5pbXN0YXRlID0gZW50aXR5LmdldF9hbmltc3RhdGUodikKCQkJCQlsb2NhbCBtYXhfZGVzeW5jID0gZW50aXR5LmdldF9tYXhfZGVzeW5jKGFuaW1zdGF0ZSkKCgkJCQkJaWYgKHNsb3Rbc3RfcHJlXSBhbmQgc2xvdFtzdF9jdXJdKSBhbmQgbWF4X2Rlc3luYyA8IC44NSBhbmQgKHN0X2N1ciAtIHN0X3ByZSA8IDIpIHRoZW4KCQkJCQkJbG9jYWwgc2lkZSA9IG1hdGguY2xhbXAobWF0aC5ub3JtYWxpemVfeWF3KGFuaW1zdGF0ZS5nb2FsX2ZlZXRfeWF3IC0gc2xvdFtzdF9jdXJdLmV5ZSksIC0xLCAxKQoJCQkJCQl2YWx1ZSA9IHNsb3Rbc3RfcHJlXSBhbmQgKHNsb3Rbc3RfcHJlXS5wb3NlICogc2lkZSAqIG1heF9kZXN5bmMpIG9yIG5pbAoJCQkJCWVuZAoKCQkJCQlpZiB2YWx1ZSB0aGVuIHBsaXN0LnNldCh2LCAiRm9yY2UgYm9keSB5YXcgdmFsdWUiLCB2YWx1ZSkgZW5kCgkJCQllbmQKCgkJCQlwbGlzdC5zZXQodiwgIkZvcmNlIGJvZHkgeWF3IiwgdmFsdWUgfj0gbmlsKQoJCQkJcGxpc3Quc2V0KHYsICJDb3JyZWN0aW9uIGFjdGl2ZSIsIHRydWUpCgkJCWVuZAoJCWVuZAoJZW5kKSwKCXJlc3RvcmUgPSBhKGZ1bmN0aW9uICgpCgkJbG9jYWwgc2VsZiA9IHJhZ2UucmVzb2x2ZXIKCQlmb3IgaSA9IDEsIDY0IGRvCgkJCXBsaXN0LnNldChpLCAiRm9yY2UgYm9keSB5YXciLCBmYWxzZSkKCQllbmQKCQlzZWxmLnJlY29yZHMgPSB7fQoJZW5kKSwKCXJ1biA9IGEoZnVuY3Rpb24gKHNlbGYpCgkJdmFycy5yYWdlLnJlc29sdmVyOnNldF9ldmVudCgibmV0X3VwZGF0ZV9lbmQiLCBzZWxmLndvcmspCgkJdmFycy5yYWdlLnJlc29sdmVyOnNldF9jYWxsYmFjayhmdW5jdGlvbiAodGhpcykKCQkJaWYgbm90IHRoaXMudmFsdWUgdGhlbiBzZWxmLnJlc3RvcmUoKSBlbmQKCQllbmQpCgkJZGVmZXIoc2VsZi5yZXN0b3JlKQoJZW5kKQp9CgpyYWdlLmV4c3dpdGNoID0gewoJb3ZyID0gZmFsc2UsCglsYXRlc3QgPSBmYWxzZSwKCXdvcmsgPSBhKGZ1bmN0aW9uIChjbWQpCgkJbG9jYWwgc2VsZiwgc2V0dGluZ3MgPSByYWdlLmV4c3dpdGNoLCB2YXJzLnJhZ2UuZXhzd2l0Y2gKCgkJbG9jYWwgaXNfZHQsIGlzX29zID0gcmVmcy5yYWdlLmFpbWJvdC5kb3VibGVfdGFwWzFdLmhvdGtleTpnZXQoKSwgcmVmcy5hYS5vdGhlci5vbnNob3QuaG90a2V5OmdldCgpCgkJbG9jYWwgaXNfcGVla2luZyA9IHJlZnMucmFnZS5vdGhlci5wZWVrLnZhbHVlIGFuZCByZWZzLnJhZ2Uub3RoZXIucGVlay5ob3RrZXk6Z2V0KCkKCgkJbG9jYWwgY2FuX3RlbGVwb3J0ID0gbm90ICggKG15LndhbGtpbmcgb3IgbXkudmVsb2NpdHkgPCA1KSBhbmQgbm90IGlzX3BlZWtpbmcgb3IgbXkuY3JvdWNoaW5nKQoJCWxvY2FsIGNhbl9kdCA9IGZhbHNlCgoJCWxvY2FsIHdlYXBvbl90ID0gbXkud2VhcG9uIGFuZCB3ZWFwb25kYXRhKG15LndlYXBvbikKCgkJaWYgd2VhcG9uX3QgdGhlbgoJCQlsb2NhbCB3ZWFwb25faWQgPSBlbnRpdHkuZ2V0X3Byb3AobXkud2VhcG9uLCAibV9pSXRlbURlZmluaXRpb25JbmRleCIpCgkJCWxvY2FsIHdlYXBvbl9hdXRvID0gd2VhcG9uX3QuaXNfZnVsbF9hdXRvCgkJCWxvY2FsIGlzX2RlYWdsZSA9IHdlYXBvbl9pZCA9PSAxCgoJCQljYW5fZHQgPSB3ZWFwb25fYXV0bwoKCQkJaWYgKCAod2VhcG9uX3Qud2VhcG9uX3R5cGVfaW50ID09IDEgYW5kIG5vdCBpc19kZWFnbGUpIGFuZCBub3Qgc2V0dGluZ3MuYWxsb3c6Z2V0ICJQaXN0b2xzIiApCgkJCW9yICggaXNfZGVhZ2xlIGFuZCBub3Qgc2V0dGluZ3MuYWxsb3c6Z2V0ICJEZXNlcnQgRWFnbGUiICkgdGhlbgoJCQkJY2FuX2R0ID0gdHJ1ZQoJCQllbmQKCQllbmQKCgkJbG9jYWwgYWxsb3cgPSBteS5vbl9ncm91bmQgYW5kIGlzX2R0IGFuZCBub3QgKGNhbl9kdCBvciBjYW5fdGVsZXBvcnQpCgoJCWlmIGFsbG93IHRoZW4KCQkJcmVmcy5yYWdlLmFpbWJvdC5kb3VibGVfdGFwWzFdOm92ZXJyaWRlKGZhbHNlKQoJCQlyZWZzLmFhLm90aGVyLm9uc2hvdC5ob3RrZXk6b3ZlcnJpZGUoeyJBbHdheXMgb24iLCAwfSkKCQkJc2VsZi5vdnIgPSB0cnVlCgkJZWxzZQoJCQlpZiBzZWxmLm92ciB0aGVuCgkJCQlyZWZzLnJhZ2UuYWltYm90LmRvdWJsZV90YXBbMV06b3ZlcnJpZGUodHJ1ZSkKCQkJCXJlZnMuYWEub3RoZXIub25zaG90LmhvdGtleTpvdmVycmlkZSgpCgkJCQlzZWxmLm92ciA9IGZhbHNlCgkJCWVuZAoJCWVuZAoJZW5kKSwKCXJ1biA9IGEoZnVuY3Rpb24gKHNlbGYpCgkJdmFycy5yYWdlLmV4c3dpdGNoLm9uOnNldF9ldmVudCgic2V0dXBfY29tbWFuZCIsIHNlbGYud29yaykKCQktLSB2YXJzLnJhZ2UuZXhzd2l0Y2gub246c2V0X2V2ZW50KCJwdWk6OmFkYXB0aXZlX3dlYXBvbiIsIGZ1bmN0aW9uICgpCgkJLS0gCWlmIHJlZnMucmFnZS5haW1ib3QuZG91YmxlX3RhcFsxXS5ob3RrZXk6Z2V0KCkgdGhlbgoJCS0tIAkJc2VsZi5vdnIgPSBmYWxzZQoJCS0tIAllbmQKCQktLSBlbmQpCgkJdmFycy5yYWdlLmV4c3dpdGNoLm9uOnNldF9jYWxsYmFjayhmdW5jdGlvbiAodGhpcykKCQkJaWYgbm90IHRoaXMudmFsdWUgdGhlbgoJCQkJcmVmcy5yYWdlLmFpbWJvdC5kb3VibGVfdGFwWzFdOm92ZXJyaWRlKCkKCQkJCXJlZnMuYWEub3RoZXIub25zaG90Om92ZXJyaWRlKCkKCQkJZW5kCgkJZW5kKQoJCWRlZmVyKGZ1bmN0aW9uICgpCgkJCXJlZnMucmFnZS5haW1ib3QuZG91YmxlX3RhcFsxXTpvdmVycmlkZSgpCgkJCXJlZnMuYWEub3RoZXIub25zaG90LmhvdGtleTpvdmVycmlkZSgpCgkJZW5kKQoJZW5kKQp9CgpyYWdlLm1pbm9yID0gewoJc2hpZnRfZXh0ZW5kID0gYShmdW5jdGlvbiAoY21kKQoJCWxvY2FsIGFsbG93ZWQgPSB2YXJzLnJhZ2Uuc2hpZnRleHQuaG90a2V5OmdldCgpCgkJcmVmcy5taXNjLnNldHRpbmdzLm1heHNoaWZ0Om92ZXJyaWRlKGFsbG93ZWQgYW5kIDE3IG9yIG5pbCkKCWVuZCksCglydW4gPSBhKGZ1bmN0aW9uIChzZWxmKQoJCS0tIHZhcnMucmFnZS5zaGlmdGV4dDpzZXRfY2FsbGJhY2soZnVuY3Rpb24gKHRoaXMpCgkJLS0gCWNhbGxiYWNrcy5zZXR1cF9jb21tYW5kKHRoaXMudmFsdWUsIHNlbGYuc2hpZnRfZXh0ZW5kKQoJCS0tIAlpZiBub3QgdGhpcy52YWx1ZSB0aGVuCgkJLS0gCQlyZWZzLm1pc2Muc2V0dGluZ3MubWF4c2hpZnQ6b3ZlcnJpZGUoKQoJCS0tIAllbmQKCQktLSBlbmQsIHRydWUpCgllbmQpCn0KCi0tCgpmb3IgaywgdiBpbiBwYWlycyhyYWdlKSBkbyBpZiB2LnJ1biB0aGVuIHY6cnVuKCkgZW5kIGVuZAoKLS0gI2VuZHJlZ2lvbgotLQoKCgotLSAjZW5kcmVnaW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQotLQoKCgotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQotLSAjcmVnaW9uIDo6IFNjcmVlbgoKCi0tCi0tICNyZWdpb24gOiBVdGlsaXRpZXMKCi0tICNyZWdpb24gLSBGaWd1cmVzCgp0ZXh0dXJlcyA9IHsKCWJ1dHRlcmZseSA9IG5pbCwKCWNvcm5lcl9oID0gcmVuZGVyLmxvYWRfc3ZnKCc8c3ZnIHdpZHRoPSI0IiBoZWlnaHQ9IjUuODciIHZpZXdCb3g9IjAgMCA0IDYiPjxwYXRoIGZpbGw9IiNmZmYiIGQ9Ik0wIDZWNGMwLTIgMi00IDQtNHYyQzIgMiAwIDQgMCA2WiIvPjwvc3ZnPicsIDgsIDEyKSwKCWNvcm5lcl92ID0gcmVuZGVyLmxvYWRfc3ZnKCc8c3ZnIHdpZHRoPSI1Ljg3IiBoZWlnaHQ9IjQiIHZpZXdCb3g9IjAgMCA2IDQiPjxwYXRoIGZpbGw9IiNmZmYiIGQ9Ik0yIDBIMGMwIDIgMiA0IDQgNGgyQzQgNCAyIDIgMiAwWiIvPjwvc3ZnPicsIDEyLCA4KSwKCXdhcm5pbmcgPSByZW5kZXIubG9hZF9zdmcoJzxzdmcgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2IiB2aWV3Qm94PSIwIDAgMTYgMTYiPjxwYXRoIGZpbGw9IiNmZmYiIGQ9Im0xMy4yNTkgMTNoLTEwLjUxOGMtMC4zNTc4NyAwLjAwMjMtMC42ODkwNi0wLjE4ODktMC44NjYtMC41LTAuMTgwOTMtMC4zMDg4LTAuMTgwOTMtMC42OTEyIDAtMWw1LjI1OS05LjAxNWMwLjE3NjktMC4zMTAxNCAwLjUwNjk2LTAuNTAxMTUgMC44NjQtMC41IDAuMzU2OC0wLjAwMTIxIDAuNjg2NTkgMC4xODk4NiAwLjg2MyAwLjVsNS4yNiA5LjAxNWMwLjE4MDkgMC4zMDg4IDAuMTgwOSAwLjY5MTIgMCAxLTAuMTc2NCAwLjMwOTctMC41MDU2IDAuNTAwNi0wLjg2MiAwLjV6bS02LjI1OS0zdjJoMnYtMnptMC01djRoMnYtNHoiLz48L3N2Zz4nLCAxNiwgMTYpLAoJbWFudWFsID0gcmVuZGVyLmxvYWRfc3ZnKCc8c3ZnIHdpZHRoPSI4IiBoZWlnaHQ9IjEwIiB2aWV3Qm94PSIwIDAgOCAxMCI+PHBhdGggZmlsbD0iI2ZmZiIgZD0ibTAuMzg0IDUuODAyYy0wLjI0Mjg2LTAuMTk0NTMtMC4zODQyLTAuNDg4ODQtMC4zODQyLTAuOHMwLjE0MTM0LTAuNjA1NDcgMC4zODQyLTAuOGw2LjA4LTRjMC4yOTUxMy0wLjIyMzcxIDAuNjkyNzctMC4yNTcyNyAxLjAyMTItMC4wODYyMDIgMC4zMjg0NiAwLjE3MTA3IDAuNTI4ODkgMC41MTYxMyAwLjUxNDc3IDAuODg2MmwtMS45MiAzLjk2IDEuOTIgNC4wNGMwLjAxNDEyIDAuMzcwMDctMC4xODYzMSAwLjcxNTEzLTAuNTE0NzcgMC44ODYyLTAuMzI4NDYgMC4xNzExLTAuNzI2MSAwLjEzNzUtMS4wMjEyLTAuMDg2MnoiLz48L3N2Zz4nLCAxMCwgMTApLAoJbWluaV9iZmx5ID0gcmVuZGVyLmxvYWRfcG5nKCdceDg5XHg1MFx4NEVceDQ3XHgwRFx4MEFceDFBXHgwQVx4MDBceDAwXHgwMFx4MERceDQ5XHg0OFx4NDRceDUyXHgwMFx4MDBceDAwXHgwOVx4MDBceDAwXHgwMFx4MDlceDA4XHgwNlx4MDBceDAwXHgwMFx4RTBceDkxXHgwNlx4MTBceDAwXHgwMFx4MDBceDA0XHg3M1x4NDJceDQ5XHg1NFx4MDhceDA4XHgwOFx4MDhceDdDXHgwOFx4NjRceDg4XHgwMFx4MDBceDAwXHhGRFx4NDlceDQ0XHg0MVx4NTRceDE4XHg1N1x4NjNceEU0XHhFN1x4RTdceEVGXHhGOFx4RjhceEYxXHg2M1x4MzlceDFGXHgxRlx4REZceEFFXHg0Rlx4OUZceDNFXHhBNVx4MzNceDMwXHgzMFx4M0NceDAwXHg2Mlx4MDVceDJFXHgyRVx4QUVceEU1XHhERlx4QkVceDdEXHhCM1x4MDBceENBXHg3N1x4MzJceDAyXHgwNVx4RkVceEJGXHg3Rlx4RkZceDlFXHg2MVx4QzFceDgyXHgwNVx4MENceEU1XHhFNVx4RTVceERGXHg3Rlx4RkRceEZBXHg5NVx4QzVceEM2XHhDNlx4MzZceEI1XHhCM1x4QjNceDkzXHgyQlx4MjFceDIxXHg4MVx4NDFceDUwXHg1MFx4OTBceDAxXHhBQ1x4MDhceDA4XHg4MFx4MTRceDAzXHg1OFx4NjFceDYyXHg2Mlx4MjJceEMzXHhGQ1x4RjlceEYzXHgxOVx4NDBceDBBXHg0MFx4ODBceDkxXHg5MVx4OTFceDgxXHg5MVx4OTdceDk3XHhGN1x4Q0RceEExXHg0M1x4ODdceDg0XHgwRFx4MENceDBDXHhFMFx4MEFceDYxXHgwQVx4MEVceDFDXHgzOFx4QzBceDEwXHgxQVx4MUFceDdBXHg5MVx4MTFceEU0XHgyNlx4NDlceDQ5XHhDOVx4QkNceEY2XHhGNlx4NzZceENFXHg4MFx4ODBceDAwXHhCMFx4NDJceDEwXHhEOFx4QjBceDYxXHgwM1x4NDNceDU2XHg1Nlx4RDZceDhGXHhFN1x4Q0ZceDlGXHg2N1x4ODJceEFDXHg3M1x4NTBceDUzXHg1M1x4REJceDcyXHhGM1x4RTZceDREXHg2RVx4OTBceEU0XHg4M1x4MDdceDBGXHgxOFx4MTRceDE0XHgxNFx4QzBceDBBXHg1NVx4NTRceDU0XHgzRVx4RERceEJEXHg3Qlx4RDdceDFGXHhBNFx4NDhceDAwXHhFOFx4QjhceDA3XHhGQlx4RjZceEVEXHhFM1x4MDdceDQ5XHhGOFx4RkFceEZBXHhGRVx4RDlceEJDXHg3OVx4MzNceDBCXHg4OFx4NkRceDZFXHg2RVx4MEVceEYyXHgwOFx4MTdceDQ4XHgxMVx4MDhceDI0XHhCMFx4QjNceEIzXHg0Rlx4MDdceDMxXHg3RVx4RkVceEZDXHhCOVx4MTJceEM4XHgwRVx4MDdceEY5XHgwNlx4QThceEMwXHgwQVx4MjhceDc0XHgwMVx4QTZceDA4XHhFRVx4MTZceDZDXHgwQ1x4MDBceDI0XHhERlx4NjFceDY5XHg1RFx4NjlceERCXHg3OVx4MDBceDAwXHgwMFx4MDBceDQ5XHg0NVx4NEVceDQ0XHhBRVx4NDJceDYwXHg4MicsIDksIDkpLAoJbG9nb19sID0gcmVuZGVyLmxvYWRfcG5nKCJceDg5XHg1MFx4NEVceDQ3XHgwRFx4MEFceDFBXHgwQVx4MDBceDAwXHgwMFx4MERceDQ5XHg0OFx4NDRceDUyXHgwMFx4MDBceDAwXHgxQVx4MDBceDAwXHgwMFx4MEZceDA4XHgwNlx4MDBceDAwXHgwMFx4RkFceDUxXHhERlx4RTZceDAwXHgwMFx4MDBceDA0XHg3M1x4NDJceDQ5XHg1NFx4MDhceDA4XHgwOFx4MDhceDdDXHgwOFx4NjRceDg4XHgwMFx4MDBceDAyXHg2OVx4NDlceDQ0XHg0MVx4NTRceDM4XHg0Rlx4QkRceDU0XHgzRFx4ODhceDkyXHg3MVx4MThceEZGXHhCRlx4NTdceDA0XHhDN1x4MDlceEJBXHg1OFx4RTFceEUyXHgzQlx4MzVceEU1XHgxN1x4NThceDRFXHgwRFx4QTFceDM0XHg1NFx4RDBceDIwXHgwOVx4MjJceDREXHgzQVx4OThceEEzXHhDM1x4QTlceEUwXHgzOVx4MzRceDA4XHgxQVx4NzdceDQzXHgyMVx4MkVceDBBXHg5Mlx4MjVceDc0XHgyMFx4NzRceDU4XHg4Qlx4RjhceEQyXHhFMlx4OTBceDYwXHgyOVx4NEVceDc3XHgzQVx4QTRceDgzXHgxMVx4QjZceEE4XHhEQ1x4NzFceDlCXHhGNlx4N0JceDVFXHhGRlx4N0ZceEJCXHgyNFx4MzJceEUyXHhCOFx4MDdceDFFXHg3Q1x4QkVceERFXHhERlx4RUZceEY5XHg3OFx4NUZceDI1XHg3Nlx4NDFceDIyXHg1RFx4MTBceDBGXHg1M1x4ODlceDQ2XHhBM1x4RDFceDdCXHhCRFx4NUVceEZGXHg4MFx4RUNceDdBXHhCRFx4N0VceDc0XHgwN1x4MDJceEYzXHhDN1x4NzlceDM2XHg0MVx4NDRceDVCXHg3RVx4QkZceEZGXHhEOFx4RUJceEY1XHgzMlx4QTdceEQzXHhDOVx4MDJceDgxXHgwMFx4Q0JceEU3XHhGM1x4RTdceDMxXHhBOVx4NkZceDNDXHgxRVx4QkZceDZFXHgzNlx4OUJceENDXHhFNVx4NzJceDk5XHgwOFx4RDBceDAxXHhGRFx4RDRceEVGXHhGN1x4OTlceEQxXHg2OFx4NjRceDkyXHgyNFx4RURceEMzXHg3Rlx4NDZceDgzXHhBRVx4NENceEE1XHg4N1x4N0ZceDE1XHg3QVx4MDJceEVEXHhBRlx4NENceDdCXHgxM1x4RkVceDlDXHhDN1x4MjlceDJGXHgwRlx4ODdceEMzXHgyM1x4ODNceEMxXHg3MFx4MjVceDlEXHg0RVx4QjNceDQ4XHgyNFx4MjJceDExXHgxMVx4MDFceEVDXHhDRVx4RTdceEYzXHgyN1x4ODNceEMxXHg4MFx4RTlceDc0XHgzQVx4QTZceEQ1XHg2QVx4NTVceDFDXHhGOFx4NEFceEI5XHg1Q1x4M0VceDBEXHg4N1x4QzNceDBGXHgwNVx4MzBceDFBXHg2MVx4QURceDU2XHg4Qlx4NTlceEFEXHg1Nlx4MTZceDhGXHhDN1x4QkZceDQ0XHhBM1x4NTFceDhCXHg0Nlx4QTNceEI5XHgyNFx4RjJceDlEXHg0RVx4RTdceDlCXHhEOVx4NkNceDM2XHg5Q1x4NkRceEE0XHhERFx4NkVceDJGXHg2RVx4OTRceENEXHg2Nlx4QkZceDA3XHg4M1x4QzFceDZCXHg2NFx4NTNceDA3XHhERFx4NkVceDk3XHhFNVx4NzJceDM5XHhCQVx4RDdceDY5XHhBMVx4NTBceEQ4XHhBNFx4MzhceEY5XHg4QVx4QTJceEQwXHgxQVx4NUFceEQzXHhFOVx4RDRceDMyXHg5Qlx4Q0RceDM2XHg2QVx4QjVceERBXHg4OVx4REJceEVEXHhERVx4MkFceDk1XHg0QVx4Q0NceEU3XHhGM1x4MkRceEIxXHg3MVx4MEFceEI1XHg5RVx4MDhceDZDXHgzNlx4OUJceDFBXHgyN1x4MjJceDE5XHgwRlx4N0NceEE1XHhGQlx4NzBceEEwXHg2NVx4QzdceEU4XHhGRVx4MTBceEY5XHgwRVx4RjJceDFFXHg3MVx4M0ZceEJCXHhERFx4NEVceDREXHg1RFx4MTdceEI1XHhCOFx4QzNceDcyXHgwM1x4OTNceEM5XHg4NFx4MzZceEQyXHg0Nlx4QkRceDk1XHhFQVx4RjlceERBXHhCNlx4MTNceDg5XHg4NFx4OUJceDg4XHg5Q1x4QjhceDRGXHg4RFx4REZceDg3XHgyNVx4OTNceDQ5XHgyNVx4MTZceDhCXHgzOVx4MzlceEQwXHgyQlx4RTRceENCXHgwMFx4M0JceDIwXHg0MFx4NTlceDk2XHg5OVx4MDBceDZFXHgzNFx4MUFceENDXHhFMVx4NzBceDMwXHgzMVx4MERceEMwXHhENVx4OTdceDI5XHg5NVx4NEFceDU1XHhEMVx4QzhceDNEXHg5QVx4ODJceENFXHhEMFx4RUJceEY1XHhBNlx4QzVceDYyXHhGMVx4NTBceENBXHg2NFx4MzJceEZCXHhBMVx4NTBceEU4XHgzMVx4MUZceEYzXHgyNVx4RjJceDlCXHhCOFx4NTdceDQwXHhFQ1x4NjFceDY3XHg2N1x4RTdceEIzXHhDN1x4RTNceEIxXHg5OFx4NENceEE2XHhDQlx4MTRceEEzXHhBRVx4RTlceDg2XHg5OFx4RjZceDE4XHgwRFx4NkFceEE4XHg0MVx4MjFceEJDXHhCOVx4MzJceDQ4XHhERFx4NDRceDRBXHg0Mlx4QjhceEQ1XHg2QVx4NTVceDVEXHhERFx4NUJceEE4XHg4N1x4MTdceDNGXHhDMlx4RUZceDJEXHg2OFx4NUNceDNDXHg4Q1x4N0JceENDXHgyQVx4OTVceENBXHgwNlx4RERceDQwXHhFQ1x4OUVceDAzXHg3RVx4NDRceENEXHhERFx4MjVceENCXHgyRlx4RTNceDI5XHhDQ1x4RUNceDRBXHhGQ1x4MERceDExXHhCRFx4MzhceDEzXHhEQ1x4ODNceDREXHgxRlx4NkFceDE0XHg0QVx4QURceDFBXHgzMFx4RERceEEyXHgzNVx4MkVceEUyXHgzNlx4NzBceDZGXHg0M1x4NkZceDQwXHhFOVx4RjNceDEwXHg3Mlx4MDBceDQzXHhFMVx4MzFceEYxXHg3Nlx4MzRceEUwXHhBQlx4NDRceDdGXHg5M1x4MEZceDQ4XHhERVx4RkZceDQzXHhDMVx4MzZceDYyXHhDRlx4RDdceDNDXHhGQlx4NUJceDdBXHgxRFx4MTFceDREXHg0M1x4ODBceDhCXHg3N1x4OTRceEIxXHgxNlx4NzRceDE3XHhGQVx4MEVceDRBXHgxRlx4RTZceDNGXHhDQlx4M0FceDIyXHgwMVx4MjRceDczXHhFMFx4RkZceEZFXHhGRlx4RkJceDA5XHgxQ1x4RkJceDA1XHg3OVx4MzFceDEyXHhFM1x4NkNceDAwXHgwMFx4MDBceDAwXHg0OVx4NDVceDRFXHg0NFx4QUVceDQyXHg2MFx4ODIiLCAyNiwgMTUpLAoJbG9nb19yID0gcmVuZGVyLmxvYWRfcG5nKCJceDg5XHg1MFx4NEVceDQ3XHgwRFx4MEFceDFBXHgwQVx4MDBceDAwXHgwMFx4MERceDQ5XHg0OFx4NDRceDUyXHgwMFx4MDBceDAwXHgxOFx4MDBceDAwXHgwMFx4MEZceDA4XHgwNlx4MDBceDAwXHgwMFx4RkVceEE0XHgwRlx4REJceDAwXHgwMFx4MDBceDA0XHg3M1x4NDJceDQ5XHg1NFx4MDhceDA4XHgwOFx4MDhceDdDXHgwOFx4NjRceDg4XHgwMFx4MDBceDAyXHgwOFx4NDlceDQ0XHg0MVx4NTRceDM4XHg0Rlx4RDVceDUzXHgzRFx4NjhceDVBXHg1MVx4MTRceDNFXHhDRlx4NjBceDk3XHgyNFx4MjhceDExXHg4N1x4QjhceEY4XHgwOFx4QjVceDYwXHg5Mlx4MTZceDI1XHg4NVx4QkFceDg5XHgzRlx4MjVceDYzXHhBMVx4QTNceEM2XHg4MFx4RThceDUwXHgwMlx4NURceDMyXHhFOFx4NTRceDM0XHhBM1x4NDJceDNCXHhCNFx4MEVceDE5XHhENFx4NERceDA5XHg0MVx4NjhceDkzXHhBOVx4NTBceDk1XHg2Mlx4MDdceEM5XHgyMFx4MTVceDkyXHg0MVx4OUNceDc0XHg5MFx4NTJceDg0XHg2MFx4MEJceEE1XHg1OFx4NjhceDVGXHhCRlx4NzNceDczXHgxRlx4M0NceDI5XHhBNFx4MjBceDY0XHhDOFx4ODVceDhGXHg3M1x4RUVceDc5XHhFN1x4OUNceEVGXHhCQlx4MUZceDNDXHg4NVx4NkVceEY4XHgyOFx4MzdceEJDXHg5Rlx4RTZceDIxXHg1OFx4OUNceDRFXHhBN1x4NjNceDkzXHhDOVx4RjRceEM3XHg2Q1x4MzZceDJGXHhGRFx4NEZceEUwXHgzQ1x4MDRceEFGXHgzNVx4NERceDdCXHgzRVx4MUNceDBFXHg0OVx4NTVceEQ1XHgyN1x4MjBceDM4XHhCRFx4OEVceEM0XHg0OFx4QjBceDg4XHg0Nlx4MTVceEY4XHgwMVx4MENceDBDXHg0M1x4OUJceEM4XHgzNVx4NzlceEU3XHhGQVx4MjdceEMwXHgyQlx4RUZceDNCXHg4OFx4MTVceDk5XHhEQlx4MTFceDc5XHg4N1x4NzFceDU2XHg1OFx4RjRceEI0XHhERFx4NkVceDFGXHhGOFx4N0NceDNFXHg1RVx4MjRceDRFXHhBRFx4NTZceEVCXHgwNFx4MDJceDgxXHg3Qlx4MzZceDlCXHg2RFx4RDlceEE4XHg2RVx4M0NceDFFXHhGRlx4QjZceERCXHhFRFx4MEJceDVDXHg5M1x4MkZceDA4XHgyM1x4RkRceDNBXHgxQVx4OERceDNBXHgwRVx4ODdceEUzXHgwRVx4RDdceEJCXHhERFx4MkVceDc5XHgzQ1x4MUVceEFBXHg1Nlx4QUJceDE0XHg4RFx4NDZceDE1XHhBNVx4REZceEVGXHg3Rlx4NzdceEI5XHg1Q1x4Q0JceEY5XHg3Q1x4OUVceDkwXHg1M1x4QjFceDU4XHgxNFx4NERceDVFXHhBRlx4OTdceDI2XHg5M1x4MDlceDU5XHgyQ1x4MTZceDUyXHg5NFx4QUJceDg3XHgyNlx4MTJceDA5XHgwQVx4MDZceDgzXHgxNFx4ODlceDQ0XHg4OFx4RkJceEQzXHhFOVx4RjRceDE2XHg3QVx4M0FceERDXHg5M1x4NENceDI2XHhBOVx4NTRceDJBXHhEMVx4NjBceDMwXHgyMFx4QUJceEQ1XHhDQVx4NzhceENCXHhFMlx4MTVceEY4XHhBOVx4M0ZceDVGXHgyQ1x4RDFceDk3XHhGM1x4MzJceDI2XHg5M1x4NEFceDNFXHg0Qlx4NUJceEJFXHg2MFx4RTFceDJBXHhGN1x4NjFceDQxXHhBQlx4NTJceEE5XHhEOFx4NDBceEI2XHhEMVx4NjhceDM0XHgyOFx4MUNceDBFXHgxRlx4OTdceENCXHhFNVx4ODdceEYxXHg3OFx4N0NceDREXHhERVx4ODVceDdEXHg4Mlx4NDBceDVGXHg2QVx4QjBceEUzXHg1NVx4QkRceDVFXHhERlx4MEZceDg1XHg0Mlx4QkFceEIyXHhGQlx4RjhceDc2XHhEMVx4NkNceDM2XHhERlx4QzNceEJBXHhFRFx4NTZceEFCXHhGNVx4Q0JceEVGXHhGN1x4MUZceEU1XHg3Mlx4QjlceEREXHg1NFx4MkFceEE1XHg4Qlx4NzhceDA2XHhGMlx4NDNceEMzXHg4Qlx4N0RceDk4XHgzOVx4NTNceEEwXHg0Mlx4RTNceDI3XHgxQlx4NEZceEExXHg1MFx4QjhceDhDXHhDNVx4NjJceDJCXHg1Mlx4RTlceDM5XHhFMlx4MDNceENFXHgzM1x4OTlceDRDXHgzQlx4OUJceENEXHhGMlx4QTBceDM4XHg2Q1x4MURceDVCXHhFMlx4NzRceDNBXHhDNVx4OURceDk1XHhCM1x4MjhceDNFXHhCRFx4NUVceEVGXHhBN1x4REJceEVEXHg1RVx4NjdceDczXHg2N1x4MkNceDkyXHhCM1x4MUZceDEwXHgxRlx4MDNceERGXHg4MFx4MzdceEMwXHgwQlx4NTlceDdGXHg4OVx4QjhceDZGXHgxMFx4RDNceDQxXHhCRVx4MzVceEEzXHg2RVx4RjZceEIyXHhDM1x4MDRceDhGXHg4MFx4QThceEFDXHhGM1x4QzJceDhGXHhDMFx4NURceDYwXHg0M1x4RDZceDRFXHg1OFx4OUNceENDXHg1NVx4QzRceDA0XHg2MFx4MDFceENFXHg4MFx4NzdceEMwXHgxRVx4QzBceDE2XHgwRVx4NTlceDM4XHhCMFx4MERceDRDXHgwMFx4MzFceDM3XHhDRlx4OEZceDc2XHg4RFx4RTBceDdGXHgzRlx4RERceDdFXHg4Mlx4QkZceDI5XHgyRVx4QkJceDhCXHgxRVx4RDJceDEzXHhEM1x4MDBceDAwXHgwMFx4MDBceDQ5XHg0NVx4NEVceDQ0XHhBRVx4NDJceDYwXHg4MiIsIDI0LCAxNSksCn0gZG8KCWxvY2FsIGZpbGVfdGV4dHVyZSA9IHJlYWRmaWxlKCJoeXN0ZXJpYS9idXR0ZXJmbHkucG5nIikKCWxvY2FsIGxvYWRfdGV4dHVyZXMgPSBmdW5jdGlvbiAoZGF0YSkKCQl0ZXh0dXJlcy5idXR0ZXJmbHkgPSByZW5kZXIubG9hZF9wbmcoZGF0YSwgMTAyNCwgMTAyNCkKCQl0ZXh0dXJlcy5idXR0ZXJmbHlfcyA9IHJlbmRlci5sb2FkX3BuZyhkYXRhLCA2NCwgNjQpCgllbmQKCglpZiBub3QgZmlsZV90ZXh0dXJlIHRoZW4KCQlodHRwLmdldCgiaHR0cHM6Ly9jZG4uaHlzdGVyaWEub25lL21haW4vYnV0dGVyZmx5LnBuZyIsIGZ1bmN0aW9uIChzdWNjZXNzLCByYXcpCgkJCWlmIHN1Y2Nlc3MgYW5kIHN0cmluZy5zdWIocmF3LmJvZHksIDIsIDQpID09ICJQTkciIHRoZW4KCQkJCWxvYWRfdGV4dHVyZXMocmF3LmJvZHkpCgkJCQl3cml0ZWZpbGUoImh5c3RlcmlhL2J1dHRlcmZseS5wbmciLCByYXcuYm9keSkKCQkJZW5kCgkJZW5kKQoJZWxzZQoJCWxvYWRfdGV4dHVyZXMoZmlsZV90ZXh0dXJlKQoJZW5kCgoJaWYgX0FaQVpJIHRoZW4KCQlodHRwLmdldCgiaHR0cHM6Ly9jZG4uaHlzdGVyaWEub25lL2F6YXpvZ28vbG9nb19sby5wbmciLCBmdW5jdGlvbiAoc3VjY2VzcywgcmF3KQoJCQlpZiBzdWNjZXNzIGFuZCBzdHJpbmcuc3ViKHJhdy5ib2R5LCAyLCA0KSA9PSAiUE5HIiB0aGVuCgkJCQl0ZXh0dXJlcy5sb2dvX2wgPSByZW5kZXIubG9hZF9wbmcocmF3LmJvZHksIDM1LCAxNSkKCQkJZW5kCgkJZW5kKQoJCWh0dHAuZ2V0KCJodHRwczovL2Nkbi5oeXN0ZXJpYS5vbmUvYXphem9nby9sb2dvX3JvLnBuZyIsIGZ1bmN0aW9uIChzdWNjZXNzLCByYXcpCgkJCWlmIHN1Y2Nlc3MgYW5kIHN0cmluZy5zdWIocmF3LmJvZHksIDIsIDQpID09ICJQTkciIHRoZW4KCQkJCXRleHR1cmVzLmxvZ29fciA9IHJlbmRlci5sb2FkX3BuZyhyYXcuYm9keSwgMzUsIDE1KQoJCQllbmQKCQllbmQpCgllbmQKZW5kCgpyZW5kZXIubG9nbyA9IGZ1bmN0aW9uICh4LCB5KQoJcmVuZGVyLnRleHR1cmUodGV4dHVyZXMubG9nb19sLCB4LCB5LCBfQVpBWkkgYW5kIDM1IG9yIDI2LCAxNSwgY29sb3JzLmFjY2VudCkKCXJlbmRlci50ZXh0dXJlKHRleHR1cmVzLmxvZ29fciwgeCArIChfQVpBWkkgYW5kIDM1IG9yIDI2KSwgeSwgX0FaQVpJIGFuZCAzNSBvciAyNCwgMTUsIGNvbG9ycy50ZXh0KQplbmQKCnJlbmRlci5lZGdlX3YgPSBmdW5jdGlvbiAoeCwgeSwgbGVuZ3RoLCBjb2wpCgljb2wgPSBjb2wgb3IgY29sb3JzLmFjY2VudAoJcmVuZGVyLnRleHR1cmUodGV4dHVyZXMuY29ybmVyX3YsIHgsIHkgKyA0LCA2LCAtNCwgY29sLCAiZiIpCglyZW5kZXIucmVjdGFuZ2xlKHgsIHkgKyA0LCAyLCBsZW5ndGggLSA4LCBjb2wpCglyZW5kZXIudGV4dHVyZSh0ZXh0dXJlcy5jb3JuZXJfdiwgeCwgeSArIGxlbmd0aCAtIDQsIDYsIDQsIGNvbCwgImYiKQplbmQKcmVuZGVyLmVkZ2VfaCA9IGZ1bmN0aW9uICh4LCB5LCBsZW5ndGgsIGNvbCkKCWNvbCA9IGNvbCBvciBjb2xvcnMuYWNjZW50CglyZW5kZXIudGV4dHVyZSh0ZXh0dXJlcy5jb3JuZXJfaCwgeCwgeSwgNCwgNiwgY29sLCAiZiIpCglyZW5kZXIucmVjdGFuZ2xlKHggKyA0LCB5LCBsZW5ndGggLSA4LCAyLCBjb2wpCglyZW5kZXIudGV4dHVyZSh0ZXh0dXJlcy5jb3JuZXJfaCwgeCArIGxlbmd0aCwgeSwgLTQsIDYsIGNvbCwgImYiKQplbmQKCnJlbmRlci5jYXBzdWxlID0gZnVuY3Rpb24gKHgsIHksIHcsIGgsIGMpCgl4LCB5LCB3LCBoID0geCAqIERQSSwgeSAqIERQSSwgdyAqIERQSSwgaCAqIERQSQoJbG9jYWwgciwgZywgYiwgYSA9IGMuciwgYy5nLCBjLmIsIGMuYSAqIHJlbmRlci5nZXRfYWxwaGEoKQoKCWxvY2FsIHJyID0gaCAqIDAuNQoKCXJlbmRlcmVyLmNpcmNsZSh4ICsgcnIsIHkgKyByciwgcixnLGIsYSwgcnIsIDE4MCwgMC41KQoJcmVuZGVyZXIucmVjdGFuZ2xlKHggKyByciwgeSwgdyAtIGgsIGgsIHIsZyxiLGEpCglyZW5kZXJlci5jaXJjbGUoeCArIHcgLSByciwgeSArIHJyLCByLGcsYixhLCByciwgMCwgMC41KQplbmQKCnJlbmRlci5yb3VuZGVkX3NpZGVfdiA9IGZ1bmN0aW9uICh4LCB5LCB3LCBoLCBjLCBuKQoJeCwgeSwgdywgaCwgbiA9IHggKiBEUEksIHkgKiBEUEksIHcgKiBEUEksIGggKiBEUEksIChuIG9yIDApICogRFBJCglsb2NhbCByLCBnLCBiLCBhID0gYy5yLCBjLmcsIGMuYiwgYy5hICogcmVuZGVyLmdldF9hbHBoYSgpCgoJcmVuZGVyZXIuY2lyY2xlKHggKyBuLCB5ICsgbiwgciwgZywgYiwgYSwgbiwgMTgwLCAwLjI1KQoJcmVuZGVyZXIucmVjdGFuZ2xlKHggKyBuLCB5LCB3IC0gbiwgbiwgciwgZywgYiwgYSkKCXJlbmRlcmVyLnJlY3RhbmdsZSh4LCB5ICsgbiwgdywgaCAtIG4gLSBuLCByLCBnLCBiLCBhKQoJcmVuZGVyZXIuY2lyY2xlKHggKyBuLCB5ICsgaCAtIG4sIHIsIGcsIGIsIGEsIG4sIDI3MCwgMC4yNSkKCXJlbmRlcmVyLnJlY3RhbmdsZSh4ICsgbiwgeSArIGggLSBuLCB3IC0gbiwgbiwgciwgZywgYiwgYSkKZW5kCnJlbmRlci5yb3VuZGVkX3NpZGVfaCA9IGZ1bmN0aW9uICh4LCB5LCB3LCBoLCBjLCBuKQoJeCwgeSwgdywgaCwgbiA9IHggKiBEUEksIHkgKiBEUEksIHcgKiBEUEksIGggKiBEUEksIChuIG9yIDApICogRFBJCglsb2NhbCByLCBnLCBiLCBhID0gYy5yLCBjLmcsIGMuYiwgYy5hICogcmVuZGVyLmdldF9hbHBoYSgpCgoJcmVuZGVyZXIuY2lyY2xlKHggKyBuLCB5ICsgbiwgciwgZywgYiwgYSwgbiwgMTgwLCAwLjI1KQoJcmVuZGVyZXIucmVjdGFuZ2xlKHggKyBuLCB5LCB3IC0gbiAtIG4sIG4sIHIsIGcsIGIsIGEpCglyZW5kZXJlci5jaXJjbGUoeCArIHcgLSBuLCB5ICsgbiwgciwgZywgYiwgYSwgbiwgOTAsIDAuMjUpCglyZW5kZXJlci5yZWN0YW5nbGUoeCwgeSArIG4sIHcsIGggLSBuLCByLCBnLCBiLCBhKQplbmQKCi0tICNlbmRyZWdpb24KCi0tICNyZWdpb24gLSBXaWRnZXRzCgpsb2NhbCBkcmFnIGRvCglsb2NhbCBjdXJyZW50CgoJbG9jYWwgaW5fYm91bmRzID0gYShmdW5jdGlvbiAoeCwgeSwgeGEsIHlhLCB4YiwgeWIpCgkJcmV0dXJuICh4ID49IHhhIGFuZCB5ID49IHlhKSBhbmQgKHggPD0geGIgYW5kIHkgPD0geWIpCgllbmQpCgoJLS0KCWxvY2FsIHByb2dyZXNzID0geyBtZW51ID0gezB9LCBiZyA9IHswfSwgfQoKCWNhbGxiYWNrcy5wYWludF91aTpzZXQoZnVuY3Rpb24gKCkKCQlsb2NhbCBwMSA9IGFuaW1hLmNvbmRpdGlvbihwcm9ncmVzcy5iZywgY3VycmVudCB+PSBuaWwsIDIpCgkJaWYgcDEgPT0gMCB0aGVuIHJldHVybiBlbmQKCgkJcmVuZGVyLnB1c2hfYWxwaGEocDEpCgkJLS0gcmVuZGVyLmJsdXIoMCwgMCwgc3csIHNoLCBwMSkKCQlyZW5kZXIucmVjdGFuZ2xlKDAsIDAsIHN3LCBzaCwgY29sb3JzLnBhbmVsLmwxKQoJCS0tIHJlbmRlci50ZXh0KGZvbnRzLnJlZ3VsYXIsIHZlY3RvcihzY3JlZW4ueCAtIDI0LCBzY3JlZW4ueSAtIDQwKSwgY29sb3JzLnRleHQsICJyIiwgIkhvbGQgU2hpZnQgdG8gZHJhZyBlbGVtZW50cyB2ZXJ0aWNhbGx5IG9yIGhvcml6b250YWxseS5cbkhvbGQgQ3RybCB0byBkaXNhYmxlIGdyaWQgYWxpZ25pbmcuIikKCQlyZW5kZXIucG9wX2FscGhhKCkKCWVuZCkKCgktLQoJbG9jYWwgcHJvY2VzcyA9IGEoZnVuY3Rpb24gKHNlbGYpCgkJbG9jYWwgY3R4ID0gc2VsZi5fX2RyYWcKCQlpZiBjdHgubG9ja2VkIG9yIG5vdCBwdWkubWVudV9vcGVuIHRoZW4gcmV0dXJuIGVuZAoKCQlsb2NhbCBoZWxkID0gbW91c2UucHJlc3NlZCgpCgkJbG9jYWwgaG92ZXJlZCA9IG1vdXNlLmluX2JvdW5kcyhzZWxmLngsIHNlbGYueSwgc2VsZi53LCBzZWxmLmgpIGFuZCBub3QgbW91c2UuaW5fYm91bmRzKG1lbnUueCwgbWVudS55LCBtZW51LncsIG1lbnUuaCkKCgkJLS0KCQlpZiBoZWxkIGFuZCBjdHgucmVhZHkgPT0gbmlsIHRoZW4KCQkJY3R4LnJlYWR5ID0gaG92ZXJlZAoJCQljdHguaXgsIGN0eC5peSA9IHNlbGYueCwgc2VsZi55CgkJCWN0eC5weCwgY3R4LnB5ID0gc2VsZi54IC0gbW91c2UueCwgc2VsZi55IC0gbW91c2UueQoJCWVuZAoKCQlpZiBoZWxkIGFuZCBjdHgucmVhZHkgdGhlbgoJCQlpZiBjdXJyZW50ID09IG5pbCBhbmQgY3R4Lm9uX2hlbGQgdGhlbiBjdHgub25faGVsZChzZWxmLCBjdHgpIGVuZAoJCQljdXJyZW50ID0gKGN0eC5yZWFkeSBhbmQgY3VycmVudCA9PSBuaWwpIGFuZCBzZWxmLmlkIG9yIGN1cnJlbnQKCQkJY3R4LmFjdGl2ZSA9IGN1cnJlbnQgPT0gc2VsZi5pZAoJCWVsc2VpZiBub3QgaGVsZCB0aGVuCgkJCWlmIGN0eC5hY3RpdmUgYW5kIGN0eC5vbl9yZWxlYXNlIHRoZW4gY3R4Lm9uX3JlbGVhc2Uoc2VsZiwgY3R4KSBlbmQKCQkJY3R4LmFjdGl2ZSA9IGZhbHNlCgkJCWN1cnJlbnQsIGN0eC5yZWFkeSwgY3R4LmFsaWduaW5nLCBjdHgucHgsIGN0eC5weSwgY3R4Lml4LCBjdHguaXkgPSBuaWwsIG5pbCwgbmlsLCBuaWwsIG5pbCwgbmlsLCBuaWwKCQllbmQKCgkJY3R4LmhvdmVyZWQgPSBob3ZlcmVkIG9yIGN0eC5hY3RpdmUKCgkJLS0KCQlsb2NhbCBwcmVmZXIgPSB7IG5pbCwgbmlsIH0KCgkJbG9jYWwgZHgsIGR5LCBkdywgZGggPSBzZWxmLnggKiBEUEksIHNlbGYueSAqIERQSSwgc2VsZi53ICogRFBJLCBzZWxmLmggKiBEUEkKCQlsb2NhbCB3eCwgd3kgPSBjdHgucHggYW5kIChjdHgucHggKyBtb3VzZS54KSAqIERQSSBvciBkeCwgY3R4LnB5IGFuZCAoY3R4LnB5ICsgbW91c2UueSkgKiBEUEkgb3IgZHkKCQlsb2NhbCBjeCwgY3kgPSBkeCArIGR3ICogLjUsIGR5ICsgZGggKiAuNQoKCQktLQoKCQlsb2NhbCBwMSA9IGFuaW1hLmNvbmRpdGlvbihjdHgucHJvZ3Jlc3NbMV0sIGN0eC5ob3ZlcmVkLCA0KQoJCWxvY2FsIHAyID0gYW5pbWEuY29uZGl0aW9uKGN0eC5wcm9ncmVzc1syXSwgY3R4LmFjdGl2ZSwgNCkKCgkJcmVuZGVyLnJlY3RhbmdsZShzZWxmLnggLSAzLCBzZWxmLnkgLSAzLCBzZWxmLncgKyA2LCBzZWxmLmggKyA2LCBjb2xvcnMud2hpdGU6YWxwaGVuKDEyICsgMjQgKiBwMSksIDYpCgoJCXJlbmRlci5wdXNoX2FscGhhKHAyKQoKCQlpZiBub3QgY2xpZW50LmtleV9zdGF0ZSgweEEyKSB0aGVuCgkJCWxvY2FsIHdjeCwgd2N5ID0gKHd4ICsgZHcgKiAuNSkgLyBEUEksICh3eSArIGRoICogLjUpIC8gRFBJCgkJCWZvciBpLCB2IGluIGlwYWlycyhjdHgucnVsZXJzKSBkbwoJCQkJbG9jYWwgc3B4LCBzcHkgPSB2WzJdIC8gRFBJLCB2WzNdIC8gRFBJCgoJCQkJbG9jYWwgZGlzdCA9IG1hdGguYWJzKHZbMV0gYW5kIHdjeCAtIHNweCBvciB3Y3kgLSBzcHkpCgkJCQlsb2NhbCBhbGxvd2VkID0gZGlzdCA8ICgxMCAqIERQSSkKCgkJCQlsb2NhbCBweHkgPSB2WzFdIGFuZCAxIG9yIDIKCQkJCWlmIG5vdCBwcmVmZXJbcHh5XSB0aGVuCgkJCQkJcHJlZmVyW3B4eV0gPSBhbGxvd2VkIGFuZCAodlsxXSBhbmQgc3B4IC0gc2VsZi53ICogLjUgb3Igc3B5IC0gc2VsZi5oICogLjUpIG9yIG5pbAoJCQkJZW5kCgoJCQkJdi5wID0gdi5wIG9yIHswfQoKCQkJCWxvY2FsIGFkaXN0ID0gbWF0aC5hYnModlsxXSBhbmQgY3ggLSBzcHggb3IgY3kgLSBzcHkpCgkJCQlsb2NhbCBwcCA9IGFuaW1hLmNvbmRpdGlvbih2LnAsIGFsbG93ZWQgb3IgYWRpc3QgPCAoMTAgKiBEUEkpLCAtOCkgKiAuMzUgKyAwLjEKCQkJCXJlbmRlci5yZWN0YW5nbGUoc3B4LCBzcHksIHZbMV0gYW5kIDEgb3Igdls0XSwgdlsxXSBhbmQgdls0XSBvciAxLCBjb2xvcnMud2hpdGU6YWxwaGVuKHBwLCB0cnVlKSkKCQkJZW5kCgkJCWlmIGN0eC5ib3JkZXJbNV0gdGhlbgoJCQkJbG9jYWwgeGEsIHlhLCB4YiwgeWIgPSBjdHguYm9yZGVyWzFdLCBjdHguYm9yZGVyWzJdLCBjdHguYm9yZGVyWzNdLCBjdHguYm9yZGVyWzRdCgoJCQkJbG9jYWwgaW5zaWRlID0gaW5fYm91bmRzKHNlbGYueCwgc2VsZi55LCB4YSwgeWEsIHhiIC0gc2VsZi53ICogLjUgLSAxLCB5YiAtIHNlbGYuaCAqIC41IC0gMSkKCQkJCWxvY2FsIHAzID0gYW5pbWEuY29uZGl0aW9uKGN0eC5wcm9ncmVzc1szXSwgbm90IGluc2lkZSkKCQkJCXJlbmRlci5yZWN0X291dGxpbmUoeGEsIHlhLCB4YiAtIHhhLCB5YiAtIHlhLCBjb2xvcnMud2hpdGU6YWxwaGVuKHAzICogLjc1ICsgLjI1LCB0cnVlKSwgNCkKCQkJZW5kCgkJZW5kCgoJCXJlbmRlci5wb3BfYWxwaGEoKQoKCQktLQoJCWlmIGN0eC5hY3RpdmUgdGhlbgoJCQlsb2NhbCBmeCwgZnkgPSBwcmVmZXJbMV0gb3Igd3ggLyBEUEksIHByZWZlclsyXSBvciB3eSAvIERQSQoKCQkJLS0KCQkJbG9jYWwgbWluX3gsIG1pbl95ID0gKGN0eC5ib3JkZXJbMV0gLSBkdyAqIC41KSAvIERQSSwgKGN0eC5ib3JkZXJbMl0gLSBkaCAqIC41KSAvIERQSQoJCQlsb2NhbCBtYXhfeCwgbWF4X3kgPSAoY3R4LmJvcmRlclszXSAtIGR3ICogLjUpIC8gRFBJLCAoY3R4LmJvcmRlcls0XSAtIGRoICogLjUpIC8gRFBJCgoJCQlsb2NhbCB4LCB5ID0gbWF0aC5jbGFtcChmeCwgbWF0aC5tYXgobWluX3gsIDApLCBtYXRoLm1pbihtYXhfeCwgc3cgLSBzZWxmLncpKSwgbWF0aC5jbGFtcChmeSwgbWF0aC5tYXgobWluX3ksIDApLCBtYXRoLm1pbihtYXhfeSwgc2ggLSBzZWxmLmgpKQoJCQlzZWxmOnNldF9wb3NpdGlvbih4LCB5KQoKCQkJaWYgY3R4Lm9uX2FjdGl2ZSB0aGVuIGN0eC5vbl9hY3RpdmUoc2VsZiwgY3R4LCBmaW4pIGVuZAoJCWVuZAoJZW5kKQoKCgktLQoJZHJhZyA9IHsKCQluZXcgPSBhKGZ1bmN0aW9uICh3aWRnZXQsIHByb3BzKQoJCQl2YXJzLmRyYWdbd2lkZ2V0LmlkXSA9IHsKCQkJCXggPSBwdWkuc2xpZGVyKCJNSVNDIiwgIlNldHRpbmdzIiwgd2lkZ2V0LmlkIC4uIjp4IiwgMCwgMTAwMDAsICh3aWRnZXQueCAvIHN3KSAqIDEwMDAwKSwKCQkJCXkgPSBwdWkuc2xpZGVyKCJNSVNDIiwgIlNldHRpbmdzIiwgd2lkZ2V0LmlkIC4uIjp5IiwgMCwgMTAwMDAsICh3aWRnZXQueSAvIHNoKSAqIDEwMDAwKSwKCQkJfQoKCQkJdmFycy5kcmFnW3dpZGdldC5pZF0ueDpzZXRfdmlzaWJsZShmYWxzZSkKCQkJdmFycy5kcmFnW3dpZGdldC5pZF0ueTpzZXRfdmlzaWJsZShmYWxzZSkKCQkJdmFycy5kcmFnW3dpZGdldC5pZF0ueDpzZXRfY2FsbGJhY2soZnVuY3Rpb24gKHRoaXMpIHdpZGdldC54ID0gbWF0aC5yb3VuZCh0aGlzLnZhbHVlICogLjAwMDEgKiBzdykgZW5kLCB0cnVlKQoJCQl2YXJzLmRyYWdbd2lkZ2V0LmlkXS55OnNldF9jYWxsYmFjayhmdW5jdGlvbiAodGhpcykgd2lkZ2V0LnkgPSBtYXRoLnJvdW5kKHRoaXMudmFsdWUgKiAuMDAwMSAqIHNoKSBlbmQsIHRydWUpCgoJCQktLQoJCQlwcm9wcyA9IHR5cGUocHJvcHMpID09ICJ0YWJsZSIgYW5kIHByb3BzIG9yIHt9CgoJCQl3aWRnZXQuX19kcmFnID0gewoJCQkJbG9ja2VkID0gZmFsc2UsIGFjdGl2ZSA9IGZhbHNlLCBob3ZlcmVkID0gbmlsLCBhbGlnbmluZyA9IG5pbCwKCQkJCXByb2dyZXNzID0ge3swfSwgezB9LCB7MH19LAoKCQkJCWl4LCBpeSA9IHdpZGdldC54LCB3aWRnZXQueSwKCQkJCXB4LCBweSA9IG5pbCwgbmlsLAoKCQkJCWJvcmRlciA9IHByb3BzLmJvcmRlciBvciB7MCwgMCwgYXN3LCBhc2h9LAoJCQkJcnVsZXJzID0gcHJvcHMucnVsZXJzIG9yIHt9LAoKCQkJCW9uX3JlbGVhc2UgPSBwcm9wcy5vbl9yZWxlYXNlLCBvbl9oZWxkID0gcHJvcHMub25faGVsZCwgb25fYWN0aXZlID0gcHJvcHMub25fYWN0aXZlLAoKCQkJCWNvbmZpZyA9IHZhcnMuZHJhZ1t3aWRnZXQuaWRdLAoJCQkJd29yayA9IHByb2Nlc3MsCgkJCX0KCgkJCS0tCgkJCWNhbGxiYWNrc1siaHlzdGVyaWE6OnJlbmRlcl9kcGkiXTpzZXQoZnVuY3Rpb24gKG5ldykKCQkJCXZhcnMuZHJhZ1t3aWRnZXQuaWRdLng6c2V0KHZhcnMuZHJhZ1t3aWRnZXQuaWRdLngudmFsdWUpCgkJCQl2YXJzLmRyYWdbd2lkZ2V0LmlkXS55OnNldCh2YXJzLmRyYWdbd2lkZ2V0LmlkXS55LnZhbHVlKQoJCQllbmQpCgoJCQljYWxsYmFja3Muc2V0dXBfY29tbWFuZDpzZXQoZnVuY3Rpb24gKGNtZCkKCQkJCWlmIHB1aS5tZW51X29wZW4gYW5kICh3aWRnZXQuX19kcmFnLmhvdmVyZWQgb3Igd2lkZ2V0Ll9fZHJhZy5hY3RpdmUpIHRoZW4gY21kLmluX2F0dGFjayA9IDAgZW5kCgkJCWVuZCkKCQllbmQpCgl9CmVuZAoKbG9jYWwgd2lkZ2V0IGRvCglsb2NhbCBtdDsgbXQgPSB7CgkJdXBkYXRlID0gZnVuY3Rpb24gKHNlbGYpIHJldHVybiAxIGVuZCwKCQlwYWludCA9IGZ1bmN0aW9uIChzZWxmLCB4LCB5LCB3LCBoKSBlbmQsCgoJCXNldF9wb3NpdGlvbiA9IGZ1bmN0aW9uIChzZWxmLCB4LCB5KQoJCQlpZiBzZWxmLl9fZHJhZyB0aGVuCgkJCQlpZiB4IHRoZW4KCQkJCQlzZWxmLl9fZHJhZy5jb25maWcueDpzZXQoIHggLyBzdyAqIDEwMDAwICkKCQkJCQlzZWxmLnggPSB4CgkJCQllbmQKCQkJCWlmIHkgdGhlbgoJCQkJCXNlbGYuX19kcmFnLmNvbmZpZy55OnNldCggeSAvIHNoICogMTAwMDAgKQoJCQkJCXNlbGYueSA9IHkKCQkJCWVuZAoJCQllbHNlCgkJCQlzZWxmLngsIHNlbGYueSA9IHggb3Igc2VsZi54LCB5IG9yIHNlbGYueQoJCQllbmQKCQllbmQsCgkJZ2V0X3Bvc2l0aW9uID0gZnVuY3Rpb24gKHNlbGYpCgkJCWxvY2FsIGN0eCA9IHNlbGYuX19kcmFnIGFuZCBzZWxmLl9fZHJhZy5jb25maWcKCQkJaWYgbm90IGN0eCB0aGVuIHJldHVybiBzZWxmLngsIHNlbGYueSBlbmQKCgkJCXJldHVybiBjdHgueC52YWx1ZSAqIC4wMDAxICogc3csIGN0eC55LnZhbHVlICogLjAwMDEgKiBzaAoJCWVuZCwKCgkJX19jYWxsID0gYShmdW5jdGlvbiAoc2VsZikKCQkJbG9jYWwgX19saXN0LCBfX2RyYWcgPSBzZWxmLl9fbGlzdCwgc2VsZi5fX2RyYWcKCQkJaWYgX19saXN0IHRoZW4KCQkJCV9fbGlzdC5pdGVtcywgX19saXN0LmFjdGl2ZSA9IF9fbGlzdC5jb2xsZWN0KCksIDAKCQkJCWZvciBpID0gMSwgI19fbGlzdC5pdGVtcyBkbwoJCQkJCWlmIF9fbGlzdC5pdGVtc1tpXS5hY3RpdmUgdGhlbiBfX2xpc3QuYWN0aXZlID0gX19saXN0LmFjdGl2ZSArIDEgZW5kCgkJCQllbmQKCQkJZW5kCgkJCXNlbGYuYWxwaGEgPSBzZWxmOnVwZGF0ZSgpCgoJCQlyZW5kZXIucHVzaF9hbHBoYShzZWxmLmFscGhhKQoKCQkJaWYgc2VsZi5hbHBoYSA+IDAgdGhlbgoJCQkJaWYgX19kcmFnIHRoZW4gX19kcmFnLndvcmsoc2VsZikgZW5kCgkJCQlpZiBfX2xpc3QgdGhlbiBtdC50cmF2ZXJzZShzZWxmKSBlbmQKCQkJCXNlbGY6cGFpbnQoc2VsZi54LCBzZWxmLnksIHNlbGYudywgc2VsZi5oKQoJCQllbmQKCgkJCXJlbmRlci5wb3BfYWxwaGEoKQoJCWVuZCksCgoJCWVubGlzdCA9IGZ1bmN0aW9uIChzZWxmLCBjb2xsZWN0b3IsIHBhaW50ZXIpCgkJCXNlbGYuX19saXN0ID0gewoJCQkJaXRlbXMgPSB7fSwgcHJvZ3Jlc3MgPSBzZXRtZXRhdGFibGUoe30sIHsgX19tb2RlID0gImsiIH0pLAoJCQkJbG9uZ2VzdCA9IDAsIGFjdGl2ZSA9IDAsIG1pbndpZHRoID0gc2VsZi53LAoJCQkJY29sbGVjdCA9IGNvbGxlY3RvciwgcGFpbnQgPSBwYWludGVyLAoJCQl9CgkJZW5kLAoJCXRyYXZlcnNlID0gZnVuY3Rpb24gKHNlbGYpCgkJCWxvY2FsIGN0eCwgb2Zmc2V0ID0gc2VsZi5fX2xpc3QsIDAKCQkJbG9jYWwgbHgsIGx5ID0gMCwgMAoJCQljdHguYWN0aXZlLCBjdHgubG9uZ2VzdCA9IDAsIDAKCgkJCWZvciBpID0gMSwgI2N0eC5pdGVtcyBkbwoJCQkJbG9jYWwgdiA9IGN0eC5pdGVtc1tpXQoJCQkJbG9jYWwgaWQgPSB2Lm5hbWUgb3IgaQoJCQkJY3R4LnByb2dyZXNzW2lkXSA9IGN0eC5wcm9ncmVzc1tpZF0gb3IgezB9CgkJCQlsb2NhbCBwID0gYW5pbWEuY29uZGl0aW9uKGN0eC5wcm9ncmVzc1tpZF0sIHYuYWN0aXZlKQoKCQkJCWlmIHAgPiAwIHRoZW4KCQkJCQlyZW5kZXIucHVzaF9hbHBoYShwKQoJCQkJCWx4LCBseSA9IGN0eC5wYWludChzZWxmLCB2LCBvZmZzZXQsIHApCgkJCQkJcmVuZGVyLnBvcF9hbHBoYSgpCgoJCQkJCWN0eC5hY3RpdmUsIG9mZnNldCA9IGN0eC5hY3RpdmUgKyAxLCBvZmZzZXQgKyAobHkgKiBwKQoJCQkJCWN0eC5sb25nZXN0ID0gbWF0aC5tYXgoY3R4Lmxvbmdlc3QsIGx4KQoJCQkJZW5kCgkJCWVuZAoKCQkJc2VsZi53ID0gYW5pbWEubGVycChzZWxmLncsIG1hdGgubWF4KGN0eC5sb25nZXN0LCBjdHgubWlud2lkdGgpLCAxMCwgLjUpCgkJZW5kLAoKCQlsb2NrID0gZnVuY3Rpb24gKHNlbGYsIGIpCgkJCWlmIG5vdCBzZWxmLl9fZHJhZyB0aGVuIHJldHVybiBlbmQKCQkJc2VsZi5fX2RyYWcubG9ja2VkID0gYiBhbmQgdHJ1ZSBvciBmYWxzZQoJCWVuZCwKCX0JbXQuX19pbmRleCA9IG10CgoKCXdpZGdldCA9IHsKCQluZXcgPSBmdW5jdGlvbiAoaWQsIHgsIHksIHcsIGgsIGRyYWdnYWJsZSkKCQkJbG9jYWwgc2VsZiA9IHsKCQkJCWlkID0gaWQsIHR5cGUgPSAwLAoJCQkJeCA9IHggb3IgMCwgeSA9IHkgb3IgMCwgdyA9IHcgb3IgMCwgaCA9IGggb3IgMCwKCQkJCWFscGhhID0gMCwgcHJvZ3Jlc3MgPSB7MH0KCQkJfQoKCQkJaWYgZHJhZ2dhYmxlIHRoZW4gZHJhZy5uZXcoc2VsZiwgZHJhZ2dhYmxlKSBlbmQKCgkJCXJldHVybiBzZXRtZXRhdGFibGUoc2VsZiwgbXQpCgkJZW5kLAoJfQplbmQKCi0tICNlbmRyZWdpb24KCi0tICNlbmRyZWdpb24KLS0KCi0tCi0tICNyZWdpb24gOiBDcm9zc2hhaXIKCmxvY2FsIGNyb3NzaGFpciA9IHdpZGdldC5uZXcoImNyb3NzaGFpciIsIHNjLnggLSAyNCwgc2MueSArIDMyLCA0OCwgMTYsIHsKCWJvcmRlciA9IHsgYXNjLngsIGFzYy55IC0gMTAwLCBhc2MueCwgYXNjLnkgKyAxMDAgfSwKCXJ1bGVycyA9IHsKCQl7IHRydWUsIGFzYy54LCBhc2MueSAtIDEwMCwgMjAwIH0sCgl9Cn0pCgpjcm9zc2hhaXIuZGF0YSwgY3Jvc3NoYWlyLml0ZW1zID0gewoJc2NvcGUgPSB7CgkJc2lkZSA9IDAsCgkJdGFyZ2V0ID0gMCwKCQlyZXNlcnZlZCA9IGZhbHNlLAoJfQp9LCB7fQoKLS0gI3JlZ2lvbiAtIEluZGljYXRvcnMKCmNyb3NzaGFpci5lbnVtZXJhdGUgPSBmdW5jdGlvbiAoc2VsZikKCWxvY2FsIHgsIHkgPSBzYy54LCBzZWxmLnkKCWxvY2FsIG0gPSBhbmltYS5jb25kaXRpb24oImNyb3NzaGFpcjo6eXBvc2l0aW9uIiwgc2VsZi55ID4gc2MueSwgMykgKiAyIC0gMQoKCWxvY2FsIHNpZGUgPSBjcm9zc2hhaXIuZGF0YS5zY29wZS5zaWRlCglsb2NhbCBvZmZzZXQgPSBzaWRlICogMC41ICsgMC41CgoJZm9yIGksIHYgaW4gaXBhaXJzKHNlbGYuaXRlbXMpIGRvCgkJdlswXSA9IHZbMF0gb3IgezB9CgkJcmVuZGVyLnB1c2hfYWxwaGEodlsxXSkKCQlsb2NhbCBzLCB3LCBoID0gdlsyXSh2LCB4ICsgdi54LCB5KQoJCXJlbmRlci5wb3BfYWxwaGEoKQoKCQl2WzFdID0gYW5pbWEuY29uZGl0aW9uKHZbMF0sIHMsIC04KQoKCQl2LnggPSB3ICogLW9mZnNldCAtIChzaWRlICogMTYpCgkJeSA9IHkgKyBoICogdlsxXSAqIG0KCWVuZAoKCXJldHVybiBtYXRoLmFicyh5IC0gc2VsZi55KQplbmQKCmNyb3NzaGFpci5pdGVtcyA9IHsKCXsJIC0tIGxvZ28gY2xhc3NpYwoJCTAsIHggPSAwLCBmdW5jdGlvbiAoc2VsZiwgeCwgeSkKCQkJaWYgc2VsZlsxXSA+IDAgdGhlbgoJCQkJbG9jYWwgYnV0dGVyZmx5ID0gYW5pbWEuY29uZGl0aW9uKHNlbGYuYmZseSwgdmFycy52aXN1YWxzLmNyb3NzaGFpci5sb2dvLnZhbHVlLCAtOCkKCQkJCWlmIGJ1dHRlcmZseSA+IDAgdGhlbgoJCQkJCXJlbmRlci50ZXh0dXJlKHRleHR1cmVzLmJ1dHRlcmZseV9zLCB4IC0gMywgeSAtIDEwLCAzMiwgMzIsIGNvbG9ycy5hY2NlbnQ6YWxwaGVuKDI1NSAqIGJ1dHRlcmZseSksICJmIikKCQkJCWVuZAoKCQkJCXNlbGYuZGVzeW5jID0gYW5pbWEubGVycChzZWxmLmRlc3luYywgbWF0aC5jbGFtcCggMS41IC0gbWF0aC5hYnMoYWRhdGEuZ2V0X292ZXJsYXAoKSksIDAsIDEgKSwgNCApCgoJCQkJcmVuZGVyLnJlY3RhbmdsZSh4LCB5ICsgMTEsIChfQVpBWkkgYW5kIDY2IG9yIDQ4KSArIDIsIDQsIGNvbG9ycy5ibGFjaywgMikKCQkJCXJlbmRlci5ncmFkaWVudCh4ICsgMSwgeSArIDEyLCBzZWxmLmRlc3luYyAqIChfQVpBWkkgYW5kIDY2IG9yIDQ4KSwgMiwgY29sb3JzLmFjY2VudDphbHBoZW4oNjQpLCBjb2xvcnMuYWNjZW50LCB0cnVlKQoJCQkJcmVuZGVyLmxvZ28oeCwgeSkKCQkJZW5kCgoJCQlyZXR1cm4gdmFycy52aXN1YWxzLmNyb3NzaGFpci5zdHlsZS52YWx1ZSA9PSAiQ2xhc3NpYyIsIF9BWkFaSSBhbmQgNjYgb3IgNDgsIDE3CgkJZW5kLCBiZmx5ID0gezB9LCBkZXN5bmMgPSAwLAoJfSwgeyAtLSBsb2dvIG1pbmkKCQkwLCB4ID0gMCwgZnVuY3Rpb24gKHNlbGYsIHgsIHkpCgkJCWxvY2FsIGJmbHkgPSB2YXJzLnZpc3VhbHMuY3Jvc3NoYWlyLmxvZ28udmFsdWUKCQkJbG9jYWwgdCA9ICJIWVNURVJJQSIgLi4gKChub3QgYmZseSBhbmQgX0xFVkVMID4gMSkgYW5kIGNvbG9ycy5oZXhzIC4uIHN0cmluZy5mb3JtYXQoIiUwMngiLCByZW5kZXIuZ2V0X2FscGhhKCkgKiAyNTUpIC4uIHN0cmluZy51cHBlcihoeXN0ZXJpYS5idWlsZCkgb3IgIiIpCgkJCWxvY2FsIHR3LCB0aCA9IHJlbmRlci5tZWFzdXJlX3RleHQoIi0iLCB0KQoJCQlpZiB2YXJzLnZpc3VhbHMuY3Jvc3NoYWlyLmxvZ28udmFsdWUgdGhlbiB0dyA9IHR3ICsgNyBlbmQKCgkJCWlmIHNlbGZbMV0gPiAwIHRoZW4KCQkJCXNlbGYuZGVzeW5jID0gYW5pbWEubGVycChzZWxmLmRlc3luYywgbWF0aC5jbGFtcCggMS41IC0gbWF0aC5hYnMoYWRhdGEuZ2V0X292ZXJsYXAoKSksIDAsIDEgKSwgNCApCgoJCQkJbG9jYWwgbGVuZ3RoID0gdHcgKiAwLjUgKiBzZWxmLmRlc3luYwoJCQkJcmVuZGVyLmdyYWRpZW50KHggKyAyICsgdHcgKiAwLjUgLSBsZW5ndGgsIHkgKyA5LCBsZW5ndGgsIDEsIGNvbG9ycy5hY2NlbnQ6YWxwaGVuKDApLCBjb2xvcnMuYWNjZW50LCB0cnVlKQoJCQkJcmVuZGVyLmdyYWRpZW50KHggKyAxICsgdHcgKiAwLjUsIHkgKyA5LCBsZW5ndGgsIDEsIGNvbG9ycy5hY2NlbnQsIGNvbG9ycy5hY2NlbnQ6YWxwaGVuKDApLCB0cnVlKQoKCQkJCXJlbmRlci50ZXh0KHgsIHksIGNvbG9ycy50ZXh0LCAiLSIsIG5pbCwgdCkKCQkJCWlmIHZhcnMudmlzdWFscy5jcm9zc2hhaXIubG9nby52YWx1ZSB0aGVuCgkJCQkJcmVuZGVyLnRleHR1cmUodGV4dHVyZXMubWluaV9iZmx5LCB4ICsgdHcgLSA2LCB5ICsgMSwgOSwgOSwgY29sb3JzLmFjY2VudCkKCQkJCWVuZAoJCQllbmQKCgkJCXJldHVybiB2YXJzLnZpc3VhbHMuY3Jvc3NoYWlyLnN0eWxlLnZhbHVlID09ICJNaW5pIiwgdHcsIHRoICsgMwoJCWVuZCwgZGVzeW5jID0gMCwKIAl9LCB7IC0tIGR0CgkJMCwgeCA9IDAsIGZ1bmN0aW9uIChzZWxmLCB4LCB5KQoJCQlsb2NhbCBjb25kaXRpb24gPSByZWZzLnJhZ2UuYWltYm90LmRvdWJsZV90YXBbMV0udmFsdWUgYW5kIHJlZnMucmFnZS5haW1ib3QuZG91YmxlX3RhcFsxXS5ob3RrZXk6Z2V0KCkKCQkJLS0gbG9jYWwgZXh0ZW5kZWQgPSB2YXJzLnJhZ2Uuc2hpZnRleHQudmFsdWUgYW5kIHZhcnMucmFnZS5zaGlmdGV4dC5ob3RrZXk6Z2V0KCkKCgkJCWlmIHNlbGZbMV0gPiAwIHRoZW4KCQkJCWxvY2FsIGNoYXJnZSwgZHQgPSBhZGF0YS5nZXRfdGlja2Jhc2Vfc2hpZnRpbmcoKSwgYWRhdGEuZ2V0X2RvdWJsZV90YXAoKQoJCQkJbG9jYWwgYWN0aXZlID0gYW5pbWEuY29uZGl0aW9uKHNlbGYuZmQsIG5vdCByZWZzLnJhZ2Uub3RoZXIuZHVjazpnZXQoKSwgLTgpCgoJCQkJbG9jYWwgcHJvZ3Jlc3MgPSBjb2xvcnMuaGV4cyAuLiBzdHJpbmcuZm9ybWF0KCIlMDJ4IiwgcmVuZGVyLmdldF9hbHBoYSgpICogMjU1KSAuLiBzdHJpbmcuaW5zZXJ0KCJsbGxsbGwiLCBzdHJpbmcuZm9ybWF0KCJcYUZGRkZGRiUwMngiLCAoZHQgYW5kIDk2IG9yIDY0KSAqIHJlbmRlci5nZXRfYWxwaGEoKSksIG1hdGgubWluKGNoYXJnZSAqIDAuNSwgNikpCgkJCQlsb2NhbCB0ZXh0ID0gIkRUICIuLiBwcm9ncmVzcwoKCQkJCXJlbmRlci50ZXh0KHgsIHksIGNvbG9ycy50ZXh0OmFscGhlbihtYXRoLmxlcnAoOTYsIDI1NSwgYWN0aXZlKSksICItIiwgbmlsLCB0ZXh0KQoJCQllbmQKCgkJCXJldHVybiBjb25kaXRpb24sIHJlbmRlci5tZWFzdXJlX3RleHQoIi0iLCAiRFQgbGxsbGxsIikKCQllbmQsIGZkID0gezB9LAoJfSwgeyAtLSBkYW1hZ2UKCQkwLCB4ID0gMCwgZnVuY3Rpb24gKHNlbGYsIHgsIHkpCgkJCWxvY2FsIGNvbmRpdGlvbiA9IG5vdCB2YXJzLnZpc3VhbHMuZGFtYWdlLnZhbHVlIGFuZCAocmVmcy5yYWdlLmFpbWJvdC5kYW1hZ2Vfb3ZyWzFdLnZhbHVlIGFuZCByZWZzLnJhZ2UuYWltYm90LmRhbWFnZV9vdnJbMV0uaG90a2V5OmdldCgpKQoJCQlsb2NhbCB0ID0gIkRNRyIKCgkJCWlmIHNlbGZbMV0gPiAwIHRoZW4KCQkJCXJlbmRlci50ZXh0KHgsIHksIGNvbG9ycy50ZXh0LCAiLSIsIG5pbCwgdCkKCQkJZW5kCgoJCQlyZXR1cm4gY29uZGl0aW9uLCByZW5kZXIubWVhc3VyZV90ZXh0KCItIiwgdCkKCQllbmQsCgl9LCB7IC0tIHBlZWsKCQkwLCB4ID0gMCwgZnVuY3Rpb24gKHNlbGYsIHgsIHkpCgkJCWxvY2FsIGNvbmRpdGlvbiA9IHJlZnMucmFnZS5vdGhlci5wZWVrLnZhbHVlIGFuZCByZWZzLnJhZ2Uub3RoZXIucGVlay5ob3RrZXk6Z2V0KCkKCQkJbG9jYWwgZHQgPSBhZGF0YS5nZXRfZG91YmxlX3RhcCgpCgoJCQlsb2NhbCB0ID0gIlBBIi4uKGR0IGFuZCAiKyIgb3IgIiIpCgoJCQlpZiBzZWxmWzFdID4gMCB0aGVuCgkJCQlsb2NhbCBpZGVhbCA9IGFuaW1hLmNvbmRpdGlvbihzZWxmLmlkZWFsLCBkdCwgLTgpCgkJCQlyZW5kZXIudGV4dCh4LCB5LCBjb2xvcnMudGV4dDpsZXJwKGNvbG9ycy5hY2NlbnQsIGlkZWFsKSwgIi0iLCBuaWwsIHQpCgkJCWVuZAoKCQkJcmV0dXJuIGNvbmRpdGlvbiwgcmVuZGVyLm1lYXN1cmVfdGV4dCgiLSIsIHQpCgkJZW5kLCBpZGVhbCA9IHswfQoJfSwgeyAtLSB0cAoJCTAsIHggPSAwLCBmdW5jdGlvbiAoc2VsZiwgeCwgeSkKCQkJbG9jYWwgYWN0aXZlLCBtb2RlID0gdmFycy5yYWdlLnRlbGVwb3J0Lm9uLmhvdGtleTpnZXQoKQoJCQlsb2NhbCBjb25kaXRpb24gPSB2YXJzLnJhZ2UudGVsZXBvcnQub24udmFsdWUgYW5kIGFjdGl2ZSBhbmQgbW9kZSB+PSAwCgoJCQlsb2NhbCB0ID0gIlRQIgoKCQkJaWYgc2VsZlsxXSA+IDAgdGhlbgoJCQkJbG9jYWwgaWRlYWwgPSBhbmltYS5jb25kaXRpb24oc2VsZi5pZGVhbCwgcmFnZS50ZWxlcG9ydC5hY3RpdmUsIC04KQoJCQkJcmVuZGVyLnRleHQoeCwgeSwgY29sb3JzLnRleHQ6bGVycChjb2xvcnMuYWNjZW50LCBpZGVhbCksICItIiwgbmlsLCB0KQoJCQllbmQKCgkJCXJldHVybiBjb25kaXRpb24sIHJlbmRlci5tZWFzdXJlX3RleHQoIi0iLCB0KQoJCWVuZCwgaWRlYWwgPSB7MH0KCX0sIHsgLS0gb3MKCQkwLCB4ID0gMCwgZnVuY3Rpb24gKHNlbGYsIHgsIHkpCgkJCWxvY2FsIGNvbmRpdGlvbiA9IHJlZnMuYWEub3RoZXIub25zaG90LnZhbHVlIGFuZCByZWZzLmFhLm90aGVyLm9uc2hvdDpnZXRfaG90a2V5KCkKCQkJbG9jYWwgdCA9ICJPUyIKCgkJCWlmIHNlbGZbMV0gPiAwIHRoZW4KCQkJCWxvY2FsIGlzX2R0ID0gcmVmcy5yYWdlLmFpbWJvdC5kb3VibGVfdGFwWzFdLnZhbHVlIGFuZCByZWZzLnJhZ2UuYWltYm90LmRvdWJsZV90YXBbMV06Z2V0X2hvdGtleSgpCgkJCQlsb2NhbCBpbmFjdGl2ZSA9IGFuaW1hLmNvbmRpdGlvbihzZWxmLmExLCBub3QgaXNfZHQsIDgpCgkJCQlyZW5kZXIudGV4dCh4LCB5LCBjb2xvcnMudGV4dDphbHBoZW4obWF0aC5sZXJwKDk2LCAyNTUsIGluYWN0aXZlKSksICItIiwgbmlsLCB0KQoJCQllbmQKCgkJCXJldHVybiBjb25kaXRpb24sIHJlbmRlci5tZWFzdXJlX3RleHQoIi0iLCB0KQoJCWVuZCwgYTEgPSB7MH0sCgl9LCB7IC0tIGJhaW0KCQkwLCB4ID0gMCwgZnVuY3Rpb24gKHNlbGYsIHgsIHkpCgkJCWxvY2FsIGNvbmRpdGlvbiA9IHJlZnMucmFnZS5haW1ib3QuZm9yY2VfYmFpbTpnZXQoKQoKCQkJbG9jYWwgdCA9ICJCQSIKCgkJCWlmIHNlbGZbMV0gPiAwIHRoZW4KCQkJCXJlbmRlci50ZXh0KHgsIHksIGNvbG9ycy50ZXh0LCAiLSIsIG5pbCwgdCkKCQkJZW5kCgoJCQlyZXR1cm4gY29uZGl0aW9uLCByZW5kZXIubWVhc3VyZV90ZXh0KCItIiwgdCkKCQllbmQsCgl9LCB7IC0tIHNwCgkJMCwgeCA9IDAsIGZ1bmN0aW9uIChzZWxmLCB4LCB5KQoJCQlsb2NhbCBjb25kaXRpb24gPSByZWZzLnJhZ2UuYWltYm90LmZvcmNlX3NwOmdldCgpCgoJCQlsb2NhbCB0ID0gIlNQIgoKCQkJaWYgc2VsZlsxXSA+IDAgdGhlbgoJCQkJcmVuZGVyLnRleHQoeCwgeSwgY29sb3JzLnRleHQsICItIiwgbmlsLCB0KQoJCQllbmQKCgkJCXJldHVybiBjb25kaXRpb24sIHJlbmRlci5tZWFzdXJlX3RleHQoIi0iLCB0KQoJCWVuZCwKCX0sIHsgLS0gZnMKCQkwLCB4ID0gMCwgZnVuY3Rpb24gKHNlbGYsIHgsIHkpCgkJCWxvY2FsIGNvbmRpdGlvbiA9IHJlZnMuYWEuYW5nbGVzLmZyZWVzdGFuZC52YWx1ZSBhbmQgcmVmcy5hYS5hbmdsZXMuZnJlZXN0YW5kOmdldF9ob3RrZXkoKQoKCQkJbG9jYWwgdCA9ICJGUyIKCgkJCWlmIHNlbGZbMV0gPiAwIHRoZW4KCQkJCXJlbmRlci50ZXh0KHgsIHksIGNvbG9ycy50ZXh0LCAiLSIsIG5pbCwgdCkKCQkJZW5kCgoJCQlyZXR1cm4gY29uZGl0aW9uLCByZW5kZXIubWVhc3VyZV90ZXh0KCItIiwgdCkKCQllbmQsCgl9LCB7IC0tIHBpbmcKCQkwLCB4ID0gMCwgZnVuY3Rpb24gKHNlbGYsIHgsIHkpCgkJCWxvY2FsIGhrYSwgaGt0ID0gcmVmcy5taXNjLnBpbmdfc3Bpa2UuaG90a2V5OmdldCgpCgkJCWxvY2FsIGNvbmRpdGlvbiA9IHJlZnMubWlzYy5waW5nX3NwaWtlLnZhbHVlIGFuZCBoa2EgYW5kIGhrdCB+PSAwCgoJCQlsb2NhbCB0ID0gIlBTIgoKCQkJaWYgc2VsZlsxXSA+IDAgdGhlbgoJCQkJcmVuZGVyLnRleHQoeCwgeSwgY29sb3JzLnRleHQsICItIiwgbmlsLCB0KQoJCQllbmQKCgkJCXJldHVybiBjb25kaXRpb24sIHJlbmRlci5tZWFzdXJlX3RleHQoIi0iLCB0KQoJCWVuZCwKCX0sIHsgLS0gZmQKCQkwLCB4ID0gMCwgZnVuY3Rpb24gKHNlbGYsIHgsIHkpCgkJCWxvY2FsIGNvbmRpdGlvbiA9IHJlZnMucmFnZS5vdGhlci5kdWNrOmdldCgpCgoJCQlsb2NhbCB0ID0gIkZEIgoKCQkJaWYgc2VsZlsxXSA+IDAgdGhlbgoJCQkJbG9jYWwgcHJvZ3Jlc3MgPSBteS52YWxpZCBhbmQgZW50aXR5LmdldF9wcm9wKG15LmVudGl0eSwgIm1fZmxEdWNrQW1vdW50Iikgb3IgMAoJCQkJcmVuZGVyLnRleHQoeCwgeSwgY29sb3JzLnRleHQ6bGVycChjb2xvcnMuYWNjZW50LCBwcm9ncmVzcyksICItIiwgbmlsLCB0KQoJCQllbmQKCgkJCXJldHVybiBjb25kaXRpb24sIHJlbmRlci5tZWFzdXJlX3RleHQoIi0iLCB0KQoJCWVuZCwKCX0sCn0KCi0tICNlbmRyZWdpb24KCi0tICNyZWdpb24gLSBNYWluCgpjcm9zc2hhaXIudXBkYXRlID0gZnVuY3Rpb24gKHNlbGYpCglpZiBteS52YWxpZCBhbmQgZW50aXR5LmdldF9wcm9wKG15LmVudGl0eSwgIm1fYklzU2NvcGVkIikgPT0gMSB0aGVuCgkJaWYgbm90IHNlbGYuZGF0YS5zY29wZS5yZXNlcnZlZCBhbmQgbXkuc2lkZSB+PSAwIHRoZW4KCQkJc2VsZi5kYXRhLnNjb3BlLnRhcmdldCwgc2VsZi5kYXRhLnNjb3BlLnJlc2VydmVkID0gLW15LnNpZGUsIHRydWUKCQllbmQKCWVsc2UKCQlzZWxmLmRhdGEuc2NvcGUudGFyZ2V0LCBzZWxmLmRhdGEuc2NvcGUucmVzZXJ2ZWQgPSAwLCBmYWxzZQoJZW5kCgoJc2VsZi5kYXRhLnNjb3BlLnNpZGUgPSBhbmltYS5sZXJwKGNyb3NzaGFpci5kYXRhLnNjb3BlLnNpZGUsIGNyb3NzaGFpci5kYXRhLnNjb3BlLnRhcmdldCwgMTIpCgoJcmV0dXJuIGFuaW1hLmNvbmRpdGlvbihjcm9zc2hhaXIucHJvZ3Jlc3MsIHZhcnMudmlzdWFscy5jcm9zc2hhaXIub24udmFsdWUgYW5kIG15LnZhbGlkIGFuZCBub3QgbXkuaW5fc2NvcmUpCmVuZAoKY3Jvc3NoYWlyLnBhaW50ID0gZnVuY3Rpb24gKHNlbGYsIHgsIHksIHcsIGgpCgljcm9zc2hhaXI6ZW51bWVyYXRlKCkKZW5kCgotLSAjZW5kcmVnaW9uCgotLSAjZW5kcmVnaW9uCi0tCgotLQotLSAjcmVnaW9uIDogSFVECgpsb2NhbCBodWQgPSB7fQoKLS0gI3JlZ2lvbiAtIFdhdGVybWFyawoKaHVkLndhdGVybWFyayA9IHdpZGdldC5uZXcoIndhdGVybWFyayIsIHN3IC0gMjQsIDI0LCAxNjAsIDI0LCB7CglydWxlcnMgPSB7CgkJeyB0cnVlLCBhc2MueCwgMCwgYXNoIH0sCgkJeyBmYWxzZSwgMCwgYXNoIC0gMzIsIGFzdyB9LAoJCXsgZmFsc2UsIDAsIDMyLCBhc3cgfSwKCX0sCglvbl9yZWxlYXNlID0gZnVuY3Rpb24gKHNlbGYsIGN0eCkKCQlsb2NhbCBwYXJ0aXRpb24gPSBzdyAvIDMKCQlsb2NhbCBwb3MgPSBzZWxmLnggKyBzZWxmLncgKiAuNQoKCQlsb2NhbCBhbGlnbiA9IG1hdGguZmxvb3IocG9zIC8gcGFydGl0aW9uKQoJCWlmIGFsaWduID09IHNlbGYuYWxpZ24gdGhlbiByZXR1cm4gZW5kCgkJc2VsZi5hbGlnbiA9IGFsaWduCgoJCWlmIHNlbGYuYWxpZ24gPT0gMSB0aGVuCgkJCXNlbGY6c2V0X3Bvc2l0aW9uKHBvcykKCQkJc2VsZi54ID0gc2VsZi54IC0gc2VsZi53ICogLjUKCQllbHNlaWYgc2VsZi5hbGlnbiA9PSAyIHRoZW4KCQkJc2VsZjpzZXRfcG9zaXRpb24oc2VsZi54ICsgc2VsZi53KQoJCQlzZWxmLnggPSBzZWxmLnggLSBzZWxmLncKCQllbmQKCgkJY3R4LmNvbmZpZy5hOnNldChhbGlnbikKCWVuZCwKCW9uX2hlbGQgPSBmdW5jdGlvbiAoc2VsZiwgY3R4KQoJCXNlbGYuYWxpZ24gPSAwCgkJY3R4LmNvbmZpZy5hOnNldCgwKQoJZW5kLAp9KQoKaHVkLndhdGVybWFyay5hbGlnbiwgaHVkLndhdGVybWFyay5sb2dvcCwgaHVkLndhdGVybWFyay5sb2dvID0gMiwgezB9LCAwCmh1ZC53YXRlcm1hcmsuX19kcmFnLmNvbmZpZy5hID0gcHVpLnNsaWRlcigiTUlTQyIsICJTZXR0aW5ncyIsICJ3YXRlcm1hcms6YWxpZ24iLCAwLCAyLCBodWQud2F0ZXJtYXJrLmFsaWduKQpodWQud2F0ZXJtYXJrLl9fZHJhZy5jb25maWcuYTpzZXRfdmlzaWJsZShmYWxzZSkKaHVkLndhdGVybWFyay5fX2RyYWcuY29uZmlnLmE6c2V0X2NhbGxiYWNrKGZ1bmN0aW9uICh0aGlzKQoJaHVkLndhdGVybWFyay5hbGlnbiA9IHRoaXMudmFsdWUKZW5kLCB0cnVlKQoKaHVkLndhdGVybWFyay5pdGVtcyA9IHsKCXsKCQkwLCBmdW5jdGlvbiAoc2VsZiwgeCwgeSkKCQkJbG9jYWwgY25hbWUgPSB2YXJzLnZpc3VhbHMud2F0ZXIubmFtZTpnZXQoKQoJCQlsb2NhbCB0ID0gc3RyaW5nLmZvcm1hdChoeXN0ZXJpYS5idWlsZCA9PSAic3RhYmxlIiBhbmQgIiVzIiBvciAiJXMgJXMlMDJ44oCUICVzIiwKCQkJCWNuYW1lIH49ICIiIGFuZCBjbmFtZSBvciBoeXN0ZXJpYS51c2VyLm5hbWUsIGNvbG9ycy5oZXhzLCByZW5kZXIuZ2V0X2FscGhhKCkgKiBzZWxmWzFdICogMjU1LCBoeXN0ZXJpYS5idWlsZCkKCQkJbG9jYWwgdHcsIHRoID0gcmVuZGVyLm1lYXN1cmVfdGV4dCgiIiwgdCkKCgkJCWlmIHNlbGZbMV0gPiAwIHRoZW4KCQkJCXJlbmRlci5ibHVyKHgsIHkgKyAxLCB0dyArIDE2LCAyMiwgMSwgOCkKCQkJCXJlbmRlci5yZWN0YW5nbGUoeCwgeSArIDEsIHR3ICsgMTYsIDIyLCBjb2xvcnMucGFuZWwubDEsIDQpCgkJCQlyZW5kZXIudGV4dCh4ICsgOCwgeSArIDYsIGNvbG9ycy50ZXh0LCBuaWwsIG5pbCwgdCkKCQkJZW5kCgoJCQlyZXR1cm4gdHJ1ZSwgdHcgKyAxNgoJCWVuZCwge30KCX0sCgl7CgkJMCwgZnVuY3Rpb24gKHNlbGYsIHgsIHkpCgkJCWxvY2FsIGhvdXJzLCBtaW51dGVzID0gY2xpZW50LnN5c3RlbV90aW1lKCkKCQkJbG9jYWwgdGV4dCA9IHN0cmluZy5mb3JtYXQoIiUwMmQ6JTAyZCIsIGhvdXJzLCBtaW51dGVzKQoJCQlsb2NhbCB0dywgdGggPSByZW5kZXIubWVhc3VyZV90ZXh0KCIiLCB0ZXh0KQoKCQkJaWYgc2VsZlsxXSA+IDAgdGhlbgoJCQkJcmVuZGVyLmJsdXIoeCwgeSArIDEsIHR3ICsgMTYsIDIyLCAxLCA4KQoJCQkJcmVuZGVyLnJlY3RhbmdsZSh4LCB5ICsgMSwgdHcgKyAxNiwgMjIsIGNvbG9ycy5wYW5lbC5sMSwgNCkKCQkJCXJlbmRlci50ZXh0KHggKyA4LCB5ICsgNiwgY29sb3JzLnRleHQsIG5pbCwgbmlsLCB0ZXh0KQoJCQllbmQKCgkJCXJldHVybiB0cnVlLCB0dyArIDE2CgkJZW5kLCB7fQoJfSwKCXsKCQkwLCBmdW5jdGlvbiAoc2VsZiwgeCwgeSkKCQkJbG9jYWwgcGluZyA9IGNsaWVudC5sYXRlbmN5KCkgKiAxMDAwCgkJCWxvY2FsIHRleHQgPSBzdHJpbmcuZm9ybWF0KCIlZG1zIiwgcGluZykKCQkJbG9jYWwgdHcsIHRoID0gcmVuZGVyLm1lYXN1cmVfdGV4dCgiIiwgdGV4dCkKCgkJCWlmIHNlbGZbMV0gPiAwIHRoZW4KCQkJCXJlbmRlci5ibHVyKHgsIHkgKyAxLCB0dyArIDE2LCAyMiwgMSwgOCkKCQkJCXJlbmRlci5yZWN0YW5nbGUoeCwgeSArIDEsIHR3ICsgMTYsIDIyLCBjb2xvcnMucGFuZWwubDEsIDQpCgkJCQlyZW5kZXIudGV4dCh4ICsgOCwgeSArIDYsIGNvbG9ycy50ZXh0LCBuaWwsIG5pbCwgdGV4dCkKCQkJZW5kCgoJCQlyZXR1cm4gcGluZyA+IDUsIHR3ICsgMTYKCQllbmQsIHt9Cgl9LAp9CgpodWQud2F0ZXJtYXJrLmVudW1lcmF0ZSA9IGZ1bmN0aW9uIChzZWxmKQoJbG9jYWwgdG90YWwgPSBzZWxmLmxvZ28gKiAoKF9BWkFaSSBhbmQgODYgb3IgNjQpICsgNCkKCWZvciBpLCB2IGluIGlwYWlycyhzZWxmLml0ZW1zKSBkbwoJCXJlbmRlci5wdXNoX2FscGhhKHZbMV0pCgkJbG9jYWwgc3RhdGUsIGxlbmd0aCA9IHZbMl0odiwgc2VsZi54ICsgdG90YWwsIHNlbGYueSkKCQlyZW5kZXIucG9wX2FscGhhKCkKCgkJdlsxXSA9IGFuaW1hLmNvbmRpdGlvbih2WzNdLCBzdGF0ZSkKCgkJdG90YWwgPSB0b3RhbCArIChsZW5ndGggKyAyKSAqIHZbMV0KCWVuZAoJc2VsZi53ID0gYW5pbWEubGVycChzZWxmLncsIHRvdGFsLCBuaWwsIC41KQplbmQKCmh1ZC53YXRlcm1hcmsudXBkYXRlID0gZnVuY3Rpb24gKHNlbGYpCglsb2NhbCBjeCwgY3kgPSBzZWxmOmdldF9wb3NpdGlvbigpCgoJaWYgc2VsZi5hbGlnbiA9PSAyIHRoZW4KCQlzZWxmLnggPSBjeCAtIHNlbGYudyAqIHNlbGYuYWxwaGEKCWVsc2VpZiBzZWxmLmFsaWduID09IDEgdGhlbgoJCXNlbGYueCA9IGN4IC0gc2VsZi53ICogLjUKCWVuZAoKCXJldHVybiBhbmltYS5jb25kaXRpb24oc2VsZi5wcm9ncmVzcywgdmFycy52aXN1YWxzLndhdGVyLm9uLnZhbHVlLCAzKQplbmQKCmh1ZC53YXRlcm1hcmsucGFpbnQgPSBmdW5jdGlvbiAoc2VsZiwgeCwgeSwgdywgaCkKCXNlbGYubG9nbyA9IGFuaW1hLmNvbmRpdGlvbihzZWxmLmxvZ29wLCBub3QgdmFycy52aXN1YWxzLndhdGVyLmhpZGUudmFsdWUpCgoJaWYgc2VsZi5sb2dvID4gMCB0aGVuCgkJbG9jYWwgd2wgPSBfQVpBWkkgYW5kIDg2IG9yIDY0CgkJcmVuZGVyLnB1c2hfYWxwaGEoc2VsZi5sb2dvKQoJCXJlbmRlci5ibHVyKHgsIHksIHdsLCBoLCAxLCA4KQoJCXJlbmRlci5yb3VuZGVkX3NpZGVfdih4LCB5LCB3bCwgaCwgY29sb3JzLnBhbmVsLmcxLCA0KQoJCXJlbmRlci5yZWN0YW5nbGUoeCArIHdsLCB5LCAyLCBoLCBjb2xvcnMucGFuZWwuZzEpCgkJcmVuZGVyLmxvZ28oeCArIDgsIHkgKyA1KQoJCXJlbmRlci5lZGdlX3YoeCArIHdsLCB5LCAyNCkKCQlyZW5kZXIucG9wX2FscGhhKCkKCWVuZAoKCXNlbGY6ZW51bWVyYXRlKCkKZW5kCgotLSAjZW5kcmVnaW9uCgotLSAjcmVnaW9uIC0gRGFtYWdlIGluZGljYXRvcgoKaHVkLmRhbWFnZSA9IHdpZGdldC5uZXcoImRhbWFnZSIsIHNjLnggKyA0LCBzYy55ICsgNCwgNiwgNCwgewoJYm9yZGVyID0geyBhc2MueCAtIDQwLCBhc2MueSAtIDQwLCBhc2MueCArIDQwLCBhc2MueSArIDQwLCB0cnVlIH0KfSkKaHVkLmRhbWFnZS5kbWcgPSByZWZzLnJhZ2UuYWltYm90LmRhbWFnZS52YWx1ZQpodWQuZGFtYWdlLm92cl9hbHBoYSA9IDAKCmh1ZC5kYW1hZ2UudXBkYXRlID0gZnVuY3Rpb24gKHNlbGYpCglpZiBub3QgdmFycy52aXN1YWxzLmRhbWFnZS52YWx1ZSB0aGVuCgkJcmV0dXJuIGFuaW1hLmNvbmRpdGlvbihzZWxmLnByb2dyZXNzLCBmYWxzZSwgLTQpCgllbmQKCglsb2NhbCBvdmVycmlkZGVuID0gKHJlZnMucmFnZS5haW1ib3QuZGFtYWdlX292clsxXS52YWx1ZSBhbmQgcmVmcy5yYWdlLmFpbWJvdC5kYW1hZ2Vfb3ZyWzFdOmdldF9ob3RrZXkoKSkKCWxvY2FsIG1pbmltdW1fZGFtYWdlID0gb3ZlcnJpZGRlbiBhbmQgcmVmcy5yYWdlLmFpbWJvdC5kYW1hZ2Vfb3ZyWzJdLnZhbHVlIG9yIHJlZnMucmFnZS5haW1ib3QuZGFtYWdlLnZhbHVlCgoJc2VsZi5kbWcgPSBhbmltYS5sZXJwKHNlbGYuZG1nLCBtaW5pbXVtX2RhbWFnZSwgMTYpCglzZWxmLm92cl9hbHBoYSA9IGFuaW1hLmNvbmRpdGlvbigiaHVkOjpkYW1hZ2Uub3ZyX2FscGhhIiwgb3ZlcnJpZGRlbiwgLTgpCgoJbG9jYWwgd2VhcG9uX3QgPSBteS53ZWFwb24gYW5kIHdlYXBvbmRhdGEobXkud2VhcG9uKQoJbG9jYWwgd2VhcG9uX3ZhbGlkID0gd2VhcG9uX3QgYW5kIHdlYXBvbl90LndlYXBvbl90eXBlX2ludCB+PSA5IGFuZCB3ZWFwb25fdC53ZWFwb25fdHlwZV9pbnQgfj0gMAoKCXJldHVybiBhbmltYS5jb25kaXRpb24oc2VsZi5wcm9ncmVzcywgbXkudmFsaWQgYW5kICh3ZWFwb25fdmFsaWQgb3IgcHVpLm1lbnVfb3BlbikgYW5kIG5vdCBteS5pbl9zY29yZSBhbmQgZ2xvYmFscy5tYXBuYW1lKCksIC04KQplbmQKCmh1ZC5kYW1hZ2UucGFpbnQgPSBmdW5jdGlvbiAoc2VsZiwgeCwgeSwgdywgaCkKCWxvY2FsIGRtZyA9IG1hdGgucm91bmQoc2VsZi5kbWcpCglkbWcgPSBkbWcgPT0gMCBhbmQgIkEiIG9yIGRtZyA+IDEwMCBhbmQgKCIrIiAuLiAoZG1nIC0gMTAwKSkgb3IgdG9zdHJpbmcoZG1nKQoKCXNlbGYudywgc2VsZi5oID0gcmVuZGVyLm1lYXN1cmVfdGV4dCgiLSIsIGRtZykKCXNlbGYuaCwgc2VsZi53ID0gc2VsZi5oIC0gMywgc2VsZi53ICsgMQoKCXJlbmRlci50ZXh0KHggLSAxLCB5IC0gMiwgY29sb3JzLnRleHQ6YWxwaGVuKCBtYXRoLmxlcnAoOTYsIDI1NSwgc2VsZi5vdnJfYWxwaGEpICksICItIiwgbmlsLCBkbWcpCmVuZAoKLS0gI2VuZHJlZ2lvbgoKLS0gI3JlZ2lvbiAtIEFudGktYWltIGFycm93cwoKaHVkLmFycm93cyA9IHdpZGdldC5uZXcoImFycm93cyIsIHNjLnggLSAzMiwgc2MueSAtIDUsIDEwLCAxMCwgewoJYm9yZGVyID0geyBhc2MueCAtIDEyMCwgYXNjLnkgKyAxLCBhc2MueCAtIDEwLCBhc2MueSArIDEgfSwKCXJ1bGVycyA9IHsKCQl7IGZhbHNlLCBhc2MueCAtIDEyMCwgYXNjLnksIDExMCB9Cgl9Cn0pCgpodWQuYXJyb3dzLnVwZGF0ZSA9IGZ1bmN0aW9uIChzZWxmKQoJcmV0dXJuIGFuaW1hLmNvbmRpdGlvbihzZWxmLnByb2dyZXNzLCB2YXJzLnZpc3VhbHMuYXJyb3dzLnZhbHVlIGFuZCBteS5pbl9nYW1lIGFuZCBteS52YWxpZCkKZW5kCgpodWQuYXJyb3dzLnBhaW50ID0gZnVuY3Rpb24gKHNlbGYsIHgsIHksIHcsIGgpCglsb2NhbCBuZXV0cmFsID0gcHVpLm1lbnVfb3BlbiBhbmQgY29sb3JzLndoaXRlOmFscGhlbigxMjgpIG9yIGNvbG9ycy5udWxsCgoJbG9jYWwgbGVmdCA9IGFuaW1hLmNvbmRpdGlvbigiaHVkOjphcnJvd3MubGVmdCIsIGFudGlhaW0uZGF0YS5tYW51YWwgPT0gLTkwLCA2KQoJcmVuZGVyLnRleHR1cmUodGV4dHVyZXMubWFudWFsLCB4LCB5LCAxMCwgMTAsIG5ldXRyYWw6bGVycChjb2xvcnMuYWNjZW50LCBsZWZ0KSwgImYiKQoKCWxvY2FsIHJpZ2h0ID0gYW5pbWEuY29uZGl0aW9uKCJodWQ6OmFycm93cy5yaWdodCIsIGFudGlhaW0uZGF0YS5tYW51YWwgPT0gOTAsIDYpCglyZW5kZXIudGV4dHVyZSh0ZXh0dXJlcy5tYW51YWwsIHN3IC0geCArIDEsIHksIC0xMCwgMTAsIG5ldXRyYWw6bGVycChjb2xvcnMuYWNjZW50LCByaWdodCksICJmIikKZW5kCgotLSAjZW5kcmVnaW9uCgotLSAjcmVnaW9uIC0gU2xvd2Rvd24KCmh1ZC5zbG93ZG93biA9IHdpZGdldC5uZXcoInNsb3dkb3duIiwgc2MueCAtIDEyMCAqIDAuNSwgc2MueSAtIDE2MCwgMTIwLCAzMiwgewoJcnVsZXJzID0gewoJCXsgdHJ1ZSwgYXNjLngsIDAsIGFzaCB9LAoJfQp9KQpodWQuc2xvd2Rvd24uc3BlZWQgPSAwLjUKCmh1ZC5zbG93ZG93bi51cGRhdGUgPSBmdW5jdGlvbiAoc2VsZikKCWlmIG5vdCB2YXJzLnZpc3VhbHMuc2xvd2Rvd24udmFsdWUgb3Igbm90IG15LnZhbGlkIHRoZW4KCQlyZXR1cm4gYW5pbWEuY29uZGl0aW9uKHNlbGYucHJvZ3Jlc3MsIGZhbHNlLCAtNCkKCWVuZAoKCXNlbGYuc3BlZWQgPSBlbnRpdHkuZ2V0X3Byb3AobXkuZW50aXR5LCAibV9mbFZlbG9jaXR5TW9kaWZpZXIiKQoKCXJldHVybiBhbmltYS5jb25kaXRpb24oc2VsZi5wcm9ncmVzcywgcHVpLm1lbnVfb3BlbiBvciAobXkudmFsaWQgYW5kIHNlbGYuc3BlZWQgPCAxKSwgLTgpCmVuZAoKaHVkLnNsb3dkb3duLnBhaW50ID0gZnVuY3Rpb24gKHNlbGYsIHgsIHksIHcsIGgpCglsb2NhbCB3YXJuY2xyID0gY29sb3IucmdiKDI0MCwgNjAsIDYwKTpsZXJwKGNvbG9ycy50ZXh0LCBzZWxmLnNwZWVkKQoKCXJlbmRlci5ibHVyKHggKyAzNiwgeSArIDEsIHcgLSAzNiwgaCAtIDIpCglyZW5kZXIucmVjdGFuZ2xlKHggKyAzNiwgeSArIDEsIHcgLSAzNiwgaCAtIDIsIGNvbG9ycy5wYW5lbC5sMSwgNCkKCglyZW5kZXIuYmx1cih4LCB5LCAzMiwgaCwgMSwgOCkKCXJlbmRlci5yb3VuZGVkX3NpZGVfdih4LCB5LCAzMiwgaCwgY29sb3JzLnBhbmVsLmcxLCA0KQoJcmVuZGVyLnJlY3RhbmdsZSh4ICsgMzIsIHksIDIsIGgsIGNvbG9ycy5wYW5lbC5nMSkKCXJlbmRlci50ZXh0dXJlKHRleHR1cmVzLndhcm5pbmcsIHggKyA4LCB5ICsgOCwgMTYsIDE2LCB3YXJuY2xyKQoKCXJlbmRlci5lZGdlX3YoeCArIDMyLCB5LCBoKQoKCXJlbmRlci50ZXh0KHggKyA0NCwgeSArIDYsIGNvbG9ycy50ZXh0OmFscGhlbigoMSAtIHNlbGYuc3BlZWQpICogMTk2ICsgNjQpLCBuaWwsIG5pbCwgInNsb3dlZCIpCglyZW5kZXIudGV4dCh4ICsgdyAtIDgsIHkgKyA2LCB3YXJuY2xyLCAiciIsIG5pbCwgc3RyaW5nLmZvcm1hdCgiJWQlJSIsIHNlbGYuc3BlZWQgKiAxMDApKQoKCXJlbmRlci5yZWN0YW5nbGUoeCArIDQ0LCB5ICsgMjEsIDY3LCAyLCBjb2xvcnMud2hpdGU6YWxwaGVuKDMyKSkKCXJlbmRlci5yZWN0YW5nbGUoeCArIDQ0LCB5ICsgMjEsIHNlbGYuc3BlZWQgKiA2NywgMiwgY29sb3JzLmFjY2VudDphbHBoZW4oc2VsZi5zcGVlZCAqIDE5NiArIDU4KSkKZW5kCgotLSAjZW5kcmVnaW9uCgotLSAjcmVnaW9uIC0gTG9ncwoKaHVkLmxvZ3MgPSB3aWRnZXQubmV3KCJsb2dzIiwgc2MueCAtIDE1MCwgc2MueSArIDE2MCwgMzAwLCAzMiwgewoJcnVsZXJzID0gewoJCXsgdHJ1ZSwgYXNjLngsIDAsIGFzaCB9LAoJfQp9KQoKaHVkLmxvZ3MucHJldmlldywgaHVkLmxvZ3MuZHVtbXkgPSBmYWxzZSwgewoJewoJCWV2ZW50ID0gImhpdCIsCgkJdGV4dCA9ICJcYUEzRDM1MFx4MDHigKJcYUU2RTZFNlx4MDIgS2lsbGVkXGFFNkU2RTZceDAyIFxhRTZFNkU2XHgwMlxhRTZFNkU2XHgwMW1hajByXGFFNkU2RTZceDAyIGluIFxhRTZFNkU2XHgwMlxhRTZFNkU2XHgwMWhlYWRcYUU2RTZFNlx4MDJcYUU2RTZFNlx4MDIiLAoJCXRpbWUgPSBtYXRoLmh1Z2UsCgkJcHJvZ3Jlc3MgPSB7MH0sCgl9LAoJewoJCWV2ZW50ID0gIm1pc3MiLAoJCXRleHQgPSAiXGFBNjdDQ0ZceDAx4oCiXGFFNkU2RTZceDAyIE1pc3NlZFxhRTZFNkU2XHgwMiBcYUU2RTZFNlx4MDFlblFcYUU2RTZFNlx4MDInc1xhRTZFNkU2XHgwMSBoZWFkXGFFNkU2RTZceDAyIGR1ZSB0byBcYUU2RTZFNlx4MDF1bnByZWRpY3RlZCBvY2Nhc2lvbiIsCgkJdGltZSA9IG1hdGguaHVnZSwKCQlwcm9ncmVzcyA9IHswfSwKCX0sCgl7CgkJZXZlbnQgPSAiaGFybSIsCgkJdGV4dCA9ICJcYWQzNTA1MFx4MDHigKJcYUU2RTZFNlx4MDIgSGFybWVkIGJ5XGFFNkU2RTZceDAyIFxhRTZFNkU2XHgwMWVuUVxhRTZFNkU2XHgwMiBpbiBcYUU2RTZFNlx4MDFoZWFkXGFFNkU2RTZceDAyIGZvciBcYUU2RTZFNlx4MDE3MiIsCgkJdGltZSA9IG1hdGguaHVnZSwKCQlwcm9ncmVzcyA9IHswfSwKCX0sCn0KCmh1ZC5sb2dzLnVwZGF0ZSA9IGZ1bmN0aW9uIChzZWxmKQoJcmV0dXJuIGFuaW1hLmNvbmRpdGlvbihzZWxmLnByb2dyZXNzLCB2YXJzLm1pc2MubG9ncy5vbi52YWx1ZSBhbmQgdmFycy5taXNjLmxvZ3Mub3V0cHV0OmdldCgiU2NyZWVuIikgYW5kIG15LmluX2dhbWUpCmVuZAoKaHVkLmxvZ3MucGFydCA9IGZ1bmN0aW9uIChzZWxmLCBsb2csIG9mZnNldCwgcHJvZ3Jlc3MsIGNvbmRpdGlvbiwgaSkKCWxvY2FsIHRleHQgPSBzdHJpbmcuZ3N1Yihsb2cudGV4dCwgIltceDAxXHgwMl0iLCB7CgkJWyJceDAxIl0gPSBzdHJpbmcuZm9ybWF0KCIlMDJ4IiwgcHJvZ3Jlc3MgKiByZW5kZXIuZ2V0X2FscGhhKCkgKiAyNTUpLAoJCVsiXHgwMiJdID0gc3RyaW5nLmZvcm1hdCgiJTAyeCIsIHByb2dyZXNzICogcmVuZGVyLmdldF9hbHBoYSgpICogMTI4KSwKCX0pCgoJbG9jYWwgdHcsIHRoID0gcmVuZGVyLm1lYXN1cmVfdGV4dCgiIiwgdGV4dCkKCglsb2NhbCB4LCB5ID0gbWF0aC5sZXJwKHNlbGYueCArIHNlbGYudyAqIDAuNSAtIHR3ICogMC41IC0gMTgsIHNlbGYueCwgc2VsZi5hbGlnbiksIG9mZnNldAoJaWYgbm90IGNvbmRpdGlvbiB0aGVuCgkJeCA9IHggKyAoMSAtIHByb2dyZXNzKSAqICh0dyAqIDAuNSkgKiAoaSAlIDIgPT0gMCBhbmQgLTEgb3IgMSkKCWVuZAoKCXJlbmRlci5ibHVyKHgsIHksIDI0LCAyNCkKCXJlbmRlci5yb3VuZGVkX3NpZGVfdih4LCB5LCAyNCwgMjQsIGNvbG9ycy5wYW5lbC5nMSwgNCkKCXJlbmRlci5yZWN0YW5nbGUoeCArIDI0LCB5LCAyLCAyNCwgY29sb3JzLnBhbmVsLmcxKQoJcmVuZGVyLmVkZ2Vfdih4ICsgMjQsIHksIDI0KQoKCXJlbmRlci5ibHVyKHggKyAyOCwgeSArIDEsIHR3ICsgMTQsIDIyKQoJcmVuZGVyLnJlY3RhbmdsZSh4ICsgMjgsIHkgKyAxLCB0dyArIDE0LCAyMiwgY29sb3JzLnBhbmVsLmwxLCA0KQoKCXJlbmRlci50ZXh0dXJlKHRleHR1cmVzLm1pbmlfYmZseSwgeCArIDgsIHkgKyA4LCA5LCA5LCBjb2xvcnMuYWNjZW50KQoJcmVuZGVyLnRleHQoeCArIDM1LCB5ICsgNSwgY29sb3JzLnRleHQ6YWxwaGVuKDEyOCksIG5pbCwgbmlsLCB0ZXh0KQplbmQKCmh1ZC5sb2dzLnBhaW50ID0gZnVuY3Rpb24gKHNlbGYsIHgsIHksIHcsIGgpCglpZiBub3QgdmFycy5taXNjLmxvZ3Mub24udmFsdWUgdGhlbiByZXR1cm4gZW5kCglsb2NhbCBjb250aW51ZQoJc2VsZi5hbGlnbiA9IGFuaW1hLmNvbmRpdGlvbigiaHVkOjpsb2dzLmFsaWduIiwgc2VsZi54IDwgc3cgLyAzKQoJc2VsZi5wcmV2aWV3ID0gYW5pbWEuY29uZGl0aW9uKCJodWQ6OmxvZ3MucHJldmlldyIsIHB1aS5tZW51X29wZW4gYW5kIHZhcnMubWlzYy5sb2dzLm91dHB1dDpnZXQoIlNjcmVlbiIpIGFuZCAjbG9nZ2VyLmxpc3QgPT0gMCkKCXkgPSB5ICsgNAoKCWxvY2FsIGN0eCA9IHNlbGYucHJldmlldyA+IDAgYW5kIHNlbGYuZHVtbXkgb3IgbG9nZ2VyLmxpc3QKCWZvciBpID0gMSwgI2N0eCBkbwoJCWxvY2FsIHYgPSBjdHhbaV0KCQlsb2NhbCBhc2NlbmQgPSAoZ2xvYmFscy5yZWFsdGltZSgpIC0gdi50aW1lKSA8IDQgYW5kIGkgPCAxMAoKCQlsb2NhbCBwcm9ncmVzcyA9IGFuaW1hLmNvbmRpdGlvbih2LnByb2dyZXNzLCB0ZXJuYXJ5KHNlbGYucHJldmlldyA+IDAsIHNlbGYucHJldmlldyA9PSAxLCBhc2NlbmQpKQoJCWlmIHByb2dyZXNzID09IDAgdGhlbiBjb250aW51ZSA9IGkgZW5kCgoJCXJlbmRlci5wdXNoX2FscGhhKHByb2dyZXNzKQoJCXNlbGY6cGFydCh2LCB5LCBwcm9ncmVzcywgYXNjZW5kLCBpKQoJCXJlbmRlci5wb3BfYWxwaGEoKQoKCQl5ID0geSArIDI4ICogKGFzY2VuZCBhbmQgcHJvZ3Jlc3Mgb3IgMSkKCWVuZAoKCWlmIGNvbnRpbnVlIHRoZW4KCQl0YWJsZS5yZW1vdmUobG9nZ2VyLmxpc3QsIGNvbnRpbnVlKQoJZW5kCmVuZAoKCi0tICNlbmRyZWdpb24KCi0tICNyZWdpb24gLSBLZXlsaXN0CgpodWQua2V5bGlzdCA9IHdpZGdldC5uZXcoImtleWxpc3QiLCBzYy54IC0gNDAwLCBzYy55LCAxMjAsIDIyLCB0cnVlKQoKaHVkLmtleWxpc3QuYmluZHMgPSB7Cgl7CgkJbmFtZSA9ICJNaW5pbXVtIGRhbWFnZSIsCgkJcmVmID0gcmVmcy5yYWdlLmFpbWJvdC5kYW1hZ2Vfb3ZyWzFdLAoJCXN0YXRlID0gZnVuY3Rpb24gKCkgcmV0dXJuIHJlZnMucmFnZS5haW1ib3QuZGFtYWdlX292clsyXS52YWx1ZSBlbmQKCX0sIHsKCQluYW1lID0gIkRvdWJsZSB0YXAiLAoJCXJlZiA9IHJlZnMucmFnZS5haW1ib3QuZG91YmxlX3RhcFsxXSwKCX0sIHsKCQluYW1lID0gIkhpZGUgc2hvdHMiLAoJCXJlZiA9IHJlZnMuYWEub3RoZXIub25zaG90LAoJfSwgewoJCW5hbWUgPSAiUXVpY2sgcGVlayIsCgkJcmVmID0gcmVmcy5yYWdlLm90aGVyLnBlZWssCgl9LCB7CgkJbmFtZSA9ICJEZWZlbnNpdmUgc25hcCIsCgkJcmVmID0gdmFycy5hbnRpYWltLmV4cGxvaXRzLnNuYXAub24sCgl9LCB7CgkJbmFtZSA9ICJNYW51YWwgeWF3IiwKCQlyZWYgPSBmdW5jdGlvbiAoKSByZXR1cm4gYW50aWFpbS5kYXRhLm1hbnVhbCBlbmQsCgkJc3RhdGUgPSBmdW5jdGlvbiAoKQoJCQlyZXR1cm4gKGFudGlhaW0uZGF0YS5tYW51YWwgPT0gLTkwIGFuZCAibGVmdCIpIG9yIChhbnRpYWltLmRhdGEubWFudWFsID09IDkwIGFuZCAicmlnaHQiKSBvciAifiIKCQllbmQsCgl9LCB7CgkJbmFtZSA9ICJFZGdlIHlhdyIsCgkJcmVmID0gcmVmcy5hYS5hbmdsZXMuZWRnZSwKCX0sIHsKCQluYW1lID0gIkZyZWVzdGFuZGluZyIsCgkJcmVmID0gcmVmcy5hYS5hbmdsZXMuZnJlZXN0YW5kLAoJfSwKfQoKaHVkLmtleWxpc3Q6ZW5saXN0KGZ1bmN0aW9uICgpCglsb2NhbCBsaXN0ID0ge30KCglmb3IgaSA9IDEsICNodWQua2V5bGlzdC5iaW5kcyBkbwoJCWxvY2FsIHYgPSBodWQua2V5bGlzdC5iaW5kc1tpXQoJCWxvY2FsIGFjdGl2ZSwgc3RhdGUgPSBmYWxzZSwgIm9uIgoKCQlpZiB0eXBlKHYucmVmKSA9PSAiZnVuY3Rpb24iIHRoZW4KCQkJYWN0aXZlID0gdi5yZWYoKQoJCWVsc2VpZiB2LnJlZiB+PSBuaWwgdGhlbgoJCQlhY3RpdmUgPSB2LnJlZi52YWx1ZQoJCQlpZiB2LnJlZi5ob3RrZXkgdGhlbgoJCQkJbG9jYWwgX19hY3RpdmUsIF9fbW9kZSA9IHYucmVmLmhvdGtleTpnZXQoKQoJCQkJYWN0aXZlID0gYWN0aXZlIGFuZCBfX2FjdGl2ZSBhbmQgX19tb2RlIH49IDAKCQkJZW5kCgkJZW5kCgoJCWlmIHYuc3RhdGUgdGhlbgoJCQlpZiB0eXBlKHYuc3RhdGUpID09ICJmdW5jdGlvbiIgdGhlbgoJCQkJc3RhdGUgPSB2LnN0YXRlKCkKCQkJZWxzZQoJCQkJc3RhdGUgPSB2LnN0YXRlCgkJCWVuZAoJCWVuZAoKCQktLQoJCWxpc3RbaV0gPSB7CgkJCW5hbWUgPSB2Lm5hbWUsCgkJCWFjdGl2ZSA9IGFjdGl2ZSwKCQkJc3RhdGUgPSBzdGF0ZSwKCQl9CgllbmQKCglyZXR1cm4gbGlzdAplbmQsIGZ1bmN0aW9uIChzZWxmLCBpdGVtLCBvZmZzZXQsIHByb2dyZXNzKQoJbG9jYWwgeCwgeSwgdywgaCA9IHNlbGYueCArIDQsIHNlbGYueSArIG9mZnNldCArIChzZWxmLmggKyA2KSAqIHByb2dyZXNzLCBzZWxmLncgLSA4LCAyMAoKCXJlbmRlci5ibHVyKHgsIHksIHcsIGgpCglyZW5kZXIucmVjdGFuZ2xlKHgsIHksIHcsIGgsIGNvbG9ycy5wYW5lbC5sMSwgNCkKCglyZW5kZXIudGV4dCh4ICsgNiwgeSArIDMsIGNvbG9ycy50ZXh0LCBuaWwsIG5pbCwgaXRlbS5uYW1lKQoJcmVuZGVyLnRleHQoeCArIHcgLSA2LCB5ICsgMywgY29sb3JzLmFjY2VudCwgInIiLCBuaWwsIGl0ZW0uc3RhdGUpCglsb2NhbCBsZW5ndGggPSByZW5kZXIubWVhc3VyZV90ZXh0KG5pbCwgaXRlbS5uYW1lIC4uIGl0ZW0uc3RhdGUpCgoJcmV0dXJuIGxlbmd0aCArIDMyLCBoICsgMgplbmQpCgoKaHVkLmtleWxpc3QudXBkYXRlID0gZnVuY3Rpb24gKHNlbGYpCglyZXR1cm4gYW5pbWEuY29uZGl0aW9uKHNlbGYucHJvZ3Jlc3MsIHZhcnMudmlzdWFscy5rZXlsaXN0LnZhbHVlIGFuZCAocHVpLm1lbnVfb3BlbiBvciBzZWxmLl9fbGlzdC5hY3RpdmUgPiAwKSkKZW5kCgpodWQua2V5bGlzdC5wYWludCA9IGZ1bmN0aW9uIChzZWxmLCB4LCB5LCB3LCBoKQoJcmVuZGVyLmJsdXIoeCwgeSwgdywgaCkKCXJlbmRlci5yb3VuZGVkX3NpZGVfaCh4LCB5LCB3LCBoLCBjb2xvcnMucGFuZWwuZzEsIDQpCglyZW5kZXIuZWRnZV9oKHgsIHkgKyBoLCB3KQoJcmVuZGVyLnRleHQoeCArIHcgKiAuNSwgeSArIDExLCBjb2xvcnMudGV4dCwgImMiLCBuaWwsICJIb3RrZXlzIikKZW5kCgotLSAjZW5kcmVnaW9uCgotLSAjcmVnaW9uIC0gU3BlY2xpc3QKCmh1ZC5zcGVjbGlzdCA9IHdpZGdldC5uZXcoInNwZWNsaXN0Iiwgc2MueCAtIDQwMCwgc2MueSwgMTIwLCAyMiwgdHJ1ZSkKCmh1ZC5zcGVjbGlzdDplbmxpc3QoZnVuY3Rpb24gKCkKCWxvY2FsIGxpc3QgPSB7fQoKCWlmIG15LnZhbGlkIHRoZW4KCQlsb2NhbCB0YXJnZXQKCgkJbG9jYWwgb2JfdGFyZ2V0LCBvYl9tb2RlID0gZW50aXR5LmdldF9wcm9wKG15LmVudGl0eSwgIm1faE9ic2VydmVyVGFyZ2V0IiksIGVudGl0eS5nZXRfcHJvcChteS5lbnRpdHksICJtX2lPYnNlcnZlck1vZGUiKQoJCWlmIG9iX3RhcmdldCBhbmQgKG9iX21vZGUgPT0gNCBvciBvYl9tb2RlID09IDUpIHRoZW4KCQkJdGFyZ2V0ID0gb2JfdGFyZ2V0CgkJZWxzZQoJCQl0YXJnZXQgPSBteS5lbnRpdHkKCQllbmQKCgkJZm9yIGVudCA9IDEsIDY0IGRvCgkJCWlmIGVudGl0eS5nZXRfY2xhc3NuYW1lKGVudCkgPT0gIkNDU1BsYXllciIgYW5kIGVudCB+PSBteS5lbnRpdHkgdGhlbgoJCQkJbG9jYWwgY29iX3RhcmdldCwgY29iX21vZGUgPSBlbnRpdHkuZ2V0X3Byb3AoZW50LCAibV9oT2JzZXJ2ZXJUYXJnZXQiKSwgZW50aXR5LmdldF9wcm9wKGVudCwgIm1faU9ic2VydmVyTW9kZSIpCgoJCQkJbGlzdFsjbGlzdCsxXSA9IHsKCQkJCQluYW1lID0gZW50LCBuaWNrID0gc3RyaW5nLmxpbWl0KGVudGl0eS5nZXRfcGxheWVyX25hbWUoZW50KSwgMjAsICIuLi4iKSwKCQkJCQlhY3RpdmUgPSBjb2JfdGFyZ2V0IGFuZCBjb2JfdGFyZ2V0ID09IHRhcmdldCBhbmQgKGNvYl9tb2RlID09IDQgb3IgY29iX21vZGUgPT0gNSkKCQkJCX0KCQkJZW5kCgkJZW5kCgllbmQKCglyZXR1cm4gbGlzdAplbmQsIGZ1bmN0aW9uIChzZWxmLCBpdGVtLCBvZmZzZXQsIHByb2dyZXNzKQoJbG9jYWwgeCwgeSwgdywgaCA9IHNlbGYueCArIDQsIHNlbGYueSArIG9mZnNldCArIChzZWxmLmggKyA2KSAqIHByb2dyZXNzLCBzZWxmLncgLSA4LCAyMAoKCXJlbmRlci5ibHVyKHgsIHksIHcsIGgpCglyZW5kZXIucmVjdGFuZ2xlKHgsIHksIHcsIGgsIGNvbG9ycy5wYW5lbC5sMSwgNCkKCglyZW5kZXIudGV4dCh4ICsgNiwgeSArIDMsIGNvbG9ycy50ZXh0LCBuaWwsIG5pbCwgaXRlbS5uaWNrKQoJbG9jYWwgbGVuZ3RoID0gcmVuZGVyLm1lYXN1cmVfdGV4dChuaWwsIGl0ZW0ubmljaykKCglyZXR1cm4gbGVuZ3RoICsgMzIsIGggKyAyCmVuZCkKCgpodWQuc3BlY2xpc3QudXBkYXRlID0gZnVuY3Rpb24gKHNlbGYpCglyZXR1cm4gYW5pbWEuY29uZGl0aW9uKHNlbGYucHJvZ3Jlc3MsIHZhcnMudmlzdWFscy5zcGVjbGlzdC52YWx1ZSBhbmQgKHB1aS5tZW51X29wZW4gb3Igc2VsZi5fX2xpc3QuYWN0aXZlID4gMCkpCmVuZAoKaHVkLnNwZWNsaXN0LnBhaW50ID0gZnVuY3Rpb24gKHNlbGYsIHgsIHksIHcsIGgpCglyZW5kZXIuYmx1cih4LCB5LCB3LCBoKQoJcmVuZGVyLnJvdW5kZWRfc2lkZV9oKHgsIHksIHcsIGgsIGNvbG9ycy5wYW5lbC5nMSwgNCkKCXJlbmRlci5lZGdlX2goeCwgeSArIGgsIHcpCglyZW5kZXIudGV4dCh4ICsgdyAqIC41LCB5ICsgMTEsIGNvbG9ycy50ZXh0LCAiYyIsIG5pbCwgc3RyaW5nLmZvcm1hdCgiU3BlY3RhdG9ycyAoJWQpIiwgc2VsZi5fX2xpc3QuYWN0aXZlKSkKZW5kCgotLSAjZW5kcmVnaW9uCgpkbwoJbG9jYWwgZm4gPSBhKGZ1bmN0aW9uICgpCgkJaWYgdmFycy52aXN1YWxzLndhdGVyLm9uLnZhbHVlIG9yIGh1ZC53YXRlcm1hcmsuYWxwaGEgPiAwIHRoZW4KCQkJaHVkLndhdGVybWFyaygpCgkJZW5kCgkJaWYgdmFycy52aXN1YWxzLmRhbWFnZS52YWx1ZSBvciBodWQuZGFtYWdlLmFscGhhID4gMCB0aGVuCgkJCWh1ZC5kYW1hZ2UoKQoJCWVuZAoJCWlmIHZhcnMudmlzdWFscy5hcnJvd3MudmFsdWUgb3IgaHVkLmFycm93cy5hbHBoYSA+IDAgdGhlbgoJCQlodWQuYXJyb3dzKCkKCQllbmQKCQlpZiB2YXJzLnZpc3VhbHMuc2xvd2Rvd24udmFsdWUgb3IgaHVkLnNsb3dkb3duLmFscGhhID4gMCB0aGVuCgkJCWh1ZC5zbG93ZG93bigpCgkJZW5kCgkJaWYgKHZhcnMubWlzYy5sb2dzLm9uLnZhbHVlIGFuZCB2YXJzLm1pc2MubG9ncy5vdXRwdXQ6Z2V0KCJTY3JlZW4iKSkgb3IgaHVkLmxvZ3MuYWxwaGEgPiAwIHRoZW4KCQkJaHVkLmxvZ3MoKQoJCWVuZAoJCWlmIHZhcnMudmlzdWFscy5zcGVjbGlzdC52YWx1ZSBvciBodWQuc3BlY2xpc3QuYWxwaGEgPiAwIHRoZW4KCQkJaHVkLnNwZWNsaXN0KCkKCQllbmQKCQlpZiB2YXJzLnZpc3VhbHMua2V5bGlzdC52YWx1ZSBvciBodWQua2V5bGlzdC5hbHBoYSA+IDAgdGhlbgoJCQlodWQua2V5bGlzdCgpCgkJZW5kCgkJaWYgdmFycy52aXN1YWxzLmNyb3NzaGFpci5vbi52YWx1ZSBvciBjcm9zc2hhaXIuYWxwaGEgPiAwIHRoZW4KCQkJY3Jvc3NoYWlyKCkKCQllbmQKCWVuZCkKCgljYWxsYmFja3MucGFpbnRfdWk6c2V0KGZuKQplbmQKCi0tICNyZWdpb24gLSBCdXR0ZXJmbHkKCmlmIG5vdCBfREVCVUcgdGhlbgoJbG9jYWwgd2VsY29tZSA9IHsKCQlzdGF0ZSA9IHRydWUsCgkJY29tcGxldGluZyA9IGZhbHNlLAoJCXByb2dyZXNzID0geyB7MH0sIHswfSwgezB9IH0KCX0KCgl3ZWxjb21lLnJlbmRlciA9IGZ1bmN0aW9uICgpCgkJbG9jYWwgUDEgPSBhbmltYS5jb25kaXRpb24od2VsY29tZS5wcm9ncmVzc1sxXSwgd2VsY29tZS5zdGF0ZSwgMikKCQlsb2NhbCBQMiA9IGFuaW1hLmNvbmRpdGlvbih3ZWxjb21lLnByb2dyZXNzWzJdLCBQMSA9PSAxLCAyKQoKCQlyZW5kZXIucmVjdGFuZ2xlKDAsIDAsIHN3LCBzaCwgY29sb3JzLmJhY2s6YWxwaGVuKFAxICogMTgwKSkKCgkJbG9jYWwgc2l6ZSA9IDQwMAoJCXJlbmRlci50ZXh0dXJlKHRleHR1cmVzLmJ1dHRlcmZseSwgc2MueCAtIHNpemUgKiAwLjUsIHNjLnkgLSBzaXplICogMC41LCBzaXplLCBzaXplLCBjb2xvcnMuYWNjZW50OmFscGhlbihQMiAqIDI1NSkpCgoJCWlmIG5vdCB3ZWxjb21lLmNvbXBsZXRpbmcgdGhlbgoJCQljbGllbnQuZGVsYXlfY2FsbCgzLCBmdW5jdGlvbiAoKSBpZiB3ZWxjb21lIHRoZW4gd2VsY29tZS5zdGF0ZSA9IGZhbHNlIGVuZCBlbmQpCgkJCXdlbGNvbWUuY29tcGxldGluZyA9IHRydWUKCQllbmQKCWVuZAoKCWNsaWVudC5kZWxheV9jYWxsKDEsIGZ1bmN0aW9uICgpIGNhbGxiYWNrcy5wYWludF91aTpzZXQod2VsY29tZS5yZW5kZXIpIGVuZCkKCWNsaWVudC5kZWxheV9jYWxsKDYsIGZ1bmN0aW9uICgpCgkJY2FsbGJhY2tzLnBhaW50X3VpOnVuc2V0KHdlbGNvbWUucmVuZGVyKQoJCXdlbGNvbWUgPSBuaWwKCWVuZCkKZW5kCgotLSAjZW5kcmVnaW9uCgotLSAjZW5kcmVnaW9uCi0tCgoKLS0gI2VuZHJlZ2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KLS0KCgkKY29uZmlncy5zeXN0ZW0gPSBwdWkuc2V0dXAodmFycykKCmVuZCkoKQ=="}