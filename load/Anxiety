{"status":200,"content":"CmxvY2FsIGx1YV9uYW1lID0gImFueGlldHkiCmxvY2FsIHByb21vdGUgPSB1aS5uZXdfbGFiZWwoIkFBIiwgIk90aGVyIiwgIipjdXJyZW50bHkgcGxheWluZyB3aXRoIGFueGlldHkucmlwKiIpCgoKbG9jYWwgbHVhX2NvbG9yID0ge3IgPSAxOTAgLCBnID0gMTgwLCBiID0gMjE0fQoKCmxvY2FsIGZ1bmN0aW9uIHRyeV9yZXF1aXJlKG1vZHVsZSwgbXNnKQogICAgbG9jYWwgc3VjY2VzcywgcmVzdWx0ID0gcGNhbGwocmVxdWlyZSwgbW9kdWxlKQogICAgaWYgc3VjY2VzcyB0aGVuIHJldHVybiByZXN1bHQgZWxzZSByZXR1cm4gZXJyb3IobXNnKSBlbmQKZW5kCgpsb2NhbCBpbWFnZXMgPSB0cnlfcmVxdWlyZSgiZ2FtZXNlbnNlL2ltYWdlcyIsICJEb3dubG9hZCBpbWFnZXMgbGlicmFyeTogaHR0cHM6Ly9nYW1lc2Vuc2UucHViL2ZvcnVtcy92aWV3dG9waWMucGhwP2lkPTIyOTE3IikKbG9jYWwgYml0ID0gdHJ5X3JlcXVpcmUoImJpdCIpCmxvY2FsIGJhc2U2NCA9IHRyeV9yZXF1aXJlKCJnYW1lc2Vuc2UvYmFzZTY0IiwgIkRvd25sb2FkIGJhc2U2NCBlbmNvZGUvZGVjb2RlIGxpYnJhcnk6IGh0dHBzOi8vZ2FtZXNlbnNlLnB1Yi9mb3J1bXMvdmlld3RvcGljLnBocD9pZD0yMTYxOSIpCmxvY2FsIGFudGlhaW1fZnVuY3MgPSB0cnlfcmVxdWlyZSgiZ2FtZXNlbnNlL2FudGlhaW1fZnVuY3MiLCAiRG93bmxvYWQgYW50aS1haW0gZnVuY3Rpb25zIGxpYnJhcnk6IGh0dHBzOi8vZ2FtZXNlbnNlLnB1Yi9mb3J1bXMvdmlld3RvcGljLnBocD9pZD0yOTY2NSIpCmxvY2FsIGZmaSA9IHRyeV9yZXF1aXJlKCJmZmkiLCAiRmFpbGVkIHRvIHJlcXVpcmUgRkZJLCBwbGVhc2UgbWFrZSBzdXJlIEFsbG93IHVuc2FmZSBzY3JpcHRzIGlzIGVuYWJsZWQhIikKbG9jYWwgdmVjdG9yID0gdHJ5X3JlcXVpcmUoInZlY3RvciIsICJNaXNzaW5nIHZlY3RvciIpCmxvY2FsIGh0dHAgPSB0cnlfcmVxdWlyZSgiZ2FtZXNlbnNlL2h0dHAiLCAiRG93bmxvYWQgSFRUUCBsaWJyYXJ5OiBodHRwczovL2dhbWVzZW5zZS5wdWIvZm9ydW1zL3ZpZXd0b3BpYy5waHA/aWQ9MjE2MTkiKQpsb2NhbCBjbGlwYm9hcmQgPSB0cnlfcmVxdWlyZSgiZ2FtZXNlbnNlL2NsaXBib2FyZCIsICJEb3dubG9hZCBDbGlwYm9hcmQgbGlicmFyeTogaHR0cHM6Ly9nYW1lc2Vuc2UucHViL2ZvcnVtcy92aWV3dG9waWMucGhwP2lkPTI4Njc4IikKbG9jYWwgZW50ID0gdHJ5X3JlcXVpcmUoImdhbWVzZW5zZS9lbnRpdHkiLCAiRG93bmxvYWQgRW50aXR5IE9iamVjdCBsaWJyYXJ5OiBodHRwczovL2dhbWVzZW5zZS5wdWIvZm9ydW1zL3ZpZXd0b3BpYy5waHA/aWQ9Mjc1MjkiKQpsb2NhbCBjc2dvX3dlYXBvbnMgPSB0cnlfcmVxdWlyZSgiZ2FtZXNlbnNlL2NzZ29fd2VhcG9ucyIsICJEb3dubG9hZCBDUzpHTyB3ZWFwb24gZGF0YSBsaWJyYXJ5OiBodHRwczovL2dhbWVzZW5zZS5wdWIvZm9ydW1zL3ZpZXd0b3BpYy5waHA/aWQ9MTg4MDciKQoKLS0gRmV0Y2ggQW54aWV0eSBkYXRhIG9yIGRlZmF1bHQgdmFsdWVzCmxvY2FsIGFueGlldHlfZGF0YSA9IGFueGlldHlfZmV0Y2ggYW5kIGFueGlldHlfZmV0Y2goKSBvciB7dXNlcm5hbWUgPSAnTW9uc3RyeScsIGJ1aWxkID0gJ2RldicsIGRpc2NvcmQgPSAnJ30KCgpsb2NhbCBsdWEgPSB7fQpsdWEuZGF0YWJhc2UgPSB7CiAgICBjb25maWdzID0gIjoiIC4uIGx1YV9uYW1lIC4uICI6OmNvbmZpZ3M6Igp9CmxvY2FsIHByZXNldHMgPSB7fQotLSBAcmVnaW9uIFVTRVJEQVRBIGVuZAoKLS0gQHJlZ2lvbiBSRUZFUkVOQ0VTIHN0YXJ0CmxvY2FsIHJlZnMgPSB7CiAgICBsZWdpdCA9IHVpLnJlZmVyZW5jZSgiTEVHSVQiLCAiQWltYm90IiwgIkVuYWJsZWQiKSwKICAgIGRtZ092ZXJyaWRlID0ge3VpLnJlZmVyZW5jZSgiUkFHRSIsICJBaW1ib3QiLCAiTWluaW11bSBkYW1hZ2Ugb3ZlcnJpZGUiKX0sCiAgICBmYWtlRHVjayA9IHVpLnJlZmVyZW5jZSgiUkFHRSIsICJPdGhlciIsICJEdWNrIHBlZWsgYXNzaXN0IiksCiAgICBtaW5EbWcgPSB1aS5yZWZlcmVuY2UoIlJBR0UiLCAiQWltYm90IiwgIk1pbmltdW0gZGFtYWdlIiksCiAgICBoaXRDaGFuY2UgPSB1aS5yZWZlcmVuY2UoIlJBR0UiLCAiQWltYm90IiwgIk1pbmltdW0gaGl0IGNoYW5jZSIpLAogICAgc2FmZVBvaW50ID0gdWkucmVmZXJlbmNlKCJSQUdFIiwgIkFpbWJvdCIsICJGb3JjZSBzYWZlIHBvaW50IiksCiAgICBmb3JjZUJhaW0gPSB1aS5yZWZlcmVuY2UoIlJBR0UiLCAiQWltYm90IiwgIkZvcmNlIGJvZHkgYWltIiksCiAgICBkdExpbWl0ID0gdWkucmVmZXJlbmNlKCJSQUdFIiwgIkFpbWJvdCIsICJEb3VibGUgdGFwIGZha2UgbGFnIGxpbWl0IiksCiAgICBxdWlja1BlZWsgPSB7dWkucmVmZXJlbmNlKCJSQUdFIiwgIk90aGVyIiwgIlF1aWNrIHBlZWsgYXNzaXN0Iil9LAogICAgZHQgPSB7dWkucmVmZXJlbmNlKCJSQUdFIiwgIkFpbWJvdCIsICJEb3VibGUgdGFwIil9LAogICAgZW5hYmxlZCA9IHVpLnJlZmVyZW5jZSgiQUEiLCAiQW50aS1haW1ib3QgYW5nbGVzIiwgIkVuYWJsZWQiKSwKICAgIHBpdGNoID0ge3VpLnJlZmVyZW5jZSgiQUEiLCAiQW50aS1haW1ib3QgYW5nbGVzIiwgInBpdGNoIil9LAogICAgcm9sbCA9IHVpLnJlZmVyZW5jZSgiQUEiLCAiQW50aS1haW1ib3QgYW5nbGVzIiwgInJvbGwiKSwKICAgIHlhd0Jhc2UgPSB1aS5yZWZlcmVuY2UoIkFBIiwgIkFudGktYWltYm90IGFuZ2xlcyIsICJZYXcgYmFzZSIpLAogICAgeWF3ID0ge3VpLnJlZmVyZW5jZSgiQUEiLCAiQW50aS1haW1ib3QgYW5nbGVzIiwgIllhdyIpfSwKICAgIGZsTGltaXQgPSB1aS5yZWZlcmVuY2UoIkFBIiwgIkZha2UgbGFnIiwgIkxpbWl0IiksCiAgICBmc0JvZHlZYXcgPSB1aS5yZWZlcmVuY2UoIkFBIiwgImFudGktYWltYm90IGFuZ2xlcyIsICJGcmVlc3RhbmRpbmcgYm9keSB5YXciKSwKICAgIGVkZ2VZYXcgPSB1aS5yZWZlcmVuY2UoIkFBIiwgIkFudGktYWltYm90IGFuZ2xlcyIsICJFZGdlIHlhdyIpLAogICAgeWF3Sml0dGVyID0ge3VpLnJlZmVyZW5jZSgiQUEiLCAiQW50aS1haW1ib3QgYW5nbGVzIiwgIllhdyBqaXR0ZXIiKX0sCiAgICBib2R5WWF3ID0ge3VpLnJlZmVyZW5jZSgiQUEiLCAiQW50aS1haW1ib3QgYW5nbGVzIiwgIkJvZHkgeWF3Iil9LAogICAgZnJlZVN0YW5kID0ge3VpLnJlZmVyZW5jZSgiQUEiLCAiQW50aS1haW1ib3QgYW5nbGVzIiwgIkZyZWVzdGFuZGluZyIpfSwKICAgIG9zID0ge3VpLnJlZmVyZW5jZSgiQUEiLCAiT3RoZXIiLCAiT24gc2hvdCBhbnRpLWFpbSIpfSwKICAgIHNsb3cgPSB7dWkucmVmZXJlbmNlKCJBQSIsICJPdGhlciIsICJTbG93IG1vdGlvbiIpfSwKICAgIGZha2VMYWcgPSB7dWkucmVmZXJlbmNlKCJBQSIsICJGYWtlIGxhZyIsICJMaW1pdCIpfSwKICAgIGxlZ01vdmVtZW50ID0gdWkucmVmZXJlbmNlKCJBQSIsICJPdGhlciIsICJMZWcgbW92ZW1lbnQiKSwKICAgIGluZGljYXRvcnMgPSB7dWkucmVmZXJlbmNlKCJWSVNVQUxTIiwgIk90aGVyIEVTUCIsICJGZWF0dXJlIGluZGljYXRvcnMiKX0sCiAgICBwaW5nID0ge3VpLnJlZmVyZW5jZSgiTUlTQyIsICJNaXNjZWxsYW5lb3VzIiwgIlBpbmcgc3Bpa2UiKX0sCn0KLS0gQHJlZ2lvbiBSRUZFUkVOQ0VTIGVuZAoKLS0gQHJlZ2lvbiBWQVJJQUJMRVMgc3RhcnQKbG9jYWwgdmFycyA9IHsKICAgIGxvY2FsUGxheWVyID0gMCwKICAgIGhpdGdyb3VwX25hbWVzID0geyAnR2VuZXJpYycsICdIZWFkJywgJ0NoZXN0JywgJ1N0b21hY2gnLCAnTGVmdCBhcm0nLCAnUmlnaHQgYXJtJywgJ0xlZnQgbGVnJywgJ1JpZ2h0IGxlZycsICdOZWNrJywgJz8nLCAnR2VhcicgfSwKICAgIGFhU3RhdGVzID0geyJHbG9iYWwiLCAiU3RhbmRpbmciLCAiTW92aW5nIiwgIlNsb3d3YWxraW5nIiwgIkNyb3VjaGluZyIsICJBaXIiLCAiQWlyLUNyb3VjaGluZyJ9LAogICAgcFN0YXRlcyA9IHsiRyIsICJTIiwgIk0iLCAiU1ciLCAiQyIsICJBIiwgIkFDIn0sCglzVG9JbnQgPSB7WyJHbG9iYWwiXSA9IDEsIFsiU3RhbmRpbmciXSA9IDIsIFsiTW92aW5nIl0gPSAzLCBbIlNsb3d3YWxraW5nIl0gPSA0LCBbIkNyb3VjaGluZyJdID0gNSwgWyJBaXIiXSA9IDYsIFsiQWlyLUNyb3VjaGluZyJdID0gN30sCiAgICBpbnRUb1MgPSB7WzFdID0gIkdsb2JhbCIsIFsyXSA9ICJTdGFuZCIsIFszXSA9ICJNb3ZlIiwgWzRdID0gIlNsb3d3YWxrIiwgWzVdID0gIkNyb3VjaCIsIFs2XSA9ICJBaXIiLCBbN10gPSAiQWlyK0MifSwKICAgIGN1cnJlbnRUYWIgPSAxLAogICAgYWN0aXZlU3RhdGUgPSAxLAogICAgcFN0YXRlID0gMQp9Cgpsb2NhbCBzbHVycyA9IHsKICAgICJkb250IHRhbGtpbmcgcGxzIiwKCSJ3aGVuIHUgbWlzcywgY3J5IHUgZG9udCBoZXYgTW9uc3RyeSIsCgkieW91IHRoaW5rIHlvdSBhcmUgaXMgZ29vZCBidXQgaW0gYmVzdCAxIiwKCSJmb2tpbiBkb2csIGdldCBvd25ldCBieSDDg8KQw4LCocODwpDDgsK+w4PCkMOCwrfDg8KQw4LCtMODwpDDgsKww4PigJjDouKCrMWhw4PCkMOCwrXDg8KQw4LCu8OD4oCYw4XigJkganMgcmV6b2x2ZXIiLAoJImlmIGltIGxvc2UgPSBteSB0ZWFtIGlzIGRvZyIsCgkibmV2ZXIgdGFsa2luZyBiYWQgdG8gbWUgYWdhaW4sIGltIGFsd2F5cyB0b3AxIiwKCSJ1bWFkIHRoYXQgeW91J3JlIG1pc3M/IGhzIGRvZyIsCgkidmljbyAodG9wMSBldSkgdnMgYWxsIGtlbGJzIG9uIGh2aC4iLAoJInlvdSBpcyBtYWQgdGhhdCBpbSB1ciBwYXBpPyIsCgkiaW0gd2lsbCByYXBlIHUncmUgbW90aGVyIGFmdGVyIGkga2lsbGVkIHlvdSIsCgkic3RheSBtYWQgdGhhdCBpbSB1bmhpdGFibGUiLAoJImdvZCBuaWdodCBicm90aGVyLCBjeWEgbmV4dCByYXVuZCA7KSIsCgkiZ2V0IGV4ZWN1dGVkIGZyb20gcHJlc2lkZW5kIG9mIGFyZ2VudGluYSIsCgkieW91IHRoaW5raW5nIHVyIGhhdmUgY2hlbmNzZSB2cyBib3NzPyIsCgkiaSBraWxsZWQgZ2VqbXNlbnNlLCBub3cgaW0ga2lsbCB5b3UiLAoJImJ5IGx1Y2tiYXlzZWQgY29uZmlnLCBjeWEgdHdpdHRlciBicm8gby8iLAoJImN5QCBodHRwczovL2dhbWVzZW5zZS5wdWIvZm9ydW1zL3ZpZXdmb3J1bS5waHA/aWQ9NiIsCgkiw4PCosOi4oKswqLDgsKtw4PCosOL4oCgw4LCqcODwqLDouKCrMKiw4LCrijDg8Kiw6LigqzigJ3DgsKjX8ODwqLDouKCrOKAncOCwqIpw4PCosOi4oKswqLDgsKtw4PCosOL4oCgw4LCqcODwqLDouKCrMKiw4LCrihpdHMgZnVjaykiLAoJImRvbnQgcGxheSB2cyBtZSBvbiB0cmFpbiwgaW0gbGl2ZSB0aGVyZSAtLi0iLAoJImJ5IHRvcDEgdXpiZWtpc3RhbiBob2xkZXIgdW1lZD8iLAoJImNvdXJhZ2UgZm9yIHBsYXkgZGVfc2hvcnRudWtlIHZzIG1lLCBteSBob21lIHRoZXJlLiIsCgkiYmljaC4uIGRvbnQgdGVzdCBnNG5nc3QzciBpbiBtZS4iLAoJImltIHJpY2ggcHJpbmMgaGVyZSwgZG9udCB0b3hpYyBkb2cuIiwKCSJmb3IgYWxsIHRoZXQgc2F5IGdhbWVzZW5zZSBiZXN0LCBpbSB0cnkgb24gcGFyc2VjIGFuZCBpcyBkb2cuIiwKCSJXRUFLIERPRyBzYW5jaGV6aiB2cyBydSBib3NzbWFuIChvd25lZCBvbiBtZWluIG1hcCkiLAoJImltIHdhbnQgZ2FtZXNlbnNlIG9ubHkgZm9yIGFuaW1icmVqa2VyLCBuZXZlcmxvc2UgYWx3YXlzIHRvcC4iLAoJInRoaXMgZG9nIGJyYW5kb2cgdGhpbmtpbmcgaGVzIHRvcCwgYnV0IHJlYWxpdHkgc2F5IG5vLiIsCgkiZmF3ayB5b3UgZm9raW5nIHRyZW55IiwKCSJ1ciB0aGluayB1ciBnb29kIGJ1dCBpdHMgZmFsc2VlLiIsCgkidG9wZG9nIG5lcGJvdCBnZXQgYmFpdHMgMjQvNyAtLi0iLAoJIndobyB0aGlzIGJvdCBtYWx2YT8gaW0gb3duIGhpbSA5LTAiLAoJImltIGJlYXQgYWxsIHJvbWFuaWEgZG9ncyB3aXRoIDEgZmlua2VyIiwKCSJpbSByZWpwIHRoaXMgZG9nIG5vb2JlcnMgd2l0aCBubyBwcm9ibGVtcyIsCgkiZ2FtZXNlbnNlIGhhemV5IHZzIGFsbCAtLi0iLAoJImlyZWxldmVudCBkb2cgam9tcGFuIHRyeSB0byBzdGF5IHBvcHVsYXIgYnV0IGZhaWwiLAoJImltIHVzZXIgZGV2IGFuZCB1ciBkb250LCBzdGF5IG1hZC4iLAoJImRvbnQgdGFsa2luZywgbm8gYW54aWV0eSByZWQgbm8gdGFsayBwbHMiLAoJIndoZW4gdSBtaXNzLCBjcnkgdSBkb250IGhldiBNb25zdHJ5IiwKCSJ5b3UgdGhpbmsgeW91IGFyZSBpcyBnb29kIGJ1dCBhbnhpZXR5IGlzIGJlc3QiLAoJImZrbiBkb2csIGdldCBvd24gYnkgYW54aWV0eSBqcyByZXpvbHZlciIsCgkiaWYgeW91IGx1c2UgPSBubyBhbnhpZXR5IGlzc3VlIiwKCSJuZXZlciB0YWxraW5nIGJhZCB0byBtZSBhZ2FpbiwgYW54aWV0eSBib29zaW5nIG1lIHRvIHRvcDEiLAoJInVtYWQgdGhhdCB5b3UncmUgbWlzcz8gZ2V0IGFueGlldHkgZDBnIiwKCSJzdGF5IG1lZCB0aGF0IGltIHVuaGl0YWJsZSBmdCBhbnhpZXR5IiwKCSJnZXQgZXhlY3V0ZWQgZnJvbSBhbnhpZXR5IHJlZG5vbG9neSIsCgkieW91IHRoaW5raW5nIHVyIGhhdmUgY2hlbmNzZSB2cyBhbnhpZXR5PyIsCgkiZmlyc3QgaSBraWxsZWQgZ2VqbXNlbnNlLCBub3cgYW54aWV0eSBraWxsIHlvdSIsCgkiYnkgYW54aWV0eSBib3NzIGFhLCBjeWEgdHdpdHRlciBicm8gby8iLAp9Cgpsb2NhbCBqcyA9IHBhbm9yYW1hLm9wZW4oKQpsb2NhbCBNeVBlcnNvbmFBUEksIExvYmJ5QVBJLCBQYXJ0eUxpc3RBUEksIFN0ZWFtT3ZlcmxheUFQSSA9IGpzLk15UGVyc29uYUFQSSwganMuTG9iYnlBUEksIGpzLlBhcnR5TGlzdEFQSSwganMuU3RlYW1PdmVybGF5QVBJCi0tIEByZWdpb24gVkFSSUFCTEVTIGVuZAoKLS0gQHJlZ2lvbiBGVU5DUyBzdGFydApsb2NhbCBmdW5jID0gewogICAgcmVuZGVyX3RleHQgPSBmdW5jdGlvbih4LCB5LCAuLi4pCiAgICAgICAgbG9jYWwgeF9PZmZzZXQgPSAwCiAgICAgICAgCiAgICAgICAgbG9jYWwgYXJncyA9IHsuLi59CiAgICAKICAgICAgICBmb3IgaSwgbGluZSBpbiBwYWlycyhhcmdzKSBkbwogICAgICAgICAgICBsb2NhbCByLCBnLCBiLCBhLCB0ZXh0ID0gdW5wYWNrKGxpbmUpCiAgICAgICAgICAgIGxvY2FsIHNpemUgPSB2ZWN0b3IocmVuZGVyZXIubWVhc3VyZV90ZXh0KHRleHQpKQogICAgICAgICAgICByZW5kZXJlci50ZXh0KHggKyB4X09mZnNldCwgeSwgciwgZywgYiwgYSwgMCwgdGV4dCkKICAgICAgICAgICAgeF9PZmZzZXQgPSB4X09mZnNldCArIHNpemUueAogICAgICAgIGVuZAogICAgZW5kLAogICAgZWFzZUluT3V0ID0gZnVuY3Rpb24odCkKICAgICAgICByZXR1cm4gKHQgPiAwLjUpIGFuZCA0KigodC0xKV4zKSsxIG9yIDQqdF4zOwogICAgZW5kLAogICAgcmVjID0gZnVuY3Rpb24oeCwgeSwgdywgaCwgcmFkaXVzLCBjb2xvcikKICAgICAgICByYWRpdXMgPSBtYXRoLm1pbih4LzIsIHkvMiwgcmFkaXVzKQogICAgICAgIGxvY2FsIHIsIGcsIGIsIGEgPSB1bnBhY2soY29sb3IpCiAgICAgICAgcmVuZGVyZXIucmVjdGFuZ2xlKHgsIHkgKyByYWRpdXMsIHcsIGggLSByYWRpdXMqMiwgciwgZywgYiwgYSkKICAgICAgICByZW5kZXJlci5yZWN0YW5nbGUoeCArIHJhZGl1cywgeSwgdyAtIHJhZGl1cyoyLCByYWRpdXMsIHIsIGcsIGIsIGEpCiAgICAgICAgcmVuZGVyZXIucmVjdGFuZ2xlKHggKyByYWRpdXMsIHkgKyBoIC0gcmFkaXVzLCB3IC0gcmFkaXVzKjIsIHJhZGl1cywgciwgZywgYiwgYSkKICAgICAgICByZW5kZXJlci5jaXJjbGUoeCArIHJhZGl1cywgeSArIHJhZGl1cywgciwgZywgYiwgYSwgcmFkaXVzLCAxODAsIDAuMjUpCiAgICAgICAgcmVuZGVyZXIuY2lyY2xlKHggLSByYWRpdXMgKyB3LCB5ICsgcmFkaXVzLCByLCBnLCBiLCBhLCByYWRpdXMsIDkwLCAwLjI1KQogICAgICAgIHJlbmRlcmVyLmNpcmNsZSh4IC0gcmFkaXVzICsgdywgeSAtIHJhZGl1cyArIGgsIHIsIGcsIGIsIGEsIHJhZGl1cywgMCwgMC4yNSkKICAgICAgICByZW5kZXJlci5jaXJjbGUoeCArIHJhZGl1cywgeSAtIHJhZGl1cyArIGgsIHIsIGcsIGIsIGEsIHJhZGl1cywgLTkwLCAwLjI1KQogICAgZW5kLAogICAgcmVjX291dGxpbmUgPSBmdW5jdGlvbih4LCB5LCB3LCBoLCByYWRpdXMsIHRoaWNrbmVzcywgY29sb3IpCiAgICAgICAgcmFkaXVzID0gbWF0aC5taW4ody8yLCBoLzIsIHJhZGl1cykKICAgICAgICBsb2NhbCByLCBnLCBiLCBhID0gdW5wYWNrKGNvbG9yKQogICAgICAgIGlmIHJhZGl1cyA9PSAxIHRoZW4KICAgICAgICAgICAgcmVuZGVyZXIucmVjdGFuZ2xlKHgsIHksIHcsIHRoaWNrbmVzcywgciwgZywgYiwgYSkKICAgICAgICAgICAgcmVuZGVyZXIucmVjdGFuZ2xlKHgsIHkgKyBoIC0gdGhpY2tuZXNzLCB3ICwgdGhpY2tuZXNzLCByLCBnLCBiLCBhKQogICAgICAgIGVsc2UKICAgICAgICAgICAgcmVuZGVyZXIucmVjdGFuZ2xlKHggKyByYWRpdXMsIHksIHcgLSByYWRpdXMqMiwgdGhpY2tuZXNzLCByLCBnLCBiLCBhKQogICAgICAgICAgICByZW5kZXJlci5yZWN0YW5nbGUoeCArIHJhZGl1cywgeSArIGggLSB0aGlja25lc3MsIHcgLSByYWRpdXMqMiwgdGhpY2tuZXNzLCByLCBnLCBiLCBhKQogICAgICAgICAgICByZW5kZXJlci5yZWN0YW5nbGUoeCwgeSArIHJhZGl1cywgdGhpY2tuZXNzLCBoIC0gcmFkaXVzKjIsIHIsIGcsIGIsIGEpCiAgICAgICAgICAgIHJlbmRlcmVyLnJlY3RhbmdsZSh4ICsgdyAtIHRoaWNrbmVzcywgeSArIHJhZGl1cywgdGhpY2tuZXNzLCBoIC0gcmFkaXVzKjIsIHIsIGcsIGIsIGEpCiAgICAgICAgICAgIHJlbmRlcmVyLmNpcmNsZV9vdXRsaW5lKHggKyByYWRpdXMsIHkgKyByYWRpdXMsIHIsIGcsIGIsIGEsIHJhZGl1cywgMTgwLCAwLjI1LCB0aGlja25lc3MpCiAgICAgICAgICAgIHJlbmRlcmVyLmNpcmNsZV9vdXRsaW5lKHggKyByYWRpdXMsIHkgKyBoIC0gcmFkaXVzLCByLCBnLCBiLCBhLCByYWRpdXMsIDkwLCAwLjI1LCB0aGlja25lc3MpCiAgICAgICAgICAgIHJlbmRlcmVyLmNpcmNsZV9vdXRsaW5lKHggKyB3IC0gcmFkaXVzLCB5ICsgcmFkaXVzLCByLCBnLCBiLCBhLCByYWRpdXMsIC05MCwgMC4yNSwgdGhpY2tuZXNzKQogICAgICAgICAgICByZW5kZXJlci5jaXJjbGVfb3V0bGluZSh4ICsgdyAtIHJhZGl1cywgeSArIGggLSByYWRpdXMsIHIsIGcsIGIsIGEsIHJhZGl1cywgMCwgMC4yNSwgdGhpY2tuZXNzKQogICAgICAgIGVuZAogICAgZW5kLAogICAgY2xhbXAgPSBmdW5jdGlvbih4LCBtaW4sIG1heCkKICAgICAgICByZXR1cm4geCA8IG1pbiBhbmQgbWluIG9yIHggPiBtYXggYW5kIG1heCBvciB4CiAgICBlbmQsCiAgICB0YWJsZV9jb250YWlucyA9IGZ1bmN0aW9uKHRibCwgdmFsdWUpCiAgICAgICAgZm9yIGkgPSAxLCAjdGJsIGRvCiAgICAgICAgICAgIGlmIHRibFtpXSA9PSB2YWx1ZSB0aGVuCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgICByZXR1cm4gZmFsc2UKICAgIGVuZCwKICAgIHNldEFBVGFiID0gZnVuY3Rpb24ocmVmKQogICAgICAgIHVpLnNldF92aXNpYmxlKHJlZnMuZW5hYmxlZCwgcmVmKQogICAgICAgIHVpLnNldF92aXNpYmxlKHJlZnMucGl0Y2hbMV0sIHJlZikKICAgICAgICB1aS5zZXRfdmlzaWJsZShyZWZzLnBpdGNoWzJdLCByZWYpCiAgICAgICAgdWkuc2V0X3Zpc2libGUocmVmcy5yb2xsLCByZWYpCiAgICAgICAgdWkuc2V0X3Zpc2libGUocmVmcy55YXdCYXNlLCByZWYpCiAgICAgICAgdWkuc2V0X3Zpc2libGUocmVmcy55YXdbMV0sIHJlZikKICAgICAgICB1aS5zZXRfdmlzaWJsZShyZWZzLnlhd1syXSwgcmVmKQogICAgICAgIHVpLnNldF92aXNpYmxlKHJlZnMueWF3Sml0dGVyWzFdLCByZWYpCiAgICAgICAgdWkuc2V0X3Zpc2libGUocmVmcy55YXdKaXR0ZXJbMl0sIHJlZikKICAgICAgICB1aS5zZXRfdmlzaWJsZShyZWZzLmJvZHlZYXdbMV0sIHJlZikKICAgICAgICB1aS5zZXRfdmlzaWJsZShyZWZzLmJvZHlZYXdbMl0sIHJlZikKICAgICAgICB1aS5zZXRfdmlzaWJsZShyZWZzLmZyZWVTdGFuZFsxXSwgcmVmKQogICAgICAgIHVpLnNldF92aXNpYmxlKHJlZnMuZnJlZVN0YW5kWzJdLCByZWYpCiAgICAgICAgdWkuc2V0X3Zpc2libGUocmVmcy5mc0JvZHlZYXcsIHJlZikKICAgICAgICB1aS5zZXRfdmlzaWJsZShyZWZzLmVkZ2VZYXcsIHJlZikKICAgIGVuZCwKICAgIGZpbmREaXN0ID0gZnVuY3Rpb24gKHgxLCB5MSwgejEsIHgyLCB5MiwgejIpCiAgICAgICAgcmV0dXJuIG1hdGguc3FydCgoeDIgLSB4MSleMiArICh5MiAtIHkxKV4yICsgKHoyIC0gejEpXjIpCiAgICBlbmQsCiAgICByZXNldEFBVGFiID0gZnVuY3Rpb24oKQogICAgICAgIHVpLnNldChyZWZzLmVuYWJsZWQsIGZhbHNlKQogICAgICAgIHVpLnNldChyZWZzLnBpdGNoWzFdLCAiT2ZmIikKICAgICAgICB1aS5zZXQocmVmcy5waXRjaFsyXSwgMCkKICAgICAgICB1aS5zZXQocmVmcy5yb2xsLCAwKQogICAgICAgIHVpLnNldChyZWZzLnlhd0Jhc2UsICJsb2NhbCB2aWV3IikKICAgICAgICB1aS5zZXQocmVmcy55YXdbMV0sICJPZmYiKQogICAgICAgIHVpLnNldChyZWZzLnlhd1syXSwgMCkKICAgICAgICB1aS5zZXQocmVmcy55YXdKaXR0ZXJbMV0sICJPZmYiKQogICAgICAgIHVpLnNldChyZWZzLnlhd0ppdHRlclsyXSwgMCkKICAgICAgICB1aS5zZXQocmVmcy5ib2R5WWF3WzFdLCAiT2ZmIikKICAgICAgICB1aS5zZXQocmVmcy5ib2R5WWF3WzJdLCAwKQogICAgICAgIHVpLnNldChyZWZzLmZyZWVTdGFuZFsxXSwgZmFsc2UpCiAgICAgICAgdWkuc2V0KHJlZnMuZnJlZVN0YW5kWzJdLCAiT24gaG90a2V5IikKICAgICAgICB1aS5zZXQocmVmcy5mc0JvZHlZYXcsIGZhbHNlKQogICAgICAgIHVpLnNldChyZWZzLmVkZ2VZYXcsIGZhbHNlKQogICAgZW5kLAogICAgdHlwZV9mcm9tX3N0cmluZyA9IGZ1bmN0aW9uKGlucHV0KQogICAgICAgIGlmIHR5cGUoaW5wdXQpIH49ICJzdHJpbmciIHRoZW4gcmV0dXJuIGlucHV0IGVuZAoKICAgICAgICBsb2NhbCB2YWx1ZSA9IGlucHV0Omxvd2VyKCkKCiAgICAgICAgaWYgdmFsdWUgPT0gInRydWUiIHRoZW4KICAgICAgICAgICAgcmV0dXJuIHRydWUKICAgICAgICBlbHNlaWYgdmFsdWUgPT0gImZhbHNlIiB0aGVuCiAgICAgICAgICAgIHJldHVybiBmYWxzZQogICAgICAgIGVsc2VpZiB0b251bWJlcih2YWx1ZSkgfj0gbmlsIHRoZW4KICAgICAgICAgICAgcmV0dXJuIHRvbnVtYmVyKHZhbHVlKQogICAgICAgIGVsc2UKICAgICAgICAgICAgcmV0dXJuIHRvc3RyaW5nKGlucHV0KQogICAgICAgIGVuZAogICAgZW5kLAogICAgbGVycCA9IGZ1bmN0aW9uKHN0YXJ0LCB2ZW5kLCB0aW1lKQogICAgICAgIHJldHVybiBzdGFydCArICh2ZW5kIC0gc3RhcnQpICogdGltZQogICAgZW5kLAogICAgdmVjX2FuZ2xlcyA9IGZ1bmN0aW9uKGFuZ2xlX3gsIGFuZ2xlX3kpCiAgICAgICAgbG9jYWwgc3kgPSBtYXRoLnNpbihtYXRoLnJhZChhbmdsZV95KSkKICAgICAgICBsb2NhbCBjeSA9IG1hdGguY29zKG1hdGgucmFkKGFuZ2xlX3kpKQogICAgICAgIGxvY2FsIHNwID0gbWF0aC5zaW4obWF0aC5yYWQoYW5nbGVfeCkpCiAgICAgICAgbG9jYWwgY3AgPSBtYXRoLmNvcyhtYXRoLnJhZChhbmdsZV94KSkKICAgICAgICByZXR1cm4gY3AgKiBjeSwgY3AgKiBzeSwgLXNwCiAgICBlbmQsCiAgICBoZXggPSBmdW5jdGlvbihhcmcpCiAgICAgICAgbG9jYWwgcmVzdWx0ID0gIlxhIgogICAgICAgIGZvciBrZXksIHZhbHVlIGluIG5leHQsIGFyZyBkbwogICAgICAgICAgICBsb2NhbCBvdXRwdXQgPSAiIgogICAgICAgICAgICB3aGlsZSB2YWx1ZSA+IDAgZG8KICAgICAgICAgICAgICAgIGxvY2FsIGluZGV4ID0gbWF0aC5mbW9kKHZhbHVlLCAxNikgKyAxCiAgICAgICAgICAgICAgICB2YWx1ZSA9IG1hdGguZmxvb3IodmFsdWUgLyAxNikKICAgICAgICAgICAgICAgIG91dHB1dCA9IHN0cmluZy5zdWIoIjAxMjM0NTY3ODlBQkNERUYiLCBpbmRleCwgaW5kZXgpIC4uIG91dHB1dCAKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGlmICNvdXRwdXQgPT0gMCB0aGVuIAogICAgICAgICAgICAgICAgb3V0cHV0ID0gIjAwIiAKICAgICAgICAgICAgZWxzZWlmICNvdXRwdXQgPT0gMSB0aGVuIAogICAgICAgICAgICAgICAgb3V0cHV0ID0gIjAiIC4uIG91dHB1dCAKICAgICAgICAgICAgZW5kIAogICAgICAgICAgICByZXN1bHQgPSByZXN1bHQgLi4gb3V0cHV0CiAgICAgICAgZW5kIAogICAgICAgIHJldHVybiByZXN1bHQgLi4gIkZGIgogICAgZW5kLAogICAgc3BsaXQgPSBmdW5jdGlvbiggaW5wdXRzdHIsIHNlcCkKICAgICAgICBpZiBzZXAgPT0gbmlsIHRoZW4KICAgICAgICAgICAgICAgIHNlcCA9ICIlcyIKICAgICAgICBlbmQKICAgICAgICBsb2NhbCB0PXt9CiAgICAgICAgZm9yIHN0ciBpbiBzdHJpbmcuZ21hdGNoKGlucHV0c3RyLCAiKFteIi4uc2VwLi4iXSspIikgZG8KICAgICAgICAgICAgICAgIHRhYmxlLmluc2VydCh0LCBzdHIpCiAgICAgICAgZW5kCiAgICAgICAgcmV0dXJuIHQKICAgIGVuZCwKICAgIFJHQkF0b0hFWCA9IGZ1bmN0aW9uKHJlZEFyZywgZ3JlZW5BcmcsIGJsdWVBcmcsIGFscGhhQXJnKQogICAgICAgIHJldHVybiBzdHJpbmcuZm9ybWF0KCclLjJ4JS4yeCUuMnglLjJ4JywgcmVkQXJnLCBncmVlbkFyZywgYmx1ZUFyZywgYWxwaGFBcmcpCiAgICBlbmQsCiAgICBjcmVhdGVfY29sb3JfYXJyYXkgPSBmdW5jdGlvbihyLCBnLCBiLCBzdHJpbmcpCiAgICAgICAgbG9jYWwgY29sb3JzID0ge30KICAgICAgICBmb3IgaSA9IDAsICNzdHJpbmcgZG8KICAgICAgICAgICAgbG9jYWwgY29sb3IgPSB7ciwgZywgYiwgMjU1ICogbWF0aC5hYnMoMSAqIG1hdGguY29zKDIgKiBtYXRoLnBpICogZ2xvYmFscy5jdXJ0aW1lKCkgLyA0ICsgaSAqIDUgLyAzMCkpfQogICAgICAgICAgICB0YWJsZS5pbnNlcnQoY29sb3JzLCBjb2xvcikKICAgICAgICBlbmQKICAgICAgICByZXR1cm4gY29sb3JzCiAgICBlbmQsCiAgICB0ZXh0QXJyYXkgPSBmdW5jdGlvbihzdHJpbmcpCiAgICAgICAgbG9jYWwgcmVzdWx0ID0ge30KICAgICAgICBmb3IgaT0xLCAjc3RyaW5nIGRvCiAgICAgICAgICAgIHJlc3VsdFtpXSA9IHN0cmluZy5zdWIoc3RyaW5nLCBpLCBpKQogICAgICAgIGVuZAogICAgICAgIHJldHVybiByZXN1bHQKICAgIGVuZCwKICAgIGdyYWRpZW50X3RleHQgPSBmdW5jdGlvbihyMSwgZzEsIGIxLCBhMSwgcjIsIGcyLCBiMiwgYTIsIHRleHQpCiAgICAgICAgbG9jYWwgb3V0cHV0ID0gJycKICAgIAogICAgICAgIGxvY2FsIGxlbiA9ICN0ZXh0LTEKICAgIAogICAgICAgIGxvY2FsIHJpbmMgPSAocjIgLSByMSkgLyBsZW4KICAgICAgICBsb2NhbCBnaW5jID0gKGcyIC0gZzEpIC8gbGVuCiAgICAgICAgbG9jYWwgYmluYyA9IChiMiAtIGIxKSAvIGxlbgogICAgICAgIGxvY2FsIGFpbmMgPSAoYTIgLSBhMSkgLyBsZW4KICAgIAogICAgICAgIGZvciBpPTEsIGxlbisxIGRvCiAgICAgICAgICAgIG91dHB1dCA9IG91dHB1dCAuLiAoJ1xhJTAyeCUwMnglMDJ4JTAyeCVzJyk6Zm9ybWF0KHIxLCBnMSwgYjEsIGExLCB0ZXh0OnN1YihpLCBpKSkKICAgIAogICAgICAgICAgICByMSA9IHIxICsgcmluYwogICAgICAgICAgICBnMSA9IGcxICsgZ2luYwogICAgICAgICAgICBiMSA9IGIxICsgYmluYwogICAgICAgICAgICBhMSA9IGExICsgYWluYwogICAgICAgIGVuZAogICAgCiAgICAgICAgcmV0dXJuIG91dHB1dAogICAgZW5kCiwgICAgCiAgICB0aW1lX3RvX3RpY2tzID0gZnVuY3Rpb24odCkKICAgICAgICByZXR1cm4gbWF0aC5mbG9vcigwLjUgKyAodCAvIGdsb2JhbHMudGlja2ludGVydmFsKCkpKQogICAgZW5kLAogICAgaGVhZFZpc2libGUgPSBmdW5jdGlvbihlbmVteSkKICAgICAgICBsb2NhbF9wbGF5ZXIgPSBlbnRpdHkuZ2V0X2xvY2FsX3BsYXllcigpCiAgICAgICAgaWYgbG9jYWxfcGxheWVyID09IG5pbCB0aGVuIHJldHVybiBlbmQKICAgICAgICBsb2NhbCBleCwgZXksIGV6ID0gZW50aXR5LmhpdGJveF9wb3NpdGlvbihlbmVteSwgMSkKICAgIAogICAgICAgIGxvY2FsIGh4LCBoeSwgaHogPSBlbnRpdHkuaGl0Ym94X3Bvc2l0aW9uKGxvY2FsX3BsYXllciwgMSkKICAgICAgICBsb2NhbCBoZWFkX2ZyYWN0aW9uLCBoZWFkX2VudGluZGV4X2hpdCA9IGNsaWVudC50cmFjZV9saW5lKGVuZW15LCBleCwgZXksIGV6LCBoeCwgaHksIGh6KQogICAgICAgIGlmIGhlYWRfZW50aW5kZXhfaGl0ID09IGxvY2FsX3BsYXllciBvciBoZWFkX2ZyYWN0aW9uID09IDEgdGhlbiByZXR1cm4gdHJ1ZSBlbHNlIHJldHVybiBmYWxzZSBlbmQKICAgIGVuZAp9Cgpsb2NhbCBjbGFudGFnID0gZnVuY3Rpb24odGV4dCwgaW5kaWNlcykKICAgIGxvY2FsIHRleHRfYW5pbSA9ICIgICAgICAgICAgICAgICAiIC4uIHRleHQgLi4gIiAgICAgICAgICAgICAgICAgICAgICAiIAogICAgbG9jYWwgdGlja2ludGVydmFsID0gZ2xvYmFscy50aWNraW50ZXJ2YWwoKQogICAgbG9jYWwgdGlja2NvdW50ID0gZ2xvYmFscy50aWNrY291bnQoKSArIGZ1bmMudGltZV90b190aWNrcyhjbGllbnQubGF0ZW5jeSgpKQogICAgbG9jYWwgaSA9IHRpY2tjb3VudCAvIGZ1bmMudGltZV90b190aWNrcygwLjMpCiAgICBpID0gbWF0aC5mbG9vcihpICUgI2luZGljZXMpCiAgICBpID0gaW5kaWNlc1tpKzFdKzEKCiAgICByZXR1cm4gc3RyaW5nLnN1Yih0ZXh0X2FuaW0sIGksIGkrMTUpCmVuZAoKbG9jYWwgdHJhc2h0YWxrID0gZnVuY3Rpb24oZSkKCiAgICBsb2NhbCB2aWN0aW1fdXNlcmlkLCBhdHRhY2tlcl91c2VyaWQgPSBlLnVzZXJpZCwgZS5hdHRhY2tlcgogICAgaWYgdmljdGltX3VzZXJpZCA9PSBuaWwgb3IgYXR0YWNrZXJfdXNlcmlkID09IG5pbCB0aGVuCiAgICAgICAgcmV0dXJuCiAgICBlbmQKCiAgICBsb2NhbCB2aWN0aW1fZW50aW5kZXggICA9IGNsaWVudC51c2VyaWRfdG9fZW50aW5kZXgodmljdGltX3VzZXJpZCkKICAgIGxvY2FsIGF0dGFja2VyX2VudGluZGV4ID0gY2xpZW50LnVzZXJpZF90b19lbnRpbmRleChhdHRhY2tlcl91c2VyaWQpCiAgICBpZiBhdHRhY2tlcl9lbnRpbmRleCA9PSBlbnRpdHkuZ2V0X2xvY2FsX3BsYXllcigpIGFuZCBlbnRpdHkuaXNfZW5lbXkodmljdGltX2VudGluZGV4KSB0aGVuCiAgICAgICAgbG9jYWwgcGhyYXNlID0gc2x1cnNbbWF0aC5yYW5kb20oMSwgI3NsdXJzKV0KICAgICAgICBsb2NhbCBzYXkgPSAnc2F5ICcgLi4gcGhyYXNlCiAgICAgICAgY2xpZW50LmV4ZWMoc2F5KQogICAgZW5kCmVuZAoKbG9jYWwgY29sb3JfdGV4dCA9IGZ1bmN0aW9uKCBzdHJpbmcsIHIsIGcsIGIsIGEpCiAgICBsb2NhbCBhY2NlbnQgPSAiXGEiIC4uIGZ1bmMuUkdCQXRvSEVYKHIsIGcsIGIsIGEpCiAgICBsb2NhbCB3aGl0ZSA9ICJcYSIgLi4gZnVuYy5SR0JBdG9IRVgoMjU1LCAyNTUsIDI1NSwgYSkKCiAgICBsb2NhbCBzdHIgPSAiIgogICAgZm9yIGksIHMgaW4gaXBhaXJzKGZ1bmMuc3BsaXQoc3RyaW5nLCAiJCIpKSBkbwogICAgICAgIHN0ciA9IHN0ciAuLiAoaSAlIDIgPT0oIHN0cmluZzpzdWIoMSwgMSkgPT0gIiQiIGFuZCAwIG9yIDEpIGFuZCB3aGl0ZSBvciBhY2NlbnQpIC4uIHMKICAgIGVuZAoKICAgIHJldHVybiBzdHIKZW5kCgpsb2NhbCBhbmltYXRlX3RleHQgPSBmdW5jdGlvbih0aW1lLCBzdHJpbmcsIHIsIGcsIGIsIGEpCiAgICBsb2NhbCB0X291dCwgdF9vdXRfaXRlciA9IHsgfSwgMQoKICAgIGxvY2FsIGwgPSBzdHJpbmc6bGVuKCApIC0gMQoKICAgIGxvY2FsIHJfYWRkID0gKDI1NSAtIHIpCiAgICBsb2NhbCBnX2FkZCA9ICgyNTUgLSBnKQogICAgbG9jYWwgYl9hZGQgPSAoMjU1IC0gYikKICAgIGxvY2FsIGFfYWRkID0gKDE1NSAtIGEpCgogICAgZm9yIGkgPSAxLCAjc3RyaW5nIGRvCiAgICAgICAgbG9jYWwgaXRlciA9IChpIC0gMSkvKCNzdHJpbmcgLSAxKSArIHRpbWUKICAgICAgICB0X291dFt0X291dF9pdGVyXSA9ICJcYSIgLi4gZnVuYy5SR0JBdG9IRVgoIHIgKyByX2FkZCAqIG1hdGguYWJzKG1hdGguY29zKCBpdGVyICkpLCBnICsgZ19hZGQgKiBtYXRoLmFicyhtYXRoLmNvcyggaXRlciApKSwgYiArIGJfYWRkICogbWF0aC5hYnMobWF0aC5jb3MoIGl0ZXIgKSksIGEgKyBhX2FkZCAqIG1hdGguYWJzKG1hdGguY29zKCBpdGVyICkpICkKCiAgICAgICAgdF9vdXRbdF9vdXRfaXRlciArIDFdID0gc3RyaW5nOnN1YiggaSwgaSApCgogICAgICAgIHRfb3V0X2l0ZXIgPSB0X291dF9pdGVyICsgMgogICAgZW5kCgogICAgcmV0dXJuIHRfb3V0CmVuZAoKbG9jYWwgZ2xvd19tb2R1bGUgPSBmdW5jdGlvbih4LCB5LCB3LCBoLCB3aWR0aCwgcm91bmRpbmcsIGFjY2VudCwgYWNjZW50X2lubmVyKQogICAgbG9jYWwgdGhpY2tuZXNzID0gMQogICAgbG9jYWwgT2Zmc2V0ID0gMQogICAgbG9jYWwgciwgZywgYiwgYSA9IHVucGFjayhhY2NlbnQpCiAgICBpZiBhY2NlbnRfaW5uZXIgdGhlbgogICAgICAgIGZ1bmMucmVjKHgsIHksIHcsIGggKyAxLCByb3VuZGluZywgYWNjZW50X2lubmVyKQogICAgZW5kCiAgICBmb3IgayA9IDAsIHdpZHRoIGRvCiAgICAgICAgaWYgYSAqIChrL3dpZHRoKV4oMSkgPiA1IHRoZW4KICAgICAgICAgICAgbG9jYWwgYWNjZW50ID0ge3IsIGcsIGIsIGEgKiAoay93aWR0aCleKDIpfQogICAgICAgICAgICBmdW5jLnJlY19vdXRsaW5lKHggKyAoayAtIHdpZHRoIC0gT2Zmc2V0KSp0aGlja25lc3MsIHkgKyAoayAtIHdpZHRoIC0gT2Zmc2V0KSAqIHRoaWNrbmVzcywgdyAtIChrIC0gd2lkdGggLSBPZmZzZXQpKnRoaWNrbmVzcyoyLCBoICsgMSAtIChrIC0gd2lkdGggLSBPZmZzZXQpKnRoaWNrbmVzcyoyLCByb3VuZGluZyArIHRoaWNrbmVzcyAqICh3aWR0aCAtIGsgKyBPZmZzZXQpLCB0aGlja25lc3MsIGFjY2VudCkKICAgICAgICBlbmQKICAgIGVuZAplbmQKCmxvY2FsIGNvbG9yZnVsX3RleHQgPSB7CiAgICBsZXJwID0gZnVuY3Rpb24oc2VsZiwgZnJvbSwgdG8sIGR1cmF0aW9uKQogICAgICAgIGlmIHR5cGUoZnJvbSkgPT0gJ3RhYmxlJyBhbmQgdHlwZSh0bykgPT0gJ3RhYmxlJyB0aGVuCiAgICAgICAgICAgIHJldHVybiB7IAogICAgICAgICAgICAgICAgc2VsZjpsZXJwKGZyb21bMV0sIHRvWzFdLCBkdXJhdGlvbiksIAogICAgICAgICAgICAgICAgc2VsZjpsZXJwKGZyb21bMl0sIHRvWzJdLCBkdXJhdGlvbiksIAogICAgICAgICAgICAgICAgc2VsZjpsZXJwKGZyb21bM10sIHRvWzNdLCBkdXJhdGlvbikgCiAgICAgICAgICAgIH07CiAgICAgICAgZW5kCiAgICAKICAgICAgICByZXR1cm4gZnJvbSArICh0byAtIGZyb20pICogZHVyYXRpb247CiAgICBlbmQsCiAgICBjb25zb2xlID0gZnVuY3Rpb24oc2VsZiwgLi4uKQogICAgICAgIGZvciBpLCB2IGluIGlwYWlycyh7IC4uLiB9KSBkbwogICAgICAgICAgICBpZiB0eXBlKHZbMV0pID09ICd0YWJsZScgYW5kIHR5cGUodlsyXSkgPT0gJ3RhYmxlJyBhbmQgdHlwZSh2WzNdKSA9PSAnc3RyaW5nJyB0aGVuCiAgICAgICAgICAgICAgICBmb3IgayA9IDEsICN2WzNdIGRvCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgbCA9IHNlbGY6bGVycCh2WzFdLCB2WzJdLCBrIC8gI3ZbM10pOwogICAgICAgICAgICAgICAgICAgIGNsaWVudC5jb2xvcl9sb2cobFsxXSwgbFsyXSwgbFszXSwgdlszXTpzdWIoaywgaykgLi4gJ1wwJyk7CiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZWxzZWlmIHR5cGUodlsxXSkgPT0gJ3RhYmxlJyBhbmQgdHlwZSh2WzJdKSA9PSAnc3RyaW5nJyB0aGVuCiAgICAgICAgICAgICAgICBjbGllbnQuY29sb3JfbG9nKHZbMV1bMV0sIHZbMV1bMl0sIHZbMV1bM10sIHZbMl0gLi4gJ1wwJyk7CiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kLAogICAgdGV4dCA9IGZ1bmN0aW9uKHNlbGYsIC4uLikKICAgICAgICBsb2NhbCBtZW51ID0gZmFsc2U7CiAgICAgICAgbG9jYWwgYWxwaGEgPSAyNTUKICAgICAgICBsb2NhbCBmID0gJyc7CiAgICAgICAgCiAgICAgICAgZm9yIGksIHYgaW4gaXBhaXJzKHsgLi4uIH0pIGRvCiAgICAgICAgICAgIGlmIHR5cGUodikgPT0gJ2Jvb2xlYW4nIHRoZW4KICAgICAgICAgICAgICAgIG1lbnUgPSB2OwogICAgICAgICAgICBlbHNlaWYgdHlwZSh2KSA9PSAnbnVtYmVyJyB0aGVuCiAgICAgICAgICAgICAgICBhbHBoYSA9IHY7CiAgICAgICAgICAgIGVsc2VpZiB0eXBlKHYpID09ICdzdHJpbmcnIHRoZW4KICAgICAgICAgICAgICAgIGYgPSBmIC4uIHY7CiAgICAgICAgICAgIGVsc2VpZiB0eXBlKHYpID09ICd0YWJsZScgdGhlbgogICAgICAgICAgICAgICAgaWYgdHlwZSh2WzFdKSA9PSAndGFibGUnIGFuZCB0eXBlKHZbMl0pID09ICdzdHJpbmcnIHRoZW4KICAgICAgICAgICAgICAgICAgICBmID0gZiAuLiAoJ1xhJTAyeCUwMnglMDJ4JTAyeCcpOmZvcm1hdCh2WzFdWzFdLCB2WzFdWzJdLCB2WzFdWzNdLCBhbHBoYSkgLi4gdlsyXTsKICAgICAgICAgICAgICAgIGVsc2VpZiB0eXBlKHZbMV0pID09ICd0YWJsZScgYW5kIHR5cGUodlsyXSkgPT0gJ3RhYmxlJyBhbmQgdHlwZSh2WzNdKSA9PSAnc3RyaW5nJyB0aGVuCiAgICAgICAgICAgICAgICAgICAgZm9yIGsgPSAxLCAjdlszXSBkbwogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBnID0gc2VsZjpsZXJwKHZbMV0sIHZbMl0sIGsgLyAjdlszXSkKICAgICAgICAgICAgICAgICAgICAgICAgZiA9IGYgLi4gKCdcYSUwMnglMDJ4JTAyeCUwMngnKTpmb3JtYXQoZ1sxXSwgZ1syXSwgZ1szXSwgYWxwaGEpIC4uIHZbM106c3ViKGssIGspCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICAKICAgICAgICByZXR1cm4gKCclc1xhJXMlMDJ4Jyk6Zm9ybWF0KGYsIChtZW51KSBhbmQgJ2NkY2RjZCcgb3IgJ2ZmZmZmZicsIGFscGhhKTsKICAgIGVuZCwKICAgIGxvZyA9IGZ1bmN0aW9uKHNlbGYsIC4uLikKICAgICAgICBmb3IgaSwgdiBpbiBpcGFpcnMoeyAuLi4gfSkgZG8KICAgICAgICAgICAgaWYgdHlwZSh2KSA9PSAndGFibGUnIHRoZW4KICAgICAgICAgICAgICAgIGlmIHR5cGUodlsxXSkgPT0gJ3RhYmxlJyB0aGVuCiAgICAgICAgICAgICAgICAgICAgaWYgdHlwZSh2WzJdKSA9PSAnc3RyaW5nJyB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGY6Y29uc29sZSh7IHZbMV0sIHZbMV0sIHZbMl0gfSkKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZbM10pIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGY6Y29uc29sZSh7IHsgMjU1LCAyNTUsIDI1NSB9LCAnXG4nIH0pCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVsc2VpZiB0eXBlKHZbMl0pID09ICd0YWJsZScgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBzZWxmOmNvbnNvbGUoeyB2WzFdLCB2WzJdLCB2WzNdIH0pCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHZbNF0gdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZjpjb25zb2xlKHsgeyAyNTUsIDI1NSwgMjU1IH0sICdcbicgfSkKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbHNlaWYgdHlwZSh2WzFdKSA9PSAnc3RyaW5nJyB0aGVuCiAgICAgICAgICAgICAgICAgICAgc2VsZjpjb25zb2xlKHsgeyAyMDUsIDIwNSwgMjA1IH0sIHZbMV0gfSk7CiAgICAgICAgICAgICAgICAgICAgaWYgdlsyXSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGY6Y29uc29sZSh7IHsgMjU1LCAyNTUsIDI1NSB9LCAnXG4nIH0pCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKfQpsb2NhbCBkb3dubG9hZApsb2NhbCBmdW5jdGlvbiBkb3dubG9hZEZpbGUoKQoJaHR0cC5nZXQoc3RyaW5nLmZvcm1hdCgiaHR0cHM6Ly9mbGFnc2FwaS5jb20vJXMvZmxhdC82NC5wbmciLCBNeVBlcnNvbmFBUEkuR2V0TXlDb3VudHJ5Q29kZSgpKSwgZnVuY3Rpb24oc3VjY2VzcywgcmVzcG9uc2UpCgkJaWYgbm90IHN1Y2Nlc3Mgb3IgcmVzcG9uc2Uuc3RhdHVzIH49IDIwMCB0aGVuCgkJCXByaW50KCJjb3VsZG50IGZldGNoIHRoZSBmbGFnIGltYWdlIikKICAgICAgICAgICAgcmV0dXJuCgkJZW5kCgoJCWRvd25sb2FkID0gcmVzcG9uc2UuYm9keQoJZW5kKQoKICAgIGh0dHAuZ2V0KCJodHRwczovL2Nkbi5kaXNjb3JkYXBwLmNvbS9hdHRhY2htZW50cy8xMjU5NTc3NTk4OTg4Nzc5NTczLzEyNTk1OTgwMTcwMzY1NTAyNzQvMDc2MDEyZWQ3NTM5NDRhYWQxZjk2MWI2ODgxNjgyNWU2NTJkNjc2ZTAxYjY5LnBuZz9leD02NjhjNDM5MSZpcz02NjhhZjIxMSZobT1mMWIxMDk2ZmU3YzcxNjYyMmY5MDExMjJmZjc2YWNkZjMwZWNhZTBmMmVmZjZjNTJkMWMxYWE1MTRhYWM4NTkzJiIsIGZ1bmN0aW9uKHN1Y2Nlc3MsIHJlc3BvbnNlKQoJCWlmIG5vdCBzdWNjZXNzIG9yIHJlc3BvbnNlLnN0YXR1cyB+PSAyMDAgdGhlbgoJCQlwcmludCgiY291bGRudCBmZXRjaCB0aGUgbG9nbyBpbWFnZSIpCiAgICAgICAgICAgIHJldHVybgoJCWVuZAoKCQl3cml0ZWZpbGUoImxvZ28ucG5nIiwgcmVzcG9uc2UuYm9keSkKCWVuZCkKZW5kCmRvd25sb2FkRmlsZSgpCi0tIEByZWdpb24gRlVOQ1MgZW5kCgotLSBAcmVnaW9uIFVJX0xBWU9VVCBzdGFydApsb2NhbCB0YWIsIGNvbnRhaW5lciA9ICJBQSIsICJBbnRpLWFpbWJvdCBhbmdsZXMiCmxvY2FsIGxhYmVsID0gdWkubmV3X2xhYmVsKHRhYiwgY29udGFpbmVyLCBsdWFfbmFtZSkKbG9jYWwgdGFiUGlja2VyID0gdWkubmV3X2NvbWJvYm94KHRhYiwgY29udGFpbmVyLCAiXG5UYWIiLCAiQW50aS1haW0iLCAiQnVpbGRlciIsICJWaXN1YWxzIiwgIk1pc2MiLCAiQ29uZmlnIikKCmxvY2FsIG1lbnUgPSB7CiAgICBhYVRhYiA9IHsKICAgICAgICBmcmVlc3RhbmRIb3RrZXkgPSB1aS5uZXdfaG90a2V5KCJBQSIsICJGYWtlIExhZyIsICJGcmVlc3RhbmQiKSwKICAgICAgICBsZWdpdEFBSG90a2V5ID0gdWkubmV3X2hvdGtleSgiQUEiLCAiRmFrZSBMYWciLCAiTGVnaXQgQW50aS1cYUNCQzVFMEU2YWltIiksCiAgICAgICAgZWRnZVlhd0hvdGtleSA9IHVpLm5ld19ob3RrZXkoIkFBIiwgIkZha2UgTGFnIiwgIkVkZ2UgXGFDQkM1RTBFNllhdyIpLAogICAgICAgIGF2b2lkQmFja3N0YWIgPSB1aS5uZXdfc2xpZGVyKCJBQSIsICJGYWtlIExhZyIsICJBdm9pZCBCYWNrXGFDQkM1RTBFNnN0YWIiLCAwLCAzMDAsIDAsIHRydWUsICJ1IiwgMSwge1swXSA9ICJPZmYifSksCiAgICAgICAgbWFudWFscyA9IHVpLm5ld19jb21ib2JveCgiQUEiLCAiRmFrZSBMYWciLCAiTWFudVxhQ0JDNUUwRTZhbHMiLCAiT2ZmIiwgIkRlZmF1bHQiLCAiU3RhdGljIiksCiAgICAgICAgbWFudWFsVGFiID0gewogICAgICAgICAgICBtYW51YWxMZWZ0ID0gdWkubmV3X2hvdGtleSgiQUEiLCAiRmFrZSBMYWciLCAiTWFudWFsICIgLi4gZnVuYy5oZXgoezIwMCwyMDAsMjAwfSkgLi4gImxlZnQiKSwKICAgICAgICAgICAgbWFudWFsUmlnaHQgPSB1aS5uZXdfaG90a2V5KCJBQSIsICJGYWtlIExhZyIsICJNYW51YWwgIiAuLiBmdW5jLmhleCh7MjAwLDIwMCwyMDB9KSAuLiAicmlnaHQiKSwKICAgICAgICAgICAgbWFudWFsRm9yd2FyZCA9IHVpLm5ld19ob3RrZXkoIkFBIiwgIkZha2UgTGFnIiwgIk1hbnVhbCAiIC4uIGZ1bmMuaGV4KHsyMDAsMjAwLDIwMH0pIC4uICJmb3J3YXJkIiksCiAgICAgICAgfSwKICAgIH0sCiAgICBidWlsZGVyVGFiID0gewogICAgICAgIHN0YXRlID0gdWkubmV3X2NvbWJvYm94KHRhYiwgY29udGFpbmVyLCAiQW50aS1haW0gc3RhdGUiLCB2YXJzLmFhU3RhdGVzKQogICAgfSwKICAgIHZpc3VhbHNUYWIgPSB7CiAgICAgICAgaW5kaWNhdG9ycyA9IHVpLm5ld19jaGVja2JveCh0YWIsIGNvbnRhaW5lciwgIkluZGlcYUNCQzVFMEU2Y2F0b3JzIiksCiAgICAgICAgaW5kaWNhdG9yc0NsciA9IHVpLm5ld19jb2xvcl9waWNrZXIodGFiLCBjb250YWluZXIsICJNYWluIENvbG9yIiwgbHVhX2NvbG9yLnIsIGx1YV9jb2xvci5nLCBsdWFfY29sb3IuYiwgMjU1KSwKICAgICAgICBpbmRpY2F0b3JzVHlwZSA9IHVpLm5ld19jb21ib2JveCh0YWIsIGNvbnRhaW5lciwgIlxuIGluZGljYXRvcnMgdHlwZSIsICItIiwgIlN0eWxlIDEiLCAiU3R5bGUgMiIpLAogICAgICAgIGluZGljYXRvcnNTdHlsZSA9IHVpLm5ld19tdWx0aXNlbGVjdCh0YWIsIGNvbnRhaW5lciwgIkVsZVxhQ0JDNUUwRTZtZW50cyIsICJOYW1lIiwgIlN0YXRlIiwgIkRvdWJsZXRhcCIsICJIaWRlc2hvdHMiLCAiRnJlZXN0YW5kIiwgIlNhZmVwb2ludCIsICJCb2R5IGFpbSIsICJGYWtlZHVjayIpLAogICAgICAgIGFycm93cyA9IHVpLm5ld19jaGVja2JveCh0YWIsIGNvbnRhaW5lciwgIkFyclxhQ0JDNUUwRTZvd3MiKSwKICAgICAgICBhcnJvd0NsciA9IHVpLm5ld19jb2xvcl9waWNrZXIodGFiLCBjb250YWluZXIsICJBcnJvdyBDb2xvciIsIGx1YV9jb2xvci5yLCBsdWFfY29sb3IuZywgbHVhX2NvbG9yLmIsIDI1NSksCiAgICAgICAgYXJyb3dJbmRpY2F0b3JTdHlsZSA9IHVpLm5ld19jb21ib2JveCh0YWIsIGNvbnRhaW5lciwgIlxuIGFycm93cyBzdHlsZSIsICItIiwgIlRlYW1za2VldCIsICJNb2Rlcm4iKSwKICAgICAgICB3YXRlcm1hcmsgPSB1aS5uZXdfY2hlY2tib3godGFiLCBjb250YWluZXIsICJCcmFuZGVkIFxhQ0JDNUUwRTZXYXRlcm1hcmsiKSwKICAgICAgICB3YXRlcm1hcmtDbHIgPSB1aS5uZXdfY29sb3JfcGlja2VyKHRhYiwgY29udGFpbmVyLCAiV2F0ZXJtYXJrIENvbG9yIiwgbHVhX2NvbG9yLnIsIGx1YV9jb2xvci5nLCBsdWFfY29sb3IuYiwgMjU1KSwKICAgICAgICBtaW5EbWdJbmRpY2F0b3IgPSB1aS5uZXdfY2hlY2tib3godGFiLCBjb250YWluZXIsICJNaW5pbXVtIFxhQ0JDNUUwRTZEYW1hZ2UgSW5kaWNhdG9yIiksCiAgICAgICAgbG9ncyA9IHVpLm5ld19jaGVja2JveCh0YWIsIGNvbnRhaW5lciwgIkxvXGFDQkM1RTBFNmdzIiksCiAgICAgICAgbG9nc0NsciA9IHVpLm5ld19jb2xvcl9waWNrZXIodGFiLCBjb250YWluZXIsICJMb2dzIENvbG9yIiwgbHVhX2NvbG9yLnIsIGx1YV9jb2xvci5nLCBsdWFfY29sb3IuYiwgMjU1KSwKICAgICAgICBsb2dPZmZzZXQgPSB1aS5uZXdfc2xpZGVyKHRhYiwgY29udGFpbmVyLCAiT2Zmc2V0IiwgMCwgNTAwLCAxMDAsIHRydWUsICJweCIsIDEpCiAgICB9LAogICAgbWlzY1RhYiA9IHsKICAgICAgICBmaXhIaWRlc2hvdHMgPSB1aS5uZXdfY2hlY2tib3godGFiLCBjb250YWluZXIsICJGaXggaGlkZVxhQ0JDNUUwRTZzaG90cyIpLAogICAgICAgIG1hbnVhbHNPdmVyRnMgPSB1aS5uZXdfY2hlY2tib3godGFiLCBjb250YWluZXIsICJNYW51YWxzIG92ZXIgZnJlZVxhQ0JDNUUwRTZzdGFuZGluZyIpLAogICAgICAgIGR0RGlzY2hhcmdlID0gdWkubmV3X2NoZWNrYm94KHRhYiwgY29udGFpbmVyLCAiQXV0byBEVCBEaXNcYUNCQzVFMEU2Y2hhcmdlIiksCiAgICAgICAgY2xhblRhZyA9IHVpLm5ld19jaGVja2JveCh0YWIsIGNvbnRhaW5lciwgIkNsYW5cYUNCQzVFMEU2dGFnIiksCiAgICAgICAgdHJhc2hUYWxrID0gdWkubmV3X2NoZWNrYm94KHRhYiwgY29udGFpbmVyLCAiVHJhc2hcYUNCQzVFMEU2dGFsayIpLAogICAgICAgIGZhc3RMYWRkZXJFbmFibGVkID0gdWkubmV3X2NoZWNrYm94KHRhYiwgY29udGFpbmVyLCAiRmFzdCBcYUNCQzVFMEU2bGFkZGVyIiksCiAgICAgICAgZmFzdExhZGRlciA9IHVpLm5ld19tdWx0aXNlbGVjdCh0YWIsIGNvbnRhaW5lciwgIlxuIGZhc3QgbGFkZGVyIiwgIkFzY2VuZGluZyIsICJEZXNjZW5kaW5nIiksCiAgICAgICAgYW5pbWF0aW9uc0VuYWJsZWQgPSB1aS5uZXdfY2hlY2tib3godGFiLCBjb250YWluZXIsICJBbmltIFxhQ0JDNUUwRTZicmVha2VycyIpLAogICAgICAgIGFuaW1hdGlvbnMgPSB1aS5uZXdfbXVsdGlzZWxlY3QodGFiLCBjb250YWluZXIsICJcbiBhbmltYXRpb24gYnJlYWtlcnMiLCAiU3RhdGljIGxlZ3MiLCAiTGVnIGZ1Y2tlciIsICIwIHBpdGNoIG9uIGxhbmRpbmciLCAiQWxsYWggbGVncyIpLAogICAgfSwKICAgIGNvbmZpZ1RhYiA9IHsKICAgICAgICBsaXN0ID0gdWkubmV3X2xpc3Rib3godGFiLCBjb250YWluZXIsICJDb25maWdzIiwgIiIpLAogICAgICAgIG5hbWUgPSB1aS5uZXdfdGV4dGJveCh0YWIsIGNvbnRhaW5lciwgIkNvbmZpZyBuYW1lIiwgIiIpLAogICAgICAgIGxvYWQgPSB1aS5uZXdfYnV0dG9uKHRhYiwgY29udGFpbmVyLCAiTG9hZCIsIGZ1bmN0aW9uKCkgZW5kKSwKICAgICAgICBzYXZlID0gdWkubmV3X2J1dHRvbih0YWIsIGNvbnRhaW5lciwgIlNhdmUiLCBmdW5jdGlvbigpIGVuZCksCiAgICAgICAgZGVsZXRlID0gdWkubmV3X2J1dHRvbih0YWIsIGNvbnRhaW5lciwgIkRlbGV0ZSIsIGZ1bmN0aW9uKCkgZW5kKSwKICAgICAgICBpbXBvcnQgPSB1aS5uZXdfYnV0dG9uKHRhYiwgY29udGFpbmVyLCAiSW1wb3J0IiwgZnVuY3Rpb24oKSBlbmQpLAogICAgICAgIGV4cG9ydCA9IHVpLm5ld19idXR0b24odGFiLCBjb250YWluZXIsICJFeHBvcnQiLCBmdW5jdGlvbigpIGVuZCkKICAgIH0KfQoKbG9jYWwgYWFCdWlsZGVyID0ge30KbG9jYWwgYWFDb250YWluZXIgPSB7fQpmb3IgaT0xLCAjdmFycy5hYVN0YXRlcyBkbwogICAgYWFDb250YWluZXJbaV0gPSBmdW5jLmhleCh7MjAwLDIwMCwyMDB9KSAuLiAiKCIgLi4gZnVuYy5oZXgoezIyMiw1NSw1NX0pIC4uICIiIC4uIHZhcnMucFN0YXRlc1tpXSAuLiAiIiAuLiBmdW5jLmhleCh7MjAwLDIwMCwyMDB9KSAuLiAiKSIgLi4gZnVuYy5oZXgoezE1NSwxNTUsMTU1fSkgLi4gIiAiCiAgICBhYUJ1aWxkZXJbaV0gPSB7CiAgICAgICAgZW5hYmxlU3RhdGUgPSB1aS5uZXdfY2hlY2tib3godGFiLCBjb250YWluZXIsICJFbmFcYUNCQzVFMEU2YmxlICIgLi4gZnVuYy5oZXgoe2x1YV9jb2xvci5yLCBsdWFfY29sb3IuZywgbHVhX2NvbG9yLmJ9KSAuLiB2YXJzLmFhU3RhdGVzW2ldIC4uIGZ1bmMuaGV4KHsyMDAsMjAwLDIwMH0pIC4uICIgc3RhdGUiKSwKICAgICAgICBmb3JjZURlZmVuc2l2ZSA9IHVpLm5ld19jaGVja2JveCh0YWIsIGNvbnRhaW5lciwgIkZvcmNlIFxhQ0JDNUUwRTZEZWZlbnNpdmVcbiIgLi4gYWFDb250YWluZXJbaV0pLAogICAgICAgIHBpdGNoID0gdWkubmV3X2NvbWJvYm94KHRhYiwgY29udGFpbmVyLCAiUGl0Y2hcbiIgLi4gYWFDb250YWluZXJbaV0sICJPZmYiLCAiRGVmYXVsdCIsICJVcCIsICJEb3duIiwgIk1pbmltYWwiLCAiUmFuZG9tIiwgIkN1c3RvbSIpLAogICAgICAgIHBpdGNoU2xpZGVyID0gdWkubmV3X3NsaWRlcih0YWIsIGNvbnRhaW5lciwgIlxuUGl0Y2ggYWRkIiAuLiBhYUNvbnRhaW5lcltpXSwgLTg5LCA4OSwgMCwgdHJ1ZSwgIsOD4oCaw4LCsCIsIDEpLAogICAgICAgIHlhd0Jhc2UgPSB1aS5uZXdfY29tYm9ib3godGFiLCBjb250YWluZXIsICJZYXcgYmFzZVxuIiAuLiBhYUNvbnRhaW5lcltpXSwgIkxvY2FsIHZpZXciLCAiQXQgdGFyZ2V0cyIpLAogICAgICAgIHlhdyA9IHVpLm5ld19jb21ib2JveCh0YWIsIGNvbnRhaW5lciwgIllhd1xuIiAuLiBhYUNvbnRhaW5lcltpXSwgIk9mZiIsICIxODAiLCAiMTgwIFoiLCAiU3BpbiIsICJTbG93IFlhdyIsICJMJlIiKSwKICAgICAgICB5YXdTdGF0aWMgPSB1aS5uZXdfc2xpZGVyKHRhYiwgY29udGFpbmVyLCAiXG55YXciIC4uIGFhQ29udGFpbmVyW2ldLCAtMTgwLCAxODAsIDAsIHRydWUsICLDg+KAmsOCwrAiLCAxKSwKICAgICAgICB5YXdMZWZ0ID0gdWkubmV3X3NsaWRlcih0YWIsIGNvbnRhaW5lciwgIkxlZnRcbnlhdyIgLi4gYWFDb250YWluZXJbaV0sIC0xODAsIDE4MCwgMCwgdHJ1ZSwgIsOD4oCaw4LCsCIsIDEpLAogICAgICAgIHlhd1JpZ2h0ID0gdWkubmV3X3NsaWRlcih0YWIsIGNvbnRhaW5lciwgIlJpZ2h0XG55YXciIC4uIGFhQ29udGFpbmVyW2ldLCAtMTgwLCAxODAsIDAsIHRydWUsICLDg+KAmsOCwrAiLCAxKSwKICAgICAgICB5YXdKaXR0ZXIgPSB1aS5uZXdfY29tYm9ib3godGFiLCBjb250YWluZXIsICJZYXcgaml0dGVyXG4iIC4uIGFhQ29udGFpbmVyW2ldLCAiT2ZmIiwgIk9mZnNldCIsICJDZW50ZXIiLCAiU2tpdHRlciIsICJSYW5kb20iLCAiMy1XYXkiLCAiTCZSIiksCiAgICAgICAgd2F5Rmlyc3QgPSB1aS5uZXdfc2xpZGVyKHRhYiwgY29udGFpbmVyLCAiRmlyc3RcbnlhdyBqaXR0ZXIiIC4uIGFhQ29udGFpbmVyW2ldLCAtMTgwLCAxODAsIDAsIHRydWUsICIiLCAxKSwKICAgICAgICB3YXlTZWNvbmQgPSB1aS5uZXdfc2xpZGVyKHRhYiwgY29udGFpbmVyLCAiU2Vjb25kXG55YXcgaml0dGVyIiAuLiBhYUNvbnRhaW5lcltpXSwgLTE4MCwgMTgwLCAwLCB0cnVlLCAiw4PigJrDgsKwIiwgMSksCiAgICAgICAgd2F5VGhpcmQgPSB1aS5uZXdfc2xpZGVyKHRhYiwgY29udGFpbmVyLCAiVGhpcmRcbnlhdyBqaXR0ZXIiIC4uIGFhQ29udGFpbmVyW2ldLCAtMTgwLCAxODAsIDAsIHRydWUsICLDg+KAmsOCwrAiLCAxKSwKICAgICAgICB5YXdKaXR0ZXJTdGF0aWMgPSB1aS5uZXdfc2xpZGVyKHRhYiwgY29udGFpbmVyLCAiXG55YXcgaml0dGVyIiAuLiBhYUNvbnRhaW5lcltpXSwgLTE4MCwgMTgwLCAwLCB0cnVlLCAiw4PigJrDgsKwIiwgMSksCiAgICAgICAgeWF3Sml0dGVyTGVmdCA9IHVpLm5ld19zbGlkZXIodGFiLCBjb250YWluZXIsICJMZWZ0XG55YXcgaml0dGVyIiAuLiBhYUNvbnRhaW5lcltpXSwgLTE4MCwgMTgwLCAwLCB0cnVlLCAiw4PigJrDgsKwIiwgMSksCiAgICAgICAgeWF3Sml0dGVyUmlnaHQgPSB1aS5uZXdfc2xpZGVyKHRhYiwgY29udGFpbmVyLCAiUmlnaHRcbnlhdyBqaXR0ZXIiIC4uIGFhQ29udGFpbmVyW2ldLCAtMTgwLCAxODAsIDAsIHRydWUsICLDg+KAmsOCwrAiLCAxKSwKICAgICAgICBib2R5WWF3ID0gdWkubmV3X2NvbWJvYm94KHRhYiwgY29udGFpbmVyLCAiQm9keSB5YXdcbiIgLi4gYWFDb250YWluZXJbaV0sICJPZmYiLCAiT3Bwb3NpdGUiLCAiSml0dGVyIiwgIlN0YXRpYyIpLAogICAgICAgIGJvZHlZYXdTdGF0aWMgPSB1aS5uZXdfc2xpZGVyKHRhYiwgY29udGFpbmVyLCAiXG5ib2R5IHlhdyIgLi4gYWFDb250YWluZXJbaV0sIC0xODAsIDE4MCwgMCwgdHJ1ZSwgIsOD4oCaw4LCsCIsIDEpLAogICAgfQplbmQKCmxvY2FsIGZ1bmN0aW9uIGdldENvbmZpZyhuYW1lKQogICAgbG9jYWwgZGF0YWJhc2UgPSBkYXRhYmFzZS5yZWFkKGx1YS5kYXRhYmFzZS5jb25maWdzKSBvciB7fQoKICAgIGZvciBpLCB2IGluIHBhaXJzKGRhdGFiYXNlKSBkbwogICAgICAgIGlmIHYubmFtZSA9PSBuYW1lIHRoZW4KICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgIGNvbmZpZyA9IHYuY29uZmlnLAogICAgICAgICAgICAgICAgaW5kZXggPSBpCiAgICAgICAgICAgIH0KICAgICAgICBlbmQKICAgIGVuZAoKICAgIGZvciBpLCB2IGluIHBhaXJzKHByZXNldHMpIGRvCiAgICAgICAgaWYgdi5uYW1lID09IG5hbWUgdGhlbgogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgY29uZmlnID0gdi5jb25maWcsCiAgICAgICAgICAgICAgICBpbmRleCA9IGkKICAgICAgICAgICAgfQogICAgICAgIGVuZAogICAgZW5kCgogICAgcmV0dXJuIGZhbHNlCmVuZApsb2NhbCBmdW5jdGlvbiBzYXZlQ29uZmlnKG5hbWUpCiAgICBsb2NhbCBkYiA9IGRhdGFiYXNlLnJlYWQobHVhLmRhdGFiYXNlLmNvbmZpZ3MpIG9yIHt9CiAgICBsb2NhbCBjb25maWcgPSB7fQoKICAgIGlmIG5hbWU6bWF0Y2goIlteJXddIikgfj0gbmlsIHRoZW4KICAgICAgICByZXR1cm4KICAgIGVuZAoKICAgIGZvciBrZXksIHZhbHVlIGluIHBhaXJzKHZhcnMucFN0YXRlcykgZG8KICAgICAgICBjb25maWdbdmFsdWVdID0ge30KICAgICAgICBmb3IgaywgdiBpbiBwYWlycyhhYUJ1aWxkZXJba2V5XSkgZG8KICAgICAgICAgICAgY29uZmlnW3ZhbHVlXVtrXSA9IHVpLmdldCh2KQogICAgICAgIGVuZAogICAgZW5kCgogICAgbG9jYWwgY2ZnID0gZ2V0Q29uZmlnKG5hbWUpCgogICAgaWYgbm90IGNmZyB0aGVuCiAgICAgICAgdGFibGUuaW5zZXJ0KGRiLCB7IG5hbWUgPSBuYW1lLCBjb25maWcgPSBjb25maWcgfSkKICAgIGVsc2UKICAgICAgICBkYltjZmcuaW5kZXhdLmNvbmZpZyA9IGNvbmZpZwogICAgZW5kCgogICAgZGF0YWJhc2Uud3JpdGUobHVhLmRhdGFiYXNlLmNvbmZpZ3MsIGRiKQplbmQKbG9jYWwgZnVuY3Rpb24gZGVsZXRlQ29uZmlnKG5hbWUpCiAgICBsb2NhbCBkYiA9IGRhdGFiYXNlLnJlYWQobHVhLmRhdGFiYXNlLmNvbmZpZ3MpIG9yIHt9CgogICAgZm9yIGksIHYgaW4gcGFpcnMoZGIpIGRvCiAgICAgICAgaWYgdi5uYW1lID09IG5hbWUgdGhlbgogICAgICAgICAgICB0YWJsZS5yZW1vdmUoZGIsIGkpCiAgICAgICAgICAgIGJyZWFrCiAgICAgICAgZW5kCiAgICBlbmQKCiAgICBmb3IgaSwgdiBpbiBwYWlycyhwcmVzZXRzKSBkbwogICAgICAgIGlmIHYubmFtZSA9PSBuYW1lIHRoZW4KICAgICAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgICAgZW5kCiAgICBlbmQKCiAgICBkYXRhYmFzZS53cml0ZShsdWEuZGF0YWJhc2UuY29uZmlncywgZGIpCmVuZApsb2NhbCBmdW5jdGlvbiBnZXRDb25maWdMaXN0KCkKICAgIGxvY2FsIGRhdGFiYXNlID0gZGF0YWJhc2UucmVhZChsdWEuZGF0YWJhc2UuY29uZmlncykgb3Ige30KICAgIGxvY2FsIGNvbmZpZyA9IHt9CgogICAgZm9yIGksIHYgaW4gcGFpcnMocHJlc2V0cykgZG8KICAgICAgICB0YWJsZS5pbnNlcnQoY29uZmlnLCB2Lm5hbWUpCiAgICBlbmQKCiAgICBmb3IgaSwgdiBpbiBwYWlycyhkYXRhYmFzZSkgZG8KICAgICAgICB0YWJsZS5pbnNlcnQoY29uZmlnLCB2Lm5hbWUpCiAgICBlbmQKCiAgICByZXR1cm4gY29uZmlnCmVuZApsb2NhbCBmdW5jdGlvbiB0eXBlRnJvbVN0cmluZyhpbnB1dCkKICAgIGlmIHR5cGUoaW5wdXQpIH49ICJzdHJpbmciIHRoZW4gcmV0dXJuIGlucHV0IGVuZAoKICAgIGxvY2FsIHZhbHVlID0gaW5wdXQ6bG93ZXIoKQoKICAgIGlmIHZhbHVlID09ICJ0cnVlIiB0aGVuCiAgICAgICAgcmV0dXJuIHRydWUKICAgIGVsc2VpZiB2YWx1ZSA9PSAiZmFsc2UiIHRoZW4KICAgICAgICByZXR1cm4gZmFsc2UKICAgIGVsc2VpZiB0b251bWJlcih2YWx1ZSkgfj0gbmlsIHRoZW4KICAgICAgICByZXR1cm4gdG9udW1iZXIodmFsdWUpCiAgICBlbHNlCiAgICAgICAgcmV0dXJuIHRvc3RyaW5nKGlucHV0KQogICAgZW5kCmVuZApsb2NhbCBmdW5jdGlvbiBsb2FkU2V0dGluZ3MoY29uZmlnKQogICAgZm9yIGtleSwgdmFsdWUgaW4gcGFpcnModmFycy5wU3RhdGVzKSBkbwogICAgICAgIGZvciBrLCB2IGluIHBhaXJzKGFhQnVpbGRlcltrZXldKSBkbwogICAgICAgICAgICBpZiAoY29uZmlnW3ZhbHVlXVtrXSB+PSBuaWwpIHRoZW4KICAgICAgICAgICAgICAgIHVpLnNldCh2LCBjb25maWdbdmFsdWVdW2tdKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQgCiAgICBlbmQKZW5kCmxvY2FsIGZ1bmN0aW9uIGltcG9ydFNldHRpbmdzKCkKICAgIGxvYWRTZXR0aW5ncyhqc29uLnBhcnNlKGNsaXBib2FyZC5nZXQoKSkpCmVuZApsb2NhbCBmdW5jdGlvbiBleHBvcnRTZXR0aW5ncyhuYW1lKQogICAgbG9jYWwgY29uZmlnID0gZ2V0Q29uZmlnKG5hbWUpCiAgICBjbGlwYm9hcmQuc2V0KGpzb24uc3RyaW5naWZ5KGNvbmZpZy5jb25maWcpKQplbmQKbG9jYWwgZnVuY3Rpb24gbG9hZENvbmZpZyhuYW1lKQogICAgbG9jYWwgY29uZmlnID0gZ2V0Q29uZmlnKG5hbWUpCiAgICBsb2FkU2V0dGluZ3MoY29uZmlnLmNvbmZpZykKZW5kCgpsb2NhbCBmdW5jdGlvbiBpbml0RGF0YWJhc2UoKQogICAgaWYgZGF0YWJhc2UucmVhZChsdWEuZGF0YWJhc2UuY29uZmlncykgPT0gbmlsIHRoZW4KICAgICAgICBkYXRhYmFzZS53cml0ZShsdWEuZGF0YWJhc2UuY29uZmlncywge30pCiAgICBlbmQKCiAgICBsb2NhbCBsaW5rID0gIm5vZmlsZSIKCiAgICBodHRwLmdldChsaW5rLCBmdW5jdGlvbihzdWNjZXNzLCByZXNwb25zZSkKICAgICAgICBpZiBub3Qgc3VjY2VzcyB0aGVuCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGVuZAogICAgCiAgICAgICAgZGF0YSA9IGpzb24ucGFyc2UocmVzcG9uc2UuYm9keSkKICAgIAogICAgICAgIGZvciBpLCBwcmVzZXQgaW4gcGFpcnMoZGF0YS5wcmVzZXRzKSBkbwogICAgICAgICAgICB0YWJsZS5pbnNlcnQocHJlc2V0cywgeyBuYW1lID0gIioiLi5wcmVzZXQubmFtZSwgY29uZmlnID0gcHJlc2V0LmNvbmZpZ30pCiAgICAgICAgICAgIHVpLnNldChtZW51LmNvbmZpZ1RhYi5uYW1lLCAiKiIuLnByZXNldC5uYW1lKQogICAgICAgIGVuZAogICAgICAgIHVpLnVwZGF0ZShtZW51LmNvbmZpZ1RhYi5saXN0LCBnZXRDb25maWdMaXN0KCkpCiAgICBlbmQpCmVuZAppbml0RGF0YWJhc2UoKQotLSBAcmVnaW9uIFVJX0xBWU9VVCBlbmQKCi0tIEByZWdpb24gTk9USUZJQ0FUSU9OX0FOSU0gc3RhcnQKbG9jYWwgYW5pbV90aW1lID0gMC43NQpsb2NhbCBtYXhfbm90aWZzID0gNgpsb2NhbCBkYXRhID0ge30KbG9jYWwgaWNvbiA9IGJhc2U2NC5kZWNvZGUoImlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFHQUFBQUJnQ0FNQUFBRFZSb2NLQUFBREFGQk1WRVZIY0V3Nk5UVjViVzR5SVNGS1JrVlBSa2pNek14WFEwV3lxNnRqVjFlM3JhMXhhV2prNCtQcXM3c3dMQ3l0cHFiWGxabm15TXZxenRGb1cxczVMQ3pueWM3bTA5WGN3TUdzcUtlUGdvT2ppWXFTaFlWQU56aUxkM25EbDV0dloyZmt6OUxWckxIY3Ryck51N3V2cEtXenBLUjBhMnk5cWF2Vm9hVGdsNTNidnNEZDB0VEtyN0xPcWF6ejFOWkhOald4blovYnM3VGkwOVhLakk3THhjYWhnWUpkVjFOU1FVRG0yTmpUdzhUazR1WGt6TS9ueGNyWXdjVG4wZFRoeU12V3ZMN2R1cjNpME5QVXJyUzhtNXpoeU1ycTF0bTRqbyswblo4c0pTWEtvYVZZUFQyL25wK1dhV2FUVzFlN1ltUEVrSlRSZUhwSlFUODZNREhVcXJLM2dZUzZqWTdKc2EvcDI5cXdpSW05Z29PYVVVL05tSjI2ZG5mTmZJQnhNelZMUFR4WVNFbWRkblhLb2FUZXg4bmFyN0taUlQ3VG9LUFJvYVNpWGx5b2VudkxqWlI0Y25KY1YxWXZKeVRrdDczbTJkamJ2cjduMGRQQ2lZbnczZDZrbEpXblpXUmtQenh3VkZCZlNVbUlZVi9VbXFBMUxDN2l3c2JtdnNQaHhjbm55YzdreE1iaXZzVG54OHpyemRIZnZyN2t4TW5nd01IaXdjVGp3c2Zsek0va3ljemp1cnZteGNubHdjUG53Y1hndTcvcXlzL255Y3ZnczdybHhzdmx4c2ZwMGRUa3ZiL256TS9ndmNMZXVMdmp2TUhtdmNEaXRyamV3Y1RweE12bXg4bmx5czNlcWJEdTFOZnIwOWJndDcza3hNUGl4c2JvenRIZXRMWGpxN0hreDhuYnVydm94TWJzMk5ubXVyN2lzYmJtd3NqbjBkUFlyckxqcnJQZHQ3bmVzTFRmcnJEZ3c4WHJ5c3ZxeDh6anY4SG94OG5lcGF6Ym9xanQwTlRqdWIvaHU3elpucUxrd01idHk5RGh5c3ZjdnNMdTI5emRzTGJZczdmcXhzanF3Y2pvd2NIbnQ3dmducUxtdXNQdjJkdmx0Ymp6M2Q3cHpjM3gwTlRhcTYvbXA2N2R2TC9hcUt2c3dNVHJ1c0Rpd2NMaXpjN2p0YndwR3hyZXFLdmswTkRkdExucjBOSHZ6OUR2eGNqZHhjZnR5TTcwNGVIdzN0N3AxOWJ6Mk5yUWtwUFVwS2Zwc0xQQmVYelVuYURIaFlmZXdNSGlvNmZSbUp2ZGtaWFJoNG5iaVk3RWFtM2F4Y0dzWkdQWGc0TEdscE5SSmlOOExTN1JiWE5ES0NqL3YvUVFBQUFBN0hSU1RsTUFFQS8rQlFvT0FRRUNCeGdXL2hZbi90dnlRdnptaDlvWkwyZEdIRmVUS1ovazAyUXlWemREOHY2MFo0MzkvU3BRL1VYNUxYYVkrM2g2T0xUMm84NnNtK2VVdTRISXR0TmNJYUpSYWFyTytyTCt4dExScGZ0ejI0bmU1dXp2L3Z0R3RjL082ZmYrdnR2ODdOZDFiT3J6NmZ4UzUrQjc0ZUN0L1lib2QvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vZ0xyby9nQUFBN2RTVVJCVkdqZTdGZDVVSk4zR2c0azVQcytVR1RFaWlnZU83VXFXclNJZUt4SHA2M3JmZTk2VisycWE2dnR0dDNwYnR2ZEdVZ2dCNWdERWhJQ0lTU1lDMElDZ1Z3a0VLNEVRMEFnY3NWa0lHQVFFU0lSaUloNHROMzlvdHV4ZzR5N3J1R1BuZWs3azhrZm1YbWZ2TS83UE8vNy9oQ0lYK1BYK1A4T0FBQ21ORCtFRGtSTUlRS0lXTDF2WDJ3UWFzb2d3RlhiOTErNHVIYzNORlg4K08yMVBCZy9mZkRrTzlEVTFBQ0VmanRVYVJsNytOUEozUUZUZ2dDdFdCWXpMSFdQamcyZERaMEtBQkE5dTFBOUZHTzFHMFBHemdaTkFRS3c4SndodjhNK1dsbFJZYXpjRlFUNlBEOWl4WkVvU2srMmU3aFNZTFV1T3hyZ2N3QndPWUhReGt5S3RxcXNuTjZWWWZOODdXbGdxY2RRMmlxL205NWJhcmpTMzE2K3k2dFZIK29WQVBaRTlWQWxralp5MVVvVlFYUzM5NE01SUloYUZlRTdEVUVmUnJtamtzcnB0WmlWR2ZsUi9TdDczNFlCL3J6VzMxYzFRSXUzdERmVXEyaFVMRi9TVmxiUDd4ZUdMWUZnWlFYNWFHNkFxUFVycjE0dVk5Zlg0L2ttcFpLbGJCV1IzL1dERVZCbzN5QkF3ZHQ2TmJZNCttVWFVK1IwS0NWS3BSejd1NTBBQW9BSHVDOGNBU0ordXoyS1VKQ2JybWpIbXdaY2NBVktGbjdtMjk3ZEFLRjlvNkVOdWdLOWdjSjEyMWdPaDltbGRDbVZWVmMzQTg4bUNPUVRseTJpcHBWUzNNTlBlYTF5azBucGNwck5kRnlZdi9lM09YTUFYd3k2TUc1MWIxdUIyMTFyN2pmM3lmaDhmaFdPL1pkNTN0VG9HWUF2Ykx5Sm9FKy8xZGFaaXBlYkIrUjhFb1lwWTdKVHRucTNKemdONVFPUnZsdWFseGRYM2k3cHc3YWFCL29sL0V3ZWxza1dmL1JzcGs3emYyTWRnUXYva05wR0psNU9jem94ck5iKy9nRUh5U1RERWptL2ViWjQwT2czQm9EZSs2QXV2Z3lINFptVStEN1JRUCtBeUVIQ2tNalVyK1o2RllSQ3Yya1R3SURaWDAwWFhMOURNbUZ3RXI1SmJqYXpsQ1ErMlVSdVdnQ2JHUXlZQmsycTdOY0FDSDYvNmxxTG9DdVo1RFE1bkE2V1hDN0psRGpJUk4zdDdhdUF5UUVBdjUzQnJ3RVFzVkhZMjhpb3F4TmZ5VlFxbFU2NW5JUmxPZmtZM2UyUGx5SW1CWUFDWjN3eDc3Ky9BY0dJYlM1SlcxS1RWTXFveVJUS0hiRFBzQ3dIaXltN3Rtd0g3TUZmQWdDQmdjKy9VUkd2VTRIZklwZmNaVXFkUHIyckFhc1RzUnd1Sis2V2c0L0RwTHRqZ1Y4QUFHRGdDMFc5enJJRFVEdk9Welc3SkZTeHBvSE8wK0Z4U2llUjZaVGdNQjc3Y1FCNm9hSkFkTUQvT0pjZy93L3BKS1hjNWFqTmFhZFNyeVppbERpZGc0UWpQeEljaHNYeU15dm9TY2NlQ0VFUUNQNkhja0F3Y1BaYlJBeEx6c2NMSmZTclpZbk16dHdybVh6VG8rTERDT2pmVGc1QUIwNVFLUWdIQktBQzRJQUFHT1hWR1A3dmJDUGljZ3JiNVN3V3ZwU2R5REZrVmZISmowb1d3QlI1WnhIa2ozNHhrUUNZZi9pbGd2SVBXdkxKN3FOYmp4L2Z1bWYzSjZ2OFVhK1VGWWlLbVAxV1EzMmFYQzRYOFhYaTZzWm9PcFBwc1hzQjBBQ0lRdi9jYVBCWmRrVGdqUG14bXovNjlMTnZ2b21KaVJtTU9YWHEyMzE3L3hIK0tvNGdtTXZGbTgvM21ZU3RJaGVKYmFEazErQnFzdHg3RUY0cW9HblArd3pBVEFRRWg2OCt1dXRjVkgxUHkvUjdVamQ4YUZaVUdpMlJUdzZPRDEyS25mUUc4VElaNEIrMGNFbm9rcVd6ejZkMHRqWExsZVJjQTZWSDBWQzg3RDF2MmY3VG52MS9PSDFRNk55dHU4NTlQR3Fzc0t1aWUvS2pTNlJ3VkZUWXZSQ1JrU0VuNTAveU9nSVFxTVYvMjd4eDI1Wmp4LzU2N05pbS9KSjhUYXZMbVZkWXFLSXAxTENUNGJXL0p1ajVrVGRuN3VFVE1TRVdxMWFydGVkbjBmUnNXd0hYUG1LNWQrT0dWSzNWcXR4REYvWUd2Mno2Z05XTE5qR3Jtb1daZkltSU5XQTJ0VmhHUm5PZHNnU2RXRVd3ZkQ0REZUeGpqWGRuQW43aFcwK01ER296T05mWkhvOHVXZmNvajV6R0pESUx4eDQvSHF3MDNxeFVaOSsrTjc1djUwUUFJR2pEMXlLbVJHNXVscEJZd3ViV1pybGVNRGcwSm0zU0VGcWs2ckVERVF2WEhncjNTaVpvd2VjaDk5VVpCQS9QbzVNbHlLN2s1ZWs4eVFvRjg0cDlNRVN0YlJFTWoyb2I3ejA0N0FkTi9QOGJ2cGFud1FZWWtEc2xRcUh3Ym5QenJSVHBnOU9uNzF0VjBodVcwd3NXL2hHSkRJWEZIbjVnK1A2OUpocVAxOWVuNC9GNHRieGFtOGZHNXJCdGo1SUVnZzV0Y1VkUng5T25qMC90UVlFVFp2cjZtWmxDSEY0ME1PQmlpWVFzVVpVc0VlY2hVTFFoSTRQM0l4OGUzQjhMNTUvMUJiUnp3VEpwdElhUWdHTXljZkNIVE1aZ2RKaTRKRTlTZWFrSmw4T3cxakUwR2RtOVRTUGZSMHpvTVRnbmpHMGpKOU52Tlp0RklwRlFoTWZGY2ZRMjIyVmFpZkhoR0p6L1pPd2hKSExkL0hrSFJxVk45WjY4TkNZR0Roa1owOWZYVndzWDRTa29xS2MxM0xtVHdzN1NHTEp6dWo1ZE5URS90SjVPVmNqaXlIQnVPajJ0dEl3YVIrL1VHM3BxOUJxQjhjSERueTZjK2Y3TDdsbHI5NXdZTkZvTm5YbDVNbGw2UXJvc21XM1RNVEVtRThZa2d4dkJGak82T3E1ejdwUzdqM3dXT25ITFFlRmI2RmdjTGhObXA2cTlMTFcrdmlDZGtISWJycGhDNFdwSHgvZi8rRU4zZC9laEhmdWZHTlZGamJucDFGUTlnVmFnS1dBblhpYVNTWHhNbnc2TG94YlNiQXlCb1BoYWFzZWx1Uzg5ZnFFVk0vbDhNcDhsWWtud1dHYVo0bHBwb2I2ajJLNFdsR2l0SmRxUngzQitKUEs3ZmVOUElnWEYrWm9lUmhkRGs2WFBUY2RnbUJpZWw2czRkazNMY0Vsbm9saGxiK21vUHZxU2plRmRQNVBNbDBoWUVsSW1GazlYMUJSZUl4anFyQ1dNbHFKaVFXWEkwRVVrM0lCWlAvdzQvc1RTVkpUZHlCRjNGY1ZuR3docEpyNjN5VHdlc1N4Uk5UZ3lURWxwdU0wOTRsNys4cGlBRjFsT21ZS3FVRkE3RTVMWnROUUdEamMvdjQ2bXAyVm90QldXeUtFei8xeUhSUDc5ek1XRFQ0eGFycUV6UFNGSm85S0k2N05zQ2h3WlBqa3dtRGdpYlhERVdFd1JHeHIvdEhlU0F4TUtmdjk2TmFPYTBWVXR6c2l1N3VrcFVWbTExcm9NUFNHRkN4ZGdPZlVkRXRuZGZXWm82T0dEa0p0YWJrcENYbnBTUVJhRnk2Z1R3d2h3ajhscHhEaUtYWjF2NElpNXl5ZDd1WVBCR3h1cXU2NTNNY1MwK0hnT0p5TTd1NmlvSTZlc0xMNURZRFJXV2hiRWZ0bU5YUGZZY244a0pETGtwcm9vTlU0WGw1REVxVzVxcWxQRnA4RUZ3QkRrTmdXTkVFMkpEMXM4eVlvR1lRQnFUbXEySVNXUm1wT2pVSFRTMk95YUhOeFYyQVNWbFZyMWdUVy83NTUxOXRLSW5WdFVmRk5xSERRS3VLbmxhU1lUTWY1ZjdWbjlUeE5uSE9lbFRkczVRa0NROFRhbHZPaUFUQ1FFRlJVQngzVGJMNHVZSlZ2MmcwczBXN0s0WkdiN1lkbXU5SHJ0M1JWNjdmV052bE9LdEFYYWpqYTA5ZXF0dHJXSVVDRGF1ZExpdVdseDR3Y1NZN3I5QXp2SnRqZ3pISWI2dzVJOVAxNHU5OXp6ZlQ3ZjUvbThTTnh1YjRLRUJ1bHV4a0ZJZm9WODcyUWJheE8rQlprWGVLU0dsUElNNFhBa1Fvcmw4Z2ZLMFdEcVh2RGh5YjN0K1NWOVgzNXdiY2tva1V4TXVDY2YvZmJvbW50UmZmOXVQMktkODNxbm5aZ0NNOUNGNWNuSXN1cC9kbWZvVGNiTUhwMk9wS3REYjRKK1h0M1BuOUZmbmd5bUxxOTgrczd1ei9KTDJwdGZtNHliNW53UlVpb3p4cjNCYTFjVFRybFdJVTI3dmFQQlVXTk1ZWS9vRGVidStrM2NIeHFtWnNIc0xCeVZTa21OeGhxZTBXcGZONlRqM251VDduMFZ6RzlLZmlxcC8zajVzdW5PaXRFb0Jld09OYm00ZEc4eWtaQmRDWHlISzczTHdlQ2MwN1lvMFJUVmIwWlQyY3hEUjZNMDJLSTJHeWtTeGRhRWwxWkZKaHFwaVlmN1hzMDcyNWRmY3ZyaTF4Tkw0VmdnOWlBUVFPeURneU9MRXduSmxGL3BWQXc2ZEg1LzhOZmcxVlNxcG9MSjNsVGNOeFZIQ1lMb3B5aVV1RFFrWEZjNEorSnhwLzloOE4ycVZ6YU8wYmV2bWxZRVY5WWc0ZnB0TlRFN0tOUTZNZ2hHR09hbVhkcnJPRjJuNWVYbGZkWFBjc2NhT2oxaW1CaW1FRWRvYUd5VmNOSXkwK1QzTDMreWw5M1dsMy93ZE91SDNxa1lKRitUcjM4UGdBLzQ5QmdIMWZ5ZTJxN3VBOG9GSWFiM1R4WndXNTVGNDFsNXg3R29Sd3lBV0VoNGFZQkduVkZpOGs5NlUrOHpjNm9QbG56Vi9vYmJiVlNyNUROeTRUcWxwOS9SOXV0aVVyU3pMcSt5aTN0K1ZtZ09uejlSK1V3UGxNVTU1UkI3b2dBR0tXNHI3SmtNcVptYVNMa0xUcnpNWVYwNG1QOVJ5NG1WdUl0Q1ZYSzVsb2pwZEJCZkJRdDBVa2R4VHk0bnQ2NjJ1ZkhONDRjTC84VmpaYjNVcTRJeFdLVUNVRW9FWUxoa0loSDNuNm1qdWRXRmtyNnFocUtmalRFOENvM3pRMUNBRWdqb2JveVN5ZEN0c1NZV215YmRXeFA0aDY1RGtBTVdBd0JsQTFHRHlSODNuZG5nTmczdFoxbVZYL3dnaTBVRTBLQkZLRmVFVUlFaGJNYkFWZnJXN3R4QnMxMFdheXNxaXIyN2t3LzMweHdsWTZkdktuTGFYWENtYmdNVkRDYUhVVnM4NDRwcERId0kxdDRkRDhGQTFHbzFEOXk0OGEzQzE3eGxnNFROcUMyRllSQkVVUXkxYXBUVzdsZkwvL2d0K3FRNkRnWmNMbHdBendDV2dURmErRWM5VnQzUWpWc0Q2RkpOTldQcjRxYlpnUUdneDJVTjB4M0VyYy83YTlucy9WelNSZElUQUd0UmFHQW9CSXVqbnFoT3V6N1duNWtxT0ZHK2RZMWZlQTV5Z0I2Zk1tdzgwTGp6U1ZDMGNmRVlMc1VSRE1OZ29WYklCenllS0t3UXlvbFovWjEwODlZVklLZStqRWdtVVkrZ3JEWXY1OG5TZHRSRUZ2UXlQUVhLWERLMVpaeXVrUWRWWUpRUDEzM3UxSFJ2M1lKaE1WdU9GSlVXOVhaVmN2Nk9pdGFhOEVvNDVrUkFsd3V4V2JTaEdiMkFHZ0ZKMy9TUDFIdzZYTWw2RGdsWTFkSFI4Vll1K3lsa3ROWk15ZkNZQ0FFQTBDbU5nWlpWWGRvQTJrWDRYTUpIS3EwVnp5TXkyUnNuMzlPUE8ycXNSbjBzU1QxdUVoOFBjMmdEYzNOR0t1bU1tS2IxTnhjcXR1OGhsWE9OR2x5YVJNUWdJZFliWENOQWdEZXQxSk9pcE5FM0h6WlhiTjhxM005ZENVdWxTVlJzSjhSVzY0SlV0NmIzcDVRUm10Mko4T24rbHUxYlBGV05zclNNcEVCNkUxQ2U5U1o5OXliVHFaUS9JaEloWkxwbSswWWVKN2VMNTVNaUZKaWgyWW9zYmVEeDhLUkdNanJxdHhHSUREdTJmZHVjelRoMEZPZmhpQTFCYkRiS2lRaEkyYnhlNHZlYVNMdFlWdFRLM3Y0RU9UdExrendmUWlVekZFWGhlbEtISnVkRklqTHNsN2lLV2hoWnNJTTVEV1VrTHkyaVY0QUNxTUZBb3BtTURyVVRQTGVwcUQ0cjhRaG54eEhrOFFRb2dvNm9vMUpnZURpRGdnNENNM0F2WmljclpITU9LelJXMFFnR0FKaktZUi9PaU5ITTdBeS91S3N3VytFTHU2MUlac1hWTUUxc3RBUFhDV0lZc0Z0V2U1dnlzcFpQc1RoTnBXWWRCc1BEdjl3ZmR4QUVpdDB1M2xXZXpaQ1F4ZGpiZU82b1dRVmJMRnFvdUxTMzYxUmhEanVyMlJRclowZjE0V043OXV6cDZkbFZ1M00zOHdXazJXd09NM2RqTUJrc1R0YkR3VC9kbmczcjdNVjgvZi94SHgyL0E5Q1dObTlja1c2OUFBQUFBRWxGVGtTdVFtQ0MiKQpsb2NhbCBub3RpZmljYXRpb25zID0gewoKICAgIG5ldyA9IGZ1bmN0aW9uKCBzdHJpbmcsIHIsIGcsIGIpCiAgICAgICAgdGFibGUuaW5zZXJ0KGRhdGEsIHsKICAgICAgICAgICAgdGltZSA9IGdsb2JhbHMuY3VydGltZSgpLAogICAgICAgICAgICBzdHJpbmcgPSBzdHJpbmcsCiAgICAgICAgICAgIGNvbG9yID0ge3IsIGcsIGIsIDI1NX0sCiAgICAgICAgICAgIGZyYWN0aW9uID0gMAogICAgICAgIH0pCiAgICAgICAgbG9jYWwgdGltZSA9IDUKICAgICAgICBmb3IgaSA9ICNkYXRhLCAxLCAtMSBkbwogICAgICAgICAgICBsb2NhbCBub3RpZiA9IGRhdGFbaV0KICAgICAgICAgICAgaWYgI2RhdGEgLSBpICsgMSA+IG1heF9ub3RpZnMgYW5kIG5vdGlmLnRpbWUgKyB0aW1lIC0gZ2xvYmFscy5jdXJ0aW1lKCkgPiAwIHRoZW4KICAgICAgICAgICAgICAgIG5vdGlmLnRpbWUgPSBnbG9iYWxzLmN1cnRpbWUoKSAtIHRpbWUKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQsCgogICAgcmVuZGVyID0gZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIHgsIHkgPSBjbGllbnQuc2NyZWVuX3NpemUoKQogICAgICAgIGxvY2FsIHRvX3JlbW92ZSA9IHt9CiAgICAgICAgbG9jYWwgT2Zmc2V0ID0gMAogICAgICAgIGZvciBpID0gMSwgI2RhdGEgZG8KICAgICAgICAgICAgbG9jYWwgbm90aWYgPSBkYXRhW2ldCgogICAgICAgICAgICBsb2NhbCBkYXRhID0ge3JvdW5kaW5nID0gNCwgc2l6ZSA9IDMsIGdsb3cgPSAyLCB0aW1lID0gNH0KCiAgICAgICAgICAgIGlmIG5vdGlmLnRpbWUgKyBkYXRhLnRpbWUgLSBnbG9iYWxzLmN1cnRpbWUoKSA+IDAgdGhlbgogICAgICAgICAgICAgICAgbm90aWYuZnJhY3Rpb24gPSBmdW5jLmNsYW1wKG5vdGlmLmZyYWN0aW9uICsgZ2xvYmFscy5mcmFtZXRpbWUoKSAvIGFuaW1fdGltZSwgMCwgMSkKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgbm90aWYuZnJhY3Rpb24gPSBmdW5jLmNsYW1wKG5vdGlmLmZyYWN0aW9uIC0gZ2xvYmFscy5mcmFtZXRpbWUoKSAvIGFuaW1fdGltZSwgMCwgMSkKICAgICAgICAgICAgZW5kCgogICAgICAgICAgICBpZiBub3RpZi5mcmFjdGlvbiA8PSAwIGFuZCBub3RpZi50aW1lICsgZGF0YS50aW1lIC0gZ2xvYmFscy5jdXJ0aW1lKCkgPD0gMCB0aGVuCiAgICAgICAgICAgICAgICB0YWJsZS5pbnNlcnQodG9fcmVtb3ZlLCBpKQogICAgICAgICAgICBlbmQKICAgICAgICAgICAgbG9jYWwgZnJhY3Rpb24gPSBmdW5jLmVhc2VJbk91dChub3RpZi5mcmFjdGlvbikKCiAgICAgICAgICAgIGxvY2FsIHIsIGcsIGIsIGEgPSB1bnBhY2sobm90aWYuY29sb3IpCiAgICAgICAgICAgIGxvY2FsIHN0cmluZyA9IGNvbG9yX3RleHQobm90aWYuc3RyaW5nLCByLCBnLCBiLCBhICogZnJhY3Rpb24pCgogICAgICAgICAgICBsb2NhbCBzdHJ3LCBzdHJoID0gcmVuZGVyZXIubWVhc3VyZV90ZXh0KCIiLCBzdHJpbmcpCiAgICAgICAgICAgIGxvY2FsIHN0cncyID0gcmVuZGVyZXIubWVhc3VyZV90ZXh0KCJiIiwgIiAgICAgICIpCgogICAgICAgICAgICBsb2NhbCBwYWRkaW5neCwgcGFkZGluZ3kgPSA3LCBkYXRhLnNpemUKICAgICAgICAgICAgbG9jYWwgb2Zmc2V0WSA9IHVpLmdldChtZW51LnZpc3VhbHNUYWIubG9nT2Zmc2V0KQoKICAgICAgICAgICAgT2Zmc2V0ID0gT2Zmc2V0ICsgKHN0cmggKyBwYWRkaW5neSoyICsgCW1hdGguc3FydChkYXRhLmdsb3cvMTApKjEwICsgNSkgKiBmcmFjdGlvbgogICAgICAgICAgICBnbG93X21vZHVsZSh4LzIgLSAoc3RydyArIHN0cncyKS8yIC0gcGFkZGluZ3gsIHkgLSBvZmZzZXRZIC0gc3RyaC8yIC0gcGFkZGluZ3kgLSBPZmZzZXQsIHN0cncgKyBzdHJ3MiArIHBhZGRpbmd4KjIsIHN0cmggKyBwYWRkaW5neSoyLCBkYXRhLmdsb3csIGRhdGEucm91bmRpbmcsIHtyLCBnLCBiLCA0NSAqIGZyYWN0aW9ufSwgezI1LDI1LDI1LDE0MCAqIGZyYWN0aW9ufSkKICAgICAgICAgICAgcmVuZGVyZXIudGV4dCh4LzIgKyBzdHJ3Mi8yLCB5IC0gb2Zmc2V0WSAtIE9mZnNldCwgMjU1LCAyNTUsIDI1NSwgMjU1ICogZnJhY3Rpb24sICJjIiwgMCwgc3RyaW5nKQogICAgICAgICAgICBsb2NhbCBpY29uID0gaW1hZ2VzLmxvYWRfcG5nKGljb24sIDEwLCAxMCkKICAgICAgICAgICAgaWNvbjpkcmF3KHgvMiAtIHN0cncvMiAtIDEyLjUsIHkgLSBvZmZzZXRZIC0gT2Zmc2V0IC0gMTAsIDIwLCAyMCwgciwgZywgYiwgMjU1ICogZnJhY3Rpb24sICJmIikKICAgICAgICAKICAgICAgICBlbmQKCiAgICAgICAgZm9yIGkgPSAjdG9fcmVtb3ZlLCAxLCAtMSBkbwogICAgICAgICAgICB0YWJsZS5yZW1vdmUoZGF0YSwgdG9fcmVtb3ZlW2ldKQogICAgICAgIGVuZAogICAgZW5kLAoKICAgIGNsZWFyID0gZnVuY3Rpb24oKQogICAgICAgIGRhdGEgPSB7fQogICAgZW5kCn0KCmxvY2FsIGZ1bmN0aW9uIG9uSGl0KGUpCiAgICBsb2NhbCBncm91cCA9IHZhcnMuaGl0Z3JvdXBfbmFtZXNbZS5oaXRncm91cCArIDFdIG9yICc/JwoJbG9jYWwgciwgZywgYiwgYSA9IHVpLmdldChtZW51LnZpc3VhbHNUYWIubG9nc0NscikKCW5vdGlmaWNhdGlvbnMubmV3KHN0cmluZy5mb3JtYXQoIkhpdCAlcydzICQlcyQgZm9yICQlZCQgZGFtYWdlICgkJWQkIGhlYWx0aCByZW1haW5pbmcpIiwgZW50aXR5LmdldF9wbGF5ZXJfbmFtZShlLnRhcmdldCksIGdyb3VwOmxvd2VyKCksIGUuZGFtYWdlLCBlbnRpdHkuZ2V0X3Byb3AoZS50YXJnZXQsICdtX2lIZWFsdGgnKSksIHIsIGcsIGIpIAoKZW5kCgpsb2NhbCBmdW5jdGlvbiBvbk1pc3MoZSkKICAgIGxvY2FsIGdyb3VwID0gdmFycy5oaXRncm91cF9uYW1lc1tlLmhpdGdyb3VwICsgMV0gb3IgJz8nCiAgICBsb2NhbCBwaW5nID0gbWF0aC5taW4oOTk5LCBjbGllbnQucmVhbF9sYXRlbmN5KCkgKiAxMDAwKQogICAgbG9jYWwgcGluZ19jb2wgPSAocGluZyA+PSAxMDApIGFuZCB7IDI1NSwgMCwgMCB9IG9yIHsgMTUwLCAyMDAsIDYwIH0KICAgIGxvY2FsIGhjID0gbWF0aC5mbG9vcihlLmhpdF9jaGFuY2UgKyAwLjUpOwogICAgbG9jYWwgaGNfY29sID0gKGhjIDwgdWkuZ2V0KHJlZnMuaGl0Q2hhbmNlKSkgYW5kIHsgMjU1LCAwLCAwIH0gb3IgeyAxNTAsIDIwMCwgNjAgfTsKICAgIGUucmVhc29uID0gZS5yZWFzb24gPT0gIj8iIGFuZCAicmVzb2x2ZXIiIG9yIGUucmVhc29uCglub3RpZmljYXRpb25zLm5ldyhzdHJpbmcuZm9ybWF0KCJNaXNzZWQgJXMncyAkJXMkIGR1ZSB0byAkJXMkIiwgZW50aXR5LmdldF9wbGF5ZXJfbmFtZShlLnRhcmdldCksIGdyb3VwOmxvd2VyKCksIGUucmVhc29uKSwgMjU1LCAxMjAsIDEyMCkKZW5kCgpjbGllbnQuc2V0X2V2ZW50X2NhbGxiYWNrKCJjbGllbnRfZGlzY29ubmVjdCIsIGZ1bmN0aW9uKCkgIG5vdGlmaWNhdGlvbnMuY2xlYXIoKSBlbmQpCmNsaWVudC5zZXRfZXZlbnRfY2FsbGJhY2soImxldmVsX2luaXQiLCBmdW5jdGlvbigpIG5vdGlmaWNhdGlvbnMuY2xlYXIoKSBlbmQpCmNsaWVudC5zZXRfZXZlbnRfY2FsbGJhY2soJ3BsYXllcl9jb25uZWN0X2Z1bGwnLCBmdW5jdGlvbihlKSBpZiBjbGllbnQudXNlcmlkX3RvX2VudGluZGV4KGUudXNlcmlkKSA9PSBlbnRpdHkuZ2V0X2xvY2FsX3BsYXllcigpIHRoZW4gbm90aWZpY2F0aW9ucy5jbGVhcigpIGVuZCBlbmQpCi0tIEByZWdpb24gTk9USUZJQ0FUSU9OX0FOSU0gZW5kCgotLSBAcmVnaW9uIEFBX0NBTExCQUNLUyBzdGFydApsb2NhbCBhYSA9IHsKCWlnbm9yZSA9IGZhbHNlLAoJbWFudWFsQUE9IDAsCglpbnB1dCA9IDAsCn0KY2xpZW50LnNldF9ldmVudF9jYWxsYmFjaygicGxheWVyX2Nvbm5lY3RfZnVsbCIsIGZ1bmN0aW9uKCkgCglhYS5pZ25vcmUgPSBmYWxzZQoJYWEubWFudWFsQUE9IDAKCWFhLmlucHV0ID0gMAplbmQpIAoKbG9jYWwgY3VycmVudF90aWNrID0gZnVuYy50aW1lX3RvX3RpY2tzKGdsb2JhbHMucmVhbHRpbWUoKSkKY2xpZW50LnNldF9ldmVudF9jYWxsYmFjaygic2V0dXBfY29tbWFuZCIsIGZ1bmN0aW9uKGNtZCkKICAgIHZhcnMubG9jYWxQbGF5ZXIgPSBlbnRpdHkuZ2V0X2xvY2FsX3BsYXllcigpCiAgICBpZiB1aS5nZXQobWVudS5taXNjVGFiLmNsYW5UYWcpIHRoZW4KICAgICAgICBpZiBjbGFuVGFnID09IG5pbCB0aGVuCiAgICAgICAgICAgIGNsYW5UYWcgPSB0cnVlCiAgICAgICAgZW5kCgkJbG9jYWwgY2xhbl90YWcgPSBjbGFudGFnKCJhbnhpZXR5IiwgezAsIDEsIDIsIDMsIDQsIDUsIDYsIDcsIDgsIDksIDEwLCAxMSwgMTEsIDExLCAxMSwgMTEsIDExLCAxMSwgMTEsIDEyLCAxMywgMTQsIDE1LCAxNiwgMTcsIDE4LCAxOSwgMjAsIDIxLCAyMn0pCgkJaWYgY2xhbl90YWcgfj0gY2xhbl90YWdfcHJldiB0aGVuCgkJCWNsaWVudC5zZXRfY2xhbl90YWcoY2xhbl90YWcpCgkJZW5kCgkJY2xhbl90YWdfcHJldiA9IGNsYW5fdGFnCiAgICBlbHNlaWYgY2xhblRhZyA9PSB0cnVlIHRoZW4KICAgICAgICBjbGllbnQuc2V0X2NsYW5fdGFnKCIiKQogICAgICAgIGNsYW5UYWcgPSBmYWxzZQogICAgZW5kCgogICAgaWYgbm90IHZhcnMubG9jYWxQbGF5ZXIgIG9yIG5vdCBlbnRpdHkuaXNfYWxpdmUodmFycy5sb2NhbFBsYXllcikgdGhlbiByZXR1cm4gZW5kCglsb2NhbCBmbGFncyA9IGVudGl0eS5nZXRfcHJvcCh2YXJzLmxvY2FsUGxheWVyLCAibV9mRmxhZ3MiKQogICAgbG9jYWwgb25ncm91bmQgPSBiaXQuYmFuZChmbGFncywgMSkgfj0gMCBhbmQgY21kLmluX2p1bXAgPT0gMAoJbG9jYWwgdmFsdmUgPSBlbnRpdHkuZ2V0X3Byb3AoZW50aXR5LmdldF9nYW1lX3J1bGVzKCksICJtX2JJc1ZhbHZlRFMiKQoJbG9jYWwgb3JpZ2luID0gdmVjdG9yKGVudGl0eS5nZXRfcHJvcCh2YXJzLmxvY2FsUGxheWVyLCAibV92ZWNPcmlnaW4iKSkKCWxvY2FsIHZlbG9jaXR5ID0gdmVjdG9yKGVudGl0eS5nZXRfcHJvcCh2YXJzLmxvY2FsUGxheWVyLCAibV92ZWNWZWxvY2l0eSIpKQoJbG9jYWwgY2FtZXJhID0gdmVjdG9yKGNsaWVudC5jYW1lcmFfYW5nbGVzKCkpCglsb2NhbCBleWUgPSB2ZWN0b3IoY2xpZW50LmV5ZV9wb3NpdGlvbigpKQoJbG9jYWwgc3BlZWQgPSBtYXRoLnNxcnQoKHZlbG9jaXR5LnggKiB2ZWxvY2l0eS54KSArICh2ZWxvY2l0eS55ICogdmVsb2NpdHkueSkgKyAodmVsb2NpdHkueiAqIHZlbG9jaXR5LnopKQogICAgbG9jYWwgd2VhcG9uID0gZW50aXR5LmdldF9wbGF5ZXJfd2VhcG9uKCkKCWxvY2FsIHBTdGlsbCA9IG1hdGguc3FydCh2ZWxvY2l0eS54IF4gMiArIHZlbG9jaXR5LnkgXiAyKSA8IDUKICAgIGxvY2FsIGJvZHlZYXcgPSBlbnRpdHkuZ2V0X3Byb3AodmFycy5sb2NhbFBsYXllciwgIm1fZmxQb3NlUGFyYW1ldGVyIiwgMTEpICogMTIwIC0gNjAKCiAgICBsb2NhbCBpc1Nsb3cgPSB1aS5nZXQocmVmcy5zbG93WzFdKSBhbmQgdWkuZ2V0KHJlZnMuc2xvd1syXSkKCWxvY2FsIGlzT3MgPSB1aS5nZXQocmVmcy5vc1sxXSkgYW5kIHVpLmdldChyZWZzLm9zWzJdKQoJbG9jYWwgaXNGZCA9IHVpLmdldChyZWZzLmZha2VEdWNrKQoJbG9jYWwgaXNEdCA9IHVpLmdldChyZWZzLmR0WzFdKSBhbmQgdWkuZ2V0KHJlZnMuZHRbMl0pCiAgICBsb2NhbCBpc0xlZ2l0QUEgPSB1aS5nZXQobWVudS5hYVRhYi5sZWdpdEFBSG90a2V5KQoKICAgIGxvY2FsIG1hbnVhbHNPdmVyRnMgPSB1aS5nZXQobWVudS5taXNjVGFiLm1hbnVhbHNPdmVyRnMpID09IHRydWUgYW5kIHRydWUgb3IgZmFsc2UKCiAgICAKICAgIC0tIHNlYXJjaCBmb3Igc3RhdGVzCiAgICB2YXJzLnBTdGF0ZSA9IDEKICAgIGlmIHBTdGlsbCB0aGVuIHZhcnMucFN0YXRlID0gMiBlbmQKICAgIGlmIG5vdCBwU3RpbGwgdGhlbiB2YXJzLnBTdGF0ZSA9IDMgZW5kCiAgICBpZiBpc1Nsb3cgdGhlbiB2YXJzLnBTdGF0ZSA9IDQgZW5kCiAgICBpZiBlbnRpdHkuZ2V0X3Byb3AodmFycy5sb2NhbFBsYXllciwgIm1fZmxEdWNrQW1vdW50IikgPiAwLjEgdGhlbiB2YXJzLnBTdGF0ZSA9IDUgZW5kCiAgICBpZiBub3Qgb25ncm91bmQgdGhlbiB2YXJzLnBTdGF0ZSA9IDYgZW5kCiAgICBpZiBub3Qgb25ncm91bmQgYW5kIGVudGl0eS5nZXRfcHJvcCh2YXJzLmxvY2FsUGxheWVyLCAibV9mbER1Y2tBbW91bnQiKSA+IDAuMSB0aGVuIHZhcnMucFN0YXRlID0gNyBlbmQKCiAgICBpZiB1aS5nZXQoYWFCdWlsZGVyW3ZhcnMucFN0YXRlXS5lbmFibGVTdGF0ZSkgPT0gZmFsc2UgYW5kIHZhcnMucFN0YXRlIH49IDEgdGhlbgogICAgICAgIHZhcnMucFN0YXRlID0gMQogICAgZW5kCgogICAgbG9jYWwgbmV4dEF0dGFjayA9IGVudGl0eS5nZXRfcHJvcCh2YXJzLmxvY2FsUGxheWVyLCAibV9mbE5leHRBdHRhY2siKQogICAgbG9jYWwgbmV4dFByaW1hcnlBdHRhY2sgPSBlbnRpdHkuZ2V0X3Byb3AoZW50aXR5LmdldF9wbGF5ZXJfd2VhcG9uKHZhcnMubG9jYWxQbGF5ZXIpLCAibV9mbE5leHRQcmltYXJ5QXR0YWNrIikKICAgIGxvY2FsIGR0QWN0aXZlID0gZmFsc2UKICAgIGxvY2FsIGlzRmwgPSB1aS5nZXQodWkucmVmZXJlbmNlKCJBQSIsICJGYWtlIGxhZyIsICJFbmFibGVkIikpCiAgICBpZiBuZXh0UHJpbWFyeUF0dGFjayB+PSBuaWwgdGhlbgogICAgICAgIGR0QWN0aXZlID0gbm90IChtYXRoLm1heChuZXh0UHJpbWFyeUF0dGFjaywgbmV4dEF0dGFjaykgPiBnbG9iYWxzLmN1cnRpbWUoKSkKICAgIGVuZAoKICAgIC0tIGFwcGx5IGFudGlhaW0gc2V0CiAgICBsb2NhbCBzaWRlID0gYm9keVlhdyA+IDAgYW5kIDEgb3IgLTEKCiAgICAgICAgLS0gbWFudWFsIGFhCiAgICAgICAgaWYgdWkuZ2V0KG1lbnUuYWFUYWIubWFudWFscykgfj0gIk9mZiIgdGhlbgogICAgICAgICAgICB1aS5zZXQobWVudS5hYVRhYi5tYW51YWxUYWIubWFudWFsTGVmdCwgIk9uIGhvdGtleSIpCiAgICAgICAgICAgIHVpLnNldChtZW51LmFhVGFiLm1hbnVhbFRhYi5tYW51YWxSaWdodCwgIk9uIGhvdGtleSIpCiAgICAgICAgICAgIHVpLnNldChtZW51LmFhVGFiLm1hbnVhbFRhYi5tYW51YWxGb3J3YXJkLCAiT24gaG90a2V5IikKICAgICAgICAgICAgaWYgYWEuaW5wdXQgKyAwLjIyIDwgZ2xvYmFscy5jdXJ0aW1lKCkgdGhlbgogICAgICAgICAgICAgICAgaWYgYWEubWFudWFsQUEgPT0gMCB0aGVuCiAgICAgICAgICAgICAgICAgICAgaWYgdWkuZ2V0KG1lbnUuYWFUYWIubWFudWFsVGFiLm1hbnVhbExlZnQpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgYWEubWFudWFsQUEgPSAxCiAgICAgICAgICAgICAgICAgICAgICAgIGFhLmlucHV0ID0gZ2xvYmFscy5jdXJ0aW1lKCkKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgdWkuZ2V0KG1lbnUuYWFUYWIubWFudWFsVGFiLm1hbnVhbFJpZ2h0KSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGFhLm1hbnVhbEFBID0gMgogICAgICAgICAgICAgICAgICAgICAgICBhYS5pbnB1dCA9IGdsb2JhbHMuY3VydGltZSgpCiAgICAgICAgICAgICAgICAgICAgZWxzZWlmIHVpLmdldChtZW51LmFhVGFiLm1hbnVhbFRhYi5tYW51YWxGb3J3YXJkKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGFhLm1hbnVhbEFBID0gMwogICAgICAgICAgICAgICAgICAgICAgICBhYS5pbnB1dCA9IGdsb2JhbHMuY3VydGltZSgpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbHNlaWYgYWEubWFudWFsQUEgPT0gMSB0aGVuCiAgICAgICAgICAgICAgICAgICAgaWYgdWkuZ2V0KG1lbnUuYWFUYWIubWFudWFsVGFiLm1hbnVhbFJpZ2h0KSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGFhLm1hbnVhbEFBID0gMgogICAgICAgICAgICAgICAgICAgICAgICBhYS5pbnB1dCA9IGdsb2JhbHMuY3VydGltZSgpCiAgICAgICAgICAgICAgICAgICAgZWxzZWlmIHVpLmdldChtZW51LmFhVGFiLm1hbnVhbFRhYi5tYW51YWxGb3J3YXJkKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGFhLm1hbnVhbEFBID0gMwogICAgICAgICAgICAgICAgICAgICAgICBhYS5pbnB1dCA9IGdsb2JhbHMuY3VydGltZSgpCiAgICAgICAgICAgICAgICAgICAgZWxzZWlmIHVpLmdldChtZW51LmFhVGFiLm1hbnVhbFRhYi5tYW51YWxMZWZ0KSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGFhLm1hbnVhbEFBID0gMAogICAgICAgICAgICAgICAgICAgICAgICBhYS5pbnB1dCA9IGdsb2JhbHMuY3VydGltZSgpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbHNlaWYgYWEubWFudWFsQUEgPT0gMiB0aGVuCiAgICAgICAgICAgICAgICAgICAgaWYgdWkuZ2V0KG1lbnUuYWFUYWIubWFudWFsVGFiLm1hbnVhbExlZnQpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgYWEubWFudWFsQUEgPSAxCiAgICAgICAgICAgICAgICAgICAgICAgIGFhLmlucHV0ID0gZ2xvYmFscy5jdXJ0aW1lKCkKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgdWkuZ2V0KG1lbnUuYWFUYWIubWFudWFsVGFiLm1hbnVhbEZvcndhcmQpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgYWEubWFudWFsQUEgPSAzCiAgICAgICAgICAgICAgICAgICAgICAgIGFhLmlucHV0ID0gZ2xvYmFscy5jdXJ0aW1lKCkKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgdWkuZ2V0KG1lbnUuYWFUYWIubWFudWFsVGFiLm1hbnVhbFJpZ2h0KSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGFhLm1hbnVhbEFBID0gMAogICAgICAgICAgICAgICAgICAgICAgICBhYS5pbnB1dCA9IGdsb2JhbHMuY3VydGltZSgpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbHNlaWYgYWEubWFudWFsQUEgPT0gMyB0aGVuCiAgICAgICAgICAgICAgICAgICAgaWYgdWkuZ2V0KG1lbnUuYWFUYWIubWFudWFsVGFiLm1hbnVhbEZvcndhcmQpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgYWEubWFudWFsQUEgPSAwCiAgICAgICAgICAgICAgICAgICAgICAgIGFhLmlucHV0ID0gZ2xvYmFscy5jdXJ0aW1lKCkKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgdWkuZ2V0KG1lbnUuYWFUYWIubWFudWFsVGFiLm1hbnVhbExlZnQpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgYWEubWFudWFsQUEgPSAxCiAgICAgICAgICAgICAgICAgICAgICAgIGFhLmlucHV0ID0gZ2xvYmFscy5jdXJ0aW1lKCkKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgdWkuZ2V0KG1lbnUuYWFUYWIubWFudWFsVGFiLm1hbnVhbFJpZ2h0KSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGFhLm1hbnVhbEFBID0gMgogICAgICAgICAgICAgICAgICAgICAgICBhYS5pbnB1dCA9IGdsb2JhbHMuY3VydGltZSgpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGlmIGFhLm1hbnVhbEFBID09IDEgb3IgYWEubWFudWFsQUEgPT0gMiBvciBhYS5tYW51YWxBQSA9PSAzIHRoZW4KICAgICAgICAgICAgICAgIGFhLmlnbm9yZSA9IHRydWUKCiAgICAgICAgICAgICAgICBpZiB1aS5nZXQobWVudS5hYVRhYi5tYW51YWxzKSA9PSAiU3RhdGljIiB0aGVuCiAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMueWF3Sml0dGVyWzFdLCAiT2ZmIikKICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy55YXdKaXR0ZXJbMl0sIDApCiAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMuYm9keVlhd1sxXSwgIlN0YXRpYyIpCiAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMuYm9keVlhd1syXSwgLTE4MCkKCiAgICAgICAgICAgICAgICAgICAgaWYgYWEubWFudWFsQUEgPT0gMSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnlhd0Jhc2UsICJsb2NhbCB2aWV3IikKICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMueWF3WzFdLCAiMTgwIikKICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMueWF3WzJdLCAtOTApCiAgICAgICAgICAgICAgICAgICAgZWxzZWlmIGFhLm1hbnVhbEFBID09IDIgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy55YXdCYXNlLCAibG9jYWwgdmlldyIpCiAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnlhd1sxXSwgIjE4MCIpCiAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnlhd1syXSwgOTApCiAgICAgICAgICAgICAgICAgICAgZWxzZWlmIGFhLm1hbnVhbEFBID09IDMgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy55YXdCYXNlLCAibG9jYWwgdmlldyIpCiAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnlhd1sxXSwgIjE4MCIpCiAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnlhd1syXSwgMTgwKQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZWxzZWlmIHVpLmdldChtZW51LmFhVGFiLm1hbnVhbHMpID09ICJEZWZhdWx0IiBhbmQgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0uZW5hYmxlU3RhdGUpIHRoZW4KICAgICAgICAgICAgICAgICAgICBpZiB1aS5nZXQoYWFCdWlsZGVyW3ZhcnMucFN0YXRlXS55YXdKaXR0ZXIpID09ICIzLVdheSIgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy55YXdKaXR0ZXJbMV0sICJDZW50ZXIiKQogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy55YXdKaXR0ZXJbMl0sIChzaWRlID09IDEgYW5kIHVpLmdldChhYUJ1aWxkZXJbdmFycy5wU3RhdGVdLnlhd0ppdHRlckxlZnQpKm1hdGgucmFuZG9tKC0xLCAxKSAgb3IgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0ueWF3Sml0dGVyUmlnaHQpKm1hdGgucmFuZG9tKC0xLCAxKSApKQogICAgICAgICAgICAgICAgICAgIGVsc2VpZiB1aS5nZXQoYWFCdWlsZGVyW3ZhcnMucFN0YXRlXS55YXdKaXR0ZXIpID09ICJMJlIiIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMueWF3Sml0dGVyWzFdLCAiQ2VudGVyIikKICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMueWF3Sml0dGVyWzJdLCAoc2lkZSA9PSAxIGFuZCB1aS5nZXQoYWFCdWlsZGVyW3ZhcnMucFN0YXRlXS55YXdKaXR0ZXJMZWZ0KSBvciB1aS5nZXQoYWFCdWlsZGVyW3ZhcnMucFN0YXRlXS55YXdKaXR0ZXJSaWdodCkpKQogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMueWF3Sml0dGVyWzFdLCB1aS5nZXQoYWFCdWlsZGVyW3ZhcnMucFN0YXRlXS55YXdKaXR0ZXIpKQogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy55YXdKaXR0ZXJbMl0sIHVpLmdldChhYUJ1aWxkZXJbdmFycy5wU3RhdGVdLnlhd0ppdHRlclN0YXRpYykpCiAgICAgICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLmJvZHlZYXdbMV0sICJTdGF0aWMiKQogICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLmJvZHlZYXdbMl0sIC0xODApCgogICAgICAgICAgICAgICAgICAgIGlmIGFhLm1hbnVhbEFBID09IDEgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy55YXdCYXNlLCAibG9jYWwgdmlldyIpCiAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnlhd1sxXSwgIjE4MCIpCiAgICAgICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnlhd1syXSwgLTkwKQogICAgICAgICAgICAgICAgICAgIGVsc2VpZiBhYS5tYW51YWxBQSA9PSAyIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMueWF3QmFzZSwgImxvY2FsIHZpZXciKQogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy55YXdbMV0sICIxODAiKQogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy55YXdbMl0sIDkwKQogICAgICAgICAgICAgICAgICAgIGVsc2VpZiBhYS5tYW51YWxBQSA9PSAzIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMueWF3QmFzZSwgImxvY2FsIHZpZXciKQogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy55YXdbMV0sICIxODAiKQogICAgICAgICAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy55YXdbMl0sIDE4MCkKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBhYS5pZ25vcmUgPSBmYWxzZQogICAgICAgICAgICBlbmQKICAgICAgICBlbHNlCiAgICAgICAgICAgIGFhLmlnbm9yZSA9IGZhbHNlCiAgICAgICAgICAgIGFhLm1hbnVhbEFBPSAwCiAgICAgICAgICAgIGFhLmlucHV0ID0gMAogICAgICAgIGVuZAoKICAgIGlmIG5vdCB1aS5nZXQobWVudS5hYVRhYi5sZWdpdEFBSG90a2V5KSBhbmQgYWEuaWdub3JlID09IGZhbHNlIHRoZW4KICAgICAgICBpZiB1aS5nZXQoYWFCdWlsZGVyW3ZhcnMucFN0YXRlXS5lbmFibGVTdGF0ZSkgdGhlbgoKICAgICAgICAgICAgY21kLmZvcmNlX2RlZmVuc2l2ZSA9IHVpLmdldChhYUJ1aWxkZXJbdmFycy5wU3RhdGVdLmZvcmNlRGVmZW5zaXZlKQoKICAgICAgICAgICAgaWYgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0ucGl0Y2gpIH49ICJDdXN0b20iIHRoZW4KICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnBpdGNoWzFdLCB1aS5nZXQoYWFCdWlsZGVyW3ZhcnMucFN0YXRlXS5waXRjaCkpCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnBpdGNoWzFdLCB1aS5nZXQoYWFCdWlsZGVyW3ZhcnMucFN0YXRlXS5waXRjaCkpCiAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy5waXRjaFsyXSwgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0ucGl0Y2hTbGlkZXIpKQogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIHVpLnNldChyZWZzLnlhd0Jhc2UsIHVpLmdldChhYUJ1aWxkZXJbdmFycy5wU3RhdGVdLnlhd0Jhc2UpKQoKICAgICAgICAgICAgbG9jYWwgc3dpdGNoID0gZmFsc2UKICAgICAgICAgICAgaWYgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0ueWF3KSA9PSAiU2xvdyBZYXciIHRoZW4KICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnlhd1sxXSwgIjE4MCIpCiAgICAgICAgICAgICAgICBsb2NhbCBzd2l0Y2hfdGlja3MgPSBmdW5jLnRpbWVfdG9fdGlja3MoZ2xvYmFscy5yZWFsdGltZSgpKSAtIGN1cnJlbnRfdGljawogICAgICAgICAgICAKICAgICAgICAgICAgICAgIGlmIHN3aXRjaF90aWNrcyAqIDIgPj0gMyB0aGVuCiAgICAgICAgICAgICAgICAgICAgc3dpdGNoID0gdHJ1ZQogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIHN3aXRjaCA9IGZhbHNlCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGlmIHN3aXRjaF90aWNrcyA+PSAzIHRoZW4KICAgICAgICAgICAgICAgICAgICBjdXJyZW50X3RpY2sgPSBmdW5jLnRpbWVfdG9fdGlja3MoZ2xvYmFscy5yZWFsdGltZSgpKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy55YXdbMl0sIHN3aXRjaCBhbmQgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0ueWF3UmlnaHQpIG9yIHVpLmdldChhYUJ1aWxkZXJbdmFycy5wU3RhdGVdLnlhd0xlZnQpKQogICAgICAgICAgICBlbHNlaWYgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0ueWF3KSA9PSAiTCZSIiB0aGVuCiAgICAgICAgICAgICAgICB1aS5zZXQocmVmcy55YXdbMV0sICIxODAiKQogICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMueWF3WzJdLChzaWRlID09IDEgYW5kIHVpLmdldChhYUJ1aWxkZXJbdmFycy5wU3RhdGVdLnlhd0xlZnQpIG9yIHVpLmdldChhYUJ1aWxkZXJbdmFycy5wU3RhdGVdLnlhd1JpZ2h0KSkpCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnlhd1sxXSwgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0ueWF3KSkKICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnlhd1syXSwgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0ueWF3U3RhdGljKSkKICAgICAgICAgICAgZW5kCgoKICAgICAgICAgICAgaWYgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0ueWF3Sml0dGVyKSA9PSAiMy1XYXkiIHRoZW4KICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnlhd0ppdHRlclsxXSwgIkNlbnRlciIpCiAgICAgICAgICAgICAgICBsb2NhbCB3YXlzID0gewogICAgICAgICAgICAgICAgICAgIHVpLmdldChhYUJ1aWxkZXJbdmFycy5wU3RhdGVdLndheUZpcnN0KSwKICAgICAgICAgICAgICAgICAgICB1aS5nZXQoYWFCdWlsZGVyW3ZhcnMucFN0YXRlXS53YXlTZWNvbmQpLAogICAgICAgICAgICAgICAgICAgIHVpLmdldChhYUJ1aWxkZXJbdmFycy5wU3RhdGVdLndheVRoaXJkKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnlhd0ppdHRlclsyXSwgd2F5c1soZ2xvYmFscy50aWNrY291bnQoKSUzKSArIDFdKQogICAgICAgICAgICBlbHNlaWYgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0ueWF3Sml0dGVyKSA9PSAiTCZSIiB0aGVuIAogICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMueWF3Sml0dGVyWzFdLCAiQ2VudGVyIikKICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnlhd0ppdHRlclsyXSwgKHNpZGUgPT0gMSBhbmQgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0ueWF3Sml0dGVyTGVmdCkgb3IgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0ueWF3Sml0dGVyUmlnaHQpKSkKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMueWF3Sml0dGVyWzFdLCB1aS5nZXQoYWFCdWlsZGVyW3ZhcnMucFN0YXRlXS55YXdKaXR0ZXIpKQogICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMueWF3Sml0dGVyWzJdLCB1aS5nZXQoYWFCdWlsZGVyW3ZhcnMucFN0YXRlXS55YXdKaXR0ZXJTdGF0aWMpKQogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIHVpLnNldChyZWZzLmJvZHlZYXdbMV0sIHVpLmdldChhYUJ1aWxkZXJbdmFycy5wU3RhdGVdLmJvZHlZYXcpKQogICAgICAgICAgICB1aS5zZXQocmVmcy5ib2R5WWF3WzJdLCAodWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0uYm9keVlhd1N0YXRpYykpKQogICAgICAgICAgICB1aS5zZXQocmVmcy5mc0JvZHlZYXcsIGZhbHNlKQogICAgICAgIGVsc2VpZiBub3QgdWkuZ2V0KGFhQnVpbGRlclt2YXJzLnBTdGF0ZV0uZW5hYmxlU3RhdGUpIHRoZW4KICAgICAgICAgICAgdWkuc2V0KHJlZnMucGl0Y2hbMV0sICJPZmYiKQogICAgICAgICAgICB1aS5zZXQocmVmcy55YXdCYXNlLCAiTG9jYWwgdmlldyIpCiAgICAgICAgICAgIHVpLnNldChyZWZzLnlhd1sxXSwgIk9mZiIpCiAgICAgICAgICAgIHVpLnNldChyZWZzLnlhd1syXSwgMCkKICAgICAgICAgICAgdWkuc2V0KHJlZnMueWF3Sml0dGVyWzFdLCAiT2ZmIikKICAgICAgICAgICAgdWkuc2V0KHJlZnMueWF3Sml0dGVyWzJdLCAwKQogICAgICAgICAgICB1aS5zZXQocmVmcy5ib2R5WWF3WzFdLCAiT2ZmIikKICAgICAgICAgICAgdWkuc2V0KHJlZnMuYm9keVlhd1syXSwgMCkKICAgICAgICAgICAgdWkuc2V0KHJlZnMuZnNCb2R5WWF3LCBmYWxzZSkKICAgICAgICAgICAgdWkuc2V0KHJlZnMuZWRnZVlhdywgZmFsc2UpCiAgICAgICAgICAgIHVpLnNldChyZWZzLnJvbGwsIDApCiAgICAgICAgZW5kCiAgICBlbHNlaWYgdWkuZ2V0KG1lbnUuYWFUYWIubGVnaXRBQUhvdGtleSkgYW5kIGFhLmlnbm9yZSA9PSBmYWxzZSB0aGVuCiAgICAgICAgaWYgZW50aXR5LmdldF9jbGFzc25hbWUoZW50aXR5LmdldF9wbGF5ZXJfd2VhcG9uKHZhcnMubG9jYWxQbGF5ZXIpKSA9PSAiQ0M0IiB0aGVuIAogICAgICAgICAgICByZXR1cm4gCiAgICAgICAgZW5kCiAgICAKICAgICAgICBsb2NhbCBzaG91bGRfZGlzYWJsZSA9IGZhbHNlCiAgICAgICAgbG9jYWwgcGxhbnRlZF9ib21iID0gZW50aXR5LmdldF9hbGwoIkNQbGFudGVkQzQiKVsxXQogICAgCiAgICAgICAgaWYgcGxhbnRlZF9ib21iIH49IG5pbCB0aGVuCiAgICAgICAgICAgIGJvbWJfZGlzdGFuY2UgPSB2ZWN0b3IoZW50aXR5LmdldF9vcmlnaW4odmFycy5sb2NhbFBsYXllcikpOmRpc3QodmVjdG9yKGVudGl0eS5nZXRfb3JpZ2luKHBsYW50ZWRfYm9tYikpKQogICAgICAgICAgICAKICAgICAgICAgICAgaWYgYm9tYl9kaXN0YW5jZSA8PSA2NCBhbmQgZW50aXR5LmdldF9wcm9wKHZhcnMubG9jYWxQbGF5ZXIsICJtX2lUZWFtTnVtIikgPT0gMyB0aGVuCiAgICAgICAgICAgICAgICBzaG91bGRfZGlzYWJsZSA9IHRydWUKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICAKICAgICAgICBsb2NhbCBwaXRjaCwgeWF3ID0gY2xpZW50LmNhbWVyYV9hbmdsZXMoKQogICAgICAgIGxvY2FsIGRpcmVjdF92ZWMgPSB2ZWN0b3IoZnVuYy52ZWNfYW5nbGVzKHBpdGNoLCB5YXcpKQogICAgCiAgICAgICAgbG9jYWwgZXllX3BvcyA9IHZlY3RvcihjbGllbnQuZXllX3Bvc2l0aW9uKCkpCiAgICAgICAgbG9jYWwgZnJhY3Rpb24sIGVudCA9IGNsaWVudC50cmFjZV9saW5lKHZhcnMubG9jYWxQbGF5ZXIsIGV5ZV9wb3MueCwgZXllX3Bvcy55LCBleWVfcG9zLnosIGV5ZV9wb3MueCArIChkaXJlY3RfdmVjLnggKiA4MTkyKSwgZXllX3Bvcy55ICsgKGRpcmVjdF92ZWMueSAqIDgxOTIpLCBleWVfcG9zLnogKyAoZGlyZWN0X3ZlYy56ICogODE5MikpCiAgICAKICAgICAgICBpZiBlbnQgfj0gbmlsIGFuZCBlbnQgfj0gLTEgdGhlbgogICAgICAgICAgICBpZiBlbnRpdHkuZ2V0X2NsYXNzbmFtZShlbnQpID09ICJDUHJvcERvb3JSb3RhdGluZyIgdGhlbgogICAgICAgICAgICAgICAgc2hvdWxkX2Rpc2FibGUgPSB0cnVlCiAgICAgICAgICAgIGVsc2VpZiBlbnRpdHkuZ2V0X2NsYXNzbmFtZShlbnQpID09ICJDSG9zdGFnZSIgdGhlbgogICAgICAgICAgICAgICAgc2hvdWxkX2Rpc2FibGUgPSB0cnVlCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgICAgIAogICAgICAgIGlmIHNob3VsZF9kaXNhYmxlIH49IHRydWUgYW5kIGNtZC5pbl91c2UgPT0gMSB0aGVuCiAgICAgICAgICAgIHVpLnNldChyZWZzLnBpdGNoWzFdLCAiT2ZmIikKICAgICAgICAgICAgdWkuc2V0KHJlZnMueWF3QmFzZSwgIkxvY2FsIHZpZXciKQogICAgICAgICAgICB1aS5zZXQocmVmcy55YXdbMV0sICJPZmYiKQogICAgICAgICAgICB1aS5zZXQocmVmcy55YXdbMl0sIDApCiAgICAgICAgICAgIHVpLnNldChyZWZzLnlhd0ppdHRlclsxXSwgIk9mZiIpCiAgICAgICAgICAgIHVpLnNldChyZWZzLnlhd0ppdHRlclsyXSwgMCkKICAgICAgICAgICAgdWkuc2V0KHJlZnMuYm9keVlhd1sxXSwgIk9wcG9zaXRlIikKICAgICAgICAgICAgdWkuc2V0KHJlZnMuZnNCb2R5WWF3LCB0cnVlKQogICAgICAgICAgICB1aS5zZXQocmVmcy5lZGdlWWF3LCBmYWxzZSkKICAgICAgICAgICAgdWkuc2V0KHJlZnMucm9sbCwgMCkKICAgIAogICAgICAgICAgICBjbWQuaW5fdXNlID0gMAogICAgICAgICAgICBjbWQucm9sbCA9IDAKICAgICAgICBlbmQKICAgIGVuZAoKICAgIC0tIGZpeCBoaWRlc2hvdHMKCglpZiB1aS5nZXQobWVudS5taXNjVGFiLmZpeEhpZGVzaG90cykgdGhlbgoJCWlmIGlzT3MgYW5kIG5vdCBpc0R0IGFuZCBub3QgaXNGZCB0aGVuCiAgICAgICAgICAgIGlmIG5vdCBoc1NhdmVkIHRoZW4KICAgICAgICAgICAgICAgIGhzVmFsdWUgPSB1aS5nZXQocmVmcy5mYWtlTGFnWzFdKQogICAgICAgICAgICAgICAgaHNTYXZlZCA9IHRydWUKICAgICAgICAgICAgZW5kCgkJCXVpLnNldChyZWZzLmZha2VMYWdbMV0sIDEpCgkJZWxzZWlmIGhzU2F2ZWQgdGhlbgoJCQl1aS5zZXQocmVmcy5mYWtlTGFnWzFdLCBoc1ZhbHVlKQogICAgICAgICAgICBoc1NhdmVkID0gZmFsc2UKCQllbmQKCWVuZAoKICAgIC0tIEF2b2lkIGJhY2tzdGFiCiAgICBpZiB1aS5nZXQobWVudS5hYVRhYi5hdm9pZEJhY2tzdGFiKSB+PSAwIHRoZW4KICAgICAgICBsb2NhbCBwbGF5ZXJzID0gZW50aXR5LmdldF9wbGF5ZXJzKHRydWUpCiAgICAgICAgZm9yIGk9MSwgI3BsYXllcnMgZG8KICAgICAgICAgICAgbG9jYWwgeCwgeSwgeiA9IGVudGl0eS5nZXRfcHJvcChwbGF5ZXJzW2ldLCAibV92ZWNPcmlnaW4iKQogICAgICAgICAgICBsb2NhbCBkaXN0YW5jZSA9IGZ1bmMuZmluZERpc3Qob3JpZ2luLngsIG9yaWdpbi55LCBvcmlnaW4ueiwgeCwgeSwgeikKICAgICAgICAgICAgbG9jYWwgd2VhcG9uID0gZW50aXR5LmdldF9wbGF5ZXJfd2VhcG9uKHBsYXllcnNbaV0pCiAgICAgICAgICAgIGlmIGVudGl0eS5nZXRfY2xhc3NuYW1lKHdlYXBvbikgPT0gIkNLbmlmZSIgYW5kIGRpc3RhbmNlIDw9IHVpLmdldChtZW51LmFhVGFiLmF2b2lkQmFja3N0YWIpIHRoZW4KICAgICAgICAgICAgICAgIHVpLnNldChyZWZzLnlhd1syXSwgMTgwKQogICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMucGl0Y2hbMV0sICJPZmYiKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAoKICAgIC0tIGZyZWVzdGFuZAogICAgaWYgKCB1aS5nZXQobWVudS5hYVRhYi5mcmVlc3RhbmRIb3RrZXkpKSB0aGVuCiAgICAgICAgaWYgbWFudWFsc092ZXJGcyA9PSB0cnVlIGFuZCBhYS5pZ25vcmUgPT0gdHJ1ZSB0aGVuCiAgICAgICAgICAgIHVpLnNldChyZWZzLmZyZWVTdGFuZFsyXSwgIk9uIGhvdGtleSIpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGVsc2UKICAgICAgICAgICAgdWkuc2V0KHJlZnMuZnJlZVN0YW5kWzJdLCAiQWx3YXlzIG9uIikKICAgICAgICAgICAgdWkuc2V0KHJlZnMuZnJlZVN0YW5kWzFdLCB0cnVlKQogICAgICAgIGVuZAogICAgZWxzZQogICAgICAgIHVpLnNldChyZWZzLmZyZWVTdGFuZFsxXSwgZmFsc2UpCiAgICAgICAgdWkuc2V0KHJlZnMuZnJlZVN0YW5kWzJdLCAiT24gaG90a2V5IikKICAgIGVuZAoKICAgIC0tIGR0IGRpc2NoYXJnZQogICAgaWYgdWkuZ2V0KG1lbnUubWlzY1RhYi5kdERpc2NoYXJnZSkgdGhlbgogICAgICAgIGlmIGR0RW5hYmxlZCA9PSBuaWwgdGhlbgogICAgICAgICAgICBkdEVuYWJsZWQgPSB0cnVlCiAgICAgICAgZW5kCiAgICAgICAgbG9jYWwgZW5lbWllcyA9IGVudGl0eS5nZXRfcGxheWVycyh0cnVlKQogICAgICAgIGxvY2FsIHZpcyA9IGZhbHNlCiAgICAgICAgbG9jYWwgaGVhbHRoID0gZW50aXR5LmdldF9wcm9wKHZhcnMubG9jYWxQbGF5ZXIsICJtX2lIZWFsdGgiKQogICAgICAgIGZvciBpPTEsICNlbmVtaWVzIGRvCiAgICAgICAgICAgIGxvY2FsIGVudGluZGV4ID0gZW5lbWllc1tpXQogICAgICAgICAgICBsb2NhbCBib2R5X3gsYm9keV95LGJvZHlfeiA9IGVudGl0eS5oaXRib3hfcG9zaXRpb24oZW50aW5kZXgsIDEpCiAgICAgICAgICAgIGlmIGNsaWVudC52aXNpYmxlKGJvZHlfeCwgYm9keV95LCBib2R5X3ogKyAyMCkgdGhlbgogICAgICAgICAgICAgICAgdmlzID0gdHJ1ZQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQJCgogICAgICAgIGlmIHZpcyB0aGVuCiAgICAgICAgICAgIHVpLnNldChyZWZzLmR0WzFdLGZhbHNlKQogICAgICAgICAgICBjbGllbnQuZGVsYXlfY2FsbCgwLjAxLCBmdW5jdGlvbigpIAogICAgICAgICAgICAgICAgdWkuc2V0KHJlZnMuZHRbMV0sdHJ1ZSkKICAgICAgICAgICAgZW5kKQogICAgICAgIGVuZAogICAgZWxzZQogICAgICAgIGlmIGR0RW5hYmxlZCA9PSB0cnVlIHRoZW4KICAgICAgICAgICAgdWkuc2V0KHJlZnMuZHRbMV0sIGR0RW5hYmxlZCkKICAgICAgICAgICAgZHRFbmFibGVkID0gZmFsc2UKICAgICAgICBlbmQKICAgIGVuZAogICAgCiAgICAtLSBmYXN0IGxhZGRlcgogICAgaWYgdWkuZ2V0KG1lbnUubWlzY1RhYi5mYXN0TGFkZGVyRW5hYmxlZCkgdGhlbgogICAgICAgIGxvY2FsIHBpdGNoLCB5YXcgPSBjbGllbnQuY2FtZXJhX2FuZ2xlcygpCiAgICAgICAgaWYgZW50aXR5LmdldF9wcm9wKHZhcnMubG9jYWxQbGF5ZXIsICJtX01vdmVUeXBlIikgPT0gOSB0aGVuCiAgICAgICAgICAgIGNtZC55YXcgPSBtYXRoLmZsb29yKGNtZC55YXcrMC41KQogICAgICAgICAgICBjbWQucm9sbCA9IDAKICAgIAogICAgICAgICAgICBpZiBmdW5jLnRhYmxlX2NvbnRhaW5zKHVpLmdldChtZW51Lm1pc2NUYWIuZmFzdExhZGRlciksICJBc2NlbmRpbmciKSB0aGVuCiAgICAgICAgICAgICAgICBpZiBjbWQuZm9yd2FyZG1vdmUgPiAwIHRoZW4KICAgICAgICAgICAgICAgICAgICBpZiBwaXRjaCA8IDQ1IHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgY21kLnBpdGNoID0gODkKICAgICAgICAgICAgICAgICAgICAgICAgY21kLmluX21vdmVyaWdodCA9IDEKICAgICAgICAgICAgICAgICAgICAgICAgY21kLmluX21vdmVsZWZ0ID0gMAogICAgICAgICAgICAgICAgICAgICAgICBjbWQuaW5fZm9yd2FyZCA9IDAKICAgICAgICAgICAgICAgICAgICAgICAgY21kLmluX2JhY2sgPSAxCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGNtZC5zaWRlbW92ZSA9PSAwIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNtZC55YXcgPSBjbWQueWF3ICsgOTAKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGNtZC5zaWRlbW92ZSA8IDAgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY21kLnlhdyA9IGNtZC55YXcgKyAxNTAKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGNtZC5zaWRlbW92ZSA+IDAgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY21kLnlhdyA9IGNtZC55YXcgKyAzMAogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQgCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGlmIGZ1bmMudGFibGVfY29udGFpbnModWkuZ2V0KG1lbnUubWlzY1RhYi5mYXN0TGFkZGVyKSwgIkRlc2NlbmRpbmciKSB0aGVuCiAgICAgICAgICAgICAgICBpZiBjbWQuZm9yd2FyZG1vdmUgPCAwIHRoZW4KICAgICAgICAgICAgICAgICAgICBjbWQucGl0Y2ggPSA4OQogICAgICAgICAgICAgICAgICAgIGNtZC5pbl9tb3ZlbGVmdCA9IDEKICAgICAgICAgICAgICAgICAgICBjbWQuaW5fbW92ZXJpZ2h0ID0gMAogICAgICAgICAgICAgICAgICAgIGNtZC5pbl9mb3J3YXJkID0gMQogICAgICAgICAgICAgICAgICAgIGNtZC5pbl9iYWNrID0gMAogICAgICAgICAgICAgICAgICAgIGlmIGNtZC5zaWRlbW92ZSA9PSAwIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgY21kLnlhdyA9IGNtZC55YXcgKyA5MAogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGlmIGNtZC5zaWRlbW92ZSA+IDAgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBjbWQueWF3ID0gY21kLnlhdyArIDE1MAogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGlmIGNtZC5zaWRlbW92ZSA8IDAgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBjbWQueWF3ID0gY21kLnlhdyArIDMwCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKCiAgICAtLSBlZGdleWF3CiAgICB1aS5zZXQocmVmcy5lZGdlWWF3LCB1aS5nZXQobWVudS5hYVRhYi5lZGdlWWF3SG90a2V5KSkKICAgIAplbmQpCgp1aS5zZXRfY2FsbGJhY2sobWVudS5taXNjVGFiLnRyYXNoVGFsaywgZnVuY3Rpb24oKSAKICAgIGxvY2FsIGNhbGxiYWNrID0gdWkuZ2V0KG1lbnUubWlzY1RhYi50cmFzaFRhbGspIGFuZCBjbGllbnQuc2V0X2V2ZW50X2NhbGxiYWNrIG9yIGNsaWVudC51bnNldF9ldmVudF9jYWxsYmFjawogICAgY2FsbGJhY2soJ3BsYXllcl9kZWF0aCcsIHRyYXNodGFsaykKZW5kKQoKdWkuc2V0X2NhbGxiYWNrKG1lbnUudmlzdWFsc1RhYi5sb2dzLCBmdW5jdGlvbigpIAogICAgbG9jYWwgY2FsbGJhY2sgPSB1aS5nZXQobWVudS52aXN1YWxzVGFiLmxvZ3MpIGFuZCBjbGllbnQuc2V0X2V2ZW50X2NhbGxiYWNrIG9yIGNsaWVudC51bnNldF9ldmVudF9jYWxsYmFjawogICAgY2FsbGJhY2soImFpbV9taXNzIiwgb25NaXNzKQogICAgY2FsbGJhY2soImFpbV9oaXQiLCBvbkhpdCkKZW5kKQoKbG9jYWwgbGVnc1NhdmVkID0gZmFsc2UKbG9jYWwgbGVnc1R5cGVzID0ge1sxXSA9ICJPZmYiLCBbMl0gPSAiQWx3YXlzIHNsaWRlIiwgWzNdID0gIk5ldmVyIHNsaWRlIn0KbG9jYWwgZ3JvdW5kX3RpY2tzID0gMApjbGllbnQuc2V0X2V2ZW50X2NhbGxiYWNrKCJwcmVfcmVuZGVyIiwgZnVuY3Rpb24oKQogICAgaWYgbm90IGVudGl0eS5nZXRfbG9jYWxfcGxheWVyKCkgdGhlbiByZXR1cm4gZW5kCiAgICBpZiB1aS5nZXQobWVudS5taXNjVGFiLmFuaW1hdGlvbnNFbmFibGVkKSA9PSBmYWxzZSB0aGVuIHJldHVybiBlbmQKICAgIGxvY2FsIGZsYWdzID0gZW50aXR5LmdldF9wcm9wKGVudGl0eS5nZXRfbG9jYWxfcGxheWVyKCksICJtX2ZGbGFncyIpCiAgICBncm91bmRfdGlja3MgPSBiaXQuYmFuZChmbGFncywgMSkgPT0gMCBhbmQgMCBvciAoZ3JvdW5kX3RpY2tzIDwgNSBhbmQgZ3JvdW5kX3RpY2tzICsgMSBvciBncm91bmRfdGlja3MpCgogICAgaWYgZnVuYy50YWJsZV9jb250YWlucyh1aS5nZXQobWVudS5taXNjVGFiLmFuaW1hdGlvbnMpLCAiU3RhdGljIGxlZ3MiKSB0aGVuCiAgICAgICAgZW50aXR5LnNldF9wcm9wKGVudGl0eS5nZXRfbG9jYWxfcGxheWVyKCksICJtX2ZsUG9zZVBhcmFtZXRlciIsIDEsIDYpIAogICAgZW5kCgogICAgaWYgZnVuYy50YWJsZV9jb250YWlucyh1aS5nZXQobWVudS5taXNjVGFiLmFuaW1hdGlvbnMpLCAiTGVnIGZ1Y2tlciIpIHRoZW4KICAgICAgICBpZiBub3QgbGVnc1NhdmVkIHRoZW4KICAgICAgICAgICAgbGVnc1NhdmVkID0gdWkuZ2V0KHJlZnMubGVnTW92ZW1lbnQpCiAgICAgICAgZW5kCiAgICAgICAgdWkuc2V0X3Zpc2libGUocmVmcy5sZWdNb3ZlbWVudCwgZmFsc2UpCiAgICAgICAgaWYgZnVuYy50YWJsZV9jb250YWlucyh1aS5nZXQobWVudS5taXNjVGFiLmFuaW1hdGlvbnMpLCAiTGVnIGZ1Y2tlciIpIHRoZW4KICAgICAgICAgICAgdWkuc2V0KHJlZnMubGVnTW92ZW1lbnQsIGxlZ3NUeXBlc1ttYXRoLnJhbmRvbSgxLCAzKV0pCiAgICAgICAgICAgIGVudGl0eS5zZXRfcHJvcChlbnRpdHkuZ2V0X2xvY2FsX3BsYXllcigpLCAibV9mbFBvc2VQYXJhbWV0ZXIiLCA4LCAwKQogICAgICAgIGVuZAoKICAgIGVsc2VpZiAobGVnc1NhdmVkID09ICJPZmYiIG9yIGxlZ3NTYXZlZCA9PSAiQWx3YXlzIHNsaWRlIiBvciBsZWdzU2F2ZWQgPT0gIk5ldmVyIHNsaWRlIikgdGhlbgogICAgICAgIHVpLnNldF92aXNpYmxlKHJlZnMubGVnTW92ZW1lbnQsIHRydWUpCiAgICAgICAgdWkuc2V0KHJlZnMubGVnTW92ZW1lbnQsIGxlZ3NTYXZlZCkKICAgICAgICBsZWdzU2F2ZWQgPSBmYWxzZQogICAgZW5kCgogICAgaWYgZnVuYy50YWJsZV9jb250YWlucyh1aS5nZXQobWVudS5taXNjVGFiLmFuaW1hdGlvbnMpLCAiMCBwaXRjaCBvbiBsYW5kaW5nIikgdGhlbgogICAgICAgIGdyb3VuZF90aWNrcyA9IGJpdC5iYW5kKGZsYWdzLCAxKSA9PSAxIGFuZCBncm91bmRfdGlja3MgKyAxIG9yIDAKCiAgICAgICAgaWYgZ3JvdW5kX3RpY2tzID4gMjAgYW5kIGdyb3VuZF90aWNrcyA8IDE1MCB0aGVuCiAgICAgICAgICAgIGVudGl0eS5zZXRfcHJvcChlbnRpdHkuZ2V0X2xvY2FsX3BsYXllcigpLCAibV9mbFBvc2VQYXJhbWV0ZXIiLCAwLjUsIDEyKQogICAgICAgIGVuZAogICAgZW5kCgogICAgaWYgZnVuYy50YWJsZV9jb250YWlucyh1aS5nZXQobWVudS5taXNjVGFiLmFuaW1hdGlvbnMpLCAiQWxsYWggbGVncyIpIHRoZW4KICAgICAgICBlbnRpdHkuc2V0X3Byb3AoZW50aXR5LmdldF9sb2NhbF9wbGF5ZXIoKSwgIm1fZmxQb3NlUGFyYW1ldGVyIiwgMCwgNykKICAgIGVuZAplbmQpCi0tIEByZWdpb24gQUFfQ0FMTEJBQ0tTIGVuZAoKLS0gQHJlZ2lvbiBJTkRJQ0FUT1JTIHN0YXJ0CmxvY2FsIGFscGhhID0gMApsb2NhbCBzY29wZWRGcmFjdGlvbiA9IDAKCmxvY2FsIG1haW5JbmRDbHIgPSB7ciA9IDAsIGcgPSAwLCBiID0gMCwgYSA9IDB9CmxvY2FsIGR0Q2xyID0ge3IgPSAwLCBnID0gMCwgYiA9IDAsIGEgPSAwfQpsb2NhbCBjaGFyZ2VDbHIgPSB7ciA9IDAsIGcgPSAwLCBiID0gMCwgYSA9IDB9CmxvY2FsIGNoYXJnZUluZCA9IHt3ID0gMCwgeCA9IDAsIHkgPSAyNX0KbG9jYWwgcHNDbHIgPSB7ciA9IDAsIGcgPSAwLCBiID0gMCwgYSA9IDB9CmxvY2FsIGR0SW5kID0ge3cgPSAwLCB4ID0gMCwgeSA9IDI1fQpsb2NhbCBxcEluZCA9IHt3ID0gMCwgeCA9IDAsIHkgPSAyNSwgYSA9IDB9CmxvY2FsIGZkSW5kID0ge3cgPSAwLCB4ID0gMCwgeSA9IDI1LCBhID0gMH0KbG9jYWwgc3BJbmQgPSB7dyA9IDAsIHggPSAwLCB5ID0gMjUsIGEgPSAwfQpsb2NhbCBiYUluZCA9IHt3ID0gMCwgeCA9IDAsIHkgPSAyNSwgYSA9IDB9CmxvY2FsIGZzSW5kID0ge3cgPSAwLCB4ID0gMCwgeSA9IDI1LCBhID0gMH0KbG9jYWwgb3NJbmQgPSB7dyA9IDAsIHggPSAwLCB5ID0gMjUsIGEgPSAwfQpsb2NhbCBwc0luZCA9IHt3ID0gMCwgeCA9IDAsIHkgPSAyNX0KbG9jYWwgd0FscGhhID0gMApjbGllbnQuc2V0X2V2ZW50X2NhbGxiYWNrKCJwYWludCIsIGZ1bmN0aW9uKCkKICAgIGxvY2FsIGxvY2FsX3BsYXllciA9IGVudGl0eS5nZXRfbG9jYWxfcGxheWVyKCkKICAgIGlmIGxvY2FsX3BsYXllciA9PSBuaWwgb3IgZW50aXR5LmlzX2FsaXZlKGxvY2FsX3BsYXllcikgPT0gZmFsc2UgdGhlbiByZXR1cm4gZW5kCiAgICBsb2NhbCBzaXplWCwgc2l6ZVkgPSBjbGllbnQuc2NyZWVuX3NpemUoKQogICAgbG9jYWwgd2VhcG9uID0gZW50aXR5LmdldF9wbGF5ZXJfd2VhcG9uKGxvY2FsX3BsYXllcikKICAgIGxvY2FsIGJvZHlZYXcgPSBlbnRpdHkuZ2V0X3Byb3AobG9jYWxfcGxheWVyLCAibV9mbFBvc2VQYXJhbWV0ZXIiLCAxMSkgKiAxMjAgLSA2MAogICAgbG9jYWwgc2lkZSA9IGJvZHlZYXcgPiAwIGFuZCAxIG9yIC0xCiAgICBsb2NhbCBzdGF0ZSA9ICJNT1ZJTkciCiAgICBsb2NhbCBtYWluQ2xyID0ge30KICAgIG1haW5DbHIuciwgbWFpbkNsci5nLCBtYWluQ2xyLmIsIG1haW5DbHIuYSA9IHVpLmdldChtZW51LnZpc3VhbHNUYWIuaW5kaWNhdG9yc0NscikKICAgIGxvY2FsIGFycm93Q2xyID0ge30KICAgIGFycm93Q2xyLnIsIGFycm93Q2xyLmcsIGFycm93Q2xyLmIsIGFycm93Q2xyLmEgPSB1aS5nZXQobWVudS52aXN1YWxzVGFiLmFycm93Q2xyKQogICAgbG9jYWwgZmFrZSA9IG1hdGguZmxvb3IoYW50aWFpbV9mdW5jcy5nZXRfZGVzeW5jKDEpKQoKICAgIGxvY2FsIGluZGljYXRvcnMgPSAwCgogICAgaWYgdWkuZ2V0KG1lbnUudmlzdWFsc1RhYi53YXRlcm1hcmspIHRoZW4KICAgICAgICBpbmRpY2F0b3JzID0gaW5kaWNhdG9ycyArIDEKICAgICAgICB3QWxwaGEgPSBmdW5jLmxlcnAod0FscGhhLCAyNTUsIGdsb2JhbHMuZnJhbWV0aW1lKCkgKiAzKQogICAgZWxzZQogICAgICAgIHdBbHBoYSA9IGZ1bmMubGVycCh3QWxwaGEsIDAsIGdsb2JhbHMuZnJhbWV0aW1lKCkgKiAxMSkKICAgIGVuZAoKICAgIGxvY2FsIHdhdGVybWFya0NsciA9IHt9CiAgICB3YXRlcm1hcmtDbHIuciwgd2F0ZXJtYXJrQ2xyLmcsIHdhdGVybWFya0Nsci5iID0gdWkuZ2V0KG1lbnUudmlzdWFsc1RhYi53YXRlcm1hcmtDbHIpCgogICAgaWYgcmVhZGZpbGUoImxvZ28ucG5nIikgfj0gbmlsIHRoZW4KICAgICAgICBsb2NhbCBtYWluWSA9IDEwCiAgICAgICAgbG9jYWwgbWFyZ2luWCwgbWFyZ2luWSA9IHJlbmRlcmVyLm1lYXN1cmVfdGV4dCggIkEgTiBYIEkgRSBUIFkiKQogICAgICAgIGxvY2FsIHBuZyA9IGltYWdlcy5sb2FkX3BuZyhyZWFkZmlsZSgibG9nby5wbmciKSkKICAgICAgICBwbmc6ZHJhdygxNSwgc2l6ZVkvMiAtIDksIDMyLCA0MiwgMjU1LCAyNTUsIDI1NSwgd0FscGhhLCB0cnVlLCAiZiIpCiAgICAgICAgcmVuZGVyZXIudGV4dCg0Nywgc2l6ZVkvMiAtIDIgKyBtYWluWSwgd2F0ZXJtYXJrQ2xyLnIsIHdhdGVybWFya0Nsci5nLCB3YXRlcm1hcmtDbHIuYiwgd0FscGhhLCBuaWwsICJBIE4gWCBJIEUgVCBZXGEiIC4uIGZ1bmMuUkdCQXRvSEVYKDI1NSwgMjU1LCAyNTUsIHdBbHBoYSkgLi4gIiBbIiAuLiB1c2VyZGF0YS5idWlsZDp1cHBlcigpIC4uICJdIikKICAgICAgICByZW5kZXJlci50ZXh0KDQ3LCBzaXplWS8yIC0gNCArIG1hcmdpblkgKyBtYWluWSwgMjU1LCAyNTUsIDI1NSwgd0FscGhhLCAiLWQiLCBuaWwsICJVU0VSIC0gXGEiIC4uIGZ1bmMuUkdCQXRvSEVYKHdhdGVybWFya0Nsci5yLCB3YXRlcm1hcmtDbHIuZywgd2F0ZXJtYXJrQ2xyLmIsIHdBbHBoYSkgLi4gdXNlcmRhdGEudXNlcm5hbWU6dXBwZXIoKSkKICAgIGVuZAogICAgCiAgICAtLSBkcmF3IGFycm93cwogICAgaWYgdWkuZ2V0KG1lbnUudmlzdWFsc1RhYi5hcnJvd3MpIHRoZW4KICAgICAgICBpZiB1aS5nZXQobWVudS52aXN1YWxzVGFiLmFycm93SW5kaWNhdG9yU3R5bGUpID09ICJNb2Rlcm4iIHRoZW4KICAgICAgICAgICAgYWxwaGEgPSAoYWEubWFudWFsQUEgPT0gMiBvciBhYS5tYW51YWxBQSA9PSAxKSBhbmQgZnVuYy5sZXJwKGFscGhhLCAyNTUsIGdsb2JhbHMuZnJhbWV0aW1lKCkgKiAzKSBvciBmdW5jLmxlcnAoYWxwaGEsIDAsIGdsb2JhbHMuZnJhbWV0aW1lKCkgKiAxMSkKICAgICAgICAgICAgcmVuZGVyZXIudGV4dChzaXplWCAvIDIgKyA0NSwgc2l6ZVkgLyAyIC0gMi41LCBhYS5tYW51YWxBQSA9PSAyIGFuZCBhcnJvd0Nsci5yIG9yIDIwMCwgYWEubWFudWFsQUEgPT0gMiBhbmQgYXJyb3dDbHIuZyBvciAyMDAsIGFhLm1hbnVhbEFBID09IDIgYW5kIGFycm93Q2xyLmIgb3IgMjAwLCBhbHBoYSwgImMrIiwgMCwgJz4nKQogICAgICAgICAgICByZW5kZXJlci50ZXh0KHNpemVYIC8gMiAtIDQ1LCBzaXplWSAvIDIgLSAyLjUsIGFhLm1hbnVhbEFBID09IDEgYW5kIGFycm93Q2xyLnIgb3IgMjAwLCBhYS5tYW51YWxBQSA9PSAxIGFuZCBhcnJvd0Nsci5nIG9yIDIwMCwgYWEubWFudWFsQUEgPT0gMSBhbmQgYXJyb3dDbHIuYiBvciAyMDAsIGFscGhhLCAiYysiLCAwLCAnPCcpCiAgICAgICAgZW5kCiAgICAKICAgICAgICBpZiB1aS5nZXQobWVudS52aXN1YWxzVGFiLmFycm93SW5kaWNhdG9yU3R5bGUpID09ICJUZWFtc2tlZXQiIHRoZW4KICAgICAgICAgICAgcmVuZGVyZXIudHJpYW5nbGUoc2l6ZVggLyAyICsgNTUsIHNpemVZIC8gMiArIDIsIHNpemVYIC8gMiArIDQyLCBzaXplWSAvIDIgLSA3LCBzaXplWCAvIDIgKyA0Miwgc2l6ZVkgLyAyICsgMTEsIAogICAgICAgICAgICBhYS5tYW51YWxBQSA9PSAyIGFuZCBhcnJvd0Nsci5yIG9yIDI1LCAKICAgICAgICAgICAgYWEubWFudWFsQUEgPT0gMiBhbmQgYXJyb3dDbHIuZyBvciAyNSwgCiAgICAgICAgICAgIGFhLm1hbnVhbEFBID09IDIgYW5kIGFycm93Q2xyLmIgb3IgMjUsIAogICAgICAgICAgICBhYS5tYW51YWxBQSA9PSAyIGFuZCBhcnJvd0Nsci5hIG9yIDE2MCkKICAgIAogICAgICAgICAgICByZW5kZXJlci50cmlhbmdsZShzaXplWCAvIDIgLSA1NSwgc2l6ZVkgLyAyICsgMiwgc2l6ZVggLyAyIC0gNDIsIHNpemVZIC8gMiAtIDcsIHNpemVYIC8gMiAtIDQyLCBzaXplWSAvIDIgKyAxMSwgCiAgICAgICAgICAgIGFhLm1hbnVhbEFBID09IDEgYW5kIGFycm93Q2xyLnIgb3IgMjUsIAogICAgICAgICAgICBhYS5tYW51YWxBQSA9PSAxIGFuZCBhcnJvd0Nsci5nIG9yIDI1LCAKICAgICAgICAgICAgYWEubWFudWFsQUEgPT0gMSBhbmQgYXJyb3dDbHIuYiBvciAyNSwgCiAgICAgICAgICAgIGFhLm1hbnVhbEFBID09IDEgYW5kIGFycm93Q2xyLmEgb3IgMTYwKQogICAgICAgIAogICAgICAgICAgICByZW5kZXJlci5yZWN0YW5nbGUoc2l6ZVggLyAyICsgMzgsIHNpemVZIC8gMiAtIDcsIDIsIDE4LCAKICAgICAgICAgICAgYm9keVlhdyA8IC0xMCBhbmQgYXJyb3dDbHIuciBvciAyNSwKICAgICAgICAgICAgYm9keVlhdyA8IC0xMCBhbmQgYXJyb3dDbHIuZyBvciAyNSwKICAgICAgICAgICAgYm9keVlhdyA8IC0xMCBhbmQgYXJyb3dDbHIuYiBvciAyNSwKICAgICAgICAgICAgYm9keVlhdyA8IC0xMCBhbmQgYXJyb3dDbHIuYSBvciAxNjApCiAgICAgICAgICAgIHJlbmRlcmVyLnJlY3RhbmdsZShzaXplWCAvIDIgLSA0MCwgc2l6ZVkgLyAyIC0gNywgMiwgMTgsCQkJCiAgICAgICAgICAgIGJvZHlZYXcgPiAxMCBhbmQgYXJyb3dDbHIuciBvciAyNSwKICAgICAgICAgICAgYm9keVlhdyA+IDEwIGFuZCBhcnJvd0Nsci5nIG9yIDI1LAogICAgICAgICAgICBib2R5WWF3ID4gMTAgYW5kIGFycm93Q2xyLmIgb3IgMjUsCiAgICAgICAgICAgIGJvZHlZYXcgPiAxMCBhbmQgYXJyb3dDbHIuYSBvciAxNjApCiAgICAgICAgZW5kCiAgICBlbmQKCiAgICAtLSBtb3ZlIG9uIHNjb3BlCiAgICBsb2NhbCBzY29wZUxldmVsID0gZW50aXR5LmdldF9wcm9wKHdlYXBvbiwgJ21fem9vbUxldmVsJykKICAgIGxvY2FsIHNjb3BlZCA9IGVudGl0eS5nZXRfcHJvcChsb2NhbF9wbGF5ZXIsICdtX2JJc1Njb3BlZCcpID09IDEKICAgIGxvY2FsIHJlc3VtZVpvb20gPSBlbnRpdHkuZ2V0X3Byb3AobG9jYWxfcGxheWVyLCAnbV9iUmVzdW1lWm9vbScpID09IDEKICAgIGxvY2FsIGlzVmFsaWQgPSB3ZWFwb24gfj0gbmlsIGFuZCBzY29wZUxldmVsIH49IG5pbAogICAgbG9jYWwgYWN0ID0gaXNWYWxpZCBhbmQgc2NvcGVMZXZlbCA+IDAgYW5kIHNjb3BlZCBhbmQgbm90IHJlc3VtZVpvb20KICAgIGxvY2FsIHRpbWUgPSBnbG9iYWxzLmZyYW1ldGltZSgpICogMzAKCiAgICBpZiBhY3QgdGhlbgogICAgICAgIGlmIHNjb3BlZEZyYWN0aW9uIDwgMSB0aGVuCiAgICAgICAgICAgIHNjb3BlZEZyYWN0aW9uID0gZnVuYy5sZXJwKHNjb3BlZEZyYWN0aW9uLCAxICsgMC4xLCB0aW1lKQogICAgICAgIGVsc2UKICAgICAgICAgICAgc2NvcGVkRnJhY3Rpb24gPSAxCiAgICAgICAgZW5kCiAgICBlbHNlCiAgICAgICAgc2NvcGVkRnJhY3Rpb24gPSBmdW5jLmxlcnAoc2NvcGVkRnJhY3Rpb24sIDAsIHRpbWUpCiAgICBlbmQKCiAgICAtLSBkcmF3IGluZGljYXRvcnMKICAgIGlmIHVpLmdldChtZW51LnZpc3VhbHNUYWIuaW5kaWNhdG9ycykgYW5kIHVpLmdldChtZW51LnZpc3VhbHNUYWIuaW5kaWNhdG9yc1R5cGUpIH49ICItIiB0aGVuCiAgICAgICAgbG9jYWwgZHBpID0gdWkuZ2V0KHVpLnJlZmVyZW5jZSgiTUlTQyIsICJTZXR0aW5ncyIsICJEUEkgc2NhbGUiKSk6Z3N1YignJSUnLCAnJykgLSAxMDAKICAgICAgICBsb2NhbCBnbG9iYWxGbGFnID0gdWkuZ2V0KG1lbnUudmlzdWFsc1RhYi5pbmRpY2F0b3JzVHlwZSkgPT0gIlN0eWxlIDEiIGFuZCAiY2QtIiBvciAiY2QiCiAgICAgICAgbG9jYWwgZ2xvYmFsTW92ZVkgPSAwCiAgICAgICAgbG9jYWwgaW5kWCwgaW5kWSA9IHJlbmRlcmVyLm1lYXN1cmVfdGV4dChnbG9iYWxGbGFnLCAiRFQiKQogICAgICAgIGxvY2FsIHlEZWZhdWx0ID0gMTYKICAgICAgICBsb2NhbCBpbmRDb3VudCA9IDAKICAgICAgICBpbmRZID0gZ2xvYmFsRmxhZyA9PSAiY2QtIiBhbmQgaW5kWSAtIDMgb3IgaW5kWSAtIDIKICAgIAogICAgICAgIGxvY2FsIGlzQ2hhcmdlZCA9IGFudGlhaW1fZnVuY3MuZ2V0X2RvdWJsZV90YXAoKQogICAgICAgIGxvY2FsIGlzRnMgPSB1aS5nZXQobWVudS5hYVRhYi5mcmVlc3RhbmRIb3RrZXkpCiAgICAgICAgbG9jYWwgaXNCYSA9IHVpLmdldChyZWZzLmZvcmNlQmFpbSkKICAgICAgICBsb2NhbCBpc1NwID0gdWkuZ2V0KHJlZnMuc2FmZVBvaW50KQogICAgICAgIGxvY2FsIGlzUXAgPSB1aS5nZXQocmVmcy5xdWlja1BlZWtbMl0pCiAgICAgICAgbG9jYWwgaXNTbG93ID0gdWkuZ2V0KHJlZnMuc2xvd1sxXSkgYW5kIHVpLmdldChyZWZzLnNsb3dbMl0pCiAgICAgICAgbG9jYWwgaXNPcyA9IHVpLmdldChyZWZzLm9zWzFdKSBhbmQgdWkuZ2V0KHJlZnMub3NbMl0pCiAgICAgICAgbG9jYWwgaXNGZCA9IHVpLmdldChyZWZzLmZha2VEdWNrKQogICAgICAgIGxvY2FsIGlzRHQgPSB1aS5nZXQocmVmcy5kdFsxXSkgYW5kIHVpLmdldChyZWZzLmR0WzJdKQogICAgCiAgICAgICAgbG9jYWwgc3RhdGUgPSB2YXJzLmludFRvU1t2YXJzLnBTdGF0ZV06dXBwZXIoKQogICAgCiAgICAgICAgaWYgZnVuYy50YWJsZV9jb250YWlucyh1aS5nZXQobWVudS52aXN1YWxzVGFiLmluZGljYXRvcnNTdHlsZSksICJOYW1lIikgdGhlbgogICAgICAgICAgICBpbmRpY2F0b3JzID0gaW5kaWNhdG9ycyArIDEKICAgICAgICAgICAgbG9jYWwgbmFtZXgsIG5hbWV5ID0gcmVuZGVyZXIubWVhc3VyZV90ZXh0KGdsb2JhbEZsYWcsIGdsb2JhbEZsYWcgPT0gImNkLSIgYW5kIGx1YV9uYW1lOnVwcGVyKCkgb3IgbHVhX25hbWU6bG93ZXIoKSkKICAgICAgICAgICAgbG9jYWwgbG9nbyA9IGFuaW1hdGVfdGV4dChnbG9iYWxzLmN1cnRpbWUoKSwgZ2xvYmFsRmxhZyA9PSAiY2QtIiBhbmQgbHVhX25hbWU6dXBwZXIoKSBvciBsdWFfbmFtZTpsb3dlcigpLCBtYWluQ2xyLnIsIG1haW5DbHIuZywgbWFpbkNsci5iLCAyNTUpCiAgICAKICAgICAgICAgICAgcmVuZGVyZXIudGV4dChzaXplWC8yICsgKChuYW1leCArIDIpLzIpICogc2NvcGVkRnJhY3Rpb24sIHNpemVZLzIgKyAyMCAtIGRwaS8xMCwgMjU1LCAyNTUsIDI1NSwgMjU1LCBnbG9iYWxGbGFnLCBuaWwsIHVucGFjayhsb2dvKSkKICAgICAgICBlbmQgCiAgICAKICAgICAgICBpZiBmdW5jLnRhYmxlX2NvbnRhaW5zKHVpLmdldChtZW51LnZpc3VhbHNUYWIuaW5kaWNhdG9yc1N0eWxlKSwgIlN0YXRlIikgdGhlbgogICAgICAgICAgICBpbmRpY2F0b3JzID0gaW5kaWNhdG9ycyArIDEKICAgICAgICAgICAgaW5kQ291bnQgPSBpbmRDb3VudCArIDEKICAgICAgICAgICAgbG9jYWwgbmFtZXgsIG5hbWV5ID0gcmVuZGVyZXIubWVhc3VyZV90ZXh0KGdsb2JhbEZsYWcsIGdsb2JhbEZsYWcgPT0gImNkLSIgYW5kIGx1YV9uYW1lOnVwcGVyKCkgb3IgbHVhX25hbWU6bG93ZXIoKSkKICAgICAgICAgICAgbG9jYWwgc3RhdGVYLCBzdGF0ZVkgPSByZW5kZXJlci5tZWFzdXJlX3RleHQoZ2xvYmFsRmxhZywgZ2xvYmFsRmxhZyA9PSAiY2QtIiBhbmQgZnVuYy5oZXgoe21haW5DbHIuciwgbWFpbkNsci5nLCBtYWluQ2xyLmJ9KSAuLiAnJScgLi4gZnVuYy5oZXgoezI1NSwgMjU1LCAyNTV9KSAuLiAgc3RhdGU6dXBwZXIoKSAuLiBmdW5jLmhleCh7bWFpbkNsci5yLCBtYWluQ2xyLmcsIG1haW5DbHIuYn0pIC4uICclJyBvciB1c2VyZGF0YS5idWlsZDpsb3dlcigpKQogICAgICAgICAgICBsb2NhbCBzdHJpbmcgPSBnbG9iYWxGbGFnID09ICJjZC0iIGFuZCBmdW5jLmhleCh7bWFpbkNsci5yLCBtYWluQ2xyLmcsIG1haW5DbHIuYn0pIC4uICclJyAuLiBmdW5jLmhleCh7MjU1LCAyNTUsIDI1NX0pIC4uICBzdGF0ZTp1cHBlcigpIC4uIGZ1bmMuaGV4KHttYWluQ2xyLnIsIG1haW5DbHIuZywgbWFpbkNsci5ifSkgLi4gJyUnIG9yIHVzZXJkYXRhLmJ1aWxkOmxvd2VyKCkKICAgICAgICAgICAgcmVuZGVyZXIudGV4dChzaXplWC8yICsgKHN0YXRlWCArIDIpLzIgKiBzY29wZWRGcmFjdGlvbiwgc2l6ZVkvMiArIDIwICsgbmFtZXkvMS4yLCAyNTUsIDI1NSwgMjU1LCBnbG9iYWxGbGFnID09ICJjZC0iIGFuZCAyNTUgb3IgbWF0aC5zaW4obWF0aC5hYnMoLW1hdGgucGkgKyAoZ2xvYmFscy5yZWFsdGltZSgpICogKDEgLyAwLjUpKSAlIChtYXRoLnBpICogMSkpKSAqIDI1NSwgZ2xvYmFsRmxhZywgMCwgc3RyaW5nKQogICAgICAgIGVuZAogICAgCiAgICAgICAgaWYgZnVuYy50YWJsZV9jb250YWlucyh1aS5nZXQobWVudS52aXN1YWxzVGFiLmluZGljYXRvcnNTdHlsZSksICJEb3VibGV0YXAiKSB0aGVuCiAgICAgICAgICAgIGluZGljYXRvcnMgPSBpbmRpY2F0b3JzICsgMQogICAgICAgICAgICBpZiBpc0R0IHRoZW4gCiAgICAgICAgICAgICAgICBkdENsci5hID0gZnVuYy5sZXJwKGR0Q2xyLmEsIDI1NSwgdGltZSkKICAgICAgICAgICAgICAgIGlmIGR0SW5kLnkgPCB5RGVmYXVsdCArIGluZFkgKiBpbmRDb3VudCB0aGVuCiAgICAgICAgICAgICAgICAgICAgZHRJbmQueSA9IGZ1bmMubGVycChkdEluZC55LCB5RGVmYXVsdCArIGluZFkgKiBpbmRDb3VudCArIDEsIHRpbWUpCiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgZHRJbmQueSA9IHlEZWZhdWx0ICsgaW5kWSAqIGluZENvdW50CiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGNoYXJnZUluZC53ID0gMC4xCiAgICAgICAgICAgICAgICBpZiBub3QgaXNDaGFyZ2VkIHRoZW4KICAgICAgICAgICAgICAgICAgICBkdENsci5yID0gZnVuYy5sZXJwKGR0Q2xyLnIsIDIyMiwgdGltZSkKICAgICAgICAgICAgICAgICAgICBkdENsci5nID0gZnVuYy5sZXJwKGR0Q2xyLmcsIDU1LCB0aW1lKQogICAgICAgICAgICAgICAgICAgIGR0Q2xyLmIgPSBmdW5jLmxlcnAoZHRDbHIuYiwgNTUsIHRpbWUpCiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgZHRDbHIuciA9IGZ1bmMubGVycChkdENsci5yLCAxNDQsIHRpbWUpCiAgICAgICAgICAgICAgICAgICAgZHRDbHIuZyA9IGZ1bmMubGVycChkdENsci5nLCAyMzgsIHRpbWUpCiAgICAgICAgICAgICAgICAgICAgZHRDbHIuYiA9IGZ1bmMubGVycChkdENsci5iLCAxNDQsIHRpbWUpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGluZENvdW50ID0gaW5kQ291bnQgKyAxCiAgICAgICAgICAgIGVsc2VpZiBub3QgaXNEdCB0aGVuIAogICAgICAgICAgICAgICAgZHRDbHIuYSA9IGZ1bmMubGVycChkdENsci5hLCAwLCB0aW1lKQogICAgICAgICAgICAgICAgZHRJbmQueSA9IGZ1bmMubGVycChkdEluZC55LCB5RGVmYXVsdCAtIDUsIHRpbWUpCiAgICAgICAgICAgIGVuZAogICAgCiAgICAgICAgICAgIHJlbmRlcmVyLnRleHQoc2l6ZVggLyAyICsgKChyZW5kZXJlci5tZWFzdXJlX3RleHQoZ2xvYmFsRmxhZywgZ2xvYmFsRmxhZyA9PSAiY2QtIiBhbmQgIkRUIiBvciAiZHQiKSArIDIpLzIpICogc2NvcGVkRnJhY3Rpb24gLCBzaXplWSAvIDIgKyBkdEluZC55ICsgMTMgKyBnbG9iYWxNb3ZlWSwgZHRDbHIuciwgZHRDbHIuZywgZHRDbHIuYiwgZHRDbHIuYSwgZ2xvYmFsRmxhZywgZHRJbmQudywgZ2xvYmFsRmxhZyA9PSAiY2QtIiBhbmQgIkRUIiBvciAiZHQiKQogICAgICAgIGVuZAogICAgCiAgICAgICAgaWYgZnVuYy50YWJsZV9jb250YWlucyh1aS5nZXQobWVudS52aXN1YWxzVGFiLmluZGljYXRvcnNTdHlsZSksICJIaWRlc2hvdHMiKSB0aGVuCiAgICAgICAgICAgIGluZGljYXRvcnMgPSBpbmRpY2F0b3JzICsgMQogICAgICAgICAgICBpZiBpc09zIHRoZW4gCiAgICAgICAgICAgICAgICBvc0luZC5hID0gZnVuYy5sZXJwKG9zSW5kLmEsIDI1NSwgdGltZSkKICAgICAgICAgICAgICAgIGlmIG9zSW5kLnkgPCB5RGVmYXVsdCArIGluZFkgKiBpbmRDb3VudCB0aGVuCiAgICAgICAgICAgICAgICAgICAgb3NJbmQueSA9IGZ1bmMubGVycChvc0luZC55LCB5RGVmYXVsdCArIGluZFkgKiBpbmRDb3VudCArIDEsIHRpbWUpCiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgb3NJbmQueSA9IHlEZWZhdWx0ICsgaW5kWSAqIGluZENvdW50CiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAKICAgICAgICAgICAgICAgIGluZENvdW50ID0gaW5kQ291bnQgKyAxCiAgICAgICAgICAgIGVsc2VpZiBub3QgaXNPcyB0aGVuCiAgICAgICAgICAgICAgICBvc0luZC5hID0gZnVuYy5sZXJwKG9zSW5kLmEsIDAsIHRpbWUpCiAgICAgICAgICAgICAgICBvc0luZC55ID0gZnVuYy5sZXJwKG9zSW5kLnksIHlEZWZhdWx0IC0gNSwgdGltZSkKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIHJlbmRlcmVyLnRleHQoc2l6ZVggLyAyICsgKChyZW5kZXJlci5tZWFzdXJlX3RleHQoZ2xvYmFsRmxhZywgZ2xvYmFsRmxhZyA9PSAiY2QtIiBhbmQgIkhTIiBvciAiaHMiKSArIDIpLzIpICogc2NvcGVkRnJhY3Rpb24sIHNpemVZIC8gMiArIG9zSW5kLnkgKyAxMyArIGdsb2JhbE1vdmVZLCAyNTUsIDI1NSwgMjU1LCBvc0luZC5hLCBnbG9iYWxGbGFnLCBvc0luZC53LCBnbG9iYWxGbGFnID09ICJjZC0iIGFuZCAiSFMiIG9yICJocyIpCiAgICAgICAgZW5kCiAgICAKICAgICAgICBpZiBmdW5jLnRhYmxlX2NvbnRhaW5zKHVpLmdldChtZW51LnZpc3VhbHNUYWIuaW5kaWNhdG9yc1N0eWxlKSwgIkZyZWVzdGFuZCIpIHRoZW4KICAgICAgICAgICAgaW5kaWNhdG9ycyA9IGluZGljYXRvcnMgKyAxCiAgICAgICAgICAgIGlmIGlzRnMgdGhlbiAKICAgICAgICAgICAgICAgIGZzSW5kLmEgPSBmdW5jLmxlcnAoZnNJbmQuYSwgMjU1LCB0aW1lKQogICAgICAgICAgICAgICAgaWYgZnNJbmQueSA8IHlEZWZhdWx0ICsgaW5kWSAqIGluZENvdW50IHRoZW4KICAgICAgICAgICAgICAgICAgICBmc0luZC55ID0gZnVuYy5sZXJwKGZzSW5kLnksIHlEZWZhdWx0ICsgaW5kWSAqIGluZENvdW50ICsgMSwgdGltZSkKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICBmc0luZC55ID0geURlZmF1bHQgKyBpbmRZICogaW5kQ291bnQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgaW5kQ291bnQgPSBpbmRDb3VudCArIDEKICAgICAgICAgICAgZWxzZWlmIG5vdCBpc0ZzIHRoZW4gCiAgICAgICAgICAgICAgICBmc0luZC5hID0gZnVuYy5sZXJwKGZzSW5kLmEsIDAsIHRpbWUpCiAgICAgICAgICAgICAgICBmc0luZC55ID0gZnVuYy5sZXJwKGZzSW5kLnksIHlEZWZhdWx0IC0gNSwgdGltZSkKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIHJlbmRlcmVyLnRleHQoc2l6ZVggLyAyICsgZnNJbmQueCArICgocmVuZGVyZXIubWVhc3VyZV90ZXh0KGdsb2JhbEZsYWcsIGdsb2JhbEZsYWcgPT0gImNkLSIgYW5kICJGUyIgb3IgImZzIikgKyAyKS8yKSAqIHNjb3BlZEZyYWN0aW9uLCBzaXplWSAvIDIgKyBmc0luZC55ICsgMTMgKyBnbG9iYWxNb3ZlWSwgMjU1LCAyNTUsIDI1NSwgZnNJbmQuYSwgZ2xvYmFsRmxhZywgZnNJbmQudywgZ2xvYmFsRmxhZyA9PSAiY2QtIiBhbmQgIkZTIiBvciAiZnMiKQogICAgICAgIGVuZAogICAgCiAgICAgICAgaWYgZnVuYy50YWJsZV9jb250YWlucyh1aS5nZXQobWVudS52aXN1YWxzVGFiLmluZGljYXRvcnNTdHlsZSksICJTYWZlcG9pbnQiKSB0aGVuCiAgICAgICAgICAgIGluZGljYXRvcnMgPSBpbmRpY2F0b3JzICsgMQogICAgICAgICAgICBpZiBpc1NwIHRoZW4gCiAgICAgICAgICAgICAgICBzcEluZC5hID0gZnVuYy5sZXJwKHNwSW5kLmEsIDI1NSwgdGltZSkKICAgICAgICAgICAgICAgIGlmIHNwSW5kLnkgPCB5RGVmYXVsdCArIGluZFkgKiBpbmRDb3VudCB0aGVuCiAgICAgICAgICAgICAgICAgICAgc3BJbmQueSA9IGZ1bmMubGVycChzcEluZC55LCB5RGVmYXVsdCArIGluZFkgKiBpbmRDb3VudCArIDEsIHRpbWUpCiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgc3BJbmQueSA9IHlEZWZhdWx0ICsgaW5kWSAqIGluZENvdW50CiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGluZENvdW50ID0gaW5kQ291bnQgKyAxCiAgICAgICAgICAgIGVsc2VpZiBub3QgaXNTcCB0aGVuIAogICAgICAgICAgICAgICAgc3BJbmQuYSA9IGZ1bmMubGVycChzcEluZC5hLCAwLCB0aW1lKQogICAgICAgICAgICAgICAgc3BJbmQueSA9IGZ1bmMubGVycChzcEluZC55LCB5RGVmYXVsdCAtIDUsIHRpbWUpCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICByZW5kZXJlci50ZXh0KHNpemVYIC8gMiArICgocmVuZGVyZXIubWVhc3VyZV90ZXh0KGdsb2JhbEZsYWcsIGdsb2JhbEZsYWcgPT0gImNkLSIgYW5kICJTUCIgb3IgInNwIikgKyAyKS8yKSAqIHNjb3BlZEZyYWN0aW9uLCBzaXplWSAvIDIgKyBzcEluZC55ICsgMTMgKyBnbG9iYWxNb3ZlWSwgMjU1LCAyNTUsIDI1NSwgc3BJbmQuYSwgZ2xvYmFsRmxhZywgMCwgZ2xvYmFsRmxhZyA9PSAiY2QtIiBhbmQgIlNQIiBvciAic3AiKQogICAgICAgIGVuZAogICAgCiAgICAgICAgaWYgZnVuYy50YWJsZV9jb250YWlucyh1aS5nZXQobWVudS52aXN1YWxzVGFiLmluZGljYXRvcnNTdHlsZSksICJCb2R5IGFpbSIpIHRoZW4KICAgICAgICAgICAgaW5kaWNhdG9ycyA9IGluZGljYXRvcnMgKyAxCiAgICAgICAgICAgIGlmIGlzQmEgdGhlbgogICAgICAgICAgICAgICAgYmFJbmQuYSA9IGZ1bmMubGVycChiYUluZC5hLCAyNTUsIHRpbWUpCiAgICAgICAgICAgICAgICBpZiBiYUluZC55IDwgeURlZmF1bHQgKyBpbmRZICogaW5kQ291bnQgdGhlbgogICAgICAgICAgICAgICAgICAgIGJhSW5kLnkgPSBmdW5jLmxlcnAoYmFJbmQueSwgeURlZmF1bHQgKyBpbmRZICogaW5kQ291bnQgKyAxLCB0aW1lKQogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIGJhSW5kLnkgPSB5RGVmYXVsdCArIGluZFkgKiBpbmRDb3VudAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBpbmRDb3VudCA9IGluZENvdW50ICsgMQogICAgICAgICAgICBlbHNlaWYgbm90IGlzQmEgdGhlbiAKICAgICAgICAgICAgICAgIGJhSW5kLmEgPSBmdW5jLmxlcnAoYmFJbmQuYSwgMCwgdGltZSkKICAgICAgICAgICAgICAgIGJhSW5kLnkgPSBmdW5jLmxlcnAoYmFJbmQueSwgeURlZmF1bHQgLSA1LCB0aW1lKQogICAgICAgICAgICBlbmQKICAgICAgICAgICAgcmVuZGVyZXIudGV4dChzaXplWCAvIDIgKyAoKHJlbmRlcmVyLm1lYXN1cmVfdGV4dChnbG9iYWxGbGFnLCBnbG9iYWxGbGFnID09ICJjZC0iIGFuZCAiQkEiIG9yICJiYSIpICsgMikvMikgKiBzY29wZWRGcmFjdGlvbiwgc2l6ZVkgLyAyICsgYmFJbmQueSArIDEzICsgZ2xvYmFsTW92ZVksIDI1NSwgMjU1LCAyNTUsIGJhSW5kLmEsIGdsb2JhbEZsYWcsIDAsIGdsb2JhbEZsYWcgPT0gImNkLSIgYW5kICJCQSIgb3IgImJhIikKICAgICAgICBlbmQKICAgIAogICAgICAgIGlmIGZ1bmMudGFibGVfY29udGFpbnModWkuZ2V0KG1lbnUudmlzdWFsc1RhYi5pbmRpY2F0b3JzU3R5bGUpLCAiRmFrZWR1Y2siKSB0aGVuCiAgICAgICAgICAgIGluZGljYXRvcnMgPSBpbmRpY2F0b3JzICsgMQogICAgICAgICAgICBpZiBpc0ZkIHRoZW4KICAgICAgICAgICAgICAgIGZkSW5kLmEgPSBmdW5jLmxlcnAoZmRJbmQuYSwgMjU1LCB0aW1lKQogICAgICAgICAgICAgICAgaWYgZmRJbmQueSA8IHlEZWZhdWx0ICsgaW5kWSAqIGluZENvdW50IHRoZW4KICAgICAgICAgICAgICAgICAgICBmZEluZC55ID0gZnVuYy5sZXJwKGZkSW5kLnksIHlEZWZhdWx0ICsgaW5kWSAqIGluZENvdW50ICsgMSwgdGltZSkKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICBmZEluZC55ID0geURlZmF1bHQgKyBpbmRZICogaW5kQ291bnQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgaW5kQ291bnQgPSBpbmRDb3VudCArIDEKICAgICAgICAgICAgZWxzZWlmIG5vdCBpc0ZkIHRoZW4gCiAgICAgICAgICAgICAgICBmZEluZC5hID0gZnVuYy5sZXJwKGZkSW5kLmEsIDAsIHRpbWUpCiAgICAgICAgICAgICAgICBmZEluZC55ID0gZnVuYy5sZXJwKGZkSW5kLnksIHlEZWZhdWx0IC0gNSwgdGltZSkKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIHJlbmRlcmVyLnRleHQoc2l6ZVggLyAyICsgKChyZW5kZXJlci5tZWFzdXJlX3RleHQoZ2xvYmFsRmxhZywgZ2xvYmFsRmxhZyA9PSAiY2QtIiBhbmQgIkZEIiBvciAiZmQiKSArIDIpLzIpICogc2NvcGVkRnJhY3Rpb24sIHNpemVZIC8gMiArIGZkSW5kLnkgKyAxMyArIGdsb2JhbE1vdmVZLCAyNTUsIDI1NSwgMjU1LCBmZEluZC5hLCBnbG9iYWxGbGFnLCAwLCBnbG9iYWxGbGFnID09ICJjZC0iIGFuZCAiRkQiIG9yICJmZCIpCiAgICAgICAgZW5kCiAgICBlbmQKCiAgICAtLSBkcmF3IGRtZyBpbmRpY2F0b3IKICAgIGlmIHVpLmdldChtZW51LnZpc3VhbHNUYWIubWluRG1nSW5kaWNhdG9yKSBhbmQgZW50aXR5LmdldF9jbGFzc25hbWUod2VhcG9uKSB+PSAiQ0tuaWZlIiBhbmQgdWkuZ2V0KHJlZnMuZG1nT3ZlcnJpZGVbMV0pIGFuZCB1aS5nZXQocmVmcy5kbWdPdmVycmlkZVsyXSkgdGhlbgogICAgICAgIGxvY2FsIGRtZyA9IHVpLmdldChyZWZzLmRtZ092ZXJyaWRlWzNdKQogICAgICAgIHJlbmRlcmVyLnRleHQoc2l6ZVggLyAyICsgMywgc2l6ZVkgLyAyIC0gMTUsIDI1NSwgMjU1LCAyNTUsIDI1NSwgIiIsIDAsIGRtZykKICAgIGVuZAoKICAgIC0tIGRyYXcgd2F0ZXJtYXJrCiAgICBpZiBpbmRpY2F0b3JzID09IDAgdGhlbgogICAgICAgIGxvY2FsIHdhdGVybWFya1gsIHdhdGVybWFya1kgPSByZW5kZXJlci5tZWFzdXJlX3RleHQoImMiLCAiZGlzY29yZC5nZy9hbnhpZXR5IikKICAgICAgICBnbG93X21vZHVsZShzaXplWCAtIDU4IC0gd2F0ZXJtYXJrWC8yLCAxMCwgd2F0ZXJtYXJrWCAtIDMsIDAsIDEwLCAwLCB7MjU1LCAyNTUsIDI1NSwgMTAwICogbWF0aC5hYnMobWF0aC5jb3MoZ2xvYmFscy5jdXJ0aW1lKCkqMikpfSwgezI1NSwgMjU1LCAyNTUsIDEwMCAqIG1hdGguYWJzKG1hdGguY29zKGdsb2JhbHMuY3VydGltZSgpKjIpKX0pCiAgICAgICAgcmVuZGVyZXIudGV4dChzaXplWCAtIDYwLCAxMCwgIG1haW5DbHIuciwgbWFpbkNsci5nLCBtYWluQ2xyLmIsIDI1NSwgImMiLCAwLCBmdW5jLmhleCh7MjU1LCAyNTUsIDI1NX0pIC4uICJkaXNjb3JkLmdnLyIgLi4gZnVuYy5oZXgoezIxMCwgMTY2LCAyNTV9KSAuLiAiYW54aWV0eSIpCiAgICBlbmQKCiAgICAtLSBkcmF3IGxvZ3MKICAgIGxvY2FsIGNhbGxfYmFjayA9IHVpLmdldChtZW51LnZpc3VhbHNUYWIubG9ncykgYW5kIGNsaWVudC5zZXRfZXZlbnRfY2FsbGJhY2sgb3IgY2xpZW50LnVuc2V0X2V2ZW50X2NhbGxiYWNrCgogICAgbm90aWZpY2F0aW9ucy5yZW5kZXIoKQplbmQpCi0tIEByZWdpb24gSU5ESUNBVE9SUyBlbmQKCi0tIEByZWdpb24gVUlfQ0FMTEJBQ0tTIHN0YXJ0CnVpLnVwZGF0ZShtZW51LmNvbmZpZ1RhYi5saXN0LGdldENvbmZpZ0xpc3QoKSkKaWYgZGF0YWJhc2UucmVhZChsdWEuZGF0YWJhc2UuY29uZmlncykgPT0gbmlsIHRoZW4KICAgIGRhdGFiYXNlLndyaXRlKGx1YS5kYXRhYmFzZS5jb25maWdzLCB7fSkKZW5kCnVpLnNldChtZW51LmNvbmZpZ1RhYi5uYW1lLCAjZGF0YWJhc2UucmVhZChsdWEuZGF0YWJhc2UuY29uZmlncykgPT0gMCBhbmQgIiIgb3IgZGF0YWJhc2UucmVhZChsdWEuZGF0YWJhc2UuY29uZmlncylbdWkuZ2V0KG1lbnUuY29uZmlnVGFiLmxpc3QpKzFdLm5hbWUpCnVpLnNldF9jYWxsYmFjayhtZW51LmNvbmZpZ1RhYi5saXN0LCBmdW5jdGlvbih2YWx1ZSkKICAgIGxvY2FsIHByb3RlY3RlZCA9IGZ1bmN0aW9uKCkKICAgICAgICBpZiB2YWx1ZSA9PSBuaWwgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgbG9jYWwgbmFtZSA9ICIiCiAgICAKICAgICAgICBsb2NhbCBjb25maWdzID0gZ2V0Q29uZmlnTGlzdCgpCiAgICAgICAgaWYgY29uZmlncyA9PSBuaWwgdGhlbiByZXR1cm4gZW5kCiAgICAKICAgICAgICBuYW1lID0gY29uZmlnc1t1aS5nZXQodmFsdWUpKzFdIG9yICIiCiAgICAKICAgICAgICB1aS5zZXQobWVudS5jb25maWdUYWIubmFtZSwgbmFtZSkKICAgIGVuZAoKICAgIGlmIHBjYWxsKHByb3RlY3RlZCkgdGhlbgoKICAgIGVuZAplbmQpCgp1aS5zZXRfY2FsbGJhY2sobWVudS5jb25maWdUYWIubG9hZCwgZnVuY3Rpb24oKQogICAgbG9jYWwgciwgZywgYiA9IHVpLmdldChtZW51LnZpc3VhbHNUYWIubG9nc0NscikKICAgIGxvY2FsIG5hbWUgPSB1aS5nZXQobWVudS5jb25maWdUYWIubmFtZSkKICAgIGlmIG5hbWUgPT0gIiIgdGhlbiByZXR1cm4gZW5kCiAgICBsb2NhbCBwcm90ZWN0ZWQgPSBmdW5jdGlvbigpCiAgICAgICAgbG9hZENvbmZpZyhuYW1lKQogICAgZW5kCgogICAgaWYgcGNhbGwocHJvdGVjdGVkKSB0aGVuCiAgICAgICAgbmFtZSA9IG5hbWU6Z3N1YignKicsICcnKQogICAgICAgIG5vdGlmaWNhdGlvbnMubmV3KHN0cmluZy5mb3JtYXQoJ1N1Y2Nlc3NmdWxseSBsb2FkZWQgIiQlcyQiJywgbmFtZSksIHIsIGcsIGIpCiAgICBlbHNlCiAgICAgICAgbm90aWZpY2F0aW9ucy5uZXcoc3RyaW5nLmZvcm1hdCgnRmFpbGVkIHRvIGxvYWQgIiQlcyQiJywgbmFtZSksIDI1NSwgMTIwLCAxMjApCiAgICBlbmQKZW5kKQoKdWkuc2V0X2NhbGxiYWNrKG1lbnUuY29uZmlnVGFiLnNhdmUsIGZ1bmN0aW9uKCkKICAgIGxvY2FsIHIsIGcsIGIgPSB1aS5nZXQobWVudS52aXN1YWxzVGFiLmxvZ3NDbHIpCgogICAgICAgIGxvY2FsIG5hbWUgPSB1aS5nZXQobWVudS5jb25maWdUYWIubmFtZSkKICAgICAgICBpZiBuYW1lID09ICIiIHRoZW4gcmV0dXJuIGVuZAogICAgCiAgICAgICAgZm9yIGksIHYgaW4gcGFpcnMocHJlc2V0cykgZG8KICAgICAgICAgICAgaWYgdi5uYW1lID09IG5hbWU6Z3N1YignKicsICcnKSB0aGVuCiAgICAgICAgICAgICAgICBub3RpZmljYXRpb25zLm5ldyhzdHJpbmcuZm9ybWF0KCdZb3UgY2FuYHQgc2F2ZSBidWlsdC1pbiBwcmVzZXQgIiQlcyQiJywgbmFtZTpnc3ViKCcqJywgJycpKSwgMjU1LCAxMjAsIDEyMCkKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKCiAgICAgICAgaWYgbmFtZTptYXRjaCgiW14ld10iKSB+PSBuaWwgdGhlbgogICAgICAgICAgICBub3RpZmljYXRpb25zLm5ldyhzdHJpbmcuZm9ybWF0KCdGYWlsZWQgdG8gc2F2ZSAiJCVzJCIgZHVlIHRvIGludmFsaWQgY2hhcmFjdGVycycsIG5hbWUpLCAyNTUsIDEyMCwgMTIwKQogICAgICAgICAgICByZXR1cm4KICAgICAgICBlbmQKICAgIGxvY2FsIHByb3RlY3RlZCA9IGZ1bmN0aW9uKCkKICAgICAgICBzYXZlQ29uZmlnKG5hbWUpCiAgICAgICAgdWkudXBkYXRlKG1lbnUuY29uZmlnVGFiLmxpc3QsIGdldENvbmZpZ0xpc3QoKSkKICAgIGVuZAogICAgaWYgcGNhbGwocHJvdGVjdGVkKSB0aGVuCiAgICAgICAgbm90aWZpY2F0aW9ucy5uZXcoc3RyaW5nLmZvcm1hdCgnU3VjY2Vzc2Z1bGx5IHNhdmVkICIkJXMkIicsIG5hbWUpLCByLCBnLCBiKQogICAgZW5kCmVuZCkKCnVpLnNldF9jYWxsYmFjayhtZW51LmNvbmZpZ1RhYi5kZWxldGUsIGZ1bmN0aW9uKCkKICAgIGxvY2FsIG5hbWUgPSB1aS5nZXQobWVudS5jb25maWdUYWIubmFtZSkKICAgIGlmIG5hbWUgPT0gIiIgdGhlbiByZXR1cm4gZW5kCiAgICBsb2NhbCByLCBnLCBiID0gdWkuZ2V0KG1lbnUudmlzdWFsc1RhYi5sb2dzQ2xyKQogICAgaWYgZGVsZXRlQ29uZmlnKG5hbWUpID09IGZhbHNlIHRoZW4KICAgICAgICBub3RpZmljYXRpb25zLm5ldyhzdHJpbmcuZm9ybWF0KCdGYWlsZWQgdG8gZGVsZXRlICIkJXMkIicsIG5hbWUpLCAyNTUsIDEyMCwgMTIwKQogICAgICAgIHVpLnVwZGF0ZShtZW51LmNvbmZpZ1RhYi5saXN0LCBnZXRDb25maWdMaXN0KCkpCiAgICAgICAgcmV0dXJuCiAgICBlbmQKCiAgICBmb3IgaSwgdiBpbiBwYWlycyhwcmVzZXRzKSBkbwogICAgICAgIGlmIHYubmFtZSA9PSBuYW1lOmdzdWIoJyonLCAnJykgdGhlbgogICAgICAgICAgICBub3RpZmljYXRpb25zLm5ldyhzdHJpbmcuZm9ybWF0KCdZb3UgY2FuYHQgZGVsZXRlIGJ1aWx0LWluIHByZXNldCAiJCVzJCInLCBuYW1lOmdzdWIoJyonLCAnJykpLCAyNTUsIDEyMCwgMTIwKQogICAgICAgICAgICByZXR1cm4KICAgICAgICBlbmQKICAgIGVuZAoKICAgIGxvY2FsIHByb3RlY3RlZCA9IGZ1bmN0aW9uKCkKICAgICAgICBkZWxldGVDb25maWcobmFtZSkKICAgIGVuZAoKICAgIGlmIHBjYWxsKHByb3RlY3RlZCkgdGhlbgogICAgICAgIHVpLnVwZGF0ZShtZW51LmNvbmZpZ1RhYi5saXN0LCBnZXRDb25maWdMaXN0KCkpCiAgICAgICAgdWkuc2V0KG1lbnUuY29uZmlnVGFiLmxpc3QsICNwcmVzZXRzICsgI2RhdGFiYXNlLnJlYWQobHVhLmRhdGFiYXNlLmNvbmZpZ3MpIC0gI2RhdGFiYXNlLnJlYWQobHVhLmRhdGFiYXNlLmNvbmZpZ3MpKQogICAgICAgIHVpLnNldChtZW51LmNvbmZpZ1RhYi5uYW1lLCAjZGF0YWJhc2UucmVhZChsdWEuZGF0YWJhc2UuY29uZmlncykgPT0gMCBhbmQgIiIgb3IgZ2V0Q29uZmlnTGlzdCgpWyNwcmVzZXRzICsgI2RhdGFiYXNlLnJlYWQobHVhLmRhdGFiYXNlLmNvbmZpZ3MpIC0gI2RhdGFiYXNlLnJlYWQobHVhLmRhdGFiYXNlLmNvbmZpZ3MpKzFdKQogICAgICAgIG5vdGlmaWNhdGlvbnMubmV3KHN0cmluZy5mb3JtYXQoJ1N1Y2Nlc3NmdWxseSBkZWxldGVkICIkJXMkIicsIG5hbWUpLCByLCBnLCBiKQogICAgZW5kCmVuZCkKCnVpLnNldF9jYWxsYmFjayhtZW51LmNvbmZpZ1RhYi5pbXBvcnQsIGZ1bmN0aW9uKCkKICAgIGxvY2FsIHIsIGcsIGIgPSB1aS5nZXQobWVudS52aXN1YWxzVGFiLmxvZ3NDbHIpCgogICAgbG9jYWwgcHJvdGVjdGVkID0gZnVuY3Rpb24oKQogICAgICAgIGltcG9ydFNldHRpbmdzKCkKICAgIGVuZAoKICAgIGlmIHBjYWxsKHByb3RlY3RlZCkgdGhlbgogICAgICAgIG5vdGlmaWNhdGlvbnMubmV3KHN0cmluZy5mb3JtYXQoJ1N1Y2Nlc3NmdWxseSBpbXBvcnRlZCBzZXR0aW5ncycsIG5hbWUpLCByLCBnLCBiKQogICAgZWxzZQogICAgICAgIG5vdGlmaWNhdGlvbnMubmV3KHN0cmluZy5mb3JtYXQoJ0ZhaWxlZCB0byBpbXBvcnQgc2V0dGluZ3MnLCBuYW1lKSwgMjU1LCAxMjAsIDEyMCkKICAgIGVuZAplbmQpCgp1aS5zZXRfY2FsbGJhY2sobWVudS5jb25maWdUYWIuZXhwb3J0LCBmdW5jdGlvbigpCiAgICBsb2NhbCBuYW1lID0gdWkuZ2V0KG1lbnUuY29uZmlnVGFiLm5hbWUpCiAgICBpZiBuYW1lID09ICIiIHRoZW4gcmV0dXJuIGVuZAoKICAgIGxvY2FsIHByb3RlY3RlZCA9IGZ1bmN0aW9uKCkKICAgICAgICBleHBvcnRTZXR0aW5ncyhuYW1lKQogICAgZW5kCiAgICBsb2NhbCByLCBnLCBiID0gdWkuZ2V0KG1lbnUudmlzdWFsc1RhYi5sb2dzQ2xyKQogICAgaWYgcGNhbGwocHJvdGVjdGVkKSB0aGVuCiAgICAgICAgbm90aWZpY2F0aW9ucy5uZXcoc3RyaW5nLmZvcm1hdCgnU3VjY2Vzc2Z1bGx5IGV4cG9ydGVkIHNldHRpbmdzJywgbmFtZSksIHIsIGcsIGIpCiAgICBlbHNlCiAgICAgICAgbm90aWZpY2F0aW9ucy5uZXcoc3RyaW5nLmZvcm1hdCgnRmFpbGVkIHRvIGV4cG9ydCBzZXR0aW5ncycsIG5hbWUpLCAyNTUsIDEyMCwgMTIwKQogICAgZW5kCmVuZCkKLS0gQHJlZ2lvbiBVSV9DQUxMQkFDS1MgZW5kCgotLSBAcmVnaW9uIFVJX1JFTkRFUiBzdGFydApjbGllbnQuc2V0X2V2ZW50X2NhbGxiYWNrKCJwYWludF91aSIsIGZ1bmN0aW9uKCkKICAgIHZhcnMuYWN0aXZlU3RhdGUgPSB2YXJzLnNUb0ludFt1aS5nZXQobWVudS5idWlsZGVyVGFiLnN0YXRlKV0KICAgIGxvY2FsIGlzRW5hYmxlZCA9IHRydWUKICAgIGxvY2FsIGlzQUFUYWIgPSB1aS5nZXQodGFiUGlja2VyKSA9PSAiQW50aS1haW0iIAogICAgbG9jYWwgaXNCdWlsZGVyVGFiID0gdWkuZ2V0KHRhYlBpY2tlcikgPT0gIkJ1aWxkZXIiIAogICAgbG9jYWwgaXNWaXN1YWxzVGFiID0gdWkuZ2V0KHRhYlBpY2tlcikgPT0gIlZpc3VhbHMiIAogICAgbG9jYWwgaXNNaXNjVGFiID0gdWkuZ2V0KHRhYlBpY2tlcikgPT0gIk1pc2MiIAogICAgbG9jYWwgaXNDRkdUYWIgPSB1aS5nZXQodGFiUGlja2VyKSA9PSAiQ29uZmlnIiAKCiAgICBsb2NhbCBhQSA9IGZ1bmMuY3JlYXRlX2NvbG9yX2FycmF5KGx1YV9jb2xvci5yLCBsdWFfY29sb3IuZywgbHVhX2NvbG9yLmIsICLDosWTwqggYW54aWV0eSIpCiAgICB1aS5zZXQobGFiZWwsIHN0cmluZy5mb3JtYXQoIsOixZPCqCBcYSVzQSBcYSVzTiBcYSVzWCBcYSVzSSBcYSVzRSBcYSVzVCBcYSVzWSBcYSVzIFtERVZdIiwgZnVuYy5SR0JBdG9IRVgodW5wYWNrKGFBWzFdKSksIGZ1bmMuUkdCQXRvSEVYKHVucGFjayhhQVsyXSkpLCBmdW5jLlJHQkF0b0hFWCh1bnBhY2soYUFbM10pKSwgZnVuYy5SR0JBdG9IRVgodW5wYWNrKGFBWzRdKSksIGZ1bmMuUkdCQXRvSEVYKHVucGFjayhhQVs1XSkpLCBmdW5jLlJHQkF0b0hFWCh1bnBhY2soYUFbNl0pKSwgIGZ1bmMuUkdCQXRvSEVYKHVucGFjayhhQVs3XSkpLCAgZnVuYy5SR0JBdG9IRVgodW5wYWNrKGFBWzhdKSkgKSApCiAgICB1aS5zZXQoYWFCdWlsZGVyWzFdLmVuYWJsZVN0YXRlLCB0cnVlKQogICAgZm9yIGkgPSAxLCAjdmFycy5hYVN0YXRlcyBkbwogICAgICAgIGxvY2FsIHN0YXRlRW5hYmxlZCA9IHVpLmdldChhYUJ1aWxkZXJbaV0uZW5hYmxlU3RhdGUpCiAgICAgICAgdWkuc2V0X3Zpc2libGUoYWFCdWlsZGVyW2ldLmVuYWJsZVN0YXRlLCB2YXJzLmFjdGl2ZVN0YXRlID09IGkgYW5kIGl+PTEgYW5kIGlzQnVpbGRlclRhYiBhbmQgaXNFbmFibGVkKQogICAgICAgIHVpLnNldF92aXNpYmxlKGFhQnVpbGRlcltpXS5mb3JjZURlZmVuc2l2ZSwgdmFycy5hY3RpdmVTdGF0ZSA9PSBpIGFuZCBpc0J1aWxkZXJUYWIgYW5kIHN0YXRlRW5hYmxlZCBhbmQgaXNFbmFibGVkKQogICAgICAgIHVpLnNldF92aXNpYmxlKGFhQnVpbGRlcltpXS5waXRjaCwgdmFycy5hY3RpdmVTdGF0ZSA9PSBpIGFuZCBpc0J1aWxkZXJUYWIgYW5kIHN0YXRlRW5hYmxlZCBhbmQgaXNFbmFibGVkKQogICAgICAgIHVpLnNldF92aXNpYmxlKGFhQnVpbGRlcltpXS5waXRjaFNsaWRlciAsIHZhcnMuYWN0aXZlU3RhdGUgPT0gaSBhbmQgaXNCdWlsZGVyVGFiIGFuZCBzdGF0ZUVuYWJsZWQgYW5kIHVpLmdldChhYUJ1aWxkZXJbaV0ucGl0Y2gpID09ICJDdXN0b20iIGFuZCBpc0VuYWJsZWQpCiAgICAgICAgdWkuc2V0X3Zpc2libGUoYWFCdWlsZGVyW2ldLnlhd0Jhc2UsIHZhcnMuYWN0aXZlU3RhdGUgPT0gaSBhbmQgaXNCdWlsZGVyVGFiIGFuZCBzdGF0ZUVuYWJsZWQgYW5kIGlzRW5hYmxlZCkKICAgICAgICB1aS5zZXRfdmlzaWJsZShhYUJ1aWxkZXJbaV0ueWF3LCB2YXJzLmFjdGl2ZVN0YXRlID09IGkgYW5kIGlzQnVpbGRlclRhYiBhbmQgc3RhdGVFbmFibGVkIGFuZCBpc0VuYWJsZWQpCiAgICAgICAgdWkuc2V0X3Zpc2libGUoYWFCdWlsZGVyW2ldLnlhd1N0YXRpYywgdmFycy5hY3RpdmVTdGF0ZSA9PSBpIGFuZCB1aS5nZXQoYWFCdWlsZGVyW2ldLnlhdykgfj0gIk9mZiIgYW5kIHVpLmdldChhYUJ1aWxkZXJbaV0ueWF3KSB+PSAiU2xvdyBZYXciIGFuZCB1aS5nZXQoYWFCdWlsZGVyW2ldLnlhdykgfj0gIkwmUiIgYW5kIGlzQnVpbGRlclRhYiBhbmQgc3RhdGVFbmFibGVkIGFuZCBpc0VuYWJsZWQpCiAgICAgICAgdWkuc2V0X3Zpc2libGUoYWFCdWlsZGVyW2ldLnlhd0xlZnQsIHZhcnMuYWN0aXZlU3RhdGUgPT0gaSBhbmQgdWkuZ2V0KGFhQnVpbGRlcltpXS55YXcpIH49ICJPZmYiIGFuZCAodWkuZ2V0KGFhQnVpbGRlcltpXS55YXcpID09ICJTbG93IFlhdyIgb3IgdWkuZ2V0KGFhQnVpbGRlcltpXS55YXcpID09ICJMJlIiKSBhbmQgaXNCdWlsZGVyVGFiIGFuZCBzdGF0ZUVuYWJsZWQgYW5kIGlzRW5hYmxlZCkKICAgICAgICB1aS5zZXRfdmlzaWJsZShhYUJ1aWxkZXJbaV0ueWF3UmlnaHQsIHZhcnMuYWN0aXZlU3RhdGUgPT0gaSBhbmQgdWkuZ2V0KGFhQnVpbGRlcltpXS55YXcpIH49ICJPZmYiIGFuZCAodWkuZ2V0KGFhQnVpbGRlcltpXS55YXcpID09ICJTbG93IFlhdyIgb3IgdWkuZ2V0KGFhQnVpbGRlcltpXS55YXcpID09ICJMJlIiKSBhbmQgaXNCdWlsZGVyVGFiIGFuZCBzdGF0ZUVuYWJsZWQgYW5kIGlzRW5hYmxlZCkKICAgICAgICB1aS5zZXRfdmlzaWJsZShhYUJ1aWxkZXJbaV0ueWF3Sml0dGVyLCB2YXJzLmFjdGl2ZVN0YXRlID09IGkgYW5kIHVpLmdldChhYUJ1aWxkZXJbaV0ueWF3KSB+PSAiT2ZmIiBhbmQgaXNCdWlsZGVyVGFiIGFuZCBzdGF0ZUVuYWJsZWQgYW5kIGlzRW5hYmxlZCkKICAgICAgICB1aS5zZXRfdmlzaWJsZShhYUJ1aWxkZXJbaV0ud2F5Rmlyc3QsIHZhcnMuYWN0aXZlU3RhdGUgPT0gaSBhbmQgdWkuZ2V0KGFhQnVpbGRlcltpXS55YXcpIH49ICJPZmYiIGFuZCB1aS5nZXQoYWFCdWlsZGVyW2ldLnlhd0ppdHRlcikgPT0gIjMtV2F5IiAgYW5kIGlzQnVpbGRlclRhYiBhbmQgc3RhdGVFbmFibGVkIGFuZCBpc0VuYWJsZWQpCiAgICAgICAgdWkuc2V0X3Zpc2libGUoYWFCdWlsZGVyW2ldLndheVNlY29uZCwgdmFycy5hY3RpdmVTdGF0ZSA9PSBpIGFuZCB1aS5nZXQoYWFCdWlsZGVyW2ldLnlhdykgfj0gIk9mZiIgYW5kIHVpLmdldChhYUJ1aWxkZXJbaV0ueWF3Sml0dGVyKSA9PSAiMy1XYXkiICBhbmQgaXNCdWlsZGVyVGFiIGFuZCBzdGF0ZUVuYWJsZWQgYW5kIGlzRW5hYmxlZCkKICAgICAgICB1aS5zZXRfdmlzaWJsZShhYUJ1aWxkZXJbaV0ud2F5VGhpcmQsIHZhcnMuYWN0aXZlU3RhdGUgPT0gaSBhbmQgdWkuZ2V0KGFhQnVpbGRlcltpXS55YXcpIH49ICJPZmYiIGFuZCB1aS5nZXQoYWFCdWlsZGVyW2ldLnlhd0ppdHRlcikgPT0gIjMtV2F5IiAgYW5kIGlzQnVpbGRlclRhYiBhbmQgc3RhdGVFbmFibGVkIGFuZCBpc0VuYWJsZWQpCiAgICAgICAgdWkuc2V0X3Zpc2libGUoYWFCdWlsZGVyW2ldLnlhd0ppdHRlclN0YXRpYywgdmFycy5hY3RpdmVTdGF0ZSA9PSBpIGFuZCB1aS5nZXQoYWFCdWlsZGVyW2ldLnlhdykgfj0gIk9mZiIgYW5kIHVpLmdldChhYUJ1aWxkZXJbaV0ueWF3Sml0dGVyKSB+PSAiT2ZmIiBhbmQgdWkuZ2V0KGFhQnVpbGRlcltpXS55YXdKaXR0ZXIpIH49ICJMJlIiIGFuZCB1aS5nZXQoYWFCdWlsZGVyW2ldLnlhd0ppdHRlcikgfj0gIjMtV2F5IiBhbmQgaXNCdWlsZGVyVGFiIGFuZCBzdGF0ZUVuYWJsZWQgYW5kIGlzRW5hYmxlZCkKICAgICAgICB1aS5zZXRfdmlzaWJsZShhYUJ1aWxkZXJbaV0ueWF3Sml0dGVyTGVmdCwgdmFycy5hY3RpdmVTdGF0ZSA9PSBpIGFuZCB1aS5nZXQoYWFCdWlsZGVyW2ldLnlhdykgfj0gIk9mZiIgYW5kIHVpLmdldChhYUJ1aWxkZXJbaV0ueWF3Sml0dGVyKSA9PSAiTCZSIiBhbmQgaXNCdWlsZGVyVGFiIGFuZCBzdGF0ZUVuYWJsZWQgYW5kIGlzRW5hYmxlZCkKICAgICAgICB1aS5zZXRfdmlzaWJsZShhYUJ1aWxkZXJbaV0ueWF3Sml0dGVyUmlnaHQsIHZhcnMuYWN0aXZlU3RhdGUgPT0gaSBhbmQgdWkuZ2V0KGFhQnVpbGRlcltpXS55YXcpIH49ICJPZmYiIGFuZCB1aS5nZXQoYWFCdWlsZGVyW2ldLnlhd0ppdHRlcikgPT0gIkwmUiIgYW5kIGlzQnVpbGRlclRhYiBhbmQgc3RhdGVFbmFibGVkIGFuZCBpc0VuYWJsZWQpCiAgICAgICAgdWkuc2V0X3Zpc2libGUoYWFCdWlsZGVyW2ldLmJvZHlZYXcsIHZhcnMuYWN0aXZlU3RhdGUgPT0gaSBhbmQgaXNCdWlsZGVyVGFiIGFuZCBzdGF0ZUVuYWJsZWQgYW5kIGlzRW5hYmxlZCkKICAgICAgICB1aS5zZXRfdmlzaWJsZShhYUJ1aWxkZXJbaV0uYm9keVlhd1N0YXRpYywgdmFycy5hY3RpdmVTdGF0ZSA9PSBpIGFuZCB1aS5nZXQoYWFCdWlsZGVyW2ldLmJvZHlZYXcpIH49ICJPZmYiIGFuZCB1aS5nZXQoYWFCdWlsZGVyW2ldLmJvZHlZYXcpIH49ICJPcHBvc2l0ZSIgYW5kIGlzQnVpbGRlclRhYiBhbmQgc3RhdGVFbmFibGVkIGFuZCBpc0VuYWJsZWQpCiAgICBlbmQKCiAgICBmb3IgaSwgZmVhdHVyZSBpbiBwYWlycyhtZW51LmFhVGFiKSBkbwogICAgICAgIGlmIHR5cGUoZmVhdHVyZSkgfj0gInRhYmxlIiB0aGVuCiAgICAgICAgICAgIHVpLnNldF92aXNpYmxlKGZlYXR1cmUsIGlzQUFUYWIgYW5kIGlzRW5hYmxlZCkKICAgICAgICBlbmQKCWVuZCAKCiAgICBmb3IgaSwgZmVhdHVyZSBpbiBwYWlycyhtZW51LmFhVGFiLm1hbnVhbFRhYikgZG8KICAgICAgICBpZiB0eXBlKGZlYXR1cmUpIH49ICJ0YWJsZSIgdGhlbgogICAgICAgICAgICB1aS5zZXRfdmlzaWJsZShmZWF0dXJlLCBpc0FBVGFiIGFuZCBpc0VuYWJsZWQgYW5kIHVpLmdldChtZW51LmFhVGFiLm1hbnVhbHMpIH49ICJPZmYiKQogICAgICAgIGVuZAoJZW5kIAoKICAgIGZvciBpLCBmZWF0dXJlIGluIHBhaXJzKG1lbnUuYnVpbGRlclRhYikgZG8KCQl1aS5zZXRfdmlzaWJsZShmZWF0dXJlLCBpc0J1aWxkZXJUYWIgYW5kIGlzRW5hYmxlZCkKCWVuZAoKICAgIGZvciBpLCBmZWF0dXJlIGluIHBhaXJzKG1lbnUudmlzdWFsc1RhYikgZG8KICAgICAgICBpZiB0eXBlKGZlYXR1cmUpIH49ICJ0YWJsZSIgdGhlbgogICAgICAgICAgICB1aS5zZXRfdmlzaWJsZShmZWF0dXJlLCBpc1Zpc3VhbHNUYWIgYW5kIGlzRW5hYmxlZCkKICAgICAgICBlbmQKCWVuZCAKICAgIHVpLnNldF92aXNpYmxlKG1lbnUudmlzdWFsc1RhYi5sb2dPZmZzZXQsIHVpLmdldChtZW51LnZpc3VhbHNUYWIubG9ncykgYW5kIGlzVmlzdWFsc1RhYiBhbmQgaXNFbmFibGVkKQogICAgdWkuc2V0X3Zpc2libGUobWVudS52aXN1YWxzVGFiLmxvZ3NDbHIsIHVpLmdldChtZW51LnZpc3VhbHNUYWIubG9ncykgYW5kIGlzVmlzdWFsc1RhYiBhbmQgaXNFbmFibGVkKQogICAgdWkuc2V0X3Zpc2libGUobWVudS52aXN1YWxzVGFiLmluZGljYXRvcnNTdHlsZSwgdWkuZ2V0KG1lbnUudmlzdWFsc1RhYi5pbmRpY2F0b3JzVHlwZSkgfj0gIi0iIGFuZCB1aS5nZXQobWVudS52aXN1YWxzVGFiLmluZGljYXRvcnMpIGFuZCBpc1Zpc3VhbHNUYWIgYW5kIGlzRW5hYmxlZCkKICAgIHVpLnNldF92aXNpYmxlKG1lbnUudmlzdWFsc1RhYi5pbmRpY2F0b3JzQ2xyLCB1aS5nZXQobWVudS52aXN1YWxzVGFiLmluZGljYXRvcnMpIGFuZCBpc1Zpc3VhbHNUYWIgYW5kIGlzRW5hYmxlZCkKICAgIHVpLnNldF92aXNpYmxlKG1lbnUudmlzdWFsc1RhYi5pbmRpY2F0b3JzVHlwZSwgdWkuZ2V0KG1lbnUudmlzdWFsc1RhYi5pbmRpY2F0b3JzKSBhbmQgaXNWaXN1YWxzVGFiIGFuZCBpc0VuYWJsZWQpCiAgICB1aS5zZXRfdmlzaWJsZShtZW51LnZpc3VhbHNUYWIuYXJyb3dJbmRpY2F0b3JTdHlsZSwgdWkuZ2V0KG1lbnUudmlzdWFsc1RhYi5hcnJvd3MpIGFuZCBpc1Zpc3VhbHNUYWIgYW5kIGlzRW5hYmxlZCkKICAgIHVpLnNldF92aXNpYmxlKG1lbnUudmlzdWFsc1RhYi5hcnJvd0NsciwgdWkuZ2V0KG1lbnUudmlzdWFsc1RhYi5hcnJvd3MpIGFuZCBpc1Zpc3VhbHNUYWIgYW5kIGlzRW5hYmxlZCkKICAgIHVpLnNldF92aXNpYmxlKG1lbnUudmlzdWFsc1RhYi53YXRlcm1hcmtDbHIsIHVpLmdldChtZW51LnZpc3VhbHNUYWIud2F0ZXJtYXJrKSBhbmQgaXNWaXN1YWxzVGFiIGFuZCBpc0VuYWJsZWQpCiAgICAKICAgIGZvciBpLCBmZWF0dXJlIGluIHBhaXJzKG1lbnUubWlzY1RhYikgZG8KICAgICAgICBpZiB0eXBlKGZlYXR1cmUpIH49ICJ0YWJsZSIgdGhlbgogICAgICAgICAgICB1aS5zZXRfdmlzaWJsZShmZWF0dXJlLCBpc01pc2NUYWIgYW5kIGlzRW5hYmxlZCkKICAgICAgICBlbmQKCWVuZAogICAgdWkuc2V0X3Zpc2libGUobWVudS5taXNjVGFiLmZhc3RMYWRkZXIsIHVpLmdldChtZW51Lm1pc2NUYWIuZmFzdExhZGRlckVuYWJsZWQpIGFuZCBpc01pc2NUYWIgYW5kIGlzRW5hYmxlZCkKICAgIHVpLnNldF92aXNpYmxlKG1lbnUubWlzY1RhYi5hbmltYXRpb25zLCB1aS5nZXQobWVudS5taXNjVGFiLmFuaW1hdGlvbnNFbmFibGVkKSBhbmQgaXNNaXNjVGFiIGFuZCBpc0VuYWJsZWQpCgogICAgZm9yIGksIGZlYXR1cmUgaW4gcGFpcnMobWVudS5jb25maWdUYWIpIGRvCgkJdWkuc2V0X3Zpc2libGUoZmVhdHVyZSwgaXNDRkdUYWIgYW5kIGlzRW5hYmxlZCkKCWVuZAoKICAgIGlmIG5vdCBpc0VuYWJsZWQgYW5kIG5vdCBzYXZlZCB0aGVuCiAgICAgICAgZnVuYy5yZXNldEFBVGFiKCkKICAgICAgICB1aS5zZXQocmVmcy5mc0JvZHlZYXcsIGlzRW5hYmxlZCkKICAgICAgICB1aS5zZXQocmVmcy5lbmFibGVkLCBpc0VuYWJsZWQpCiAgICAgICAgc2F2ZWQgPSB0cnVlCiAgICBlbHNlaWYgaXNFbmFibGVkIGFuZCBzYXZlZCB0aGVuCiAgICAgICAgdWkuc2V0KHJlZnMuZnNCb2R5WWF3LCBub3QgaXNFbmFibGVkKQogICAgICAgIHVpLnNldChyZWZzLmVuYWJsZWQsIGlzRW5hYmxlZCkKICAgICAgICBzYXZlZCA9IGZhbHNlCiAgICBlbmQKICAgIGZ1bmMuc2V0QUFUYWIobm90IGlzRW5hYmxlZCkKCmVuZCkKLS0gQHJlZ2lvbiBVSV9SRU5ERVIgZW5kCgpjbGllbnQuc2V0X2V2ZW50X2NhbGxiYWNrKCJzaHV0ZG93biIsIGZ1bmN0aW9uKCkKICAgIGlmIGxlZ3NTYXZlZCB+PSBmYWxzZSB0aGVuCiAgICAgICAgdWkuc2V0KHJlZnMubGVnTW92ZW1lbnQsIGxlZ3NTYXZlZCkKICAgIGVuZAogICAgaWYgaHNWYWx1ZSB+PSBuaWwgdGhlbgogICAgICAgIHVpLnNldChyZWZzLmZha2VMYWdbMV0sIGhzVmFsdWUpCiAgICBlbmQKICAgIGlmIGNsYW5UYWcgfj0gbmlsIHRoZW4KICAgICAgICBjbGllbnQuc2V0X2NsYW5fdGFnKCIiKQogICAgZW5kCiAgICBpZiBkdFNhdmVkIH49IG5pbCB0aGVuCiAgICAgICAgdWkuc2V0KHJlZnMuZHRbM10sICJEZWZlbnNpdmUiKQogICAgZW5kCiAgICBmdW5jLnNldEFBVGFiKHRydWUpCmVuZCk="}