{"status":200,"content":"bG9jYWwgdmVjdG9yID0gcmVxdWlyZSgidmVjdG9yIikKbG9jYWwgY2xpcGJvYXJkID0gcmVxdWlyZSgiZ2FtZXNlbnNlL2NsaXBib2FyZCIpCmxvY2FsIHNsb3csIGtleSA9IHVpLnJlZmVyZW5jZSgiYWEiLCAib3RoZXIiLCAic2xvdyBtb3Rpb24iKQpsb2NhbCBsaW1pdGZsID0gdWkucmVmZXJlbmNlKCJhYSIsICJmYWtlIGxhZyIsICJsaW1pdCIpCnJldHVybiAoZnVuY3Rpb24oeikKICAgIHouaXRlbXMgPSB7CiAgICAgICAgYWEgPSB7CiAgICAgICAgICAgIGVuYWJsZWQgPSB6LnJlZigiYWEiLCAiYW50aS1haW1ib3QgYW5nbGVzIiwgImVuYWJsZWQiKSwKICAgICAgICAgICAgcGl0Y2ggPSB6LnJlZigiYWEiLCAiYW50aS1haW1ib3QgYW5nbGVzIiwgInBpdGNoIiksCiAgICAgICAgICAgIGJhc2UgPSB6LnJlZigiYWEiLCAiYW50aS1haW1ib3QgYW5nbGVzIiwgInlhdyBiYXNlIiksCiAgICAgICAgICAgIGppdHRlciA9IHoucmVmKCJhYSIsICJhbnRpLWFpbWJvdCBhbmdsZXMiLCAieWF3IGppdHRlciIpLAogICAgICAgICAgICB5YXcgPSB6LnJlZigiYWEiLCAiYW50aS1haW1ib3QgYW5nbGVzIiwgInlhdyIpLAogICAgICAgICAgICBib2R5ID0gei5yZWYoImFhIiwgImFudGktYWltYm90IGFuZ2xlcyIsICJib2R5IHlhdyIpLAogICAgICAgICAgICBmc2JvZHkgPSB6LnJlZigiYWEiLCAiYW50aS1haW1ib3QgYW5nbGVzIiwgImZyZWVzdGFuZGluZyBib2R5IHlhdyIpLAogICAgICAgICAgICBlZGdlID0gei5yZWYoImFhIiwgImFudGktYWltYm90IGFuZ2xlcyIsICJlZGdlIHlhdyIpLAogICAgICAgICAgICByb2xsID0gei5yZWYoImFhIiwgImFudGktYWltYm90IGFuZ2xlcyIsICJyb2xsIiksCiAgICAgICAgICAgIGZzID0gei5yZWYoImFhIiwgImFudGktYWltYm90IGFuZ2xlcyIsICJmcmVlc3RhbmRpbmciKQogICAgICAgIH0sCgkJCQkJa2V5cyA9IHsgCgkJCQkJCWR0ID0gei5yZWYoInJhZ2UiLCAiYWltYm90IiwgImRvdWJsZSB0YXAiKSwKCQkJCQkJbW9kZSA9IHNlbGVjdCgyLCB1aS5yZWZlcmVuY2UoIlJBR0UiLCAiQWltYm90IiwgIkRvdWJsZSB0YXAiKSksCgkJCQkJCWhzID0gei5yZWYoImFhIiwgIm90aGVyIiwgIm9uIHNob3QgYW50aS1haW0iKSwKCQkJCQkJZmQgPSB6LnJlZigicmFnZSIsICJvdGhlciIsICJkdWNrIHBlZWsgYXNzaXN0IiksCgkJCQkJCXNwID0gei5yZWYoInJhZ2UiLCAiYWltYm90IiwgImZvcmNlIHNhZmUgcG9pbnQiKSwKCQkJCQkJZmIgPSB6LnJlZigicmFnZSIsICJhaW1ib3QiLCAiZm9yY2UgYm9keSBhaW0iKQoJCQkJCX0KICAgIH0KICAgIHouaGV4ID0gZnVuY3Rpb24oYXJnKQogICAgICAgIGxvY2FsIHJlc3VsdCA9ICJcYSIKICAgICAgICBmb3Iga2V5LCB2YWx1ZSBpbiBuZXh0LCBhcmcgZG8KICAgICAgICAgICAgbG9jYWwgb3V0cHV0ID0gIiIKICAgICAgICAgICAgd2hpbGUgdmFsdWUgPiAwIGRvCiAgICAgICAgICAgICAgICBsb2NhbCBpbmRleCA9IG1hdGguZm1vZCh2YWx1ZSwgMTYpICsgMQogICAgICAgICAgICAgICAgdmFsdWUgPSBtYXRoLmZsb29yKHZhbHVlIC8gMTYpCiAgICAgICAgICAgICAgICBvdXRwdXQgPSBzdHJpbmcuc3ViKCIwMTIzNDU2Nzg5QUJDREVGIiwgaW5kZXgsIGluZGV4KSAuLiBvdXRwdXQgCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBpZiAjb3V0cHV0ID09IDAgdGhlbiAKICAgICAgICAgICAgICAgIG91dHB1dCA9ICIwMCIgCiAgICAgICAgICAgIGVsc2VpZiAjb3V0cHV0ID09IDEgdGhlbiAKICAgICAgICAgICAgICAgIG91dHB1dCA9ICIwIiAuLiBvdXRwdXQgCiAgICAgICAgICAgIGVuZCAKICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0IC4uIG91dHB1dAogICAgICAgIGVuZCAKICAgICAgICByZXR1cm4gcmVzdWx0IC4uICJGRiIKICAgIGVuZAogICAgei5wcmVmaXggPSB7CiAgICAgICAgc2VjdGlvbiA9IHouaGV4KHs1NSw1NSw1NX0pIC4uICJbIiAuLiB6LmhleCh7NjksIDI1NSwgNTV9KSAuLiAiJXMiIC4uIHouaGV4KHs1NSw1NSw1NX0pIC4uICJdICIgLi4gei5oZXgoezI1NSwgMjU1LCAyNTV9KSAuLiAiLSAiIC4uIHouaGV4KHs1NSw1NSw1NX0pIC4uICJbIiAuLiB6LmhleCh7MTY5LDE2OSwxNjl9KSAuLiAiJXMiIC4uIHouaGV4KHs1NSw1NSw1NX0pIC4uICJdICIgLi4gei5oZXgoezEyMywxMjMsMTIzfSkgLi4gIiVzIiwKICAgICAgICB4ID0gei5oZXgoezY5LCAyNTUsIDU1fSkgLi4gIkRTICIgLi4gei5oZXgoezI1NSwgMjU1LCAyNTV9KSAuLiAiLSAiIC4uIHouaGV4KHsxMjMsMTIzLDEyM30pIC4uICIlcyIKICAgIH0KICAgIHouaXRlbSA9IGZ1bmN0aW9uKHR5cGUsIGFyZ3MpCiAgICAgICAgcmV0dXJuIHVpW3R5cGVdKCJhYSIsICJhbnRpLWFpbWJvdCBhbmdsZXMiLCB1bnBhY2soYXJncykpCiAgICBlbmQKICAgIHoubWVudSA9IHsKICAgICAgICBsYWJlbCA9IHouaXRlbSgibmV3X2xhYmVsIiwge3oucHJlZml4Lng6Zm9ybWF0KCJMIFUgQSBTIEUgTiBTIEUiKX0pLAogICAgICAgIHNlbGVjdCA9IHouaXRlbSgibmV3X2NvbWJvYm94IiwgeyJcbiIsICJBbnRpIEFpbSIsICJLZXliaW5kcyIsICJWaXN1YWxzIiwgIk1pc2MiLCAiQ2ZnIn0pLAogICAgICAgIFsiQW50aSBBaW0iXSA9IHsKICAgICAgICAgICAgc3RhdGUgPSB6Lml0ZW0oIm5ld19jb21ib2JveCIsIHt6LnByZWZpeC54OmZvcm1hdCgiU3RhdGUiKSwgei5zdGF0ZXN9KSwKICAgICAgICAgICAgYnVpbGRlciA9IHt9LAoJCQljdXN0b20gPSB7fQogICAgICAgIH0sCgkJWyJLZXliaW5kcyJdID0gewoJCQlsZWZ0ID0gei5pdGVtKCJuZXdfaG90a2V5Iiwge3oucHJlZml4Lng6Zm9ybWF0KCJMZWZ0Iil9KSwKCQkJcmlnaHQgPSB6Lml0ZW0oIm5ld19ob3RrZXkiLCB7ei5wcmVmaXgueDpmb3JtYXQoIlJpZ2h0Iil9KSwKCQkJZm9yd2FyZCA9IHouaXRlbSgibmV3X2hvdGtleSIsIHt6LnByZWZpeC54OmZvcm1hdCgiRm9yd2FyZCIpfSksCgkJCWZzID0gei5pdGVtKCJuZXdfaG90a2V5Iiwge3oucHJlZml4Lng6Zm9ybWF0KCJGcmVlc3RhbmQiKX0pCiAgICAgICAgfSwKICAgICAgICBbIlZpc3VhbHMiXSA9IHsKCQkJd2F0ZXJtYXJrID0gei5pdGVtKCJuZXdfY29tYm9ib3giLCB7ei5wcmVmaXgueDpmb3JtYXQoIldhdGVybWFyayIpLCB7IlJpZ2h0IiwgIkxlZnQifX0pLAoJCQlsdWFjb2xvciA9IHouaXRlbSgibmV3X2NvbG9yX3BpY2tlciIsIHt6LnByZWZpeC54OmZvcm1hdCgiTHVhIENvbG9yIiksIDE3OSwgMjU1LCAxOCwyNTV9KSwKCQkJc3BhY2VzID0gei5pdGVtKCJuZXdfY2hlY2tib3giLCB7ei5wcmVmaXgueDpmb3JtYXQoIlJlbW92ZSBzcGFjZXMiKX0pLAoJCQlpbmRpY2F0b3IgPSB6Lml0ZW0oIm5ld19jaGVja2JveCIsIHt6LnByZWZpeC54OmZvcm1hdCgiSW5kaWNhdG9yIil9KSwKCQkJYXJyb3dzID0gei5pdGVtKCJuZXdfY2hlY2tib3giLCB7ei5wcmVmaXgueDpmb3JtYXQoIkFycm93cyIpfSksCgkJCWtleXMgPSB6Lml0ZW0oIm5ld19jb21ib2JveCIsIHsiXG5BcnJvd3MiLCB7ImIiLCAiICIsICIrIiwgInRzIiwgImJlc3QifX0pLAoJCQlrZXljb2xvciA9IHouaXRlbSgibmV3X2NvbG9yX3BpY2tlciIsIHt6LnByZWZpeC54OmZvcm1hdCgiS2V5IENvbG9yIiksIDU1LCA1NSwgNTUsMjU1fSksCgkJCWNvbG9ya2V5ID0gei5pdGVtKCJuZXdfY29sb3JfcGlja2VyIiwge3oucHJlZml4Lng6Zm9ybWF0KCJDb2xvciBLZXkiKSwgMTc5LCAyNTUsIDE4LDI1NX0pLAoJCQljZW50ZXIgPSB6Lml0ZW0oIm5ld19jaGVja2JveCIsIHt6LnByZWZpeC54OmZvcm1hdCgiQ2VudGVyIil9KSwKCQkJbGFiZWwgPSB6Lml0ZW0oIm5ld19sYWJlbCIsIHt6LnByZWZpeC54OmZvcm1hdCgiQ29sb3IiKX0pLAoJCQljb2xvciA9IHouaXRlbSgibmV3X2NvbG9yX3BpY2tlciIsIHt6LnByZWZpeC54OmZvcm1hdCgiQ29sb3IgUGlja2VyIiksIDE3OSwgMjU1LCAxOCwyNTV9KQogICAgICAgIH0sCgkJWyJNaXNjIl0gPSB7CgkJCWJhY2tzdGFiID0gei5pdGVtKCJuZXdfY2hlY2tib3giLCB7ei5wcmVmaXgueDpmb3JtYXQoIkFudGkgYmFja3N0YWIiKX0pLAoJCQloaWRlc2hvdCA9IHouaXRlbSgibmV3X2NoZWNrYm94Iiwge3oucHJlZml4Lng6Zm9ybWF0KCJIaWRlc2hvdCBmaXgiKX0pLAoJCQlkaXNhYmxlciA9IHouaXRlbSgibmV3X211bHRpc2VsZWN0Iiwge3oucHJlZml4Lng6Zm9ybWF0KCJGUyBEaXNhYmxlcnMiKSwgeyJBaXIiLCAiRHVjayIsICJTbG93In19KSwKCQl9LAoJCVsiQ2ZnIl0gPSB7CgkJCWV4cG9ydCA9IHouaXRlbSgibmV3X2J1dHRvbiIsIHsiRSBYIFAgTyBSIFQiLCBmdW5jdGlvbigpCgkJCQlsb2NhbCBjZmcgPSB7fQoJCQkJZm9yIGluZGV4LCB2YWx1ZSBpbiBuZXh0LCB6Lm1lbnVbIkFudGkgQWltIl0gZG8KCQkJCQlpZiB0eXBlKHZhbHVlKSA9PSAidGFibGUiIHRoZW4KCQkJCQkJY2ZnW2luZGV4XSA9IHt9CgkJCQkJCWZvciBpLCB2IGluIG5leHQsIHZhbHVlIGRvCgkJCQkJCQlpZiB0eXBlKHYpID09ICJ0YWJsZSIgdGhlbgoJCQkJCQkJCWNmZ1tpbmRleF1baV0gPSB7fQoJCQkJCQkJCWZvciB6LCB4IGluIG5leHQsIHYgZG8KCQkJCQkJCQkJaWYgeiB+PSAiYnV0dG9uIiB0aGVuCgkJCQkJCQkJCQljZmdbaW5kZXhdW2ldW3pdID0gdWkuZ2V0KHgpCgkJCQkJCQkJCWVuZAoJCQkJCQkJCWVuZAoJCQkJCQkJZWxzZQoJCQkJCQkJCWNmZ1tpbmRleF1baV0gPSB1aS5nZXQodikKCQkJCQkJCWVuZAoJCQkJCQllbmQKCQkJCQllbHNlCgkJCQkJCWNmZ1tpbmRleF0gPSB1aS5nZXQodmFsdWUpCgkJCQkJZW5kCgkJCQllbmQKCQkJCWNsaXBib2FyZC5zZXQoanNvbi5zdHJpbmdpZnkoY2ZnKSkKCQkJZW5kfSksCgkJCWltcG9ydCA9IHouaXRlbSgibmV3X2J1dHRvbiIsIHsiSSBNIFAgTyBSIFQiLCBmdW5jdGlvbigpCgkJCQlwY2FsbChmdW5jdGlvbigpCgkJCQkJbG9jYWwgY2ZnID0ganNvbi5wYXJzZShjbGlwYm9hcmQuZ2V0KCkpCgkJCQkJZm9yIGluZGV4LCB2YWx1ZSBpbiBuZXh0LCB6Lm1lbnVbIkFudGkgQWltIl0gZG8KCQkJCQkJaWYgdHlwZSh2YWx1ZSkgPT0gInRhYmxlIiB0aGVuCgkJCQkJCQlmb3IgaSwgdiBpbiBuZXh0LCB2YWx1ZSBkbwoJCQkJCQkJCWlmIHR5cGUodikgPT0gInRhYmxlIiB0aGVuCgkJCQkJCQkJCWZvciB6LCB4IGluIG5leHQsIHYgZG8KCQkJCQkJCQkJCWlmIHogfj0gImJ1dHRvbiIgdGhlbgoJCQkJCQkJCQkJCXVpLnNldCh4LCBjZmdbaW5kZXhdW2ldW3pdKQoJCQkJCQkJCQkJZW5kCgkJCQkJCQkJCWVuZAoJCQkJCQkJCWVsc2UKCQkJCQkJCQkJdWkuc2V0KHYsIGNmZ1tpbmRleF1baV0pCgkJCQkJCQkJZW5kCgkJCQkJCQllbmQKCQkJCQkJZWxzZQoJCQkJCQkJdWkuc2V0KHZhbHVlLCBjZmdbaW5kZXhdKQoJCQkJCQllbmQKCQkJCQllbmQKCQkJCWVuZCkKCQkJZW5kfSkKCQl9CiAgICB9CiAgICBsb2NhbCBmdW5jdGlvbiBtb3ZlY2ZnKGFyZykKICAgICAgICBsb2NhbCB4ID0gc3RyaW5nLmZpbmQodWkubmFtZShhcmcpLCAiQ1QiKSBhbmQgIkNUIiBvciAiVCIKICAgICAgICBsb2NhbCB4eHggPSBzdHJpbmcuZmluZCh1aS5uYW1lKGFyZyksICJDVCIpIGFuZCAiVCIgb3IgIkNUIgogICAgICAgIGxvY2FsIHRibCA9IHoubWVudVsiQW50aSBBaW0iXS5idWlsZGVyW3VpLmdldCh6Lm1lbnVbIkFudGkgQWltIl0uc3RhdGUpIC4uICIgIiAuLiB4eHhdCiAgICAgICAgZm9yIGksIHYgaW4gbmV4dCwgei5tZW51WyJBbnRpIEFpbSJdLmJ1aWxkZXJbdWkuZ2V0KHoubWVudVsiQW50aSBBaW0iXS5zdGF0ZSkgLi4gIiAiIC4uIHhdIGRvCiAgICAgICAgICAgIGlmIGkgfj0gImJ1dHRvbiIgdGhlbgogICAgICAgICAgICAgICAgdWkuc2V0KHYsIHVpLmdldCh0YmxbaV0pKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAoJbG9jYWwgbG9naWMgPSB7fQoJbG9jYWwgY3VzdG9taml0dGVyID0gZmFsc2UKCWxvY2FsIHRlbXBfYm9vbCA9IGZhbHNlCglsb2NhbCBsYWRkZXIgPSBmYWxzZQoJbG9jYWwgdGVtcF93YXkgPSAxCglsb2NhbCBmdW5jdGlvbiBnZXRfdmFsdWUoeCwgeikKCQlpZiB6IDwgMyB0aGVuCgkJCXRlbXBfYm9vbCA9IG5vdCB0ZW1wX2Jvb2wKCQkJcmV0dXJuIHRlbXBfYm9vbCBhbmQgLXggb3IgeAoJCWVuZAoJCWxvY2FsIGxpc3QgPSB7fQoJCWZvciBsb29wID0gMSwgeiBkbwoJCQlpZiBsb29wICUgNCA9PSAwIHRoZW4KCQkJCWxpc3RbI2xpc3QrMV0gPSB4CgkJCWVuZAoJCQlpZiBsb29wICUgNCA9PSAxIHRoZW4KCQkJCWxpc3RbI2xpc3QrMV0gPSB4LzIKCQkJZW5kCgkJCWlmIGxvb3AgJSA0ID09IDIgdGhlbgoJCQkJbGlzdFsjbGlzdCsxXSA9IC0oeC8yKQoJCQllbmQKCQkJaWYgbG9vcCAlIDQgPT0gMyB0aGVuCgkJCQlsaXN0WyNsaXN0KzFdID0gLXgKCQkJZW5kCgkJZW5kCgkJaWYgdGVtcF93YXkgPD0geiB0aGVuCgkJCXRlbXBfd2F5ID0gdGVtcF93YXkgKyAxCgkJCWlmIHRlbXBfd2F5ID09IHorMSB0aGVuCgkJCQl0ZW1wX3dheSA9IDEKCQkJZW5kCgkJZW5kCgkJcmV0dXJuIGxpc3RbdGVtcF93YXktMV0KCWVuZAoJbG9jYWwgZnVuY3Rpb24gZGVzeW5jZnVuYyh6LCB4LCBzcGVlZCkKCQlsb2NhbCBzZWxlY3RlZCA9IGVudGl0eS5nZXRfcGxheWVyX3dlYXBvbih6KQoJCWxvY2FsIHRocm93ID0gZW50aXR5LmdldF9wcm9wKHNlbGVjdGVkLCAibV9mVGhyb3dUaW1lIikKCQlpZiAodGhyb3cgfj0gbmlsIGFuZCB0aHJvdyB+PSAwKSB0aGVuIAoJCQlyZXR1cm4gZmFsc2UgCgkJZWxzZSAKCQkJaWYgeC5pbl9hdHRhY2sgPT0gMSB0aGVuIAoJCQkJbG9jYWwgd2VhcG9uID0gZW50aXR5LmdldF9jbGFzc25hbWUoc2VsZWN0ZWQpIAoJCQkJaWYgbm90IHdlYXBvbjpmaW5kKCJHcmVuYWRlIikgdGhlbiAKCQkJCQlyZXR1cm4gZmFsc2UgCgkJCQllbmQgCgkJCWVuZCAKCQllbmQKCQlpZiBlbnRpdHkuZ2V0X3Byb3AoZW50aXR5LmdldF9nYW1lX3J1bGVzKCksICJtX2JGcmVlemVQZXJpb2QiKSA9PSAxIHRoZW4gcmV0dXJuIGZhbHNlIGVuZAoJCWlmIGxhZGRlciBvciAoZW50aXR5LmdldF9wcm9wKHosICJtX01vdmVUeXBlIikgPT0gOSBhbmQgc3BlZWQgfj0gMCkgdGhlbiByZXR1cm4gZmFsc2UgZW5kCgkJaWYgeC5pbl91c2UgPT0gMSB0aGVuIHJldHVybiBmYWxzZSBlbmQKCQlyZXR1cm4gdHJ1ZQoJZW5kCglsb2NhbCBmdW5jdGlvbiBzcGxpdChzdHIsIGFyZykgCgkJbG9jYWwgcmVzdWx0ID0ge30gCgkJZm9yIGxvb3AgaW4gc3RyaW5nLmdtYXRjaChzdHIsICIoW14iIC4uIGFyZyAuLiAiXSspIikgZG8gCgkJCXJlc3VsdFsjcmVzdWx0KzFdID0gbG9vcCAKCQllbmQgCgkJcmV0dXJuIHJlc3VsdCAKCWVuZAoJbG9jYWwgZnVuY3Rpb24gaGVpZ2h0KGFyZykKCQlsb2NhbCB4LHkseiA9IGVudGl0eS5nZXRfb3JpZ2luKGVudGl0eS5nZXRfbG9jYWxfcGxheWVyKCkpCgkJbG9jYWwgb3gsb3ksb3ogPSBlbnRpdHkuZ2V0X29yaWdpbihhcmcpCgkJbG9jYWwgbHYgPSBzcGxpdCh0b3N0cmluZyh2ZWN0b3IoeCx5LHopKSwgIiAiKQoJCWxvY2FsIG92ID0gc3BsaXQodG9zdHJpbmcodmVjdG9yKG94LG95LG96KSksICIgIikKCQlyZXR1cm4gKChsdlszXSAtIDQ1KSA+IChvdlszXSArIDApKQoJZW5kCglsb2NhbCBmdW5jdGlvbiBub2Rlc3luYyhhYXRibCkKCQl1aS5zZXQoYWF0YmwuZW5hYmxlZFsxXSwgdHJ1ZSkKCQl1aS5zZXQoYWF0Ymwucm9sbFsxXSwgMCkKCQl1aS5zZXQoYWF0YmwuZWRnZVsxXSwgZmFsc2UpCgkJdWkuc2V0KGFhdGJsLmZzYm9keVsxXSwgZmFsc2UpCgkJdWkuc2V0KGFhdGJsLnlhd1sxXSwgIjE4MCIpCgkJdWkuc2V0KGFhdGJsLnBpdGNoWzFdLCAiZGVmYXVsdCIpCgkJdWkuc2V0KGFhdGJsLmJhc2VbMV0sICJhdCB0YXJnZXRzIikKCQl1aS5zZXQoYWF0YmwuYm9keVsxXSwgIm9mZiIpCgkJdWkuc2V0KGFhdGJsLmJvZHlbMl0sIDApCgkJdWkuc2V0KGFhdGJsLmppdHRlclsxXSwgIm9mZiIpCgkJdWkuc2V0KGFhdGJsLmppdHRlclsyXSwgMCkKCQl1aS5zZXQoYWF0YmwueWF3WzJdLCAwKQoJZW5kCglsb2NhbCBzY3JpcHQgPSB7CgkJY2FjaGUgPSB7CgkJCW1hbnVhbCA9IHsKCQkJCWFhID0gMCwKCQkJCXRpY2sgPSAwCgkJCX0KCQl9Cgl9Cglmb3IgaSwgdiBpbiBuZXh0LCB6LnN0YXRlcyBkbwogICAgICAgIHoubWVudVsiQW50aSBBaW0iXS5jdXN0b21bdl0gPSB7CgkJCWRlc3luYyA9IHouaXRlbSgibmV3X2NvbWJvYm94Iiwge3oucHJlZml4LnNlY3Rpb246Zm9ybWF0KCJBQSIsIHYsICJEZXN5bmMiKSwgIkRlZmF1bHQiLCAiQ3VzdG9tIn0pLAoJCQl0ZWFtID0gei5pdGVtKCJuZXdfY29tYm9ib3giLCB7ei5wcmVmaXguc2VjdGlvbjpmb3JtYXQoIkFBIiwgdiwgIlRlYW0iKSwgIkNUIiwgIlQifSksCiAgICAgICAgICAgIGVuYWJsZSA9IHouaXRlbSgibmV3X211bHRpc2VsZWN0Iiwge3oucHJlZml4LnNlY3Rpb246Zm9ybWF0KCJBQSIsIHYsICJTdGF0dXMiKSwgIkVuYWJsZWQifSksCgkJCXlhd3RlYW0gPSB6Lml0ZW0oIm5ld19jb21ib2JveCIsIHt6LnByZWZpeC5zZWN0aW9uOmZvcm1hdCgiQUEiLCB2LCAiVGVhbSIpLCB7IkNUIiwgIlQifX0pLAoJCQl5YXdvcHRpb24gPSB6Lml0ZW0oIm5ld19jb21ib2JveCIsIHt6LnByZWZpeC5zZWN0aW9uOmZvcm1hdCgiQUEiLCB2LCAiWWF3IG1vZGUiKSwgeyJMZWZ0IHJpZ2h0IChGUzogWWVzKSIsICJMZWZ0IHJpZ2h0IChGUzogTm8pIiwgIkF1dG9tYXRpYyAoRlM6IE5vKSJ9fSksCiAgICAgICAgICAgIHR5YXdsZWZ0ID0gei5pdGVtKCJuZXdfc2xpZGVyIiwge3oucHJlZml4LnNlY3Rpb246Zm9ybWF0KCJBQSIsIHYsICJZYXcgbGVmdFxuVCIpLCAtMTgwLCAxODAsIC0xMH0pLAogICAgICAgICAgICB0eWF3cmlnaHQgPSB6Lml0ZW0oIm5ld19zbGlkZXIiLCB7ei5wcmVmaXguc2VjdGlvbjpmb3JtYXQoIkFBIiwgdiwgIllhdyByaWdodFxuVCIpLCAtMTgwLCAxODAsIDEwfSksCgkJCWN0eWF3bGVmdCA9IHouaXRlbSgibmV3X3NsaWRlciIsIHt6LnByZWZpeC5zZWN0aW9uOmZvcm1hdCgiQUEiLCB2LCAiWWF3IGxlZnRcbkNUIiksIC0xODAsIDE4MCwgLTEwfSksCiAgICAgICAgICAgIGN0eWF3cmlnaHQgPSB6Lml0ZW0oIm5ld19zbGlkZXIiLCB7ei5wcmVmaXguc2VjdGlvbjpmb3JtYXQoIkFBIiwgdiwgIllhdyByaWdodFxuQ1QiKSwgLTE4MCwgMTgwLCAxMH0pLAoJCQl5YXdhdXRvID0gei5pdGVtKCJuZXdfY29tYm9ib3giLCB7ei5wcmVmaXguc2VjdGlvbjpmb3JtYXQoIkFBIiwgdiwgIkF1dG9tYXRpYyIpLCB7IkRlZmF1bHQiLCAiV2F5cyJ9fSksCgkJCXlhd3dheXMgPSAgei5pdGVtKCJuZXdfc2xpZGVyIiwge3oucHJlZml4LnNlY3Rpb246Zm9ybWF0KCJBQSIsIHYsICJXYXlzXG4iKSwgMiwgNSwgNX0pLAoJCQlvcHRpb25zID0gei5pdGVtKCJuZXdfbXVsdGlzZWxlY3QiLCB7ei5wcmVmaXguc2VjdGlvbjpmb3JtYXQoIkFBIiwgdiwgIkRlZmVuc2l2ZSIpLCB7IlBpdGNoIHVwIiwgIlJhbmRvbSB5YXciLCAiT2ZmZW5zaXZlIiwgIkFsd2F5cyBvbiJ9fSkKICAgICAgICB9CgkJaWYgc3RyaW5nLmxvd2VyKHYpOmZpbmQoImR1Y2siKSBvciB2ID09ICJTdGFuZGluZyIgdGhlbgoJCQl6Lm1lbnVbIkFudGkgQWltIl0uY3VzdG9tW3ZdLnlhd29wdGlvbnMgPSB6Lml0ZW0oIm5ld19tdWx0aXNlbGVjdCIsIHt6LnByZWZpeC5zZWN0aW9uOmZvcm1hdCgiQUEiLCB2LCAiT3B0aW9ucyIpLCB7IkhlaWdodCBubyBkZXN5bmMifX0pCgkJZW5kCgkJdWlbInNldF9jYWxsYmFjayJdKHoubWVudVsiQW50aSBBaW0iXS5jdXN0b21bdl0ueWF3d2F5cyxmdW5jdGlvbigpCgkJCWxvZ2ljID0ge30KCQllbmQpCiAgICBlbmQKICAgIHouY2FjaGUgPSB7fQogICAgZm9yIGksIHYgaW4gbmV4dCwgei5zdGF0ZXMgZG8KICAgICAgICB6LmNhY2hlWyN6LmNhY2hlKzFdID0gdiAuLiAiIENUIgogICAgICAgIHouY2FjaGVbI3ouY2FjaGUrMV0gPSB2IC4uICIgVCIKICAgIGVuZAogICAgZm9yIGksIHYgaW4gbmV4dCwgei5jYWNoZSBkbwogICAgICAgIHoubWVudVsiQW50aSBBaW0iXS5idWlsZGVyW3ZdID0gewogICAgICAgICAgICBlbmFibGUgPSB6Lml0ZW0oIm5ld19tdWx0aXNlbGVjdCIsIHt6LnByZWZpeC5zZWN0aW9uOmZvcm1hdCgiQUEiLCB2LCAiU3RhdHVzIiksICJFbmFibGVkIn0pLAogICAgICAgICAgICB5YXdtb2RlID0gei5pdGVtKCJuZXdfY29tYm9ib3giLCB7ei5wcmVmaXguc2VjdGlvbjpmb3JtYXQoIkFBIiwgdiwgIllhdyBvcHRpb25zIiksICJPZmYiLCAiQ3VzdG9taXplIiwgIkN1c3RvbWl6ZSArIGwgJiByIiwgIkxlZnQgYW5kIHJpZ2h0In0pLAogICAgICAgICAgICB5YXcgPSB6Lml0ZW0oIm5ld19zbGlkZXIiLCB7ei5wcmVmaXguc2VjdGlvbjpmb3JtYXQoIkFBIiwgdiwgIllhdyIpLCAtMTgwLCAxODAsIDB9KSwKICAgICAgICAgICAgbGVmdHJpZ2h0ID0gei5pdGVtKCJuZXdfY29tYm9ib3giLCB7ei5wcmVmaXguc2VjdGlvbjpmb3JtYXQoIkFBIiwgdiwgIkxlZnQgcmlnaHQiKSwgIk5vcm1hbCIsICJTaW1wbGUiLCAiQWR2YW5jZWQifSksCiAgICAgICAgICAgIHlhd2xlZnQgPSB6Lml0ZW0oIm5ld19zbGlkZXIiLCB7ei5wcmVmaXguc2VjdGlvbjpmb3JtYXQoIkFBIiwgdiwgIllhdyBsZWZ0IiksIC0xMDAsIDEwMCwgLTEwfSksCiAgICAgICAgICAgIHlhd3JpZ2h0ID0gei5pdGVtKCJuZXdfc2xpZGVyIiwge3oucHJlZml4LnNlY3Rpb246Zm9ybWF0KCJBQSIsIHYsICJZYXcgcmlnaHQiKSwgLTEwMCwgMTAwLCAxMH0pLAoJCQl5YXd0aW1lciA9IHouaXRlbSgibmV3X3NsaWRlciIsIHt6LnByZWZpeC5zZWN0aW9uOmZvcm1hdCgiQUEiLCB2LCAiWWF3IHRpbWVyIiksIDEsIDEwLCAxfSksCiAgICAgICAgICAgIGppdHRlcnlhdyA9IHouaXRlbSgibmV3X2NvbWJvYm94Iiwge3oucHJlZml4LnNlY3Rpb246Zm9ybWF0KCJBQSIsIHYsICJKaXR0ZXIgbW9kZSIpLCAiT2ZmIiwgIkNlbnRlciIsICJMZWZ0IHJpZ2h0IiwgIlJhbmRvbSBjZW50ZXIiLCAiQXV0b21hdGljIHNtYWxsIiwgIkF1dG9tYXRpYyBiaWcifSksCiAgICAgICAgICAgIGppdHRlciA9IHouaXRlbSgibmV3X3NsaWRlciIsIHt6LnByZWZpeC5zZWN0aW9uOmZvcm1hdCgiQUEiLCB2LCAiSml0dGVyIiksIC0xODAsIDE4MCwgMH0pLAogICAgICAgICAgICBqaXR0ZXJsciA9IHouaXRlbSgibmV3X3NsaWRlciIsIHt6LnByZWZpeC5zZWN0aW9uOmZvcm1hdCgiQUEiLCB2LCAiTGVmdCByaWdodCIpLCAtMTgwLCAxODAsIDB9KSwKCQkJaml0dGVycmFuZG9tID0gei5pdGVtKCJuZXdfc2xpZGVyIiwge3oucHJlZml4LnNlY3Rpb246Zm9ybWF0KCJBQSIsIHYsICJKaXR0ZXJcblxuXG4iKSwgMCwgOTAsIDYwfSksCiAgICAgICAgICAgIGppdHRlcnJuZCA9IHouaXRlbSgibmV3X3NsaWRlciIsIHt6LnByZWZpeC5zZWN0aW9uOmZvcm1hdCgiQUEiLCB2LCAiUmFuZG9tIiksIDAsIDMwLCAxNX0pLAogICAgICAgICAgICBmYWtleWF3ID0gei5pdGVtKCJuZXdfY29tYm9ib3giLCB7ei5wcmVmaXguc2VjdGlvbjpmb3JtYXQoIkFBIiwgdiwgIkZha2UgeWF3IiksICJEZWZhdWx0IHNrZWV0IiwgIkF1dG9tYXRpYyBmYWtlIiwgIlJhbmRvbSBza2VldCBmYWtlIn0pLAoJCQlib2R5bW9kZSA9IHouaXRlbSgibmV3X2NvbWJvYm94Iiwge3oucHJlZml4LnNlY3Rpb246Zm9ybWF0KCJBQSIsIHYsICJCb2R5IHlhdyIpLCAiSml0dGVyIiwgIlN0YXRpYyIsICJPcHBvc2l0ZSIsICJPZmYifSksCiAgICAgICAgICAgIGJvZHl5YXcgPSB6Lml0ZW0oIm5ld19zbGlkZXIiLCB7IlxuQm9keSB5YXdcbiIsIC0xODAsIDE4MCwgMH0pLAogICAgICAgICAgICBsaW1pdHlhdyA9IHouaXRlbSgibmV3X3NsaWRlciIsIHt6LnByZWZpeC5zZWN0aW9uOmZvcm1hdCgiQUEiLCB2LCAiTGltaXQgeWF3IiksIDAsIDYwLCA2MH0pLAogICAgICAgICAgICBvcHRpb25zID0gei5pdGVtKCJuZXdfbXVsdGlzZWxlY3QiLCB7ei5wcmVmaXguc2VjdGlvbjpmb3JtYXQoIkFBIiwgdiwgIk9wdGlvbnMiKSwgKChzdHJpbmcubG93ZXIodik6ZmluZCgiZHVjayIpIG9yIHY6ZmluZCgiU3RhbmRpbmciKSkgYW5kIHsiSGVpZ2h0IG5vIGRlc3luYyIsICJTdGF0aWMgZnJlZXN0YW5kaW5nIiwgIkRlZmVuc2l2ZSIsICJQcmlvcml0aXplIG1hbnVhbCJ9IG9yIHsiU3RhdGljIGZyZWVzdGFuZGluZyIsICJEZWZlbnNpdmUiLCAiUHJpb3JpdGl6ZSBtYW51YWwifSl9KSwKICAgICAgICAgICAgZGVmZW5zaXZlID0gei5pdGVtKCJuZXdfbXVsdGlzZWxlY3QiLCB7ei5wcmVmaXguc2VjdGlvbjpmb3JtYXQoIkFBIiwgdiwgIkRlZmVuc2l2ZSIpLCB7IlBpdGNoIHVwIiwgIlJhbmRvbSB5YXciLCAiU3dpdGNoIGN5Y2xlIiwgIkFsd2F5cyBvbiJ9fSksCiAgICAgICAgICAgIGJ1dHRvbiA9IHouaXRlbSgibmV3X2J1dHRvbiIsIHsiU2VuZCB0bzogIiAuLiAoc3RyaW5nLmZpbmQodiwgIkNUIikgYW5kICJUIiBvciAiQ1QiKSwgbW92ZWNmZ30pLAoJCQlsYWJlbCA9IHouaXRlbSgibmV3X2xhYmVsIiwgeyJcbiJ9KQogICAgICAgIH0KICAgIGVuZAogICAgei5oaWRlc2hvd2V0YyA9IHsKICAgICAgICBoYW5kbGVyID0gZnVuY3Rpb24oKQoJCQlpZiBub3QgdWkuaXNfbWVudV9vcGVuKCkgdGhlbiByZXR1cm4gbmlsIGVuZAoJCQlmb3IgaW5kZXgsIHZhbHVlIGluIG5leHQsIHouaXRlbXMuYWEgZG8KICAgICAgICAgICAgICAgIGZvciBpLCB2IGluIG5leHQsIHZhbHVlIGRvCiAgICAgICAgICAgICAgICAgICAgdWkuc2V0X3Zpc2libGUodiwgZmFsc2UpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGxvY2FsIHNlbGVjdGVkID0gdWkuZ2V0KHoubWVudS5zZWxlY3QpCiAgICAgICAgICAgIGxvY2FsIHRvZ2dsZSA9IHRydWUKICAgICAgICAgICAgZm9yIGluZGV4LCB2YWx1ZSBpbiBuZXh0LCB6Lm1lbnUgZG8KICAgICAgICAgICAgICAgIGlmIHR5cGUodmFsdWUpID09ICJ0YWJsZSIgdGhlbgogICAgICAgICAgICAgICAgICAgIGZvciBpLCB2IGluIG5leHQsIHZhbHVlIGRvCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHR5cGUodikgPT0gInRhYmxlIiB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgaWksIHZ2IGluIG5leHQsIHYgZG8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiB0eXBlKHZ2KSA9PSAidGFibGUiIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGlpaSwgdnZ2IGluIG5leHQsIHZ2IGRvCgkJCQkJCQkJCQlpZiAoaSA9PSAiY3VzdG9tIikgdGhlbgoJCQkJCQkJCQkJCWlmIGlpaSA9PSAiZGVzeW5jIiB0aGVuCgkJCQkJCQkJCQkJCXVpLnNldF92aXNpYmxlKHZ2diwgaW5kZXggPT0gc2VsZWN0ZWQgYW5kIGlpID09IHVpLmdldCh6Lm1lbnVbIkFudGkgQWltIl0uc3RhdGUpKQoJCQkJCQkJCQkJCWVuZAoJCQkJCQkJCQkJCWlmIGlpaSA9PSAidGVhbSIgdGhlbgoJCQkJCQkJCQkJCQl1aS5zZXRfdmlzaWJsZSh2dnYsIGluZGV4ID09IHNlbGVjdGVkIGFuZCBpaSA9PSB1aS5nZXQoei5tZW51WyJBbnRpIEFpbSJdLnN0YXRlKSBhbmQgdWkuZ2V0KHoubWVudVsiQW50aSBBaW0iXVsiY3VzdG9tIl1bdWkuZ2V0KHoubWVudVsiQW50aSBBaW0iXS5zdGF0ZSldLmRlc3luYykgPT0gIkRlZmF1bHQiKQoJCQkJCQkJCQkJCWVuZAoJCQkJCQkJCQkJCWlmIGlpaSA9PSAiZW5hYmxlIiBhbmQgaWkgPT0gIkdsb2JhbCIgYW5kIHVpLmdldCh6Lm1lbnVbIkFudGkgQWltIl0uc3RhdGUpID09ICJHbG9iYWwiIHRoZW4KCQkJCQkJCQkJCQkJdWkuc2V0X3Zpc2libGUodnZ2LCBmYWxzZSkKCQkJCQkJCQkJCQllbHNlCgkJCQkJCQkJCQkJCWlmIGlpaSB+PSAidGVhbSIgYW5kIGlpaSB+PSAiZGVzeW5jIiB0aGVuCgkJCQkJCQkJCQkJCQlsb2NhbCBzaG9ydGN1dCA9IHoubWVudVsiQW50aSBBaW0iXVsiY3VzdG9tIl1bdWkuZ2V0KHoubWVudVsiQW50aSBBaW0iXS5zdGF0ZSldCgkJCQkJCQkJCQkJCQl0b2dnbGUgPSB6LmNvbnRhaW5zKHVpLmdldChzaG9ydGN1dC5lbmFibGUpLCAiRW5hYmxlZCIpIG9yIGlpaSA9PSAiZW5hYmxlIiBvciBpaSA9PSAiR2xvYmFsIgoJCQkJCQkJCQkJCQkJaWYgKHRvZ2dsZSkgYW5kIChpaWkgPT0gImN0eWF3bGVmdCIgb3IgaWlpID09ICJjdHlhd3JpZ2h0IiBvciBpaWkgPT0gInR5YXdsZWZ0IiBvciBpaWkgPT0gInR5YXdyaWdodCIgb3IgaWlpID09ICJ5YXd0ZWFtIikgdGhlbgoJCQkJCQkJCQkJCQkJCWxvY2FsIHRlYW0gPSB0cnVlCgkJCQkJCQkJCQkJCQkJaWYgKGlpaSA9PSAiY3R5YXdsZWZ0IiBvciBpaWkgPT0gImN0eWF3cmlnaHQiKSB0aGVuCgkJCQkJCQkJCQkJCQkJCXRlYW0gPSB1aS5nZXQoc2hvcnRjdXQueWF3dGVhbSkgPT0gIkNUIgoJCQkJCQkJCQkJCQkJCWVuZAoJCQkJCQkJCQkJCQkJCWlmIChpaWkgPT0gInR5YXdsZWZ0IiBvciBpaWkgPT0gInR5YXdyaWdodCIpIHRoZW4KCQkJCQkJCQkJCQkJCQkJdGVhbSA9IHVpLmdldChzaG9ydGN1dC55YXd0ZWFtKSA9PSAiVCIKCQkJCQkJCQkJCQkJCQllbmQKCQkJCQkJCQkJCQkJCQl0b2dnbGUgPSB1aS5nZXQoc2hvcnRjdXQueWF3b3B0aW9uKSB+PSAiQXV0b21hdGljIChGUzogTm8pIiBhbmQgdGVhbQoJCQkJCQkJCQkJCQkJZW5kCgkJCQkJCQkJCQkJCQlpZiAodG9nZ2xlKSBhbmQgKGlpaSA9PSAieWF3YXV0byIpIHRoZW4KCQkJCQkJCQkJCQkJCQl0b2dnbGUgPSB1aS5nZXQoc2hvcnRjdXQueWF3b3B0aW9uKSA9PSAiQXV0b21hdGljIChGUzogTm8pIgoJCQkJCQkJCQkJCQkJZW5kCgkJCQkJCQkJCQkJCQlpZiAodG9nZ2xlKSBhbmQgKGlpaSA9PSAieWF3d2F5cyIpIHRoZW4KCQkJCQkJCQkJCQkJCQl0b2dnbGUgPSB1aS5nZXQoc2hvcnRjdXQueWF3YXV0bykgPT0gIldheXMiIGFuZCB1aS5nZXQoc2hvcnRjdXQueWF3b3B0aW9uKSA9PSAiQXV0b21hdGljIChGUzogTm8pIgoJCQkJCQkJCQkJCQkJZW5kCgkJCQkJCQkJCQkJCQl1aS5zZXRfdmlzaWJsZSh2dnYsIHRvZ2dsZSBhbmQgaW5kZXggPT0gc2VsZWN0ZWQgYW5kIGlpID09IHVpLmdldCh6Lm1lbnVbIkFudGkgQWltIl0uc3RhdGUpIGFuZCB1aS5nZXQoc2hvcnRjdXQuZGVzeW5jKSA9PSAiQ3VzdG9tIikKCQkJCQkJCQkJCQkJZW5kCgkJCQkJCQkJCQkJZW5kCgkJCQkJCQkJCQllbHNlCgkJCQkJCQkJCQkJbG9jYWwgc2hvcnRjdXQgPSB6Lm1lbnVbIkFudGkgQWltIl0uYnVpbGRlclt1aS5nZXQoei5tZW51WyJBbnRpIEFpbSJdLnN0YXRlKSAuLiAiICIgLi4gdWkuZ2V0KHoubWVudVsiQW50aSBBaW0iXVsiY3VzdG9tIl1bdWkuZ2V0KHoubWVudVsiQW50aSBBaW0iXS5zdGF0ZSldLnRlYW0pXQoJCQkJCQkJCQkJCXRvZ2dsZSA9IHRydWUKCQkJCQkJCQkJCQlpZiAoaWlpID09ICJsZWZ0cmlnaHQiIG9yIGlpaSA9PSAieWF3bGVmdCIgb3IgaWlpID09ICJ5YXdyaWdodCIpIHRoZW4KCQkJCQkJCQkJCQkJdG9nZ2xlID0gdWkuZ2V0KHNob3J0Y3V0Lnlhd21vZGUpID09ICJMZWZ0IGFuZCByaWdodCIgb3IgdWkuZ2V0KHNob3J0Y3V0Lnlhd21vZGUpID09ICJDdXN0b21pemUgKyBsICYgciIKCQkJCQkJCQkJCQllbmQKCQkJCQkJCQkJCQlpZiAoaWlpID09ICJ5YXd0aW1lciIpIHRoZW4KCQkJCQkJCQkJCQkJdG9nZ2xlID0gdWkuZ2V0KHNob3J0Y3V0LmxlZnRyaWdodCkgPT0gIlRpbWVyIgoJCQkJCQkJCQkJCWVuZAoJCQkJCQkJCQkJCWlmIChpaWkgPT0gImppdHRlciIpIHRoZW4KCQkJCQkJCQkJCQkJdG9nZ2xlID0gdWkuZ2V0KHNob3J0Y3V0LmppdHRlcnlhdykgPT0gIkxlZnQgcmlnaHQiIG9yIHVpLmdldChzaG9ydGN1dC5qaXR0ZXJ5YXcpID09ICJDZW50ZXIiCgkJCQkJCQkJCQkJZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlpaSA9PSAiaml0dGVybHIiKSB0aGVuCgkJCQkJCQkJCQkJCXRvZ2dsZSA9IHVpLmdldChzaG9ydGN1dC5qaXR0ZXJ5YXcpID09ICJMZWZ0IHJpZ2h0IgoJCQkJCQkJCQkJCWVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpaWkgPT0gImppdHRlcnJuZCIpIHRoZW4KCQkJCQkJCQkJCQkJdG9nZ2xlID0gdWkuZ2V0KHNob3J0Y3V0LmppdHRlcnlhdykgPT0gIlJhbmRvbSBjZW50ZXIiCgkJCQkJCQkJCQkJZW5kCgkJCQkJCQkJCQkJaWYgKGlpaSA9PSAiaml0dGVycmFuZG9tIikgdGhlbgoJCQkJCQkJCQkJCQl0b2dnbGUgPSB1aS5nZXQoc2hvcnRjdXQuaml0dGVyeWF3KSA9PSAiUmFuZG9tIGNlbnRlciIKCQkJCQkJCQkJCQllbmQKCQkJCQkJCQkJCQlpZiAoaWlpID09ICJkZWZlbnNpdmUiKSB0aGVuCgkJCQkJCQkJCQkJCXRvZ2dsZSA9IHouY29udGFpbnModWkuZ2V0KHNob3J0Y3V0Lm9wdGlvbnMpLCAiRGVmZW5zaXZlIikKCQkJCQkJCQkJCQllbmQKCQkJCQkJCQkJCQlpZiAoaWlpID09ICJ5YXciKSB0aGVuCgkJCQkJCQkJCQkJCXRvZ2dsZSA9IHVpLmdldChzaG9ydGN1dC55YXdtb2RlKSA9PSAiQ3VzdG9taXplIiBvciB1aS5nZXQoc2hvcnRjdXQueWF3bW9kZSkgPT0gIkN1c3RvbWl6ZSArIGwgJiByIgoJCQkJCQkJCQkJCWVuZAoJCQkJCQkJCQkJCWlmIChpaWkgPT0gImJvZHltb2RlIiBvciBpaWkgPT0gImxpbWl0eWF3IikgdGhlbgoJCQkJCQkJCQkJCQl0b2dnbGUgPSB1aS5nZXQoc2hvcnRjdXQuZmFrZXlhdykgPT0gIkRlZmF1bHQgc2tlZXQiCgkJCQkJCQkJCQkJZW5kCgkJCQkJCQkJCQkJaWYgKGlpaSA9PSAiYm9keXlhdyIpIHRoZW4KCQkJCQkJCQkJCQkJdG9nZ2xlID0gdWkuZ2V0KHNob3J0Y3V0LmZha2V5YXcpID09ICJEZWZhdWx0IHNrZWV0IiBhbmQgKHVpLmdldChzaG9ydGN1dC5ib2R5bW9kZSkgPT0gIkppdHRlciIgb3IgdWkuZ2V0KHNob3J0Y3V0LmJvZHltb2RlKSA9PSAiU3RhdGljIikKCQkJCQkJCQkJCQllbmQKCQkJCQkJCQkJCQlpZiAodG9nZ2xlKSB0aGVuCgkJCQkJCQkJCQkJCWlmICh1aS5nZXQoei5tZW51WyJBbnRpIEFpbSJdLnN0YXRlKTpmaW5kKCJHbG9iYWwiKSkgdGhlbgoJCQkJCQkJCQkJCQkJdG9nZ2xlID0gaWlpIH49ICJlbmFibGUiCgkJCQkJCQkJCQkJCWVsc2UKCQkJCQkJCQkJCQkJCXRvZ2dsZSA9IHouY29udGFpbnModWkuZ2V0KHNob3J0Y3V0LmVuYWJsZSksICJFbmFibGVkIikgb3IgaWlpID09ICJlbmFibGUiCgkJCQkJCQkJCQkJCWVuZAoJCQkJCQkJCQkJCWVuZAoJCQkJCQkJCQkJCXVpLnNldF92aXNpYmxlKHZ2diwgaW5kZXggPT0gc2VsZWN0ZWQgYW5kIGlpID09IHVpLmdldCh6Lm1lbnVbIkFudGkgQWltIl0uc3RhdGUpIC4uICIgIiAuLiB1aS5nZXQoei5tZW51WyJBbnRpIEFpbSJdWyJjdXN0b20iXVt1aS5nZXQoei5tZW51WyJBbnRpIEFpbSJdLnN0YXRlKV0udGVhbSkgYW5kIHRvZ2dsZSBhbmQgdWkuZ2V0KHoubWVudVsiQW50aSBBaW0iXVsiY3VzdG9tIl1bdWkuZ2V0KHoubWVudVsiQW50aSBBaW0iXS5zdGF0ZSldLmRlc3luYykgPT0gIkRlZmF1bHQiKQoJCQkJCQkJCQkJZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKCQkJCQkJCXRvZ2dsZSA9IHRydWUKCQkJCQkJCWlmIChpID09ICJ0ZWFtIikgdGhlbgoJCQkJCQkJCXRvZ2dsZSA9IHVpLmdldCh6Lm1lbnVbIkFudGkgQWltIl0uZGVzeW5jKSA9PSAiRGVmYXVsdCIKCQkJCQkJCWVuZAoJCQkJCQkJaWYgKGkgPT0gImxhYmVsIiBvciBpID09ICJjb2xvciIgb3IgaSA9PSAiYXJyb3dzIiBvciBpID09ICJjZW50ZXIiKSB0aGVuCgkJCQkJCQkJdG9nZ2xlID0gdWkuZ2V0KHoubWVudVsiVmlzdWFscyJdLmluZGljYXRvcikKCQkJCQkJCWVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdWkuc2V0X3Zpc2libGUodiwgaW5kZXggPT0gc2VsZWN0ZWQgYW5kIHRvZ2dsZSkKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kLAogICAgICAgIHRpdGxlID0gZnVuY3Rpb24oKQoJCQlpZiBub3QgdWkuaXNfbWVudV9vcGVuKCkgdGhlbiByZXR1cm4gbmlsIGVuZAogICAgICAgICAgICBkbwoJCQkJbG9jYWwgcjIsIGcyLCBiMiwgYTIgPSAyNTUsMjU1LDI1NSwyNTUKCQkJCWxvY2FsIGhpZ2hsaWdodF9mcmFjdGlvbiA9ICAoZ2xvYmFscy5yZWFsdGltZSgpIC8gMiAlIDEuMiAqIDIpIC0gMS4yCgkJCQlsb2NhbCBvdXRwdXQgPSAiIgoJCQkJbG9jYWwgdGV4dF90b19kcmF3ID0gIkwgVSBBIFMgRSBOIFMgRSIKCQkJCWZvciBpZHggPSAxLCAjdGV4dF90b19kcmF3IGRvCgkJCQkJbG9jYWwgY2hhcmFjdGVyID0gdGV4dF90b19kcmF3OnN1YihpZHgsIGlkeCkKCQkJCQlsb2NhbCBjaGFyYWN0ZXJfZnJhY3Rpb24gPSBpZHggLyAjdGV4dF90b19kcmF3CgkJCQkJbG9jYWwgcjEsIGcxLCBiMSwgYTEgPSAxMjMsIDEyMywgMTIzLCAyNTUKCQkJCQlsb2NhbCBoaWdobGlnaHRfZGVsdGEgPSAoY2hhcmFjdGVyX2ZyYWN0aW9uIC0gaGlnaGxpZ2h0X2ZyYWN0aW9uKQoJCQkJCWlmIGhpZ2hsaWdodF9kZWx0YSA+PSAwIGFuZCBoaWdobGlnaHRfZGVsdGEgPD0gMS40IHRoZW4KCQkJCQkJaWYgaGlnaGxpZ2h0X2RlbHRhID4gMC43IHRoZW4KCQkJCQkJICAgaGlnaGxpZ2h0X2RlbHRhID0gMS40IC0gaGlnaGxpZ2h0X2RlbHRhCgkJCQkJCWVuZAoJCQkJCQlsb2NhbCByX2ZyYWN0aW9uLCBnX2ZyYWN0aW9uLCBiX2ZyYWN0aW9uLCBhX2ZyYWN0aW9uID0gcjIgLSByMSwgZzIgLSBnMSwgYjIgLSBiMQoJCQkJCQlyMSA9IHIxICsgcl9mcmFjdGlvbiAqIGhpZ2hsaWdodF9kZWx0YSAvIDAuOAoJCQkJCQlnMSA9IGcxICsgZ19mcmFjdGlvbiAqIGhpZ2hsaWdodF9kZWx0YSAvIDAuOAoJCQkJCQliMSA9IGIxICsgYl9mcmFjdGlvbiAqIGhpZ2hsaWdodF9kZWx0YSAvIDAuOAoJCQkJCWVuZAoJCQkJCW91dHB1dCA9IG91dHB1dCAuLiAoJ1xhJTAyeCUwMnglMDJ4JTAyeCVzJyk6Zm9ybWF0KHIxLCBnMSwgYjEsIDI1NSwgdGV4dF90b19kcmF3OnN1YihpZHgsIGlkeCkpCiAgICAgICAgICAgICAgICAgICAgdWkuc2V0KHoubWVudS5sYWJlbCwgei5wcmVmaXgueDpmb3JtYXQob3V0cHV0KSkKCQkJCWVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQsCiAgICAgICAgcmVzZXRtZW51ID0gZnVuY3Rpb24oKQoJCQlsb2NhbCBhYXRibCA9IHouaXRlbXMuYWEKCQkJdWkuc2V0KGFhdGJsLmVuYWJsZWRbMV0sIHRydWUpCgkJCXVpLnNldChhYXRibC5yb2xsWzFdLCAwKQoJCQl1aS5zZXQoYWF0YmwuZWRnZVsxXSwgZmFsc2UpCgkJCXVpLnNldChhYXRibC5mc2JvZHlbMV0sIGZhbHNlKQoJCQl1aS5zZXQoYWF0YmwueWF3WzFdLCAiMTgwIikKCQkJdWkuc2V0KGFhdGJsLnBpdGNoWzFdLCAibWluaW1hbCIpCgkJCXVpLnNldChhYXRibC5iYXNlWzFdLCAiYXQgdGFyZ2V0cyIpCgkJCXVpLnNldChhYXRibC5mc1syXSwgImFsd2F5cyBvbiIpCgkJCXVpLnNldChhYXRibC5mc1sxXSwgIiIpCgkJCXVpLnNldChhYXRibC5ib2R5WzFdLCAib3Bwb3NpdGUiKQoJCQl1aS5zZXQoYWF0YmwuYm9keVsyXSwgMCkKCQkJdWkuc2V0KGFhdGJsLmppdHRlclsxXSwgIm9mZiIpCgkJCXVpLnNldChhYXRibC5qaXR0ZXJbMl0sIDApCgkJCXVpLnNldChhYXRibC55YXdbMl0sIDApCiAgICAgICAgICAgIGZvciBpbmRleCwgdmFsdWUgaW4gbmV4dCwgei5pdGVtcy5hYSBkbwogICAgICAgICAgICAgICAgZm9yIGksIHYgaW4gbmV4dCwgdmFsdWUgZG8KICAgICAgICAgICAgICAgICAgICB1aS5zZXRfdmlzaWJsZSh2LCB0cnVlKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgfQoJbG9jYWwgZGF0YSA9IHsKCQl0aWNrYm9vbCA9IGZhbHNlLAoJCWNob2tlYm9vbCA9IGZhbHNlLAoJCXRpbWVyYm9vbCA9IGZhbHNlLAoJCWppdHRlcmJvb2wgPSBmYWxzZSwKCQljdXN0b21ib29sID0gZmFsc2UsCgkJYXV0b2Jvb2wgPSBmYWxzZSwKCQlvZmZlbnNpdmVib29sID0gZmFsc2UsCgkJaml0dGVybGlzdCA9IHt9LAoJCWppdHRlcnNpemUgPSB7fSwKCQlmYWtlbGlzdCA9IHt9LAoJCWN1c3RvbWxvZyA9IHt9LAoJCWZha2VjYWNoZSA9ICIiLAoJCWNhY2hleWF3ID0gMCwKCQlkb3VibGV0YXAgPSAwLAoJCWxhc3QgPSAwCgl9Cglsb2NhbCBkZWxheXMgPSB7CgkJY2hva2VkID0gMCwKCQltb3VzZTEgPSAwLAoJCWR0ID0gMCwKCQlkdDIgPSAwLAoJfQoJbG9jYWwgYWEgPSB7CgkJaml0dGVyID0gMCwKCQl5YXcgPSAwCgl9Cgl6LmNhbl9kZXN5bmMgPSBmdW5jdGlvbihjbWQpCgkJbG9jYWwgbG9jYWxwbGF5ZXIgPSBlbnRpdHkuZ2V0X2xvY2FsX3BsYXllcigpCgkJaWYgKGVudGl0eS5nZXRfcHJvcChsb2NhbHBsYXllciwgIm1fTW92ZVR5cGUiKSBvciAwKSA9PSA5IHRoZW4KCQkJcmV0dXJuIGZhbHNlCgkJZW5kLS0gTy5HIEwuRS5BLksuUwoJCWxvY2FsIGdldF93cG4gPSBlbnRpdHkuZ2V0X3BsYXllcl93ZWFwb24obG9jYWxwbGF5ZXIpCgkJaWYgZ2V0X3dwbiA9PSBuaWwgdGhlbiByZXR1cm4gZmFsc2UgZW5kCgkJbG9jYWwgd2VhcG9uID0gZW50aXR5LmdldF9jbGFzc25hbWUoZ2V0X3dwbikKCQlsb2NhbCBpbl91c2UgPSBjbWQuaW5fdXNlID09IDEKCQlsb2NhbCBhdHRhY2sxID0gY21kLmluX2F0dGFjayA9PSAxCgkJbG9jYWwgYXR0YWNrMiA9IGNtZC5pbl9hdHRhY2syID09IDEKCQlpZiBpbl91c2UgdGhlbiByZXR1cm4gZW5kCgkJaWYgYXR0YWNrMSBvciBhdHRhY2syIHRoZW4KCQkJaWYgd2VhcG9uOmZpbmQoIkdyZW5hZGUiKSB0aGVuCgkJCQlkZWxheXMubW91c2UxID0gZ2xvYmFsc19jdXJ0aW1lKCkgKyAwLjE1CgkJCWVuZAoJCWVuZAoJCWlmIGRlbGF5cy5tb3VzZTEgPiBnbG9iYWxzLmN1cnRpbWUoKSB0aGVuIHJldHVybiBmYWxzZSBlbmQKCQlpZiBhdHRhY2sxIHRoZW4KCQkJbG9jYWwgd2VhcG9uID0gZW50aXR5LmdldF9wbGF5ZXJfd2VhcG9uKGxvY2FscGxheWVyKQoJCQlpZiB3ZWFwb24gPT0gbmlsIHRoZW4gcmV0dXJuIGZhbHNlIGVuZAoJCQlsb2NhbCBwbGF5ZXJfd2VhcG9uID0gZW50aXR5LmdldF9jbGFzc25hbWUod2VhcG9uKQoJCQlpZiBhdHRhY2syIHRoZW4KCQkJCXJldHVybiBmYWxzZQoJCQllbmQKCQkJcmV0dXJuIGZhbHNlCgkJZW5kCgkJcmV0dXJuIHRydWUKCWVuZAoJei5nZXRfY2hva2UgPSBmdW5jdGlvbihjbWQpCgkJbG9jYWwgZmFrZWxhZyA9IHVpLmdldChsaW1pdGZsKQoJCWxvY2FsIGNoZWNrX2Zha2VsYWcgPSBmYWtlbGFnICUgMiA9PSAxCgkJaWYgY2hlY2tfZmFrZWxhZyBhbmQgZmFrZWxhZyA+IDEgdGhlbgoJCQl1aS5zZXQobGltaXRmbCwgZmFrZWxhZy0xKQoJCWVuZAoJCWxvY2FsIGNob2tlZCA9IGNtZC5jaG9rZWRjb21tYW5kcwoJCWxvY2FsIGNoZWNrX2Nob2tlID0gY2hva2VkICUgMiA9PSAwCgkJbG9jYWwgZHRfb24gPSAodWkuZ2V0KHouaXRlbXMua2V5cy5kdFsxXSkgYW5kIHVpLmdldCh6Lml0ZW1zLmtleXMuZHRbMl0pKQoJCWxvY2FsIGhzX29uID0gKHVpLmdldCh6Lml0ZW1zLmtleXMuaHNbMV0pIGFuZCB1aS5nZXQoei5pdGVtcy5rZXlzLmhzWzJdKSkKCQlsb2NhbCBmZF9vbiA9IHVpLmdldCh6Lml0ZW1zLmtleXMuZmRbMV0pCgkJbG9jYWwgeHYsIHl2LCB6diA9IGVudGl0eS5nZXRfcHJvcChlbnRpdHkuZ2V0X2xvY2FsX3BsYXllcigpLCAibV92ZWNWZWxvY2l0eSIpCgkJbG9jYWwgdmVsID0gbWF0aC5zcXJ0KHh2Knh2ICsgeXYqeXYgKyB6dip6dikKCQlpZiBkdF9vbiB0aGVuCgkJCWlmIGRlbGF5cy5jaG9rZWQgPiAyIHRoZW4KCQkJCWlmIGNtZC5jaG9rZWRjb21tYW5kcyA+PSAwIHRoZW4KCQkJCQljaGVja19jaG9rZSA9IGZhbHNlCgkJCQllbmQKCQkJZW5kCgkJZW5kCgkJZGVsYXlzLmNob2tlZCA9IGNtZC5jaG9rZWRjb21tYW5kcwoJCWlmIGRlbGF5cy5kdCB+PSBkdF9vbiB0aGVuCgkJCWRlbGF5cy5kdDIgPSBnbG9iYWxzLmN1cnRpbWUoKSArIDAuMjUKCQllbmQKCQlpZiBub3QgZHRfb24gYW5kIG5vdCBoc19vbiBhbmQgbm90IGNtZC5ub19jaG9rZSBvciBmZF9vbiB0aGVuCgkJCWlmIG5vdCBjaGVja19mYWtlbGFnIHRoZW4KCQkJCWlmIGRlbGF5cy5kdDIgPiBnbG9iYWxzLmN1cnRpbWUoKSB0aGVuCgkJCQkJaWYgY21kLmNob2tlZGNvbW1hbmRzID49IDAgYW5kIGNtZC5jaG9rZWRjb21tYW5kcyA8IGZha2VsYWcgdGhlbgoJCQkJCQljaGVja19jaG9rZSA9IGNob2tlZCAlIDIgPT0gMAoJCQkJCWVsc2UKCQkJCQkJY2hlY2tfY2hva2UgPSBjaG9rZWQgJSAyID09IDEKCQkJCQllbmQKCQkJCWVsc2UKCQkJCQljaGVja19jaG9rZSA9IGNob2tlZCAlIDIgPT0gMQoJCQkJZW5kCgkJCWVuZAoJCWVuZAoJCWRlbGF5cy5kdCA9IGR0X29uCgkJcmV0dXJuIGNoZWNrX2Nob2tlCgllbmQKCWxvY2FsIGRpc3RhbmNlID0gZnVuY3Rpb24oeDEseTEsejEseDIseTIsejIpCgkJcmV0dXJuIG1hdGguc3FydCgoeDEgLSB4MikgKiAoeDEgLSB4MikgKyAoeTEgLSB5MikgKiAoeTEgLSB5MikpCgllbmQKCWxvY2FsIGV4dHJhcG9sYXRlID0gZnVuY3Rpb24ocGxheWVyLCB0aWNrcywgeCx5LHopCgkJbG9jYWwgeHYsIHl2LCB6diA9ICBlbnRpdHkuZ2V0X3Byb3AocGxheWVyLCAibV92ZWNWZWxvY2l0eSIpCgkJbG9jYWwgbmV3X3ggPSB4ICsgZ2xvYmFscy50aWNraW50ZXJ2YWwoKSAqIHh2ICogdGlja3MKCQlsb2NhbCBuZXdfeSA9IHkgKyBnbG9iYWxzLnRpY2tpbnRlcnZhbCgpICogeXYgKiB0aWNrcwoJCWxvY2FsIG5ld196ID0geiArIGdsb2JhbHMudGlja2ludGVydmFsKCkgKiB6diAqIHRpY2tzCgkJcmV0dXJuIG5ld194LCBuZXdfeSwgbmV3X3oKCWVuZAogICAgei5hYSA9IHsKCQl5YXdoYW5kbGVyID0gZnVuY3Rpb24oeWF3Ym9keSwgbm9jaG9rZSwgbGVmdCwgcmlnaHQpCgkJCWxvY2FsIHJlc3VsdCA9IG5pbAoJCQlpZiBub2Nob2tlIHRoZW4KCQkJCXJlc3VsdCA9ICh5YXdib2R5ID4gMCBhbmQgbGVmdCBvciByaWdodCkKCQkJZW5kCgkJCXJldHVybiByZXN1bHQKCQllbmQsCiAgICAgICAgYnVpbGRlciA9IGZ1bmN0aW9uKGFyZykKCQkJdWkuc2V0KHouaXRlbXMua2V5cy5tb2RlLCAiZGVmZW5zaXZlIikKICAgICAgICAgICAgbG9jYWwgbXlzZWxmID0gZW50aXR5LmdldF9sb2NhbF9wbGF5ZXIoKQoJCQlsb2NhbCBhaXIgPSBiaXQuYmFuZChlbnRpdHkuZ2V0X3Byb3AobXlzZWxmLCAibV9mRmxhZ3MiKSwgMSkgPT0gMAogICAgICAgICAgICBsb2NhbCB4diwgeXYsIHp2ID0gZW50aXR5LmdldF9wcm9wKG15c2VsZiwgIm1fdmVjVmVsb2NpdHkiKQoJCQlsb2NhbCBkdWNrID0gKGVudGl0eS5nZXRfcHJvcChteXNlbGYsICJtX2ZsRHVja0Ftb3VudCIpID4gMC4xKSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtLSBPLkcgTC5FLkEuSy5TCiAgICAgICAgICAgIGxvY2FsIHN0YXRlID0gei5nZXRzdGF0ZShteXNlbGYsIGFyZy5pbl9qdW1wID09IDEgb3IgYWlyLCBkdWNrLCBtYXRoLnNxcnQoeHYqeHYgKyB5dip5diArIHp2Knp2KSwgZmFrZWxhZywgKHVpLmdldChzbG93KSBhbmQgdWkuZ2V0KGtleSkpKQoJCQlsb2NhbCBjYWNoZSA9ICh1aS5nZXQoei5tZW51WyJBbnRpIEFpbSJdLmN1c3RvbVtzdGF0ZV0uZGVzeW5jKSA9PSAiRGVmYXVsdCIgYW5kICJidWlsZGVyIiBvciBzdHJpbmcubG93ZXIodWkuZ2V0KHoubWVudVsiQW50aSBBaW0iXS5jdXN0b21bc3RhdGVdLmRlc3luYykpKQoJCQlsb2NhbCBmaXggPSBzdGF0ZQogICAgICAgICAgICBsb2NhbCB0ZWFtID0gZW50aXR5LmdldF9wcm9wKG15c2VsZiwgIm1faVRlYW1OdW0iKQogICAgICAgICAgICBpZiB0ZWFtID09IDIgdGhlbgogICAgICAgICAgICAgICAgZml4ID0gZml4IC4uICIgVCIKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgZml4ID0gZml4IC4uICIgQ1QiCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBpZiBub3Qgei5jb250YWlucyh1aS5nZXQoei5tZW51WyJBbnRpIEFpbSJdW2NhY2hlXVsoY2FjaGUgPT0gImJ1aWxkZXIiIGFuZCBmaXggb3Igc3RhdGUpXS5lbmFibGUpLCAiRW5hYmxlZCIpIHRoZW4KCQkJCWNhY2hlID0gKHVpLmdldCh6Lm1lbnVbIkFudGkgQWltIl0uY3VzdG9tWyJHbG9iYWwiXS5kZXN5bmMpID09ICJEZWZhdWx0IiBhbmQgImJ1aWxkZXIiIG9yIHN0cmluZy5sb3dlcih1aS5nZXQoei5tZW51WyJBbnRpIEFpbSJdLmN1c3RvbVsiR2xvYmFsIl0uZGVzeW5jKSkpCgkJCQlpZiBjYWNoZSA9PSAiYnVpbGRlciIgdGhlbgoJCQkJCWZpeCA9ICh0ZWFtID09IDIgYW5kICJHbG9iYWwgVCIgb3IgIkdsb2JhbCBDVCIpCgkJCQllbHNlCgkJCQkJc3RhdGUgPSAiR2xvYmFsIgoJCQkJZW5kCgkJCWVuZCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0tIE8uRyBMLkUuQS5LLlMKCQkJbG9jYWwgdGlja2NvdW50ID0gZ2xvYmFscy50aWNrY291bnQoKQoJCQlsb2NhbCBlbmVteSA9IGNsaWVudC5jdXJyZW50X3RocmVhdCgpCgkJCWlmIGVuZW15ID09IG5pbCB0aGVuCgkJCQllbmVteSA9IG15c2VsZgoJCQllbmQKCQkJbG9jYWwgZGVmZW5zaXZlID0gKHouZGVmZW5zaXZlLmRlZmVuc2l2ZSA+IDEgYW5kIHouZGVmZW5zaXZlLmRlZmVuc2l2ZSA8IDE0KQoJCQlsb2NhbCBtZW51dGJsID0gei5tZW51WyJBbnRpIEFpbSJdW2NhY2hlXVsoY2FjaGUgPT0gImJ1aWxkZXIiIGFuZCBmaXggb3Igc3RhdGUpXQoJCQlsb2NhbCBhYXRibCA9IHouaXRlbXMuYWEKCQkJdWkuc2V0KGFhdGJsLmVuYWJsZWRbMV0sIHRydWUpCgkJCXVpLnNldChhYXRibC5yb2xsWzFdLCAwKQoJCQl1aS5zZXQoYWF0YmwuZWRnZVsxXSwgZmFsc2UpCgkJCXVpLnNldChhYXRibC5mc2JvZHlbMV0sIGZhbHNlKQoJCQl1aS5zZXQoYWF0YmwueWF3WzFdLCAiMTgwIikKCQkJdWkuc2V0KGFhdGJsLnBpdGNoWzFdLCAibWluaW1hbCIpCgkJCXVpLnNldChhYXRibC5iYXNlWzFdLCBzY3JpcHQuY2FjaGUubWFudWFsLmFhID09IDAgYW5kICJhdCB0YXJnZXRzIiBvciAibG9jYWwgdmlldyIpCgkJCXVpLnNldChhYXRibC5mc1syXSwgImFsd2F5cyBvbiIpCgkJCWlmIHNjcmlwdC5jYWNoZS5tYW51YWwuYWEgfj0gMCBhbmQgei5jb250YWlucyh1aS5nZXQobWVudXRibC5vcHRpb25zKSwgIlByaW9yaXRpemUgbWFudWFsIikgdGhlbgoJCQkJdWkuc2V0KGFhdGJsLmZzWzFdLCAiIikJCgkJCWVuZAoJCQlpZiB6LmNvbnRhaW5zKHVpLmdldCh6Lm1lbnVbIk1pc2MiXS5kaXNhYmxlciksICJBaXIiKSBhbmQgKGFpciBvciBhcmcuaW5fanVtcCA9PSAxKSB0aGVuCgkJCQl1aS5zZXQoYWF0YmwuZnNbMV0sICIiKQkKCQkJZW5kCgkJCWlmIHouY29udGFpbnModWkuZ2V0KHoubWVudVsiTWlzYyJdLmRpc2FibGVyKSwgIkR1Y2siKSBhbmQgZHVjayB0aGVuCgkJCQl1aS5zZXQoYWF0YmwuZnNbMV0sICIiKQkKCQkJZW5kCgkJCWlmIHouY29udGFpbnModWkuZ2V0KHoubWVudVsiTWlzYyJdLmRpc2FibGVyKSwgIlNsb3ciKSBhbmQgKHVpLmdldChzbG93KSBhbmQgdWkuZ2V0KGtleSkpIHRoZW4KCQkJCXVpLnNldChhYXRibC5mc1sxXSwgIiIpCgkJCWVuZAoJCQlpZiB1aS5nZXQoei5tZW51WyJNaXNjIl0uaGlkZXNob3QpIHRoZW4KCQkJCWlmICh1aS5nZXQoei5pdGVtcy5rZXlzLmhzWzFdKSBhbmQgdWkuZ2V0KHouaXRlbXMua2V5cy5oc1syXSkpIGFuZCBub3QgdWkuZ2V0KHouaXRlbXMua2V5cy5mZFsxXSkgdGhlbgoJCQkJCXVpLnNldChsaW1pdGZsLCAxKQoJCQkJZWxzZQoJCQkJCXVpLnNldChsaW1pdGZsLCAxNCkKCQkJCWVuZAoJCQllbmQKCQkJaWYgdWkuZ2V0KHoubWVudVsiTWlzYyJdLmJhY2tzdGFiKSB0aGVuCgkJCQlsb2NhbCB3ZWFwb24gPSBlbnRpdHkuZ2V0X3BsYXllcl93ZWFwb24oZW5lbXkpCgkJCQlpZiBteXNlbGYgfj0gZW5lbXkgYW5kIG15c2VsZiB+PSBuaWwgYW5kIHdlYXBvbiB+PSBuaWwgYW5kIGVudGl0eS5nZXRfY2xhc3NuYW1lKHdlYXBvbikgPT0gIkNLbmlmZSIgdGhlbgoJCQkJCWxvY2FsIGV4LGV5LGV6ID0gZW50aXR5LmdldF9vcmlnaW4oZW5lbXkpCgkJCQkJbG9jYWwgbHgsbHksbHogPSBlbnRpdHkuZ2V0X29yaWdpbihteXNlbGYpCgkJCQkJaWYgZXggfj0gbmlsIGFuZCBseCB+PSBuaWwgdGhlbiAKCQkJCQkJZm9yIHRpY2tzID0gMSw5IGRvCgkJCQkJCQlsb2NhbCB0ZXgsdGV5LHRleiA9IGV4dHJhcG9sYXRlKG15c2VsZix0aWNrcyxseCxseSxseikKCQkJCQkJCWxvY2FsIGRpc3RhbmNlID0gZGlzdGFuY2UoZXgsZXksZXosdGV4LHRleSx0ZXopCgkJCQkJCQlpZiBtYXRoLmFicyhkaXN0YW5jZSkgPCAxNjkgdGhlbgoJCQkJCQkJCXVpLnNldChhYXRibC5ib2R5WzFdLCAiaml0dGVyIikKCQkJCQkJCQl1aS5zZXQoYWF0YmwuYm9keVsyXSwgMCkKCQkJCQkJCQl1aS5zZXQoYWF0Ymwuaml0dGVyWzFdLCAiY2VudGVyIikKCQkJCQkJCQl1aS5zZXQoYWF0Ymwuaml0dGVyWzJdLCA2OSkKCQkJCQkJCQl1aS5zZXQoYWF0YmwueWF3WzJdLCAxODApCgkJCQkJCQkJcmV0dXJuCgkJCQkJCQllbmQKCQkJCQkJZW5kCgkJCQkJZW5kCgkJCQllbmQKCQkJZW5kCgkJCWlmIGNhY2hlID09ICJidWlsZGVyIiB0aGVuCgkJCQlsb2NhbCB5YXdfYm9keSA9IG1hdGgubWF4KC02MCwgbWF0aC5taW4oNjAsIG1hdGguZmxvb3IoKGVudGl0eS5nZXRfcHJvcChteXNlbGYsIm1fZmxQb3NlUGFyYW1ldGVyIiwxMSkgb3IgMCkqMTIwLTYwKzAuNSkpKQoJCQkJaWYgeWF3X2JvZHkgPiAwIGFuZCB5YXdfYm9keSA+IDYwIHRoZW4geWF3X2JvZHkgPSA2MCBlbmQKCQkJCWlmIHlhd19ib2R5IDwgMCBhbmQgeWF3X2JvZHkgPCAtNjAgdGhlbiB5YXdfYm9keSA9IC02MCBlbmQKCQkJCWxvY2FsIHlhd2ZpeCA9IDAKCQkJCWlmIHVpLmdldChtZW51dGJsLnlhd21vZGUpID09ICJDdXN0b21pemUiIHRoZW4KCQkJCQl5YXdmaXggPSB1aS5nZXQobWVudXRibC55YXcpCgkJCQllbmQKCQkJCWlmIHVpLmdldChtZW51dGJsLnlhd21vZGUpID09ICJMZWZ0IGFuZCByaWdodCIgb3IgdWkuZ2V0KG1lbnV0YmwueWF3bW9kZSkgPT0gIkN1c3RvbWl6ZSArIGwgJiByIiB0aGVuCgkJCQkJaWYgdWkuZ2V0KG1lbnV0YmwubGVmdHJpZ2h0KSA9PSAiQWR2YW5jZWQiIHRoZW4KCQkJCQkJeWF3Zml4ID0gei5hYS55YXdoYW5kbGVyKHlhd19ib2R5LCBhcmcuY2hva2VkY29tbWFuZHMgfj0gMCwgdWkuZ2V0KG1lbnV0YmwueWF3bGVmdCksIHVpLmdldChtZW51dGJsLnlhd3JpZ2h0KSkKCQkJCQllbHNlCgkJCQkJCWlmIHVpLmdldChtZW51dGJsLmxlZnRyaWdodCkgPT0gIlNpbXBsZSIgdGhlbgoJCQkJCQkJaWYgYXJnLmNob2tlZGNvbW1hbmRzIH49IDAgdGhlbgoJCQkJCQkJCXlhd2ZpeCA9ICh5YXdfYm9keSA+IDAgYW5kIHVpLmdldChtZW51dGJsLnlhd2xlZnQpIG9yIHVpLmdldChtZW51dGJsLnlhd3JpZ2h0KSkKCQkJCQkJCWVuZAoJCQkJCQllbHNlCgkJCQkJCQlpZiBhcmcuY2hva2VkY29tbWFuZHMgPT0gMCB0aGVuCgkJCQkJCQkJbG9jYWwgZGVsdGEgPSBlbnRpdHkuZ2V0X3Byb3AobXlzZWxmLCAibV9mbFBvc2VQYXJhbWV0ZXIiLCAxMSkgKiAxMjAgLSA2MAoJCQkJCQkJCXlhd2ZpeCA9IChkZWx0YSA+IDAgYW5kIHVpLmdldChtZW51dGJsLnlhd2xlZnQpIG9yIHVpLmdldChtZW51dGJsLnlhd3JpZ2h0KSkKCQkJCQkJCWVsc2UKCQkJCQkJCQl5YXdmaXggPSBuaWwKCQkJCQkJCWVuZAoJCQkJCQllbmQKCQkJCQllbmQgICAgIC0tIE8uRyBMLkUuQS5LLlMKCQkJCQlpZiB1aS5nZXQobWVudXRibC55YXdtb2RlKSA9PSAiQ3VzdG9taXplICsgbCAmIHIiIGFuZCB5YXdmaXggfj0gbmlsIHRoZW4KCQkJCQkJeWF3Zml4ID0geWF3Zml4ICsgdWkuZ2V0KG1lbnV0YmwueWF3KQoJCQkJCWVuZAoJCQkJZW5kCgkJCQlpZiB5YXdmaXggfj0gbmlsIHRoZW4KCQkJCQl1aS5zZXQoYWF0YmwueWF3WzJdLCB6LmNsYW1wKHlhd2ZpeCArIHNjcmlwdC5jYWNoZS5tYW51YWwuYWEpKQoJCQkJCWRhdGEuY2FjaGV5YXcgPSB5YXdmaXgKCQkJCWVuZAoJCQkJdWkuc2V0KGFhdGJsLmppdHRlclsxXSwgdWkuZ2V0KG1lbnV0Ymwuaml0dGVyeWF3KSA9PSAiT2ZmIiBhbmQgIm9mZiIgb3IgImNlbnRlciIpCgkJCQlpZiB1aS5nZXQobWVudXRibC5qaXR0ZXJ5YXcpID09ICJDZW50ZXIiIHRoZW4KCQkJCQl1aS5zZXQoYWF0Ymwuaml0dGVyWzJdLCB1aS5nZXQobWVudXRibC5qaXR0ZXIpKQoJCQkJZW5kCgkJCQlpZiB1aS5nZXQobWVudXRibC5qaXR0ZXJ5YXcpID09ICJSYW5kb20gY2VudGVyIiB0aGVuCgkJCQkJdWkuc2V0KGFhdGJsLmppdHRlclsyXSwgY2xpZW50LnJhbmRvbV9pbnQodWkuZ2V0KG1lbnV0Ymwuaml0dGVycmFuZG9tKSwgdWkuZ2V0KG1lbnV0Ymwuaml0dGVycmFuZG9tKSt1aS5nZXQobWVudXRibC5qaXR0ZXJybmQpKSkKCQkJCWVuZAoJCQkJaWYgdWkuZ2V0KG1lbnV0Ymwuaml0dGVyeWF3KSA9PSAiTGVmdCByaWdodCIgdGhlbgoJCQkJCWlmIGFyZy5jaG9rZWRjb21tYW5kcyA9PSAwIHRoZW4KCQkJCQkJZGF0YS5qaXR0ZXJib29sID0gbm90IGRhdGEuaml0dGVyYm9vbAoJCQkJCQl1aS5zZXQoYWF0Ymwuaml0dGVyWzJdLCAoZGF0YS5qaXR0ZXJib29sIGFuZCB1aS5nZXQobWVudXRibC5qaXR0ZXIpIG9yIHVpLmdldChtZW51dGJsLmppdHRlcmxyKSkpCgkJCQkJZW5kCgkJCQllbmQKCQkJCWlmIGRhdGEuZmFrZWNhY2hlIH49IHVpLmdldChtZW51dGJsLmppdHRlcnlhdykgdGhlbgoJCQkJCWRhdGEuZmFrZWNhY2hlID0gdWkuZ2V0KG1lbnV0Ymwuaml0dGVyeWF3KQoJCQkJCWRhdGEuaml0dGVybGlzdCA9IHt9CgkJCQllbmQKCQkJCWlmIHVpLmdldChtZW51dGJsLmppdHRlcnlhdykgPT0gIkF1dG9tYXRpYyBiaWciIHRoZW4KCQkJCQlpZiBkYXRhLmppdHRlcmxpc3RbZW5lbXldID09IG5pbCB0aGVuCgkJCQkJCWlmIGRhdGEuaml0dGVyc2l6ZVtlbmVteV0gPT0gbmlsIHRoZW4KCQkJCQkJCWRhdGEuaml0dGVybGlzdFtlbmVteV0gPSBjbGllbnQucmFuZG9tX2ludCg1OSw3OSkKCQkJCQkJZWxzZQoJCQkJCQkJaWYgZGF0YS5qaXR0ZXJzaXplW2VuZW15XSA9PSAiYmlnIiB0aGVuCgkJCQkJCQkJZGF0YS5qaXR0ZXJsaXN0W2VuZW15XSA9IGNsaWVudC5yYW5kb21faW50KDU5LDY5KQoJCQkJCQkJZWxzZQoJCQkJCQkJCWRhdGEuaml0dGVybGlzdFtlbmVteV0gPSBjbGllbnQucmFuZG9tX2ludCg3MCw3OSkgICAgIC0tIE8uRyBMLkUuQS5LLlMKCQkJCQkJCWVuZAoJCQkJCQllbmQKCQkJCQkJZGF0YS5qaXR0ZXJzaXplW2VuZW15XSA9IGRhdGEuaml0dGVybGlzdFtlbmVteV0gPiA2OSBhbmQgImJpZyIgb3IgInNtYWxsIgoJCQkJCQlwcmludCgiaml0dGVyOiB7IiwgZGF0YS5qaXR0ZXJzaXplW2VuZW15XSwgIn0gWyIsIChlbmVteSA9PSBteXNlbGYgYW5kICIiIG9yIHN0cmluZy5sb3dlcihlbnRpdHkuZ2V0X3BsYXllcl9uYW1lKGVuZW15KSkpLCAiXSAoIiwgZGF0YS5qaXR0ZXJsaXN0W2VuZW15XSwgIikiKQoJCQkJCWVuZAoJCQkJCXVpLnNldChhYXRibC5qaXR0ZXJbMl0sIGRhdGEuaml0dGVybGlzdFtlbmVteV0pCgkJCQllbmQKCQkJCWlmIHVpLmdldChtZW51dGJsLmppdHRlcnlhdykgPT0gIkF1dG9tYXRpYyBzbWFsbCIgdGhlbgoJCQkJCWlmIGRhdGEuaml0dGVybGlzdFtlbmVteV0gPT0gbmlsIHRoZW4KCQkJCQkJaWYgZGF0YS5qaXR0ZXJzaXplW2VuZW15XSA9PSBuaWwgdGhlbgoJCQkJCQkJZGF0YS5qaXR0ZXJsaXN0W2VuZW15XSA9IGNsaWVudC5yYW5kb21faW50KDM5LDU5KQoJCQkJCQllbHNlCgkJCQkJCQlpZiBkYXRhLmppdHRlcnNpemVbZW5lbXldID09ICJiaWciIHRoZW4KCQkJCQkJCQlkYXRhLmppdHRlcmxpc3RbZW5lbXldID0gY2xpZW50LnJhbmRvbV9pbnQoMzksNDkpCgkJCQkJCQllbHNlCgkJCQkJCQkJZGF0YS5qaXR0ZXJsaXN0W2VuZW15XSA9IGNsaWVudC5yYW5kb21faW50KDUwLDU5KQoJCQkJCQkJZW5kCgkJCQkJCWVuZAoJCQkJCQlkYXRhLmppdHRlcnNpemVbZW5lbXldID0gZGF0YS5qaXR0ZXJsaXN0W2VuZW15XSA+IDQ5IGFuZCAiYmlnIiBvciAic21hbGwiCgkJCQkJCXByaW50KCJqaXR0ZXI6IHsiLCBkYXRhLmppdHRlcnNpemVbZW5lbXldLCAifSBbIiwgKGVuZW15ID09IG15c2VsZiBhbmQgIiIgb3Igc3RyaW5nLmxvd2VyKGVudGl0eS5nZXRfcGxheWVyX25hbWUoZW5lbXkpKSksICJdICgiLCBkYXRhLmppdHRlcmxpc3RbZW5lbXldLCAiKSIpCgkJCQkJZW5kCgkJCQkJdWkuc2V0KGFhdGJsLmppdHRlclsyXSwgZGF0YS5qaXR0ZXJsaXN0W2VuZW15XSkKCQkJCWVuZAoJCQkJaWYgdWkuZ2V0KG1lbnV0YmwuZmFrZXlhdykgPT0gIkRlZmF1bHQgc2tlZXQiIHRoZW4KCQkJCQl1aS5zZXQoYWF0YmwuYm9keVsxXSwgdWkuZ2V0KG1lbnV0YmwuYm9keW1vZGUpKQoJCQkJCXVpLnNldChhYXRibC5ib2R5WzJdLCB1aS5nZXQobWVudXRibC5ib2R5eWF3KSkKCQkJCWVuZAoJCQkJaWYgdWkuZ2V0KG1lbnV0YmwuZmFrZXlhdykgPT0gIlJhbmRvbSBza2VldCBmYWtlIiB0aGVuCgkJCQkJdWkuc2V0KGFhdGJsLmJvZHlbMV0sICJqaXR0ZXIiKQoJCQkJCXVpLnNldChhYXRibC5ib2R5WzJdLCAwKQoJCQkJZW5kCgkJCQlpZiB1aS5nZXQobWVudXRibC5mYWtleWF3KSA9PSAiQXV0b21hdGljIGZha2UiIHRoZW4KCQkJCQlpZiBkYXRhLmZha2VsaXN0W2VuZW15XSA9PSBuaWwgdGhlbgoJCQkJCQlkYXRhLmZha2VsaXN0W2VuZW15XSA9IGNsaWVudC5yYW5kb21faW50KDI5LDU5KQoJCQkJCQlwcmludCgiZmFrZTogKCIsIGRhdGEuZmFrZWxpc3RbZW5lbXldLCAiKSBbIiwgKGVuZW15ID09IG15c2VsZiBhbmQgIiIgb3Igc3RyaW5nLmxvd2VyKGVudGl0eS5nZXRfcGxheWVyX25hbWUoZW5lbXkpKSksICJdIikKCQkJCQllbmQKCQkJCQl1aS5zZXQoYWF0YmwuYm9keVsxXSwgImppdHRlciIpCgkJCQkJdWkuc2V0KGFhdGJsLmJvZHlbMl0sIDApCgkJCQllbmQKCQkJCWlmIHouY29udGFpbnModWkuZ2V0KG1lbnV0Ymwub3B0aW9ucyksICJTdGF0aWMgZnJlZXN0YW5kaW5nIikgYW5kICh1aS5nZXQoei5tZW51WyJLZXliaW5kcyJdLmZzKSBvciBzY3JpcHQuY2FjaGUubWFudWFsLmFhIH49IDApIHRoZW4KCQkJCQl1aS5zZXQoYWF0YmwuYm9keVsxXSwgIm9wcG9zaXRlIikKCQkJCQl1aS5zZXQoYWF0YmwuYm9keVsyXSwgMCkKCQkJCQl1aS5zZXQoYWF0Ymwuaml0dGVyWzFdLCAib2ZmIikKCQkJCQl1aS5zZXQoYWF0YmwueWF3WzJdLCBzY3JpcHQuY2FjaGUubWFudWFsLmFhKQoJCQkJZW5kCgkJCQlpZiB6LmNvbnRhaW5zKHVpLmdldChtZW51dGJsLm9wdGlvbnMpLCAiRGVmZW5zaXZlIikgdGhlbgoJCQkJCWlmIHouY29udGFpbnModWkuZ2V0KG1lbnV0YmwuZGVmZW5zaXZlKSwgIlBpdGNoIHVwIikgYW5kIGRlZmVuc2l2ZSB0aGVuIC0tIE8uRyBMLkUuQS5LLlMKCQkJCQkJdWkuc2V0KGFhdGJsLnBpdGNoWzFdLCAidXAiKQoJCQkJCWVuZAoJCQkJCWlmIHouY29udGFpbnModWkuZ2V0KG1lbnV0YmwuZGVmZW5zaXZlKSwgIlJhbmRvbSB5YXciKSBhbmQgZGVmZW5zaXZlIHRoZW4KCQkJCQkJbG9jYWwgcmFuZG9teWF3ID0gY2xpZW50LnJhbmRvbV9pbnQoNjksMTY5KQoJCQkJCQl1aS5zZXQoYWF0YmwueWF3WzJdLCB6LmNsYW1wKCh0aWNrY291bnQgJSA2IDwgMyBhbmQgcmFuZG9teWF3IG9yIC1yYW5kb215YXcpICsgc2NyaXB0LmNhY2hlLm1hbnVhbC5hYSkpCgkJCQkJZW5kCgkJCQkJaWYgei5jb250YWlucyh1aS5nZXQobWVudXRibC5kZWZlbnNpdmUpLCAiU3dpdGNoIGN5Y2xlIikgdGhlbgoJCQkJCQlpZiB0aWNrY291bnQgJSAzID09IDEgdGhlbgoJCQkJCQkJdWkuc2V0KHouaXRlbXMua2V5cy5tb2RlLCAib2ZmZW5zaXZlIikKCQkJCQkJZW5kCgkJCQkJCWFyZy5mb3JjZV9kZWZlbnNpdmUgPSB0aWNrY291bnQgJSAzIH49IDEKCQkJCQllbmQKCQkJCQlpZiB6LmNvbnRhaW5zKHVpLmdldChtZW51dGJsLmRlZmVuc2l2ZSksICJBbHdheXMgb24iKSB0aGVuCgkJCQkJCWFyZy5mb3JjZV9kZWZlbnNpdmUgPSB0cnVlCgkJCQkJZW5kCgkJCQllbmQKCQkJCWlmIHouY29udGFpbnModWkuZ2V0KG1lbnV0Ymwub3B0aW9ucyksICJIZWlnaHQgbm8gZGVzeW5jIikgYW5kIChlbmVteSB+PSBteXNlbGYgYW5kIGhlaWdodChlbmVteSkgYW5kIChlbnRpdHkuZ2V0X3Byb3AobXlzZWxmLCAibV9pSGVhbHRoIikgPiA5OSkpIGFuZCBzY3JpcHQuY2FjaGUubWFudWFsLmFhID09IDAgYW5kIG5vdCB1aS5nZXQoei5tZW51WyJLZXliaW5kcyJdLmZzKSB0aGVuCgkJCQkJcmV0dXJuIG5vZGVzeW5jKGFhdGJsKQoJCQkJZW5kCgkJCWVsc2UKCQkJCWlmIG1lbnV0YmwueWF3b3B0aW9ucyB+PSBuaWwgdGhlbgoJCQkJCWlmIHouY29udGFpbnModWkuZ2V0KG1lbnV0YmwueWF3b3B0aW9ucyksICJIZWlnaHQgbm8gZGVzeW5jIikgYW5kIChlbmVteSB+PSBteXNlbGYgYW5kIGhlaWdodChlbmVteSkgYW5kIChlbnRpdHkuZ2V0X3Byb3AobXlzZWxmLCAibV9pSGVhbHRoIikgPiA5OSkpIGFuZCBzY3JpcHQuY2FjaGUubWFudWFsLmFhID09IDAgYW5kIG5vdCB1aS5nZXQoei5tZW51WyJLZXliaW5kcyJdLmZzKSB0aGVuCgkJCQkJCXJldHVybiBub2Rlc3luYyhhYXRibCkKCQkJCQllbmQKCQkJCWVuZAoJCQkJbG9jYWwgbXl0ZWFtID0gImN0IgoJCQkJaWYgdGVhbSA9PSAyIHRoZW4KCQkJCQlteXRlYW0gPSAidCIKCQkJCWVuZAoJCQkJbG9jYWwgeWF3bGVmdCA9IHVpLmdldChtZW51dGJsW215dGVhbSAuLiAieWF3bGVmdCJdKQoJCQkJbG9jYWwgeWF3cmlnaHQgPSB1aS5nZXQobWVudXRibFtteXRlYW0gLi4gInlhd3JpZ2h0Il0pCgkJCQlpZiB1aS5nZXQobWVudXRibC55YXdvcHRpb24pID09ICJMZWZ0IHJpZ2h0IChGUzogWWVzKSIgdGhlbgoJCQkJCXVpLnNldChhYXRibC5ib2R5WzFdLCAic3RhdGljIikKCQkJCQl1aS5zZXQoYWF0YmwuYm9keVsyXSwgMCkKCQkJCQl1aS5zZXQoYWF0Ymwuaml0dGVyWzFdLCAib2ZmIikKCQkJCQl1aS5zZXQoYWF0Ymwuaml0dGVyWzJdLCAwKQoJCQkJCWFyZy5hbGxvd19zZW5kX3BhY2tldCA9IGZhbHNlCgkJCQkJaWYgYXJnLmNob2tlZGNvbW1hbmRzID09IDEgdGhlbgoJCQkJCQlkYXRhLmN1c3RvbWJvb2wgPSBub3QgZGF0YS5jdXN0b21ib29sCgkJCQkJCXVpLnNldChhYXRibC55YXdbMl0sIHouY2xhbXAoKGRhdGEuY3VzdG9tYm9vbCBhbmQgeWF3cmlnaHQgb3IgeWF3bGVmdCkgK3NjcmlwdC5jYWNoZS5tYW51YWwuYWEpKQoJCQkJCWVsc2UKCQkJCQkJdWkuc2V0KGFhdGJsLnlhd1syXSwgei5jbGFtcCgoZGF0YS5jdXN0b21ib29sIGFuZCB5YXdyaWdodCBvciB5YXdsZWZ0KSArIHNjcmlwdC5jYWNoZS5tYW51YWwuYWEpKQoJCQkJCWVuZAoJCQkJCWlmIHouY29udGFpbnModWkuZ2V0KG1lbnV0Ymwub3B0aW9ucyksICJQaXRjaCB1cCIpIGFuZCBkZWZlbnNpdmUgdGhlbgoJCQkJCQl1aS5zZXQoYWF0YmwucGl0Y2hbMV0sICJ1cCIpCgkJCQkJZW5kCgkJCQkJaWYgei5jb250YWlucyh1aS5nZXQobWVudXRibC5vcHRpb25zKSwgIlJhbmRvbSB5YXciKSBhbmQgZGVmZW5zaXZlIHRoZW4KCQkJCQkJbG9jYWwgcmFuZG9teWF3ID0gY2xpZW50LnJhbmRvbV9pbnQoNjksMTY5KQoJCQkJCQl1aS5zZXQoYWF0YmwueWF3WzJdLCB6LmNsYW1wKCh0aWNrY291bnQgJSA2IDwgMyBhbmQgcmFuZG9teWF3IG9yIC1yYW5kb215YXcpICsgc2NyaXB0LmNhY2hlLm1hbnVhbC5hYSkpCgkJCQkJZW5kCgkJCQkJaWYgei5jb250YWlucyh1aS5nZXQobWVudXRibC5vcHRpb25zKSwgIkFsd2F5cyBvbiIpIHRoZW4KCQkJCQkJYXJnLmZvcmNlX2RlZmVuc2l2ZSA9IHRydWUKCQkJCQllbmQKCQkJCQlpZiB6LmNvbnRhaW5zKHVpLmdldChtZW51dGJsLm9wdGlvbnMpLCAiT2ZmZW5zaXZlIikgdGhlbgoJCQkJCQlkYXRhLmRvdWJsZXRhcCA9IChkYXRhLmxhc3Qgfj0gMSBvciB6LmRlZmVuc2l2ZS5kZWZlbnNpdmUgfj0gMSkKCQkJCQkJZGF0YS5sYXN0ID0gei5kZWZlbnNpdmUuZGVmZW5zaXZlCgkJCQkJCWxvY2FsIHRpY2tiYXNlID0gZW50aXR5LmdldF9wcm9wKG15c2VsZiwgIm1fblRpY2tCYXNlIikKCQkJCQkJdWkuc2V0KHouaXRlbXMua2V5cy5tb2RlLCAib2ZmZW5zaXZlIikKCQkJCQkJaWYgdGlja2Jhc2UgJSA3ID09IDAgdGhlbgoJCQkJCQkJZGF0YS5vZmZlbnNpdmVib29sID0gbm90IGRhdGEub2ZmZW5zaXZlYm9vbAoJCQkJCQkJdWkuc2V0KGFhdGJsLmJvZHlbMV0sICJvZmYiKQoJCQkJCQkJdWkuc2V0KGFhdGJsLnlhd1syXSwgei5jbGFtcCgoeWF3bGVmdCoyKSArIHNjcmlwdC5jYWNoZS5tYW51YWwuYWEpKQoJCQkJCQllbHNlCgkJCQkJCQlpZiBub3QgKGRhdGEubGFzdCA+IDIgYW5kIGRhdGEubGFzdCA8IDE0KSB0aGVuCgkJCQkJCQkJdWkuc2V0KGFhdGJsLmJvZHlbMV0sIGRhdGEuZG91YmxldGFwIGFuZCAiaml0dGVyIiBvciAic3RhdGljIikKCQkJCQkJCQl1aS5zZXQoYWF0YmwueWF3WzJdLCB6LmNsYW1wKChkYXRhLmRvdWJsZXRhcCBhbmQgLXlhd3JpZ2h0IG9yICgtKHlhd3JpZ2h0LzIpKSkgKyBzY3JpcHQuY2FjaGUubWFudWFsLmFhKSkKCQkJCQkJCWVuZAoJCQkJCQllbmQKCQkJCQkJYXJnLmZvcmNlX2RlZmVuc2l2ZSA9IGRhdGEuZG91YmxldGFwIGFuZCB0aWNrYmFzZSAlIDMgfj0gMQoJCQkJCQl1aS5zZXQoYWF0YmwuYm9keVsyXSwgZGF0YS5kb3VibGV0YXAgYW5kIDAgb3IgKGRhdGEub2ZmZW5zaXZlYm9vbCBhbmQgLTE2OSBvciAxNjkpKQoJCQkJCWVuZAoJCQkJZWxzZQoJCQkJCXVpLnNldChhYXRibC5lbmFibGVkWzFdLCBmYWxzZSkKCQkJCQlsb2NhbCBlbnRzID0gZW50aXR5LmdldF9wbGF5ZXJzKHRydWUpCgkJCQkJZm9yIGk9MSwgI2VudHMgZG8KCQkJCQkJbG9jYWwgY3VycmVudCA9IGVudHNbaV0KCQkJCQkJaWYgY3VycmVudCB+PSBuaWwgYW5kIHBsYXllciB+PSBteXNlbGYgdGhlbgoJCQkJCQkJaWYgZW50aXR5LmlzX2VuZW15KGN1cnJlbnQpIHRoZW4KCQkJCQkJCQlpZiBkYXRhLmN1c3RvbWxvZ1tjdXJyZW50XSA9PSBuaWwgdGhlbgoJCQkJCQkJCQlkYXRhLmN1c3RvbWxvZ1tjdXJyZW50XSA9IHsKCQkJCQkJCQkJCWlkeCA9IGN1cnJlbnQsCgkJCQkJCQkJCQl5YXcgPSB7bGVmdCA9IDAsIHJpZ2h0ID0gMH0sCgkJCQkJCQkJCQlmYWtlID0ge2Zha2UgPSAwLCBsYnkgPSAwfSwKCQkJCQkJCQkJCXNob3VsZF91cGRhdGUgPSB0cnVlLAoJCQkJCQkJCQl9CgkJCQkJCQkJCWZvciBpLCB4IGluIG5leHQsIGRhdGEuY3VzdG9tbG9nIGRvCgkJCQkJCQkJCQlsb2NhbCBocCA9IGVudGl0eS5nZXRfcHJvcCh4LmlkeCwgIm1faUhlYWx0aCIpCgkJCQkJCQkJCQlsb2NhbCB0ZWFtID0gZW50aXR5LmdldF9wcm9wKHguaWR4LCAibV9pVGVhbU51bSIpCgkJCQkJCQkJCQlpZiBocCA9PSBuaWwgb3IgdGVhbSA9PSBuaWwgdGhlbgoJCQkJCQkJCQkJCXRhYmxlLnJlbW92ZShkYXRhLmN1c3RvbWxvZywgaikKCQkJCQkJCQkJCWVsc2UKCQkJCQkJCQkJCQlpZiB0ZWFtID09IGVudGl0eS5nZXRfcHJvcChtZSwgIm1faVRlYW1OdW0iKSB0aGVuCgkJCQkJCQkJCQkJCXRhYmxlLnJlbW92ZShkYXRhLmN1c3RvbWxvZywgaSkKCQkJCQkJCQkJCQllbmQKCQkJCQkJCQkJCWVuZAoJCQkJCQkJCQllbmQKCQkJCQkJCQllbmQKCQkJCQkJCWVuZAoJCQkJCQllbmQKCQkJCQllbmQKCQkJCQlsb2NhbCB2YWx1ZXMgPSB7IC0yMywgNDMsIDEyMCwgLTEyMCwgdHJ1ZSB9CgkJCQkJbG9jYWwgYXV0b3lhdyA9IHVpLmdldChtZW51dGJsLnlhd2F1dG8pID09ICJEZWZhdWx0IgoJCQkJCWlmIHVpLmdldChtZW51dGJsLnlhd29wdGlvbikgPT0gIkxlZnQgcmlnaHQgKEZTOiBObykiIHRoZW4KCQkJCQkJYXV0b3lhdyA9IHRydWUKCQkJCQkJdmFsdWVzID0geyB5YXdyaWdodCwgeWF3bGVmdCwgMTIwLCAtMTIwLCB0cnVlIH0KCQkJCQllbHNlCgkJCQkJCWlmIGF1dG95YXcgdGhlbgoJCQkJCQkJaWYgdGFnZXQgfj0gbXlzZWxmIGFuZCBkYXRhLmN1c3RvbWxvZ1tlbmVteV0gdGhlbgoJCQkJCQkJCWlmIGRhdGEuY3VzdG9tbG9nW2VuZW15XS5zaG91bGRfdXBkYXRlIHRoZW4KCQkJCQkJCQkJaWYgZGF0YS5jdXN0b21sb2dbZW5lbXldLnlhdyA9PSBuaWwgdGhlbiBkYXRhLmN1c3RvbWxvZ1tlbmVteV0ueWF3ID0ge2xlZnQgPSAwLCByaWdodCA9IDB9IGVuZAoJCQkJCQkJCQlkYXRhLmN1c3RvbWxvZ1tlbmVteV0ueWF3LmxlZnQgPSBjbGllbnQucmFuZG9tX2ludCgtMjgsIC0yMikKCQkJCQkJCQkJZGF0YS5jdXN0b21sb2dbZW5lbXldLnlhdy5yaWdodCA9IG1hdGguYWJzKGRhdGEuY3VzdG9tbG9nW2VuZW15XS55YXcubGVmdCkgKyBjbGllbnQucmFuZG9tX2ludCgxMCwgMTUpICsgNQoJCQkJCQkJCQlkYXRhLmN1c3RvbWxvZ1tlbmVteV0uZmFrZS5mYWtlID0gY2xpZW50LnJhbmRvbV9pbnQoNjUsIDEyMSkKCQkJCQkJCQkJZGF0YS5jdXN0b21sb2dbZW5lbXldLmZha2UubGJ5ID0gLWRhdGEuY3VzdG9tbG9nW2VuZW15XS5mYWtlLmZha2UgLSA1CgkJCQkJCQkJCWRhdGEuY3VzdG9tbG9nW2VuZW15XS5zaG91bGRfdXBkYXRlID0gZmFsc2UKCQkJCQkJCQkJcHJpbnQoImF1dG9tYXRpYzogIiAuLiBzdHJpbmcubG93ZXIoZW50aXR5LmdldF9wbGF5ZXJfbmFtZShkYXRhLmN1c3RvbWxvZ1tlbmVteV0uaWR4KSksICIgIiwganNvbi5zdHJpbmdpZnkoZGF0YS5jdXN0b21sb2dbZW5lbXldLnlhdykpCgkJCQkJCQkJZW5kCgkJCQkJCQkJdmFsdWVzID0geyBkYXRhLmN1c3RvbWxvZ1tlbmVteV0ueWF3LmxlZnQsIGRhdGEuY3VzdG9tbG9nW2VuZW15XS55YXcucmlnaHQsIGRhdGEuY3VzdG9tbG9nW2VuZW15XS5mYWtlLmZha2UsIGRhdGEuY3VzdG9tbG9nW2VuZW15XS5mYWtlLmxieSwgdHJ1ZSB9CgkJCQkJCQllbmQKCQkJCQkJZW5kCgkJCQkJZW5kCgkJCQkJaWYgYXV0b3lhdyB0aGVuCgkJCQkJCWxvY2FsIF8sIHlhdyA9IGNsaWVudC5jYW1lcmFfYW5nbGVzKCkKCQkJCQkJeWF3ID0geWF3ICsgMTgwCgkJCQkJCWlmIGVuZW15IH49IG15c2VsZiBhbmQgc2NyaXB0LmNhY2hlLm1hbnVhbC5hYSA9PSAwIHRoZW4KCQkJCQkJCWxvY2FsIGV5ZXBvcyA9IHZlY3RvcihjbGllbnQuZXllX3Bvc2l0aW9uKCkpCgkJCQkJCQlsb2NhbCBvcmlnaW4gPSB2ZWN0b3IoZW50aXR5LmdldF9vcmlnaW4oZW5lbXkpKQoJCQkJCQkJbG9jYWwgdGFyZ2V0ID0gb3JpZ2luICsgdmVjdG9yKDAsIDAsIDQwKQoJCQkJCQkJXywgeWF3ID0gZXllcG9zOnRvKHRhcmdldCk6YW5nbGVzKCkKCQkJCQkJCXlhdyA9IHlhdyArIDE4MAoJCQkJCQllbmQKCQkJCQkJbG9jYWwgaHNfb24gPSAodWkuZ2V0KHouaXRlbXMua2V5cy5oc1sxXSkgYW5kIHVpLmdldCh6Lml0ZW1zLmtleXMuaHNbMl0pKQoJCQkJCQlpZiBub3QgaHNfb24gdGhlbgoJCQkJCQkJYXJnLmFsbG93X3NlbmRfcGFja2V0ID0gZmFsc2UKCQkJCQkJZW5kCgkJCQkJCWlmIChiaXQuYmFuZChlbnRpdHkuZ2V0X3Byb3AobXlzZWxmLCAibV9mRmxhZ3MiKSwgYml0LmxzaGlmdCgxLCAwKSkgPT0gMSkgdGhlbgoJCQkJCQkJaWYgbm90IChhcmcuaW5fZm9yd2FyZCA9PSAxIG9yIGFyZy5pbl9tb3ZlbGVmdCA9PSAxIG9yIGFyZy5pbl9tb3ZlcmlnaHQgPT0gMSBvciBhcmcuaW5fYmFjayA9PSAxKSB0aGVuCgkJCQkJCQkJbG9jYWwgYW1vdW50ID0gKGVudGl0eS5nZXRfcHJvcChteXNlbGYsICJtX2ZsRHVja0Ftb3VudCIpID4gMC43KSBhbmQgMy4yNSBvciAxLjEKCQkJCQkJCQlpZiBtYXRoLmZsb29yKG1hdGguc3FydCh4dip4diArIHl2Knl2ICsgenYqenYpKSA8IDEuMSB0aGVuCgkJCQkJCQkJCWFyZy5zaWRlbW92ZSA9IChnbG9iYWxzLnRpY2tjb3VudCgpICUgMiA9PSAwKSBhbmQgYW1vdW50IG9yIC1hbW91bnQKCQkJCQkJCQllbmQKCQkJCQkJCWVuZAoJCQkJCQllbmQKCQkJCQkJaWYgei5jYW5fZGVzeW5jKGFyZykgdGhlbgoJCQkJCQkJaWYgei5nZXRfY2hva2UoYXJnKSB0aGVuCgkJCQkJCQkJaWYgaHNfb24gdGhlbgoJCQkJCQkJCQlhcmcuYWxsb3dfc2VuZF9wYWNrZXQgPSBmYWxzZQoJCQkJCQkJCWVuZAoJCQkJCQkJCWFhLmppdHRlciA9IG5vdCBhYS5qaXR0ZXIKCQkJCQkJCQlpZiBhYS5qaXR0ZXIgdGhlbgoJCQkJCQkJCQlhYS55YXcgPSB2YWx1ZXNbM10KCQkJCQkJCQllbHNlCgkJCQkJCQkJCWFhLnlhdyA9IHZhbHVlc1s0XQoJCQkJCQkJCWVuZAoJCQkJCQkJZWxzZQoJCQkJCQkJCWlmIGFhLmppdHRlciB0aGVuCgkJCQkJCQkJCWFhLnlhdyA9IHZhbHVlc1sxXQoJCQkJCQkJCWVsc2UKCQkJCQkJCQkJYWEueWF3ID0gdmFsdWVzWzJdCgkJCQkJCQkJZW5kCgkJCQkJCQllbmQKCQkJCQkJCWFyZy55YXcgPSB5YXcgKyBhYS55YXcgKyBzY3JpcHQuY2FjaGUubWFudWFsLmFhCgkJCQkJCQlhcmcucGl0Y2ggPSA5MAoJCQkJCQllbmQKCQkJCQkJaWYgei5jb250YWlucyh1aS5nZXQobWVudXRibC5vcHRpb25zKSwgIlBpdGNoIHVwIikgYW5kIGRlZmVuc2l2ZSB0aGVuCgkJCQkJCQlhcmcucGl0Y2ggPSAtOTAKCQkJCQkJZW5kCgkJCQkJCWlmIHouY29udGFpbnModWkuZ2V0KG1lbnV0Ymwub3B0aW9ucyksICJSYW5kb20geWF3IikgYW5kIGRlZmVuc2l2ZSB0aGVuCgkJCQkJCQlsb2NhbCByYW5kb215YXcgPSBjbGllbnQucmFuZG9tX2ludCg2OSwxNjkpCgkJCQkJCQlhcmcueWF3ID0gKHRpY2tjb3VudCAlIDYgPCAzIGFuZCByYW5kb215YXcgb3IgLXJhbmRvbXlhdykKCQkJCQkJZW5kCgkJCQkJCWlmIHouY29udGFpbnModWkuZ2V0KG1lbnV0Ymwub3B0aW9ucyksICJPZmZlbnNpdmUiKSB0aGVuCgkJCQkJCQlpZiB0aWNrY291bnQgJSAzID09IDEgdGhlbgoJCQkJCQkJCXVpLnNldCh6Lml0ZW1zLmtleXMubW9kZVsyXSwgIm9mZmVuc2l2ZSIpCgkJCQkJCQllbmQKCQkJCQkJCWFyZy5mb3JjZV9kZWZlbnNpdmUgPSB0aWNrY291bnQgJSA1IH49IDEKCQkJCQkJZW5kCgkJCQkJCWlmIHouY29udGFpbnModWkuZ2V0KG1lbnV0Ymwub3B0aW9ucyksICJBbHdheXMgb24iKSB0aGVuCgkJCQkJCQlhcmcuZm9yY2VfZGVmZW5zaXZlID0gdHJ1ZQoJCQkJCQllbmQKCQkJCQllbHNlCgkJCQkJCXVpLnNldChhYXRibC5lbmFibGVkWzFdLCB0cnVlKQoJCQkJCQl1aS5zZXQoYWF0Ymwucm9sbFsxXSwgMCkKCQkJCQkJdWkuc2V0KGFhdGJsLmVkZ2VbMV0sIGZhbHNlKQoJCQkJCQl1aS5zZXQoYWF0YmwuZnNib2R5WzFdLCB0cnVlKQoJCQkJCQl1aS5zZXQoYWF0YmwueWF3WzFdLCAiMTgwIikKCQkJCQkJdWkuc2V0KGFhdGJsLnBpdGNoWzFdLCAibWluaW1hbCIpCgkJCQkJCXVpLnNldChhYXRibC5iYXNlWzFdLCBzY3JpcHQuY2FjaGUubWFudWFsLmFhID09IDAgYW5kICJhdCB0YXJnZXRzIiBvciAibG9jYWwgdmlldyIpCgkJCQkJCXVpLnNldChhYXRibC5mc1syXSwgImFsd2F5cyBvbiIpCgkJCQkJCXVpLnNldChhYXRibC5mc1sxXSwgIiIpCgkJCQkJCXVpLnNldChhYXRibC5ib2R5WzFdLCAib3Bwb3NpdGUiKQoJCQkJCQl1aS5zZXQoYWF0YmwuYm9keVsyXSwgMCkKCQkJCQkJdWkuc2V0KGFhdGJsLmppdHRlclsxXSwgIm9mZiIpCgkJCQkJCXVpLnNldChhYXRibC5qaXR0ZXJbMl0sIDApCgkJCQkJCXVpLnNldChhYXRibC55YXdbMl0sIDApCgkJCQkJCWlmIGRlc3luY2Z1bmMobXlzZWxmLCBhcmcsIG1hdGguc3FydCh4dip4diArIHl2Knl2ICsgenYqenYpKSB0aGVuCgkJCQkJCQlsb2NhbCBhbmdsZSA9ICh7Y2xpZW50LmNhbWVyYV9hbmdsZXMoKX0pWzJdCgkJCQkJCQlsb2NhbCBqdW5rID0gMAoJCQkJCQkJaWYgZW5lbXkgfj0gbmlsIGFuZCBlbmVteSB+PSBteXNlbGYgYW5kIHNjcmlwdC5jYWNoZS5tYW51YWwuYWEgPT0gMCB0aGVuCgkJCQkJCQkJbG9jYWwgZXllcG9zID0gdmVjdG9yKGNsaWVudC5leWVfcG9zaXRpb24oKSkKCQkJCQkJCQlsb2NhbCBvcmlnaW4gPSB2ZWN0b3IoZW50aXR5LmdldF9vcmlnaW4oZW5lbXkpKQoJCQkJCQkJCWxvY2FsIHRhcmdldCA9IG9yaWdpbiArIHZlY3RvcigwLCAwLCA0MCkKCQkJCQkJCQlqdW5rLCBhbmdsZSA9IGV5ZXBvczp0byh0YXJnZXQpOmFuZ2xlcygpCgkJCQkJCQllbmQKCQkJCQkJCWFuZ2xlID0gYW5nbGUgKyAxODAgKyBzY3JpcHQuY2FjaGUubWFudWFsLmFhCgkJCQkJCQlsb2NhbCBkZXN5bmMgPSAoYXJnLmNob2tlZGNvbW1hbmRzICUgMiA9PSAwKQoJCQkJCQkJaWYgYXJnLmNob2tlZGNvbW1hbmRzID4gMSB0aGVuCgkJCQkJCQkJZGVzeW5jID0gKGFyZy5jaG9rZWRjb21tYW5kcyAlIDMgPT0gMSkKCQkJCQkJCWVuZAoJCQkJCQkJaWYgbG9naWNbZW5lbXldID09IG5pbCB0aGVuCgkJCQkJCQkJbG9naWNbZW5lbXldID0gewoJCQkJCQkJCQl5YXcgPSBjbGllbnQucmFuZG9tX2ludCgzMCw1MCksCgkJCQkJCQkJCWRlc3luYyA9IGNsaWVudC5yYW5kb21faW50KDkwLDEyMCksCgkJCQkJCQkJCWFuZ2xlID0gY2xpZW50LnJhbmRvbV9pbnQoLTExLDExKQoJCQkJCQkJCX0KCQkJCQkJCWVuZAoJCQkJCQkJaWYgZGVzeW5jIHRoZW4KCQkJCQkJCQljdXN0b21qaXR0ZXIgPSBub3QgY3VzdG9taml0dGVyCgkJCQkJCQkJYXJnLmFsbG93X3NlbmRfcGFja2V0ID0gZmFsc2UKCQkJCQkJCQlhcmcueWF3ID0gKGN1c3RvbWppdHRlciBhbmQgbG9naWNbZW5lbXldWyJkZXN5bmMiXSBvciAtbG9naWNbZW5lbXldWyJkZXN5bmMiXSkKCQkJCQkJCWVsc2UKCQkJCQkJCQlsb2NhbCByZXN1bHQgPSBnZXRfdmFsdWUobG9naWNbZW5lbXldWyJ5YXciXSwgdWkuZ2V0KG1lbnV0YmwueWF3d2F5cykpCgkJCQkJCQkJaWYgcmVzdWx0ID09IG5pbCB0aGVuCgkJCQkJCQkJCXJlc3VsdCA9IGdldF92YWx1ZShsb2dpY1tlbmVteV1bInlhdyJdLCB1aS5nZXQobWVudXRibC55YXd3YXlzKSkKCQkJCQkJCQkJaWYgcmVzdWx0ID09IG5pbCB0aGVuCgkJCQkJCQkJCQlyZXN1bHQgPSBsb2dpY1tlbmVteV1bInlhdyJdCgkJCQkJCQkJCWVuZAoJCQkJCQkJCWVuZAoJCQkJCQkJCWlmIHouY29udGFpbnModWkuZ2V0KG1lbnV0Ymwub3B0aW9ucyksICJBbHdheXMgb24iKSB0aGVuCgkJCQkJCQkJCWFyZy5mb3JjZV9kZWZlbnNpdmUgPSB0cnVlCgkJCQkJCQkJZW5kCgkJCQkJCQkJaWYgYXJnLmNob2tlZGNvbW1hbmRzID4gMSB0aGVuCgkJCQkJCQkJCWFyZy5hbGxvd19zZW5kX3BhY2tldCA9IGZhbHNlCgkJCQkJCQkJZWxzZQoJCQkJCQkJCQlhcmcuYWxsb3dfc2VuZF9wYWNrZXQgPSB0cnVlCgkJCQkJCQkJZW5kCgkJCQkJCQkJYXJnLnlhdyA9IGFuZ2xlICsgcmVzdWx0ICsgbG9naWNbZW5lbXldWyJhbmdsZSJdCgkJCQkJCQllbmQKCQkJCQkJCWFyZy5waXRjaCA9IDg5CgkJCQkJCQlhcmcucm9sbCA9IDAKCQkJCQkJCWlmIHouY29udGFpbnModWkuZ2V0KG1lbnV0Ymwub3B0aW9ucyksICJQaXRjaCB1cCIpIGFuZCBkZWZlbnNpdmUgdGhlbgoJCQkJCQkJCWFyZy5waXRjaCA9IC04OQoJCQkJCQkJZW5kCgkJCQkJCQlpZiB6LmNvbnRhaW5zKHVpLmdldChtZW51dGJsLm9wdGlvbnMpLCAiUmFuZG9tIHlhdyIpIGFuZCBkZWZlbnNpdmUgdGhlbgoJCQkJCQkJCWxvY2FsIHJhbmRvbXlhdyA9IGNsaWVudC5yYW5kb21faW50KDY5LDE2OSkKCQkJCQkJCQlhcmcueWF3ID0gKHRpY2tjb3VudCAlIDYgPCAzIGFuZCByYW5kb215YXcgb3IgLXJhbmRvbXlhdykKCQkJCQkJCWVuZAoJCQkJCQkJaWYgei5jb250YWlucyh1aS5nZXQobWVudXRibC5vcHRpb25zKSwgIk9mZmVuc2l2ZSIpIHRoZW4KCQkJCQkJCQlpZiB0aWNrY291bnQgJSAzID09IDEgdGhlbgoJCQkJCQkJCQl1aS5zZXQoei5pdGVtcy5rZXlzLm1vZGVbMV0sICJvZmZlbnNpdmUiKQoJCQkJCQkJCWVuZAoJCQkJCQkJCWFyZy5mb3JjZV9kZWZlbnNpdmUgPSB0aWNrY291bnQgJSA1IH49IDEKCQkJCQkJCWVuZAoJCQkJCQllbmQKCQkJCQllbmQKCQkJCWVuZAoJCQllbmQKICAgICAgICBlbmQKICAgIH0KCXouYW50aWJmID0gewoJCWdldF9jYW1lcmFfcG9zID0gZnVuY3Rpb24oZW50aW5kZXgpCgkJCWxvY2FsIGVfeCwgZV95LCBlX3ogPSBlbnRpdHkuZ2V0X3Byb3AoZW50aW5kZXgsICJtX3ZlY09yaWdpbiIpCgkJCWlmIGVfeCA9PSBuaWwgdGhlbiByZXR1cm4gZW5kCgkJCWxvY2FsIF8sIF8sIG9mcyA9IGVudGl0eS5nZXRfcHJvcChlbnRpbmRleCwgIm1fdmVjVmlld09mZnNldCIpCgkJCWVfeiA9IGVfeiArIChvZnMgLSAoZW50aXR5LmdldF9wcm9wKGVudGluZGV4LCAibV9mbER1Y2tBbW91bnQiKSAqIDE2KSkKCQkJcmV0dXJuIGVfeCwgZV95LCBlX3oKCQllbmQsCgkJZmlyZWQgPSBmdW5jdGlvbih0YXJnZXQsIHNob290ZXIsIHNob3QpCgkJCWxvY2FsIHNob290ZXJfY2FtID0geyB6LmFudGliZi5nZXRfY2FtZXJhX3BvcyhzaG9vdGVyKSB9CgkJCWlmIHNob290ZXJfY2FtWzFdID09IG5pbCB0aGVuIHJldHVybiBlbmQKCQkJbG9jYWwgcGxheWVyX2hlYWQgPSB7IGVudGl0eS5oaXRib3hfcG9zaXRpb24odGFyZ2V0LCAwKSB9CgkJCWxvY2FsIHNob290ZXJfY2FtX3RvX2hlYWQgPSB7IAoJCQkJcGxheWVyX2hlYWRbMV0gLSBzaG9vdGVyX2NhbVsxXSwKCQkJCXBsYXllcl9oZWFkWzJdIC0gc2hvb3Rlcl9jYW1bMl0sCgkJCQlwbGF5ZXJfaGVhZFszXSAtIHNob290ZXJfY2FtWzNdIAoJCQl9CgkJCWxvY2FsIHNob290ZXJfY2FtX3RvX3Nob3QgPSB7IAoJCQkJc2hvdFsxXSAtIHNob290ZXJfY2FtWzFdLCAKCQkJCXNob3RbMl0gLSBzaG9vdGVyX2NhbVsyXSwKCQkJCXNob3RbM10gLSBzaG9vdGVyX2NhbVszXQoJCQl9CgkJCWxvY2FsIHR0ID0gKAoJCQkJKHNob290ZXJfY2FtX3RvX2hlYWRbMV0qc2hvb3Rlcl9jYW1fdG9fc2hvdFsxXSkgKyAKCQkJCShzaG9vdGVyX2NhbV90b19oZWFkWzJdKnNob290ZXJfY2FtX3RvX3Nob3RbMl0pICsgCgkJCQkoc2hvb3Rlcl9jYW1fdG9faGVhZFszXSpzaG9vdGVyX2NhbV90b19zaG90WzNdKQoJCQkpIC8gKAoJCQkJbWF0aC5wb3coc2hvb3Rlcl9jYW1fdG9fc2hvdFsxXSwgMikgKyAKCQkJCW1hdGgucG93KHNob290ZXJfY2FtX3RvX3Nob3RbMl0sIDIpICsgCgkJCQltYXRoLnBvdyhzaG9vdGVyX2NhbV90b19zaG90WzNdLCAyKQoJCQkpCgkJCWxvY2FsIGNsb3Nlc3QgPSB7IHNob290ZXJfY2FtWzFdICsgc2hvb3Rlcl9jYW1fdG9fc2hvdFsxXSp0dCwgc2hvb3Rlcl9jYW1bMl0gKyBzaG9vdGVyX2NhbV90b19zaG90WzJdKnR0LCBzaG9vdGVyX2NhbVszXSArIHNob290ZXJfY2FtX3RvX3Nob3RbM10qdHR9CgkJCWxvY2FsIGxlbmd0aCA9IG1hdGguYWJzKAoJCQkJbWF0aC5zcXJ0KAoJCQkJCW1hdGgucG93KChwbGF5ZXJfaGVhZFsxXS1jbG9zZXN0WzFdKSwgMikgKyAKCQkJCQltYXRoLnBvdygocGxheWVyX2hlYWRbMl0tY2xvc2VzdFsyXSksIDIpICsgCgkJCQkJbWF0aC5wb3coKHBsYXllcl9oZWFkWzNdLWNsb3Nlc3RbM10pLCAyKQoJCQkJKQoJCQkpCgkJCWxvY2FsIGZyYWNfc2hvdCwgdHJhY2VfaGl0ID0gY2xpZW50LnRyYWNlX2xpbmUoc2hvb3Rlciwgc2hvdFsxXSwgc2hvdFsyXSwgc2hvdFszXSwgcGxheWVyX2hlYWRbMV0sIHBsYXllcl9oZWFkWzJdLCBwbGF5ZXJfaGVhZFszXSkKCQkJbG9jYWwgZnJhY19maW5hbCwgdHJhY2VfaGl0ID0gY2xpZW50LnRyYWNlX2xpbmUodGFyZ2V0LCBjbG9zZXN0WzFdLCBjbG9zZXN0WzJdLCBjbG9zZXN0WzNdLCBwbGF5ZXJfaGVhZFsxXSwgcGxheWVyX2hlYWRbMl0sIHBsYXllcl9oZWFkWzNdKQoJCQlyZXR1cm4gKGxlbmd0aCA8IDE2OSkgYW5kIChmcmFjX3Nob3QgPiAwLjk5IG9yIGZyYWNfZmluYWwgPiAwLjk5KQoJCWVuZCwKCQlldmVudCA9IGZ1bmN0aW9uKGV2ZW50KQoJCQlsb2NhbCBscCA9IGVudGl0eS5nZXRfbG9jYWxfcGxheWVyKCkKCQkJaWYgbHAgPT0gbmlsIG9yIG5vdCBlbnRpdHkuaXNfYWxpdmUobHApIHRoZW4gcmV0dXJuIGVuZAoJCQlsb2NhbCBlbnRpbmRleCA9IGNsaWVudC51c2VyaWRfdG9fZW50aW5kZXgoZXZlbnQudXNlcmlkKQoJCQlpZiBlbnRpbmRleCA9PSBscCBvciBub3QgZW50aXR5LmlzX2VuZW15KGVudGluZGV4KSB0aGVuIHJldHVybiBlbmQKCQkJaWYgei5hbnRpYmYuZmlyZWQobHAsIGVudGluZGV4LCB7ZXZlbnQueCwgZXZlbnQueSwgZXZlbnQuen0pIHRoZW4KCQkJCWRhdGEuaml0dGVybGlzdFtlbnRpbmRleF0gPSBuaWwKCQkJCWRhdGEuZmFrZWxpc3RbZW50aW5kZXhdID0gbmlsCgkJCQlpZiBkYXRhLmN1c3RvbWxvZ1tlbnRpbmRleF0gPT0gbmlsIHRoZW4KCQkJCQlkYXRhLmN1c3RvbWxvZ1tlbnRpbmRleF0gPSB7CgkJCQkJCWlkeCA9IGVudGluZGV4LAoJCQkJCQl5YXcgPSB7bGVmdCA9IDAsIHJpZ2h0ID0gMH0sCgkJCQkJCWZha2UgPSB7ZmFrZSA9IDAsIGxieSA9IDB9LAoJCQkJCQlzaG91bGRfdXBkYXRlID0gdHJ1ZSwKCQkJCQl9CgkJCQllbHNlCgkJCQkJZGF0YS5jdXN0b21sb2dbZW50aW5kZXhdLnNob3VsZF91cGRhdGUgPSB0cnVlCgkJCQllbmQKCQkJZW5kCgkJZW5kCgl9Cgl6LmRlZmVuc2l2ZSA9IHsKCQljbWQgPSAwLAoJCWNoZWNrID0gMCwKCQlkZWZlbnNpdmUgPSAwLAoJCXJ1biA9IGZ1bmN0aW9uKGFyZykKCQkJei5kZWZlbnNpdmUuY21kID0gYXJnLmNvbW1hbmRfbnVtYmVyCgkJCWxhZGRlciA9IChlbnRpdHkuZ2V0X3Byb3AoeiwgIm1fTW92ZVR5cGUiKSA9PSA5KQoJCWVuZCwKCQlwcmVkaWN0ID0gZnVuY3Rpb24oYXJnKQoJCQlpZiBhcmcuY29tbWFuZF9udW1iZXIgPT0gei5kZWZlbnNpdmUuY21kIHRoZW4KCQkJCWxvY2FsIHRpY2tiYXNlID0gZW50aXR5LmdldF9wcm9wKGVudGl0eS5nZXRfbG9jYWxfcGxheWVyKCksICJtX25UaWNrQmFzZSIpCgkJCQl6LmRlZmVuc2l2ZS5kZWZlbnNpdmUgPSBtYXRoLmFicyh0aWNrYmFzZSAtIHouZGVmZW5zaXZlLmNoZWNrKQoJCQkJei5kZWZlbnNpdmUuY2hlY2sgPSBtYXRoLm1heCh0aWNrYmFzZSwgei5kZWZlbnNpdmUuY2hlY2sgb3IgMCkKCQkJCXouZGVmZW5zaXZlLmNtZCA9IDAKCQkJZW5kCgkJZW5kCgl9CgljbGllbnQuc2V0X2V2ZW50X2NhbGxiYWNrKCJsZXZlbF9pbml0IiwgZnVuY3Rpb24oKQoJCXouZGVmZW5zaXZlLmNoZWNrLCB6LmRlZmVuc2l2ZS5kZWZlbnNpdmUgPSAwLCAwCgllbmQpCglsb2NhbCBzY29wZV9maXggPSBmYWxzZQoJbG9jYWwgc2NvcGVfaW50ID0gMAoJbG9jYWwgc2hpZnRfaW50ID0gMAoJbG9jYWwgbGlzdF9zaGlmdCA9IChmdW5jdGlvbigpCgkJbG9jYWwgaW5kZXgsIG1heCA9IHsgfSwgMTYKCQlmb3IgaT0xLCBtYXggZG8KCQkJaW5kZXhbI2luZGV4KzFdID0gMAoJCQlpZiBpID09IG1heCB0aGVuCgkJCQlyZXR1cm4gaW5kZXgKCQkJZW5kCgkJZW5kCgllbmQpKCkKCXouZHRzaGlmdCA9IGZ1bmN0aW9uKCkKCQlsb2NhbCBsb2NhbF9wbGF5ZXIgPSBlbnRpdHkuZ2V0X2xvY2FsX3BsYXllcigpCgkJbG9jYWwgc2ltX3RpbWUgPSBlbnRpdHkuZ2V0X3Byb3AobG9jYWxfcGxheWVyLCAibV9mbFNpbXVsYXRpb25UaW1lIikKCQlpZiBsb2NhbF9wbGF5ZXIgPT0gbmlsIG9yIHNpbV90aW1lID09IG5pbCB0aGVuCgkJCXJldHVybgoJCWVuZAoJCWxvY2FsIHRpY2tfY291bnQgPSBnbG9iYWxzLnRpY2tjb3VudCgpCgkJbG9jYWwgc2hpZnRlZCA9IG1hdGgubWF4KHVucGFjayhsaXN0X3NoaWZ0KSkKCQlzaGlmdF9pbnQgPSBzaGlmdGVkIDwgMCBhbmQgbWF0aC5hYnMoc2hpZnRlZCkgb3IgMAoJCWxpc3Rfc2hpZnRbI2xpc3Rfc2hpZnQrMV0gPSBzaW1fdGltZS9nbG9iYWxzLnRpY2tpbnRlcnZhbCgpIC0gdGlja19jb3VudAoJCXRhYmxlLnJlbW92ZShsaXN0X3NoaWZ0LCAxKQoJZW5kCglsb2NhbCBhbmlta2V5cyA9IHsKCQlkdCA9IDAsCgkJZHVjayA9IDAsCgkJaGlkZSA9IDAsCgkJc2FmZSA9IDAsCgkJYmFpbSA9IDAsCgkJZnMgPSAwCgl9Cglsb2NhbCBncmFkaWVudCA9IGZ1bmN0aW9uKHIxLCBnMSwgYjEsIGExLCByMiwgZzIsIGIyLCBhMiwgdGV4dCkKCQlsb2NhbCBvdXRwdXQgPSAnJwoJCWxvY2FsIGxlbiA9ICN0ZXh0LTEKCQlsb2NhbCByaW5jID0gKHIyIC0gcjEpIC8gbGVuCgkJbG9jYWwgZ2luYyA9IChnMiAtIGcxKSAvIGxlbgoJCWxvY2FsIGJpbmMgPSAoYjIgLSBiMSkgLyBsZW4KCQlsb2NhbCBhaW5jID0gKGEyIC0gYTEpIC8gbGVuCgkJZm9yIGk9MSwgbGVuKzEgZG8KCQkJb3V0cHV0ID0gb3V0cHV0IC4uICgnXGElMDJ4JTAyeCUwMnglMDJ4JXMnKTpmb3JtYXQocjEsIGcxLCBiMSwgYTEsIHRleHQ6c3ViKGksIGkpKQoJCQlyMSA9IHIxICsgcmluYwoJCQlnMSA9IGcxICsgZ2luYwoJCQliMSA9IGIxICsgYmluYwoJCQlhMSA9IGExICsgYWluYwoJCWVuZAoJCXJldHVybiBvdXRwdXQKCWVuZAoJei5pbmRpY2F0b3IgPSBmdW5jdGlvbigpCgkJbG9jYWwgbWUgPSBlbnRpdHkuZ2V0X2xvY2FsX3BsYXllcigpCgkJaWYgbWUgPT0gbmlsIHRoZW4gcmV0dXJuIGVuZAoJCWxvY2FsIHJyLGdnLGJiID0gdWkuZ2V0KHoubWVudVsiVmlzdWFscyJdLmNvbG9yKQoJCWxvY2FsIHdpZHRoLCBoZWlnaHQgPSBjbGllbnQuc2NyZWVuX3NpemUoKQoJCWxvY2FsIHIyLCBnMiwgYjIsIGEyID0gNTUsNTUsNTUsMjU1CgkJbG9jYWwgaGlnaGxpZ2h0X2ZyYWN0aW9uID0gIChnbG9iYWxzLnJlYWx0aW1lKCkgLyAyICUgMS4yICogMikgLSAxLjIKCQlsb2NhbCBvdXRwdXQgPSAiIgoJCWxvY2FsIHRleHRfdG9fZHJhdyA9ICIgUyBFIE4gUyBFIgoJCWZvciBpZHggPSAxLCAjdGV4dF90b19kcmF3IGRvCgkJCWxvY2FsIGNoYXJhY3RlciA9IHRleHRfdG9fZHJhdzpzdWIoaWR4LCBpZHgpCgkJCWxvY2FsIGNoYXJhY3Rlcl9mcmFjdGlvbiA9IGlkeCAvICN0ZXh0X3RvX2RyYXcKCQkJbG9jYWwgcjEsIGcxLCBiMSwgYTEgPSAyNTUsIDI1NSwgMjU1LCAyNTUKCQkJbG9jYWwgaGlnaGxpZ2h0X2RlbHRhID0gKGNoYXJhY3Rlcl9mcmFjdGlvbiAtIGhpZ2hsaWdodF9mcmFjdGlvbikKCQkJaWYgaGlnaGxpZ2h0X2RlbHRhID49IDAgYW5kIGhpZ2hsaWdodF9kZWx0YSA8PSAxLjQgdGhlbgoJCQkJaWYgaGlnaGxpZ2h0X2RlbHRhID4gMC43IHRoZW4KCQkJCSAgIGhpZ2hsaWdodF9kZWx0YSA9IDEuNCAtIGhpZ2hsaWdodF9kZWx0YQoJCQkJZW5kCgkJCQlsb2NhbCByX2ZyYWN0aW9uLCBnX2ZyYWN0aW9uLCBiX2ZyYWN0aW9uLCBhX2ZyYWN0aW9uID0gcjIgLSByMSwgZzIgLSBnMSwgYjIgLSBiMQoJCQkJcjEgPSByMSArIHJfZnJhY3Rpb24gKiBoaWdobGlnaHRfZGVsdGEgLyAwLjgKCQkJCWcxID0gZzEgKyBnX2ZyYWN0aW9uICogaGlnaGxpZ2h0X2RlbHRhIC8gMC44CgkJCQliMSA9IGIxICsgYl9mcmFjdGlvbiAqIGhpZ2hsaWdodF9kZWx0YSAvIDAuOAoJCQllbmQKCQkJb3V0cHV0ID0gb3V0cHV0IC4uICgnXGElMDJ4JTAyeCUwMnglMDJ4JXMnKTpmb3JtYXQocjEsIGcxLCBiMSwgMjU1LCB0ZXh0X3RvX2RyYXc6c3ViKGlkeCwgaWR4KSkKCQllbmQKCQlvdXRwdXQgPSAiTCBVIEEiIC4uIG91dHB1dAoJCWlmIHVpLmdldCh6Lm1lbnVbIlZpc3VhbHMiXS5zcGFjZXMpIHRoZW4KCQkJb3V0cHV0ID0gb3V0cHV0OmdzdWIoIiAiLCAiIikKCQllbmQKCQlsb2NhbCBtZW51dGJsID0gei5tZW51WyJWaXN1YWxzIl0KCQlsb2NhbCByLGcsYixhID0gdWkuZ2V0KG1lbnV0YmwubHVhY29sb3IpCgkJcmVuZGVyZXIudGV4dCh3aWR0aCAtICh1aS5nZXQobWVudXRibC53YXRlcm1hcmspID09ICJSaWdodCIgYW5kIDU1IG9yICh3aWR0aC01NSkpLCBoZWlnaHQgLSA1NTUsIHIsZyxiLCAyNTUsICJjIiwgMCwgb3V0cHV0KQoJCXIsZyxiLGEgPSB1aS5nZXQobWVudXRibC5jb2xvcikKCQlsb2NhbCB3ID0gd2lkdGgvMgoJCWxvY2FsIGggPSBoZWlnaHQvMgoJCWxvY2FsIHRpY2sgPSBnbG9iYWxzLnRpY2tjb3VudCgpCgkJbWVudXRibCA9IHoubWVudVsiS2V5YmluZHMiXQogICAgICAgIHVpLnNldChtZW51dGJsLmxlZnQsICJvbiBob3RrZXkiKQogICAgICAgIHVpLnNldChtZW51dGJsLnJpZ2h0LCAib24gaG90a2V5IikKICAgICAgICBpZiB1aS5nZXQobWVudXRibC5sZWZ0KSBhbmQgKHNjcmlwdC5jYWNoZS5tYW51YWxbInRpY2siXSA8IHRpY2sgLSAxMSkgdGhlbgogICAgICAgICAgICBzY3JpcHQuY2FjaGUubWFudWFsWyJhYSJdID0gKHNjcmlwdC5jYWNoZS5tYW51YWxbImFhIl0gPT0gLTkwKSBhbmQgMCBvciAtOTAKICAgICAgICAgICAgc2NyaXB0LmNhY2hlLm1hbnVhbFsidGljayJdID0gdGljawogICAgICAgIGVuZAogICAgICAgIGlmIHVpLmdldChtZW51dGJsLnJpZ2h0KSBhbmQgKHNjcmlwdC5jYWNoZS5tYW51YWxbInRpY2siXSA8IHRpY2sgLSAxMSkgdGhlbgogICAgICAgICAgICBzY3JpcHQuY2FjaGUubWFudWFsWyJhYSJdID0gKHNjcmlwdC5jYWNoZS5tYW51YWxbImFhIl0gPT0gOTApIGFuZCAwIG9yIDkwCiAgICAgICAgICAgIHNjcmlwdC5jYWNoZS5tYW51YWxbInRpY2siXSA9IHRpY2sKICAgICAgICBlbmQKCQlpZiB1aS5nZXQobWVudXRibC5mb3J3YXJkKSBhbmQgKHNjcmlwdC5jYWNoZS5tYW51YWxbInRpY2siXSA8IHRpY2sgLSAxMSkgdGhlbgogICAgICAgICAgICBzY3JpcHQuY2FjaGUubWFudWFsWyJhYSJdID0gKHNjcmlwdC5jYWNoZS5tYW51YWxbImFhIl0gPT0gMTgwKSBhbmQgMCBvciAxODAKICAgICAgICAgICAgc2NyaXB0LmNhY2hlLm1hbnVhbFsidGljayJdID0gdGljawogICAgICAgIGVuZAoJCW1lbnV0YmwgPSB6Lm1lbnVbIlZpc3VhbHMiXQoJCWxvY2FsIGxpZmVzdGF0ZSA9IGVudGl0eS5nZXRfcHJvcChtZSwgIm1fbGlmZVN0YXRlIikgfj0gMAoJCWlmIGxpZmVzdGF0ZSBvciBub3QgdWkuZ2V0KG1lbnV0YmwuaW5kaWNhdG9yKSB0aGVuIHJldHVybiBlbmQKCQlpZiB1aS5nZXQobWVudXRibC5hcnJvd3MpIHRoZW4KCQkJbG9jYWwgcnJyLCBnZ2csIGJiYiwgYWFhID0gdWkuZ2V0KG1lbnV0Ymwua2V5Y29sb3IpCgkJCWxvY2FsIHJycnIsIGdnZ2csIGJiYmIgPSB1aS5nZXQobWVudXRibC5jb2xvcmtleSkKCQkJbG9jYWwgbGVmdGtleSA9ICI8IgoJCQlsb2NhbCByaWdodGtleSA9ICI+IgoJCQlsb2NhbCBmbGFnID0gdWkuZ2V0KG1lbnV0Ymwua2V5cykKCQkJaWYgZmxhZyA9PSAidHMiIHRoZW4KCQkJCWxlZnRrZXkgPSAi4q+HIgoJCQkJcmlnaHRrZXkgPSAi4q+IIgoJCQkJZmxhZyA9ICIrIgoJCQkJbG9jYWwgeWF3X2JvZHkgPSBtYXRoLm1heCgtNjAsIG1hdGgubWluKDYwLCBtYXRoLmZsb29yKChlbnRpdHkuZ2V0X3Byb3AoZW50aXR5LmdldF9sb2NhbF9wbGF5ZXIoKSwibV9mbFBvc2VQYXJhbWV0ZXIiLCAxMSkgb3IgMCkqMTIwLTYwKzAuNSkpKQoJCQkJaWYgeWF3X2JvZHkgPiAwIGFuZCB5YXdfYm9keSA+IDYwIHRoZW4geWF3X2JvZHkgPSA2MCBlbmQKCQkJCWlmIHlhd19ib2R5IDwgMCBhbmQgeWF3X2JvZHkgPCAtNjAgdGhlbiB5YXdfYm9keSA9IC02MCBlbmQKCQkJCXJlbmRlcmVyLmxpbmUodyArIC0oNDIpLCBoLTgsIHcgKyAtKDQyKSwgaCs4LCBycnJyLCBnZ2dnLCBiYmJiLCB5YXdfYm9keSA+IDAgYW5kIDU1IG9yIDI1NSkKCQkJCXJlbmRlcmVyLmxpbmUodyArICg0MiksIGgtOCwgdyArICg0MiksIGgrOCwgcnJyciwgZ2dnZywgYmJiYiwgeWF3X2JvZHkgPCAwIGFuZCA1NSBvciAyNTUpCgkJCQloID0gaCAtIDIuNQoJCQllbmQKCQkJaWYgZmxhZyA9PSAiYmVzdCIgdGhlbgoJCQkJbGVmdGtleSA9ICLirpwiCgkJCQlyaWdodGtleSA9ICLirp4iCgkJCQlmbGFnID0gImIiCgkJCWVuZAoJCQlpZiBzY3JpcHQuY2FjaGUubWFudWFsWyJhYSJdID09IDkwIHRoZW4KCQkJCXJlbmRlcmVyLnRleHQodyArIDUwLCBoLCBycnJyLCBnZ2dnLCBiYmJiLCAyNTUsICJjIiAuLiBmbGFnLCAwLCByaWdodGtleSkKCQkJZWxzZQoJCQkJcmVuZGVyZXIudGV4dCh3ICsgNTAsIGgsIHJyciwgZ2dnLCBiYmIsIGFhYSwgImMiIC4uIGZsYWcsIDAsIHJpZ2h0a2V5KQoJCQllbmQKCQkJaWYgc2NyaXB0LmNhY2hlLm1hbnVhbFsiYWEiXSA9PSAtOTAgdGhlbgoJCQkJcmVuZGVyZXIudGV4dCh3ICsgLSg1MCksIGgsIHJycnIsIGdnZ2csIGJiYmIsIDI1NSwgImMiIC4uIGZsYWcsIDAsIGxlZnRrZXkpCgkJCWVsc2UKCQkJCXJlbmRlcmVyLnRleHQodyArIC0oNTApLCBoLCBycnIsIGdnZywgYmJiLCBhYWEsICJjIiAuLiBmbGFnLCAwLCBsZWZ0a2V5KQoJCQllbmQKCQllbmQKCQlpZiB1aS5nZXQobWVudXRibC5jZW50ZXIpIHRoZW4KCQkJbG9jYWwgeWF3X2JvZHkgPSBtYXRoLm1heCgtNjAsIG1hdGgubWluKDYwLCBtYXRoLmZsb29yKChlbnRpdHkuZ2V0X3Byb3AoZW50aXR5LmdldF9sb2NhbF9wbGF5ZXIoKSwibV9mbFBvc2VQYXJhbWV0ZXIiLCAxMSkgb3IgMCkqMTIwLTYwKzAuNSkpKQoJCQlpZiB5YXdfYm9keSA+IDAgYW5kIHlhd19ib2R5ID4gNjAgdGhlbiB5YXdfYm9keSA9IDYwIGVuZAoJCQlpZiB5YXdfYm9keSA8IDAgYW5kIHlhd19ib2R5IDwgLTYwIHRoZW4geWF3X2JvZHkgPSAtNjAgZW5kCgkJCXNjb3BlX2ZpeCA9IGVudGl0eS5nZXRfcHJvcChtZSwgIm1fYklzU2NvcGVkIikgfj0gMAoJCQlpZiBzY29wZV9maXggdGhlbiAKCQkJCWlmIHNjb3BlX2ludCA8IDQwIHRoZW4KCQkJCQlzY29wZV9pbnQgPSBzY29wZV9pbnQgKyAxCgkJCQllbmQKCQkJZWxzZQoJCQkJaWYgc2NvcGVfaW50ID4gMCB0aGVuCgkJCQkJc2NvcGVfaW50ID0gc2NvcGVfaW50IC0gMQoJCQkJZW5kCgkJCWVuZAoJCQl3ID0gdyArIHNjb3BlX2ludAoJCQl3ID0gdyAtIDIKCQkJbG9jYWwgaW5kX2hlaWdodCA9IDI1CgkJCWxvY2FsIHIxLCBnMSwgYjEsIGExID0gcixnLGIsIDI1NQoJCQlsb2NhbCByMiwgZzIsIGIyLCBhMiA9IDE1NSwgMTU1LCAxNTUsIDI1NQoJCQlpZiB5YXdfYm9keSA+IDAgdGhlbgoJCQkJcmVuZGVyZXIudGV4dCggdywgaCArIGluZF9oZWlnaHQgLSAyLjUsIDI1NSwgMjU1LCAyNTUsIDI1NSwgImNiIiwgbmlsLCBncmFkaWVudChyMiwgZzIsIGIyLCBhMiwgcjEsIGcxLCBiMSwgYTEsICJMdWFzZW5zZSIpICkKCQkJZWxzZQoJCQkJcmVuZGVyZXIudGV4dCggdywgaCArIGluZF9oZWlnaHQgLSAyLjUsIDI1NSwgMjU1LCAyNTUsIDI1NSwgImNiIiwgbmlsLCBncmFkaWVudChyMSwgZzEsIGIxLCBhMSwgcjIsIGcyLCBiMiwgYTIsICJMdWFzZW5zZSIpICkKCQkJZW5kCgkJCWxvY2FsIGR0X29uID0gKHVpLmdldCh6Lml0ZW1zLmtleXMuZHRbMV0pIGFuZCB1aS5nZXQoei5pdGVtcy5rZXlzLmR0WzJdKSkKCQkJbG9jYWwgaHNfb24gPSAodWkuZ2V0KHouaXRlbXMua2V5cy5oc1sxXSkgYW5kIHVpLmdldCh6Lml0ZW1zLmtleXMuaHNbMl0pKQoJCQlpZiB1aS5nZXQoei5pdGVtcy5rZXlzLmZkWzFdKSB0aGVuCgkJCQlpbmRfaGVpZ2h0ID0gaW5kX2hlaWdodCArIDgKCQkJCXJlbmRlcmVyLnRleHQoIHcsIGggKyBpbmRfaGVpZ2h0LCByMiwgZzIsIGIyLCBhMiwgImMtIiwgbmlsLCAiRFVDSyIgKQoJCQkJaWYgZW50aXR5LmdldF9wcm9wKG1lLCAibV9mbER1Y2tBbW91bnQiKSA+IDAuMSB0aGVuCgkJCQkJaWYgYW5pbWtleXMuZHVjayA8IDI1NSB0aGVuCgkJCQkJCWFuaW1rZXlzLmR1Y2sgPSBhbmlta2V5cy5kdWNrICsgMi41CgkJCQkJZW5kCgkJCQkJcmVuZGVyZXIudGV4dCggdywgaCArIGluZF9oZWlnaHQsIHIxLCBnMSwgYjEsIGFuaW1rZXlzLmR1Y2ssICJjLSIsIG5pbCwgIkRVQ0siICkKCQkJCWVsc2UKCQkJCQlhbmlta2V5cy5kdWNrID0gMAoJCQkJZW5kCgkJCWVsc2UKCQkJCWFuaW1rZXlzLmR1Y2sgPSAwCgkJCWVuZAoJCQlpZiB1aS5nZXQoei5pdGVtcy5rZXlzLnNwWzFdKSB0aGVuCgkJCQlpbmRfaGVpZ2h0ID0gaW5kX2hlaWdodCArIDgKCQkJCWlmIGFuaW1rZXlzLnNhZmUgIDwgMjU1IHRoZW4KCQkJCQlhbmlta2V5cy5zYWZlID0gYW5pbWtleXMuc2FmZSAgKyAyLjUKCQkJCWVuZAoJCQkJcmVuZGVyZXIudGV4dCggdywgaCArIGluZF9oZWlnaHQsIHIxLCBnMSwgYjEsIGFuaW1rZXlzLnNhZmUgLCAiYy0iLCBuaWwsICJTQUZFIiApCgkJCWVsc2UKCQkJCWFuaW1rZXlzLnNhZmUgPSAwCgkJCWVuZAoJCQlpZiB1aS5nZXQoei5pdGVtcy5rZXlzLmZiWzFdKSB0aGVuCgkJCQlpbmRfaGVpZ2h0ID0gaW5kX2hlaWdodCArIDgKCQkJCWlmIGFuaW1rZXlzLmJhaW0gIDwgMjU1IHRoZW4KCQkJCQlhbmlta2V5cy5iYWltID0gYW5pbWtleXMuYmFpbSAgKyAyLjUKCQkJCWVuZAoJCQkJcmVuZGVyZXIudGV4dCggdywgaCArIGluZF9oZWlnaHQsIHIxLCBnMSwgYjEsIGFuaW1rZXlzLmJhaW0gLCAiYy0iLCBuaWwsICJCQUlNIiApCgkJCWVsc2UKCQkJCWFuaW1rZXlzLmJhaW0gPSAwCgkJCWVuZAoJCQlpZiBkdF9vbiB0aGVuCgkJCQlpbmRfaGVpZ2h0ID0gaW5kX2hlaWdodCArIDgKCQkJCXJlbmRlcmVyLnRleHQoIHcsIGggKyBpbmRfaGVpZ2h0LCByMiwgZzIsIGIyLCBhMiwgImMtIiwgbmlsLCAiRFQiICkKCQkJCWlmIChzaGlmdF9pbnQgPiAwKSBvciAoei5kZWZlbnNpdmUuZGVmZW5zaXZlID4gMSkgdGhlbgoJCQkJCWlmIGFuaW1rZXlzLmR0ICA8IDI1NSB0aGVuCgkJCQkJCWFuaW1rZXlzLmR0ICA9IGFuaW1rZXlzLmR0ICArIDIuNQoJCQkJCWVuZAoJCQkJCXJlbmRlcmVyLnRleHQoIHcsIGggKyBpbmRfaGVpZ2h0LCByMSwgZzEsIGIxLCBhbmlta2V5cy5kdCAsICJjLSIsIG5pbCwgIkRUIiApCgkJCQllbHNlCgkJCQkJYW5pbWtleXMuZHQgPSAwCgkJCQllbmQKCQkJZWxzZQoJCQkJYW5pbWtleXMuZHQgPSAwCgkJCWVuZAoJCQlpZiBoc19vbiB0aGVuCgkJCQlpbmRfaGVpZ2h0ID0gaW5kX2hlaWdodCArIDgKCQkJCXJlbmRlcmVyLnRleHQoIHcsIGggKyBpbmRfaGVpZ2h0LCByMiwgZzIsIGIyLCBhMiwgImMtIiwgbmlsLCAiSFMiICkKCQkJCWlmIG5vdCAoZHRfb24pIHRoZW4KCQkJCQlpZiBhbmlta2V5cy5oaWRlICA8IDI1NSB0aGVuCgkJCQkJCWFuaW1rZXlzLmhpZGUgID0gYW5pbWtleXMuaGlkZSAgKyAyLjUKCQkJCQllbmQKCQkJCQlyZW5kZXJlci50ZXh0KCB3LCBoICsgaW5kX2hlaWdodCwgcjEsIGcxLCBiMSwgYW5pbWtleXMuaGlkZSAsICJjLSIsIG5pbCwgIkhTIiApCgkJCQllbHNlCgkJCQkJYW5pbWtleXMuaGlkZSA9IDAKCQkJCWVuZAoJCQllbHNlCgkJCQlhbmlta2V5cy5oaWRlID0gMAoJCQllbmQKCQkJaWYgdWkuZ2V0KHoubWVudVsiS2V5YmluZHMiXS5mcykgdGhlbgoJCQkJaW5kX2hlaWdodCA9IGluZF9oZWlnaHQgKyA4CgkJCQlpZiBhbmlta2V5cy5mcyAgPCAyNTUgdGhlbgoJCQkJCWFuaW1rZXlzLmZzID0gYW5pbWtleXMuZnMgICsgMi41CgkJCQllbmQKCQkJCXJlbmRlcmVyLnRleHQoIHcsIGggKyBpbmRfaGVpZ2h0LCByMSwgZzEsIGIxLCBhbmlta2V5cy5mcyAsICJjLSIsIG5pbCwgIkZTIiApCgkJCWVsc2UKCQkJCWFuaW1rZXlzLmZzID0gMAoJCQllbmQKCQllbmQKCWVuZAoJei5yZXNldCA9IGZ1bmN0aW9uKCkKCQlzY3JpcHQuY2FjaGUubWFudWFsWyJ0aWNrIl0gPSAwCgkJc2NyaXB0LmNhY2hlLm1hbnVhbFsiYWEiXSA9IDAKCWVuZAogICAgei5ldmVudHMgPSB7CiAgICAgICAgcGFpbnRfdWkgPSB7IHouaGlkZXNob3dldGMudGl0bGUsIHouaGlkZXNob3dldGMuaGFuZGxlciwgei5pbmRpY2F0b3IgfSwKICAgICAgICBzZXR1cF9jb21tYW5kID0geyB6LmFhLmJ1aWxkZXIgfSwKCQlydW5fY29tbWFuZCA9IHsgei5kZWZlbnNpdmUucnVuIH0sCgkJcHJlZGljdF9jb21tYW5kID0geyB6LmRlZmVuc2l2ZS5wcmVkaWN0IH0sCgkJYnVsbGV0X2ltcGFjdCA9IHsgei5hbnRpYmYuZXZlbnQgfSwKICAgICAgICBzaHV0ZG93biA9IHsgei5oaWRlc2hvd2V0Yy5yZXNldG1lbnUgfSwKCQluZXRfdXBkYXRlX3N0YXJ0ID0geyB6LmR0c2hpZnQgfSwKCQlyb3VuZF9wcmVzdGFydCA9IHsgei5yZXNldCB9CiAgICB9CiAgICBmb3IgaW5kZXgsIHZhbHVlIGluIG5leHQsIHouZXZlbnRzIGRvIAogICAgICAgIGZvciBpLCB2IGluIG5leHQsIHZhbHVlIGRvIGNsaWVudC5zZXRfZXZlbnRfY2FsbGJhY2soaW5kZXgsIHYpIGVuZAogICAgZW5kCmVuZCkoewogICAgcmVmID0gZnVuY3Rpb24oYSxiLGMpIHByaW50KGEsYixjKXJldHVybiB7IHVpLnJlZmVyZW5jZShhLGIsYykgfSBlbmQsCiAgICBjbGFtcCA9IGZ1bmN0aW9uKHgpIGlmIHggPT0gbmlsIHRoZW4gcmV0dXJuIDAgZW5kIHggPSAoeCAlIDM2MCArIDM2MCkgJSAzNjAgcmV0dXJuIHggPiAxODAgYW5kIHggLSAzNjAgb3IgeCBlbmQsCiAgICBjb250YWlucyA9IGZ1bmN0aW9uKHoseCkgZm9yIGksIHYgaW4gbmV4dCwgeiBkbyBpZiB2ID09IHggdGhlbiByZXR1cm4gdHJ1ZSBlbmQgZW5kIHJldHVybiBmYWxzZSBlbmQsCiAgICBzdGF0ZXMgPSB7ICJHbG9iYWwiLCAiU3RhbmRpbmciLCAiTW92aW5nIiwgIkFpciIsICJBaXIgZHVjayIsICJEdWNrIiwgIkR1Y2sgbW92aW5nIiwgIlNsb3cgbW90aW9uIiB9LAogICAgZ2V0c3RhdGUgPSBmdW5jdGlvbihtZSwgYWlyLCBkdWNrLCBzcGVlZCwgZmwsIHNsb3djaGVjaykKICAgICAgICBsb2NhbCBzdGF0ZSA9ICJHbG9iYWwiCiAgICAgICAgaWYgYWlyIGFuZCBkdWNrIHRoZW4gc3RhdGUgPSAiQWlyIGR1Y2siIGVuZAogICAgICAgIGlmIGFpciBhbmQgbm90IGR1Y2sgdGhlbiBzdGF0ZSA9ICJBaXIiIGVuZAogICAgICAgIGlmIGR1Y2sgYW5kIG5vdCBhaXIgYW5kIHNwZWVkIDwgMS4xIHRoZW4gc3RhdGUgPSAiRHVjayIgZW5kCiAgICAgICAgaWYgZHVjayBhbmQgbm90IGFpciBhbmQgc3BlZWQgPiAxLjEgdGhlbiBzdGF0ZSA9ICJEdWNrIG1vdmluZyIgZW5kCiAgICAgICAgaWYgc3BlZWQgPCAxLjEgYW5kIG5vdCBhaXIgYW5kIG5vdCBkdWNrIHRoZW4gc3RhdGUgPSAiU3RhbmRpbmciIGVuZAogICAgICAgIGlmIHNwZWVkID4gMS4xIGFuZCBub3QgYWlyIGFuZCBub3QgZHVjayB0aGVuIHN0YXRlID0gIk1vdmluZyIgZW5kCgkJaWYgc2xvd2NoZWNrIGFuZCBub3QgYWlyIGFuZCBub3QgZHVjayBhbmQgc3BlZWQgPiAxLjEgdGhlbiBzdGF0ZSA9ICJTbG93IG1vdGlvbiIgZW5kCiAgICAgICAgcmV0dXJuIHN0YXRlCiAgICBlbmQsCn0pCg=="}